function Xy(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const l=Object.getOwnPropertyDescriptor(n,i);l&&Object.defineProperty(t,i,l.get?l:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=r(i);fetch(i.href,l)}})();function tu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Jy(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}var Xd={exports:{}},No={},Jd={exports:{}},lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gm;function Yy(){if(Gm)return lt;Gm=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function v(M){return M===null||typeof M!="object"?null:(M=g&&M[g]||M["@@iterator"],typeof M=="function"?M:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,y={};function E(M,b,I){this.props=M,this.context=b,this.refs=y,this.updater=I||w}E.prototype.isReactComponent={},E.prototype.setState=function(M,b){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,b,"setState")},E.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function D(){}D.prototype=E.prototype;function A(M,b,I){this.props=M,this.context=b,this.refs=y,this.updater=I||w}var C=A.prototype=new D;C.constructor=A,S(C,E.prototype),C.isPureReactComponent=!0;var P=Array.isArray,F=Object.prototype.hasOwnProperty,L={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function j(M,b,I){var H,G={},se=null,_e=null;if(b!=null)for(H in b.ref!==void 0&&(_e=b.ref),b.key!==void 0&&(se=""+b.key),b)F.call(b,H)&&!N.hasOwnProperty(H)&&(G[H]=b[H]);var me=arguments.length-2;if(me===1)G.children=I;else if(1<me){for(var ye=Array(me),xe=0;xe<me;xe++)ye[xe]=arguments[xe+2];G.children=ye}if(M&&M.defaultProps)for(H in me=M.defaultProps,me)G[H]===void 0&&(G[H]=me[H]);return{$$typeof:t,type:M,key:se,ref:_e,props:G,_owner:L.current}}function T(M,b){return{$$typeof:t,type:M.type,key:b,ref:M.ref,props:M.props,_owner:M._owner}}function k(M){return typeof M=="object"&&M!==null&&M.$$typeof===t}function q(M){var b={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(I){return b[I]})}var B=/\/+/g;function Y(M,b){return typeof M=="object"&&M!==null&&M.key!=null?q(""+M.key):b.toString(36)}function pe(M,b,I,H,G){var se=typeof M;(se==="undefined"||se==="boolean")&&(M=null);var _e=!1;if(M===null)_e=!0;else switch(se){case"string":case"number":_e=!0;break;case"object":switch(M.$$typeof){case t:case e:_e=!0}}if(_e)return _e=M,G=G(_e),M=H===""?"."+Y(_e,0):H,P(G)?(I="",M!=null&&(I=M.replace(B,"$&/")+"/"),pe(G,b,I,"",function(xe){return xe})):G!=null&&(k(G)&&(G=T(G,I+(!G.key||_e&&_e.key===G.key?"":(""+G.key).replace(B,"$&/")+"/")+M)),b.push(G)),1;if(_e=0,H=H===""?".":H+":",P(M))for(var me=0;me<M.length;me++){se=M[me];var ye=H+Y(se,me);_e+=pe(se,b,I,ye,G)}else if(ye=v(M),typeof ye=="function")for(M=ye.call(M),me=0;!(se=M.next()).done;)se=se.value,ye=H+Y(se,me++),_e+=pe(se,b,I,ye,G);else if(se==="object")throw b=String(M),Error("Objects are not valid as a React child (found: "+(b==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":b)+"). If you meant to render a collection of children, use an array instead.");return _e}function we(M,b,I){if(M==null)return M;var H=[],G=0;return pe(M,H,"","",function(se){return b.call(I,se,G++)}),H}function te(M){if(M._status===-1){var b=M._result;b=b(),b.then(function(I){(M._status===0||M._status===-1)&&(M._status=1,M._result=I)},function(I){(M._status===0||M._status===-1)&&(M._status=2,M._result=I)}),M._status===-1&&(M._status=0,M._result=b)}if(M._status===1)return M._result.default;throw M._result}var he={current:null},Q={transition:null},W={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:Q,ReactCurrentOwner:L};function re(){throw Error("act(...) is not supported in production builds of React.")}return lt.Children={map:we,forEach:function(M,b,I){we(M,function(){b.apply(this,arguments)},I)},count:function(M){var b=0;return we(M,function(){b++}),b},toArray:function(M){return we(M,function(b){return b})||[]},only:function(M){if(!k(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},lt.Component=E,lt.Fragment=r,lt.Profiler=i,lt.PureComponent=A,lt.StrictMode=n,lt.Suspense=m,lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W,lt.act=re,lt.cloneElement=function(M,b,I){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var H=S({},M.props),G=M.key,se=M.ref,_e=M._owner;if(b!=null){if(b.ref!==void 0&&(se=b.ref,_e=L.current),b.key!==void 0&&(G=""+b.key),M.type&&M.type.defaultProps)var me=M.type.defaultProps;for(ye in b)F.call(b,ye)&&!N.hasOwnProperty(ye)&&(H[ye]=b[ye]===void 0&&me!==void 0?me[ye]:b[ye])}var ye=arguments.length-2;if(ye===1)H.children=I;else if(1<ye){me=Array(ye);for(var xe=0;xe<ye;xe++)me[xe]=arguments[xe+2];H.children=me}return{$$typeof:t,type:M.type,key:G,ref:se,props:H,_owner:_e}},lt.createContext=function(M){return M={$$typeof:c,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:l,_context:M},M.Consumer=M},lt.createElement=j,lt.createFactory=function(M){var b=j.bind(null,M);return b.type=M,b},lt.createRef=function(){return{current:null}},lt.forwardRef=function(M){return{$$typeof:d,render:M}},lt.isValidElement=k,lt.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:te}},lt.memo=function(M,b){return{$$typeof:f,type:M,compare:b===void 0?null:b}},lt.startTransition=function(M){var b=Q.transition;Q.transition={};try{M()}finally{Q.transition=b}},lt.unstable_act=re,lt.useCallback=function(M,b){return he.current.useCallback(M,b)},lt.useContext=function(M){return he.current.useContext(M)},lt.useDebugValue=function(){},lt.useDeferredValue=function(M){return he.current.useDeferredValue(M)},lt.useEffect=function(M,b){return he.current.useEffect(M,b)},lt.useId=function(){return he.current.useId()},lt.useImperativeHandle=function(M,b,I){return he.current.useImperativeHandle(M,b,I)},lt.useInsertionEffect=function(M,b){return he.current.useInsertionEffect(M,b)},lt.useLayoutEffect=function(M,b){return he.current.useLayoutEffect(M,b)},lt.useMemo=function(M,b){return he.current.useMemo(M,b)},lt.useReducer=function(M,b,I){return he.current.useReducer(M,b,I)},lt.useRef=function(M){return he.current.useRef(M)},lt.useState=function(M){return he.current.useState(M)},lt.useSyncExternalStore=function(M,b,I){return he.current.useSyncExternalStore(M,b,I)},lt.useTransition=function(){return he.current.useTransition()},lt.version="18.3.1",lt}var Km;function zf(){return Km||(Km=1,Jd.exports=Yy()),Jd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xm;function Qy(){if(Xm)return No;Xm=1;var t=zf(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(d,m,f){var p,g={},v=null,w=null;f!==void 0&&(v=""+f),m.key!==void 0&&(v=""+m.key),m.ref!==void 0&&(w=m.ref);for(p in m)n.call(m,p)&&!l.hasOwnProperty(p)&&(g[p]=m[p]);if(d&&d.defaultProps)for(p in m=d.defaultProps,m)g[p]===void 0&&(g[p]=m[p]);return{$$typeof:e,type:d,key:v,ref:w,props:g,_owner:i.current}}return No.Fragment=r,No.jsx=c,No.jsxs=c,No}var Jm;function Zy(){return Jm||(Jm=1,Xd.exports=Qy()),Xd.exports}var a=Zy(),U=zf();const $f=tu(U),e_=Xy({__proto__:null,default:$f},[U]);var _c={},Yd={exports:{}},Wr={},Qd={exports:{}},Zd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ym;function t_(){return Ym||(Ym=1,function(t){function e(Q,W){var re=Q.length;Q.push(W);e:for(;0<re;){var M=re-1>>>1,b=Q[M];if(0<i(b,W))Q[M]=W,Q[re]=b,re=M;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var W=Q[0],re=Q.pop();if(re!==W){Q[0]=re;e:for(var M=0,b=Q.length,I=b>>>1;M<I;){var H=2*(M+1)-1,G=Q[H],se=H+1,_e=Q[se];if(0>i(G,re))se<b&&0>i(_e,G)?(Q[M]=_e,Q[se]=re,M=se):(Q[M]=G,Q[H]=re,M=H);else if(se<b&&0>i(_e,re))Q[M]=_e,Q[se]=re,M=se;else break e}}return W}function i(Q,W){var re=Q.sortIndex-W.sortIndex;return re!==0?re:Q.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var m=[],f=[],p=1,g=null,v=3,w=!1,S=!1,y=!1,E=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(Q){for(var W=r(f);W!==null;){if(W.callback===null)n(f);else if(W.startTime<=Q)n(f),W.sortIndex=W.expirationTime,e(m,W);else break;W=r(f)}}function P(Q){if(y=!1,C(Q),!S)if(r(m)!==null)S=!0,te(F);else{var W=r(f);W!==null&&he(P,W.startTime-Q)}}function F(Q,W){S=!1,y&&(y=!1,D(j),j=-1),w=!0;var re=v;try{for(C(W),g=r(m);g!==null&&(!(g.expirationTime>W)||Q&&!q());){var M=g.callback;if(typeof M=="function"){g.callback=null,v=g.priorityLevel;var b=M(g.expirationTime<=W);W=t.unstable_now(),typeof b=="function"?g.callback=b:g===r(m)&&n(m),C(W)}else n(m);g=r(m)}if(g!==null)var I=!0;else{var H=r(f);H!==null&&he(P,H.startTime-W),I=!1}return I}finally{g=null,v=re,w=!1}}var L=!1,N=null,j=-1,T=5,k=-1;function q(){return!(t.unstable_now()-k<T)}function B(){if(N!==null){var Q=t.unstable_now();k=Q;var W=!0;try{W=N(!0,Q)}finally{W?Y():(L=!1,N=null)}}else L=!1}var Y;if(typeof A=="function")Y=function(){A(B)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,we=pe.port2;pe.port1.onmessage=B,Y=function(){we.postMessage(null)}}else Y=function(){E(B,0)};function te(Q){N=Q,L||(L=!0,Y())}function he(Q,W){j=E(function(){Q(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){S||w||(S=!0,te(F))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return r(m)},t.unstable_next=function(Q){switch(v){case 1:case 2:case 3:var W=3;break;default:W=v}var re=v;v=W;try{return Q()}finally{v=re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,W){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var re=v;v=Q;try{return W()}finally{v=re}},t.unstable_scheduleCallback=function(Q,W,re){var M=t.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?M+re:M):re=M,Q){case 1:var b=-1;break;case 2:b=250;break;case 5:b=1073741823;break;case 4:b=1e4;break;default:b=5e3}return b=re+b,Q={id:p++,callback:W,priorityLevel:Q,startTime:re,expirationTime:b,sortIndex:-1},re>M?(Q.sortIndex=re,e(f,Q),r(m)===null&&Q===r(f)&&(y?(D(j),j=-1):y=!0,he(P,re-M))):(Q.sortIndex=b,e(m,Q),S||w||(S=!0,te(F))),Q},t.unstable_shouldYield=q,t.unstable_wrapCallback=function(Q){var W=v;return function(){var re=v;v=W;try{return Q.apply(this,arguments)}finally{v=re}}}}(Zd)),Zd}var Qm;function r_(){return Qm||(Qm=1,Qd.exports=t_()),Qd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zm;function n_(){if(Zm)return Wr;Zm=1;var t=zf(),e=r_();function r(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function l(s,o){c(s,o),c(s+"Capture",o)}function c(s,o){for(i[s]=o,s=0;s<o.length;s++)n.add(o[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function v(s){return m.call(g,s)?!0:m.call(p,s)?!1:f.test(s)?g[s]=!0:(p[s]=!0,!1)}function w(s,o,u,h){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function S(s,o,u,h){if(o===null||typeof o>"u"||w(s,o,u,h))return!0;if(h)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function y(s,o,u,h,x,_,O){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=x,this.mustUseProperty=u,this.propertyName=s,this.type=o,this.sanitizeURL=_,this.removeEmptyString=O}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){E[s]=new y(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var o=s[0];E[o]=new y(o,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){E[s]=new y(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){E[s]=new y(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){E[s]=new y(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){E[s]=new y(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){E[s]=new y(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){E[s]=new y(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){E[s]=new y(s,5,!1,s.toLowerCase(),null,!1,!1)});var D=/[\-:]([a-z])/g;function A(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var o=s.replace(D,A);E[o]=new y(o,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var o=s.replace(D,A);E[o]=new y(o,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var o=s.replace(D,A);E[o]=new y(o,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){E[s]=new y(s,1,!1,s.toLowerCase(),null,!1,!1)}),E.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){E[s]=new y(s,1,!1,s.toLowerCase(),null,!0,!0)});function C(s,o,u,h){var x=E.hasOwnProperty(o)?E[o]:null;(x!==null?x.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(S(o,u,x,h)&&(u=null),h||x===null?v(o)&&(u===null?s.removeAttribute(o):s.setAttribute(o,""+u)):x.mustUseProperty?s[x.propertyName]=u===null?x.type===3?!1:"":u:(o=x.attributeName,h=x.attributeNamespace,u===null?s.removeAttribute(o):(x=x.type,u=x===3||x===4&&u===!0?"":""+u,h?s.setAttributeNS(h,o,u):s.setAttribute(o,u))))}var P=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),L=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),q=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),pe=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),Q=Symbol.iterator;function W(s){return s===null||typeof s!="object"?null:(s=Q&&s[Q]||s["@@iterator"],typeof s=="function"?s:null)}var re=Object.assign,M;function b(s){if(M===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);M=o&&o[1]||""}return`
`+M+s}var I=!1;function H(s,o){if(!s||I)return"";I=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(fe){var h=fe}Reflect.construct(s,[],o)}else{try{o.call()}catch(fe){h=fe}s.call(o.prototype)}else{try{throw Error()}catch(fe){h=fe}s()}}catch(fe){if(fe&&h&&typeof fe.stack=="string"){for(var x=fe.stack.split(`
`),_=h.stack.split(`
`),O=x.length-1,Z=_.length-1;1<=O&&0<=Z&&x[O]!==_[Z];)Z--;for(;1<=O&&0<=Z;O--,Z--)if(x[O]!==_[Z]){if(O!==1||Z!==1)do if(O--,Z--,0>Z||x[O]!==_[Z]){var ee=`
`+x[O].replace(" at new "," at ");return s.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",s.displayName)),ee}while(1<=O&&0<=Z);break}}}finally{I=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?b(s):""}function G(s){switch(s.tag){case 5:return b(s.type);case 16:return b("Lazy");case 13:return b("Suspense");case 19:return b("SuspenseList");case 0:case 2:case 15:return s=H(s.type,!1),s;case 11:return s=H(s.type.render,!1),s;case 1:return s=H(s.type,!0),s;default:return""}}function se(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case N:return"Fragment";case L:return"Portal";case T:return"Profiler";case j:return"StrictMode";case Y:return"Suspense";case pe:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case q:return(s.displayName||"Context")+".Consumer";case k:return(s._context.displayName||"Context")+".Provider";case B:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case we:return o=s.displayName||null,o!==null?o:se(s.type)||"Memo";case te:o=s._payload,s=s._init;try{return se(s(o))}catch{}}return null}function _e(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(o);case 8:return o===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function me(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ye(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function xe(s){var o=ye(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),h=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var x=u.get,_=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return x.call(this)},set:function(O){h=""+O,_.call(this,O)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(O){h=""+O},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Ie(s){s._valueTracker||(s._valueTracker=xe(s))}function qe(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return s&&(h=ye(s)?s.checked?"true":"false":s.value),s=h,s!==u?(o.setValue(s),!0):!1}function st(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ke(s,o){var u=o.checked;return re({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function tt(s,o){var u=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;u=me(o.value!=null?o.value:u),s._wrapperState={initialChecked:h,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function $e(s,o){o=o.checked,o!=null&&C(s,"checked",o,!1)}function Fe(s,o){$e(s,o);var u=me(o.value),h=o.type;if(u!=null)h==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(h==="submit"||h==="reset"){s.removeAttribute("value");return}o.hasOwnProperty("value")?ot(s,o.type,u):o.hasOwnProperty("defaultValue")&&ot(s,o.type,me(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(s.defaultChecked=!!o.defaultChecked)}function Qe(s,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+s._wrapperState.initialValue,u||o===s.value||(s.value=o),s.defaultValue=o}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function ot(s,o,u){(o!=="number"||st(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var ut=Array.isArray;function qt(s,o,u,h){if(s=s.options,o){o={};for(var x=0;x<u.length;x++)o["$"+u[x]]=!0;for(u=0;u<s.length;u++)x=o.hasOwnProperty("$"+s[u].value),s[u].selected!==x&&(s[u].selected=x),x&&h&&(s[u].defaultSelected=!0)}else{for(u=""+me(u),o=null,x=0;x<s.length;x++){if(s[x].value===u){s[x].selected=!0,h&&(s[x].defaultSelected=!0);return}o!==null||s[x].disabled||(o=s[x])}o!==null&&(o.selected=!0)}}function hr(s,o){if(o.dangerouslySetInnerHTML!=null)throw Error(r(91));return re({},o,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function ln(s,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(r(92));if(ut(u)){if(1<u.length)throw Error(r(93));u=u[0]}o=u}o==null&&(o=""),u=o}s._wrapperState={initialValue:me(u)}}function pt(s,o){var u=me(o.value),h=me(o.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),o.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),h!=null&&(s.defaultValue=""+h)}function rr(s){var o=s.textContent;o===s._wrapperState.initialValue&&o!==""&&o!==null&&(s.value=o)}function kt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function It(s,o){return s==null||s==="http://www.w3.org/1999/xhtml"?kt(o):s==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Mt,ls=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,h,x){MSApp.execUnsafeLocalFunction(function(){return s(o,u,h,x)})}:s}(function(s,o){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=o;else{for(Mt=Mt||document.createElement("div"),Mt.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Mt.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;o.firstChild;)s.appendChild(o.firstChild)}});function yn(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var Or={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pr=["Webkit","ms","Moz","O"];Object.keys(Or).forEach(function(s){Pr.forEach(function(o){o=o+s.charAt(0).toUpperCase()+s.substring(1),Or[o]=Or[s]})});function _n(s,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||Or.hasOwnProperty(s)&&Or[s]?(""+o).trim():o+"px"}function cs(s,o){s=s.style;for(var u in o)if(o.hasOwnProperty(u)){var h=u.indexOf("--")===0,x=_n(u,o[u],h);u==="float"&&(u="cssFloat"),h?s.setProperty(u,x):s[u]=x}}var dl=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ui(s,o){if(o){if(dl[s]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(r(137,s));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(r(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(r(61))}if(o.style!=null&&typeof o.style!="object")throw Error(r(62))}}function zi(s,o){if(s.indexOf("-")===-1)return typeof o.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ra=null;function Fa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Da=null,us=null,ds=null;function ea(s){if(s=co(s)){if(typeof Da!="function")throw Error(r(280));var o=s.stateNode;o&&(o=Dl(o),Da(s.stateNode,s.type,o))}}function fl(s){us?ds?ds.push(s):ds=[s]:us=s}function hl(){if(us){var s=us,o=ds;if(ds=us=null,ea(s),o)for(s=0;s<o.length;s++)ea(o[s])}}function ml(s,o){return s(o)}function pl(){}var $i=!1;function xl(s,o,u){if($i)return s(o,u);$i=!0;try{return ml(s,o,u)}finally{$i=!1,(us!==null||ds!==null)&&(pl(),hl())}}function ta(s,o){var u=s.stateNode;if(u===null)return null;var h=Dl(u);if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var Wi=!1;if(d)try{var Wn={};Object.defineProperty(Wn,"passive",{get:function(){Wi=!0}}),window.addEventListener("test",Wn,Wn),window.removeEventListener("test",Wn,Wn)}catch{Wi=!1}function pu(s,o,u,h,x,_,O,Z,ee){var fe=Array.prototype.slice.call(arguments,3);try{o.apply(u,fe)}catch(Ee){this.onError(Ee)}}var ra=!1,La=null,R=!1,K=null,z={onError:function(s){ra=!0,La=s}};function V(s,o,u,h,x,_,O,Z,ee){ra=!1,La=null,pu.apply(z,arguments)}function X(s,o,u,h,x,_,O,Z,ee){if(V.apply(this,arguments),ra){if(ra){var fe=La;ra=!1,La=null}else throw Error(r(198));R||(R=!0,K=fe)}}function J(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function le(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function ve(s){if(J(s)!==s)throw Error(r(188))}function oe(s){var o=s.alternate;if(!o){if(o=J(s),o===null)throw Error(r(188));return o!==s?null:s}for(var u=s,h=o;;){var x=u.return;if(x===null)break;var _=x.alternate;if(_===null){if(h=x.return,h!==null){u=h;continue}break}if(x.child===_.child){for(_=x.child;_;){if(_===u)return ve(x),s;if(_===h)return ve(x),o;_=_.sibling}throw Error(r(188))}if(u.return!==h.return)u=x,h=_;else{for(var O=!1,Z=x.child;Z;){if(Z===u){O=!0,u=x,h=_;break}if(Z===h){O=!0,h=x,u=_;break}Z=Z.sibling}if(!O){for(Z=_.child;Z;){if(Z===u){O=!0,u=_,h=x;break}if(Z===h){O=!0,h=_,u=x;break}Z=Z.sibling}if(!O)throw Error(r(189))}}if(u.alternate!==h)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:o}function ce(s){return s=oe(s),s!==null?de(s):null}function de(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=de(s);if(o!==null)return o;s=s.sibling}return null}var Ne=e.unstable_scheduleCallback,Le=e.unstable_cancelCallback,Be=e.unstable_shouldYield,ke=e.unstable_requestPaint,Te=e.unstable_now,Ze=e.unstable_getCurrentPriorityLevel,St=e.unstable_ImmediatePriority,Et=e.unstable_UserBlockingPriority,$t=e.unstable_NormalPriority,na=e.unstable_LowPriority,fs=e.unstable_IdlePriority,Rn=null,nr=null;function Vi(s){if(nr&&typeof nr.onCommitFiberRoot=="function")try{nr.onCommitFiberRoot(Rn,s,void 0,(s.current.flags&128)===128)}catch{}}var Wt=Math.clz32?Math.clz32:h1,d1=Math.log,f1=Math.LN2;function h1(s){return s>>>=0,s===0?32:31-(d1(s)/f1|0)|0}var gl=64,vl=4194304;function Hi(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function yl(s,o){var u=s.pendingLanes;if(u===0)return 0;var h=0,x=s.suspendedLanes,_=s.pingedLanes,O=u&268435455;if(O!==0){var Z=O&~x;Z!==0?h=Hi(Z):(_&=O,_!==0&&(h=Hi(_)))}else O=u&~x,O!==0?h=Hi(O):_!==0&&(h=Hi(_));if(h===0)return 0;if(o!==0&&o!==h&&(o&x)===0&&(x=h&-h,_=o&-o,x>=_||x===16&&(_&4194240)!==0))return o;if((h&4)!==0&&(h|=u&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=h;0<o;)u=31-Wt(o),x=1<<u,h|=s[u],o&=~x;return h}function m1(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function p1(s,o){for(var u=s.suspendedLanes,h=s.pingedLanes,x=s.expirationTimes,_=s.pendingLanes;0<_;){var O=31-Wt(_),Z=1<<O,ee=x[O];ee===-1?((Z&u)===0||(Z&h)!==0)&&(x[O]=m1(Z,o)):ee<=o&&(s.expiredLanes|=Z),_&=~Z}}function xu(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Eh(){var s=gl;return gl<<=1,(gl&4194240)===0&&(gl=64),s}function gu(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function qi(s,o,u){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-Wt(o),s[o]=u}function x1(s,o){var u=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var h=s.eventTimes;for(s=s.expirationTimes;0<u;){var x=31-Wt(u),_=1<<x;o[x]=0,h[x]=-1,s[x]=-1,u&=~_}}function vu(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var h=31-Wt(u),x=1<<h;x&o|s[h]&o&&(s[h]|=o),u&=~x}}var xt=0;function Nh(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var bh,yu,Th,kh,Ch,_u=!1,_l=[],hs=null,ms=null,ps=null,Gi=new Map,Ki=new Map,xs=[],g1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ah(s,o){switch(s){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":ms=null;break;case"mouseover":case"mouseout":ps=null;break;case"pointerover":case"pointerout":Gi.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ki.delete(o.pointerId)}}function Xi(s,o,u,h,x,_){return s===null||s.nativeEvent!==_?(s={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:_,targetContainers:[x]},o!==null&&(o=co(o),o!==null&&yu(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),s)}function v1(s,o,u,h,x){switch(o){case"focusin":return hs=Xi(hs,s,o,u,h,x),!0;case"dragenter":return ms=Xi(ms,s,o,u,h,x),!0;case"mouseover":return ps=Xi(ps,s,o,u,h,x),!0;case"pointerover":var _=x.pointerId;return Gi.set(_,Xi(Gi.get(_)||null,s,o,u,h,x)),!0;case"gotpointercapture":return _=x.pointerId,Ki.set(_,Xi(Ki.get(_)||null,s,o,u,h,x)),!0}return!1}function Oh(s){var o=sa(s.target);if(o!==null){var u=J(o);if(u!==null){if(o=u.tag,o===13){if(o=le(u),o!==null){s.blockedOn=o,Ch(s.priority,function(){Th(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function wl(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=ju(s.domEventName,s.eventSystemFlags,o[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);Ra=h,u.target.dispatchEvent(h),Ra=null}else return o=co(u),o!==null&&yu(o),s.blockedOn=u,!1;o.shift()}return!0}function Ph(s,o,u){wl(s)&&u.delete(o)}function y1(){_u=!1,hs!==null&&wl(hs)&&(hs=null),ms!==null&&wl(ms)&&(ms=null),ps!==null&&wl(ps)&&(ps=null),Gi.forEach(Ph),Ki.forEach(Ph)}function Ji(s,o){s.blockedOn===o&&(s.blockedOn=null,_u||(_u=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,y1)))}function Yi(s){function o(x){return Ji(x,s)}if(0<_l.length){Ji(_l[0],s);for(var u=1;u<_l.length;u++){var h=_l[u];h.blockedOn===s&&(h.blockedOn=null)}}for(hs!==null&&Ji(hs,s),ms!==null&&Ji(ms,s),ps!==null&&Ji(ps,s),Gi.forEach(o),Ki.forEach(o),u=0;u<xs.length;u++)h=xs[u],h.blockedOn===s&&(h.blockedOn=null);for(;0<xs.length&&(u=xs[0],u.blockedOn===null);)Oh(u),u.blockedOn===null&&xs.shift()}var Ia=P.ReactCurrentBatchConfig,jl=!0;function _1(s,o,u,h){var x=xt,_=Ia.transition;Ia.transition=null;try{xt=1,wu(s,o,u,h)}finally{xt=x,Ia.transition=_}}function w1(s,o,u,h){var x=xt,_=Ia.transition;Ia.transition=null;try{xt=4,wu(s,o,u,h)}finally{xt=x,Ia.transition=_}}function wu(s,o,u,h){if(jl){var x=ju(s,o,u,h);if(x===null)Bu(s,o,h,Sl,u),Ah(s,h);else if(v1(x,s,o,u,h))h.stopPropagation();else if(Ah(s,h),o&4&&-1<g1.indexOf(s)){for(;x!==null;){var _=co(x);if(_!==null&&bh(_),_=ju(s,o,u,h),_===null&&Bu(s,o,h,Sl,u),_===x)break;x=_}x!==null&&h.stopPropagation()}else Bu(s,o,h,null,u)}}var Sl=null;function ju(s,o,u,h){if(Sl=null,s=Fa(h),s=sa(s),s!==null)if(o=J(s),o===null)s=null;else if(u=o.tag,u===13){if(s=le(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null);return Sl=s,null}function Rh(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case St:return 1;case Et:return 4;case $t:case na:return 16;case fs:return 536870912;default:return 16}default:return 16}}var gs=null,Su=null,El=null;function Fh(){if(El)return El;var s,o=Su,u=o.length,h,x="value"in gs?gs.value:gs.textContent,_=x.length;for(s=0;s<u&&o[s]===x[s];s++);var O=u-s;for(h=1;h<=O&&o[u-h]===x[_-h];h++);return El=x.slice(s,1<h?1-h:void 0)}function Nl(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function bl(){return!0}function Dh(){return!1}function Jr(s){function o(u,h,x,_,O){this._reactName=u,this._targetInst=x,this.type=h,this.nativeEvent=_,this.target=O,this.currentTarget=null;for(var Z in s)s.hasOwnProperty(Z)&&(u=s[Z],this[Z]=u?u(_):_[Z]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?bl:Dh,this.isPropagationStopped=Dh,this}return re(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=bl)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=bl)},persist:function(){},isPersistent:bl}),o}var Ma={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eu=Jr(Ma),Qi=re({},Ma,{view:0,detail:0}),j1=Jr(Qi),Nu,bu,Zi,Tl=re({},Qi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ku,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Zi&&(Zi&&s.type==="mousemove"?(Nu=s.screenX-Zi.screenX,bu=s.screenY-Zi.screenY):bu=Nu=0,Zi=s),Nu)},movementY:function(s){return"movementY"in s?s.movementY:bu}}),Lh=Jr(Tl),S1=re({},Tl,{dataTransfer:0}),E1=Jr(S1),N1=re({},Qi,{relatedTarget:0}),Tu=Jr(N1),b1=re({},Ma,{animationName:0,elapsedTime:0,pseudoElement:0}),T1=Jr(b1),k1=re({},Ma,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),C1=Jr(k1),A1=re({},Ma,{data:0}),Ih=Jr(A1),O1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},P1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},R1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F1(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=R1[s])?!!o[s]:!1}function ku(){return F1}var D1=re({},Qi,{key:function(s){if(s.key){var o=O1[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Nl(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?P1[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ku,charCode:function(s){return s.type==="keypress"?Nl(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Nl(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),L1=Jr(D1),I1=re({},Tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mh=Jr(I1),M1=re({},Qi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ku}),B1=Jr(M1),U1=re({},Ma,{propertyName:0,elapsedTime:0,pseudoElement:0}),z1=Jr(U1),$1=re({},Tl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),W1=Jr($1),V1=[9,13,27,32],Cu=d&&"CompositionEvent"in window,eo=null;d&&"documentMode"in document&&(eo=document.documentMode);var H1=d&&"TextEvent"in window&&!eo,Bh=d&&(!Cu||eo&&8<eo&&11>=eo),Uh=" ",zh=!1;function $h(s,o){switch(s){case"keyup":return V1.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wh(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ba=!1;function q1(s,o){switch(s){case"compositionend":return Wh(o);case"keypress":return o.which!==32?null:(zh=!0,Uh);case"textInput":return s=o.data,s===Uh&&zh?null:s;default:return null}}function G1(s,o){if(Ba)return s==="compositionend"||!Cu&&$h(s,o)?(s=Fh(),El=Su=gs=null,Ba=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Bh&&o.locale!=="ko"?null:o.data;default:return null}}var K1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vh(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!K1[s.type]:o==="textarea"}function Hh(s,o,u,h){fl(h),o=Pl(o,"onChange"),0<o.length&&(u=new Eu("onChange","change",null,u,h),s.push({event:u,listeners:o}))}var to=null,ro=null;function X1(s){c0(s,0)}function kl(s){var o=Va(s);if(qe(o))return s}function J1(s,o){if(s==="change")return o}var qh=!1;if(d){var Au;if(d){var Ou="oninput"in document;if(!Ou){var Gh=document.createElement("div");Gh.setAttribute("oninput","return;"),Ou=typeof Gh.oninput=="function"}Au=Ou}else Au=!1;qh=Au&&(!document.documentMode||9<document.documentMode)}function Kh(){to&&(to.detachEvent("onpropertychange",Xh),ro=to=null)}function Xh(s){if(s.propertyName==="value"&&kl(ro)){var o=[];Hh(o,ro,s,Fa(s)),xl(X1,o)}}function Y1(s,o,u){s==="focusin"?(Kh(),to=o,ro=u,to.attachEvent("onpropertychange",Xh)):s==="focusout"&&Kh()}function Q1(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return kl(ro)}function Z1(s,o){if(s==="click")return kl(o)}function ey(s,o){if(s==="input"||s==="change")return kl(o)}function ty(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var wn=typeof Object.is=="function"?Object.is:ty;function no(s,o){if(wn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var x=u[h];if(!m.call(o,x)||!wn(s[x],o[x]))return!1}return!0}function Jh(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Yh(s,o){var u=Jh(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=o&&h>=o)return{node:u,offset:o-s};s=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Jh(u)}}function Qh(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Qh(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Zh(){for(var s=window,o=st();o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=st(s.document)}return o}function Pu(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function ry(s){var o=Zh(),u=s.focusedElem,h=s.selectionRange;if(o!==u&&u&&u.ownerDocument&&Qh(u.ownerDocument.documentElement,u)){if(h!==null&&Pu(u)){if(o=h.start,s=h.end,s===void 0&&(s=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(s,u.value.length);else if(s=(o=u.ownerDocument||document)&&o.defaultView||window,s.getSelection){s=s.getSelection();var x=u.textContent.length,_=Math.min(h.start,x);h=h.end===void 0?_:Math.min(h.end,x),!s.extend&&_>h&&(x=h,h=_,_=x),x=Yh(u,_);var O=Yh(u,h);x&&O&&(s.rangeCount!==1||s.anchorNode!==x.node||s.anchorOffset!==x.offset||s.focusNode!==O.node||s.focusOffset!==O.offset)&&(o=o.createRange(),o.setStart(x.node,x.offset),s.removeAllRanges(),_>h?(s.addRange(o),s.extend(O.node,O.offset)):(o.setEnd(O.node,O.offset),s.addRange(o)))}}for(o=[],s=u;s=s.parentNode;)s.nodeType===1&&o.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)s=o[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var ny=d&&"documentMode"in document&&11>=document.documentMode,Ua=null,Ru=null,so=null,Fu=!1;function e0(s,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Fu||Ua==null||Ua!==st(h)||(h=Ua,"selectionStart"in h&&Pu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),so&&no(so,h)||(so=h,h=Pl(Ru,"onSelect"),0<h.length&&(o=new Eu("onSelect","select",null,o,u),s.push({event:o,listeners:h}),o.target=Ua)))}function Cl(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var za={animationend:Cl("Animation","AnimationEnd"),animationiteration:Cl("Animation","AnimationIteration"),animationstart:Cl("Animation","AnimationStart"),transitionend:Cl("Transition","TransitionEnd")},Du={},t0={};d&&(t0=document.createElement("div").style,"AnimationEvent"in window||(delete za.animationend.animation,delete za.animationiteration.animation,delete za.animationstart.animation),"TransitionEvent"in window||delete za.transitionend.transition);function Al(s){if(Du[s])return Du[s];if(!za[s])return s;var o=za[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in t0)return Du[s]=o[u];return s}var r0=Al("animationend"),n0=Al("animationiteration"),s0=Al("animationstart"),a0=Al("transitionend"),i0=new Map,o0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vs(s,o){i0.set(s,o),l(o,[s])}for(var Lu=0;Lu<o0.length;Lu++){var Iu=o0[Lu],sy=Iu.toLowerCase(),ay=Iu[0].toUpperCase()+Iu.slice(1);vs(sy,"on"+ay)}vs(r0,"onAnimationEnd"),vs(n0,"onAnimationIteration"),vs(s0,"onAnimationStart"),vs("dblclick","onDoubleClick"),vs("focusin","onFocus"),vs("focusout","onBlur"),vs(a0,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iy=new Set("cancel close invalid load scroll toggle".split(" ").concat(ao));function l0(s,o,u){var h=s.type||"unknown-event";s.currentTarget=u,X(h,o,void 0,s),s.currentTarget=null}function c0(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],x=h.event;h=h.listeners;e:{var _=void 0;if(o)for(var O=h.length-1;0<=O;O--){var Z=h[O],ee=Z.instance,fe=Z.currentTarget;if(Z=Z.listener,ee!==_&&x.isPropagationStopped())break e;l0(x,Z,fe),_=ee}else for(O=0;O<h.length;O++){if(Z=h[O],ee=Z.instance,fe=Z.currentTarget,Z=Z.listener,ee!==_&&x.isPropagationStopped())break e;l0(x,Z,fe),_=ee}}}if(R)throw s=K,R=!1,K=null,s}function Ct(s,o){var u=o[Hu];u===void 0&&(u=o[Hu]=new Set);var h=s+"__bubble";u.has(h)||(u0(o,s,2,!1),u.add(h))}function Mu(s,o,u){var h=0;o&&(h|=4),u0(u,s,h,o)}var Ol="_reactListening"+Math.random().toString(36).slice(2);function io(s){if(!s[Ol]){s[Ol]=!0,n.forEach(function(u){u!=="selectionchange"&&(iy.has(u)||Mu(u,!1,s),Mu(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Ol]||(o[Ol]=!0,Mu("selectionchange",!1,o))}}function u0(s,o,u,h){switch(Rh(o)){case 1:var x=_1;break;case 4:x=w1;break;default:x=wu}u=x.bind(null,o,u,s),x=void 0,!Wi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),h?x!==void 0?s.addEventListener(o,u,{capture:!0,passive:x}):s.addEventListener(o,u,!0):x!==void 0?s.addEventListener(o,u,{passive:x}):s.addEventListener(o,u,!1)}function Bu(s,o,u,h,x){var _=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var O=h.tag;if(O===3||O===4){var Z=h.stateNode.containerInfo;if(Z===x||Z.nodeType===8&&Z.parentNode===x)break;if(O===4)for(O=h.return;O!==null;){var ee=O.tag;if((ee===3||ee===4)&&(ee=O.stateNode.containerInfo,ee===x||ee.nodeType===8&&ee.parentNode===x))return;O=O.return}for(;Z!==null;){if(O=sa(Z),O===null)return;if(ee=O.tag,ee===5||ee===6){h=_=O;continue e}Z=Z.parentNode}}h=h.return}xl(function(){var fe=_,Ee=Fa(u),be=[];e:{var Se=i0.get(s);if(Se!==void 0){var Me=Eu,ze=s;switch(s){case"keypress":if(Nl(u)===0)break e;case"keydown":case"keyup":Me=L1;break;case"focusin":ze="focus",Me=Tu;break;case"focusout":ze="blur",Me=Tu;break;case"beforeblur":case"afterblur":Me=Tu;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Me=Lh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Me=E1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Me=B1;break;case r0:case n0:case s0:Me=T1;break;case a0:Me=z1;break;case"scroll":Me=j1;break;case"wheel":Me=W1;break;case"copy":case"cut":case"paste":Me=C1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Me=Mh}var Ve=(o&4)!==0,Vt=!Ve&&s==="scroll",ae=Ve?Se!==null?Se+"Capture":null:Se;Ve=[];for(var ne=fe,ie;ne!==null;){ie=ne;var Ce=ie.stateNode;if(ie.tag===5&&Ce!==null&&(ie=Ce,ae!==null&&(Ce=ta(ne,ae),Ce!=null&&Ve.push(oo(ne,Ce,ie)))),Vt)break;ne=ne.return}0<Ve.length&&(Se=new Me(Se,ze,null,u,Ee),be.push({event:Se,listeners:Ve}))}}if((o&7)===0){e:{if(Se=s==="mouseover"||s==="pointerover",Me=s==="mouseout"||s==="pointerout",Se&&u!==Ra&&(ze=u.relatedTarget||u.fromElement)&&(sa(ze)||ze[Vn]))break e;if((Me||Se)&&(Se=Ee.window===Ee?Ee:(Se=Ee.ownerDocument)?Se.defaultView||Se.parentWindow:window,Me?(ze=u.relatedTarget||u.toElement,Me=fe,ze=ze?sa(ze):null,ze!==null&&(Vt=J(ze),ze!==Vt||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Me=null,ze=fe),Me!==ze)){if(Ve=Lh,Ce="onMouseLeave",ae="onMouseEnter",ne="mouse",(s==="pointerout"||s==="pointerover")&&(Ve=Mh,Ce="onPointerLeave",ae="onPointerEnter",ne="pointer"),Vt=Me==null?Se:Va(Me),ie=ze==null?Se:Va(ze),Se=new Ve(Ce,ne+"leave",Me,u,Ee),Se.target=Vt,Se.relatedTarget=ie,Ce=null,sa(Ee)===fe&&(Ve=new Ve(ae,ne+"enter",ze,u,Ee),Ve.target=ie,Ve.relatedTarget=Vt,Ce=Ve),Vt=Ce,Me&&ze)t:{for(Ve=Me,ae=ze,ne=0,ie=Ve;ie;ie=$a(ie))ne++;for(ie=0,Ce=ae;Ce;Ce=$a(Ce))ie++;for(;0<ne-ie;)Ve=$a(Ve),ne--;for(;0<ie-ne;)ae=$a(ae),ie--;for(;ne--;){if(Ve===ae||ae!==null&&Ve===ae.alternate)break t;Ve=$a(Ve),ae=$a(ae)}Ve=null}else Ve=null;Me!==null&&d0(be,Se,Me,Ve,!1),ze!==null&&Vt!==null&&d0(be,Vt,ze,Ve,!0)}}e:{if(Se=fe?Va(fe):window,Me=Se.nodeName&&Se.nodeName.toLowerCase(),Me==="select"||Me==="input"&&Se.type==="file")var Ge=J1;else if(Vh(Se))if(qh)Ge=ey;else{Ge=Q1;var Xe=Y1}else(Me=Se.nodeName)&&Me.toLowerCase()==="input"&&(Se.type==="checkbox"||Se.type==="radio")&&(Ge=Z1);if(Ge&&(Ge=Ge(s,fe))){Hh(be,Ge,u,Ee);break e}Xe&&Xe(s,Se,fe),s==="focusout"&&(Xe=Se._wrapperState)&&Xe.controlled&&Se.type==="number"&&ot(Se,"number",Se.value)}switch(Xe=fe?Va(fe):window,s){case"focusin":(Vh(Xe)||Xe.contentEditable==="true")&&(Ua=Xe,Ru=fe,so=null);break;case"focusout":so=Ru=Ua=null;break;case"mousedown":Fu=!0;break;case"contextmenu":case"mouseup":case"dragend":Fu=!1,e0(be,u,Ee);break;case"selectionchange":if(ny)break;case"keydown":case"keyup":e0(be,u,Ee)}var Je;if(Cu)e:{switch(s){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else Ba?$h(s,u)&&(Ye="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Ye="onCompositionStart");Ye&&(Bh&&u.locale!=="ko"&&(Ba||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&Ba&&(Je=Fh()):(gs=Ee,Su="value"in gs?gs.value:gs.textContent,Ba=!0)),Xe=Pl(fe,Ye),0<Xe.length&&(Ye=new Ih(Ye,s,null,u,Ee),be.push({event:Ye,listeners:Xe}),Je?Ye.data=Je:(Je=Wh(u),Je!==null&&(Ye.data=Je)))),(Je=H1?q1(s,u):G1(s,u))&&(fe=Pl(fe,"onBeforeInput"),0<fe.length&&(Ee=new Ih("onBeforeInput","beforeinput",null,u,Ee),be.push({event:Ee,listeners:fe}),Ee.data=Je))}c0(be,o)})}function oo(s,o,u){return{instance:s,listener:o,currentTarget:u}}function Pl(s,o){for(var u=o+"Capture",h=[];s!==null;){var x=s,_=x.stateNode;x.tag===5&&_!==null&&(x=_,_=ta(s,u),_!=null&&h.unshift(oo(s,_,x)),_=ta(s,o),_!=null&&h.push(oo(s,_,x))),s=s.return}return h}function $a(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function d0(s,o,u,h,x){for(var _=o._reactName,O=[];u!==null&&u!==h;){var Z=u,ee=Z.alternate,fe=Z.stateNode;if(ee!==null&&ee===h)break;Z.tag===5&&fe!==null&&(Z=fe,x?(ee=ta(u,_),ee!=null&&O.unshift(oo(u,ee,Z))):x||(ee=ta(u,_),ee!=null&&O.push(oo(u,ee,Z)))),u=u.return}O.length!==0&&s.push({event:o,listeners:O})}var oy=/\r\n?/g,ly=/\u0000|\uFFFD/g;function f0(s){return(typeof s=="string"?s:""+s).replace(oy,`
`).replace(ly,"")}function Rl(s,o,u){if(o=f0(o),f0(s)!==o&&u)throw Error(r(425))}function Fl(){}var Uu=null,zu=null;function $u(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Wu=typeof setTimeout=="function"?setTimeout:void 0,cy=typeof clearTimeout=="function"?clearTimeout:void 0,h0=typeof Promise=="function"?Promise:void 0,uy=typeof queueMicrotask=="function"?queueMicrotask:typeof h0<"u"?function(s){return h0.resolve(null).then(s).catch(dy)}:Wu;function dy(s){setTimeout(function(){throw s})}function Vu(s,o){var u=o,h=0;do{var x=u.nextSibling;if(s.removeChild(u),x&&x.nodeType===8)if(u=x.data,u==="/$"){if(h===0){s.removeChild(x),Yi(o);return}h--}else u!=="$"&&u!=="$?"&&u!=="$!"||h++;u=x}while(u);Yi(o)}function ys(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return s}function m0(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}var Wa=Math.random().toString(36).slice(2),Fn="__reactFiber$"+Wa,lo="__reactProps$"+Wa,Vn="__reactContainer$"+Wa,Hu="__reactEvents$"+Wa,fy="__reactListeners$"+Wa,hy="__reactHandles$"+Wa;function sa(s){var o=s[Fn];if(o)return o;for(var u=s.parentNode;u;){if(o=u[Vn]||u[Fn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=m0(s);s!==null;){if(u=s[Fn])return u;s=m0(s)}return o}s=u,u=s.parentNode}return null}function co(s){return s=s[Fn]||s[Vn],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Va(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(r(33))}function Dl(s){return s[lo]||null}var qu=[],Ha=-1;function _s(s){return{current:s}}function At(s){0>Ha||(s.current=qu[Ha],qu[Ha]=null,Ha--)}function Nt(s,o){Ha++,qu[Ha]=s.current,s.current=o}var ws={},Sr=_s(ws),Mr=_s(!1),aa=ws;function qa(s,o){var u=s.type.contextTypes;if(!u)return ws;var h=s.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var x={},_;for(_ in u)x[_]=o[_];return h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=x),x}function Br(s){return s=s.childContextTypes,s!=null}function Ll(){At(Mr),At(Sr)}function p0(s,o,u){if(Sr.current!==ws)throw Error(r(168));Nt(Sr,o),Nt(Mr,u)}function x0(s,o,u){var h=s.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return u;h=h.getChildContext();for(var x in h)if(!(x in o))throw Error(r(108,_e(s)||"Unknown",x));return re({},u,h)}function Il(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||ws,aa=Sr.current,Nt(Sr,s),Nt(Mr,Mr.current),!0}function g0(s,o,u){var h=s.stateNode;if(!h)throw Error(r(169));u?(s=x0(s,o,aa),h.__reactInternalMemoizedMergedChildContext=s,At(Mr),At(Sr),Nt(Sr,s)):At(Mr),Nt(Mr,u)}var Hn=null,Ml=!1,Gu=!1;function v0(s){Hn===null?Hn=[s]:Hn.push(s)}function my(s){Ml=!0,v0(s)}function js(){if(!Gu&&Hn!==null){Gu=!0;var s=0,o=xt;try{var u=Hn;for(xt=1;s<u.length;s++){var h=u[s];do h=h(!0);while(h!==null)}Hn=null,Ml=!1}catch(x){throw Hn!==null&&(Hn=Hn.slice(s+1)),Ne(St,js),x}finally{xt=o,Gu=!1}}return null}var Ga=[],Ka=0,Bl=null,Ul=0,cn=[],un=0,ia=null,qn=1,Gn="";function oa(s,o){Ga[Ka++]=Ul,Ga[Ka++]=Bl,Bl=s,Ul=o}function y0(s,o,u){cn[un++]=qn,cn[un++]=Gn,cn[un++]=ia,ia=s;var h=qn;s=Gn;var x=32-Wt(h)-1;h&=~(1<<x),u+=1;var _=32-Wt(o)+x;if(30<_){var O=x-x%5;_=(h&(1<<O)-1).toString(32),h>>=O,x-=O,qn=1<<32-Wt(o)+x|u<<x|h,Gn=_+s}else qn=1<<_|u<<x|h,Gn=s}function Ku(s){s.return!==null&&(oa(s,1),y0(s,1,0))}function Xu(s){for(;s===Bl;)Bl=Ga[--Ka],Ga[Ka]=null,Ul=Ga[--Ka],Ga[Ka]=null;for(;s===ia;)ia=cn[--un],cn[un]=null,Gn=cn[--un],cn[un]=null,qn=cn[--un],cn[un]=null}var Yr=null,Qr=null,Ft=!1,jn=null;function _0(s,o){var u=mn(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=s,o=s.deletions,o===null?(s.deletions=[u],s.flags|=16):o.push(u)}function w0(s,o){switch(s.tag){case 5:var u=s.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(s.stateNode=o,Yr=s,Qr=ys(o.firstChild),!0):!1;case 6:return o=s.pendingProps===""||o.nodeType!==3?null:o,o!==null?(s.stateNode=o,Yr=s,Qr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=ia!==null?{id:qn,overflow:Gn}:null,s.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=mn(18,null,null,0),u.stateNode=o,u.return=s,s.child=u,Yr=s,Qr=null,!0):!1;default:return!1}}function Ju(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Yu(s){if(Ft){var o=Qr;if(o){var u=o;if(!w0(s,o)){if(Ju(s))throw Error(r(418));o=ys(u.nextSibling);var h=Yr;o&&w0(s,o)?_0(h,u):(s.flags=s.flags&-4097|2,Ft=!1,Yr=s)}}else{if(Ju(s))throw Error(r(418));s.flags=s.flags&-4097|2,Ft=!1,Yr=s}}}function j0(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Yr=s}function zl(s){if(s!==Yr)return!1;if(!Ft)return j0(s),Ft=!0,!1;var o;if((o=s.tag!==3)&&!(o=s.tag!==5)&&(o=s.type,o=o!=="head"&&o!=="body"&&!$u(s.type,s.memoizedProps)),o&&(o=Qr)){if(Ju(s))throw S0(),Error(r(418));for(;o;)_0(s,o),o=ys(o.nextSibling)}if(j0(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(o===0){Qr=ys(s.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}s=s.nextSibling}Qr=null}}else Qr=Yr?ys(s.stateNode.nextSibling):null;return!0}function S0(){for(var s=Qr;s;)s=ys(s.nextSibling)}function Xa(){Qr=Yr=null,Ft=!1}function Qu(s){jn===null?jn=[s]:jn.push(s)}var py=P.ReactCurrentBatchConfig;function uo(s,o,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(r(309));var h=u.stateNode}if(!h)throw Error(r(147,s));var x=h,_=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===_?o.ref:(o=function(O){var Z=x.refs;O===null?delete Z[_]:Z[_]=O},o._stringRef=_,o)}if(typeof s!="string")throw Error(r(284));if(!u._owner)throw Error(r(290,s))}return s}function $l(s,o){throw s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function E0(s){var o=s._init;return o(s._payload)}function N0(s){function o(ae,ne){if(s){var ie=ae.deletions;ie===null?(ae.deletions=[ne],ae.flags|=16):ie.push(ne)}}function u(ae,ne){if(!s)return null;for(;ne!==null;)o(ae,ne),ne=ne.sibling;return null}function h(ae,ne){for(ae=new Map;ne!==null;)ne.key!==null?ae.set(ne.key,ne):ae.set(ne.index,ne),ne=ne.sibling;return ae}function x(ae,ne){return ae=As(ae,ne),ae.index=0,ae.sibling=null,ae}function _(ae,ne,ie){return ae.index=ie,s?(ie=ae.alternate,ie!==null?(ie=ie.index,ie<ne?(ae.flags|=2,ne):ie):(ae.flags|=2,ne)):(ae.flags|=1048576,ne)}function O(ae){return s&&ae.alternate===null&&(ae.flags|=2),ae}function Z(ae,ne,ie,Ce){return ne===null||ne.tag!==6?(ne=Wd(ie,ae.mode,Ce),ne.return=ae,ne):(ne=x(ne,ie),ne.return=ae,ne)}function ee(ae,ne,ie,Ce){var Ge=ie.type;return Ge===N?Ee(ae,ne,ie.props.children,Ce,ie.key):ne!==null&&(ne.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===te&&E0(Ge)===ne.type)?(Ce=x(ne,ie.props),Ce.ref=uo(ae,ne,ie),Ce.return=ae,Ce):(Ce=fc(ie.type,ie.key,ie.props,null,ae.mode,Ce),Ce.ref=uo(ae,ne,ie),Ce.return=ae,Ce)}function fe(ae,ne,ie,Ce){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ie.containerInfo||ne.stateNode.implementation!==ie.implementation?(ne=Vd(ie,ae.mode,Ce),ne.return=ae,ne):(ne=x(ne,ie.children||[]),ne.return=ae,ne)}function Ee(ae,ne,ie,Ce,Ge){return ne===null||ne.tag!==7?(ne=pa(ie,ae.mode,Ce,Ge),ne.return=ae,ne):(ne=x(ne,ie),ne.return=ae,ne)}function be(ae,ne,ie){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=Wd(""+ne,ae.mode,ie),ne.return=ae,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case F:return ie=fc(ne.type,ne.key,ne.props,null,ae.mode,ie),ie.ref=uo(ae,null,ne),ie.return=ae,ie;case L:return ne=Vd(ne,ae.mode,ie),ne.return=ae,ne;case te:var Ce=ne._init;return be(ae,Ce(ne._payload),ie)}if(ut(ne)||W(ne))return ne=pa(ne,ae.mode,ie,null),ne.return=ae,ne;$l(ae,ne)}return null}function Se(ae,ne,ie,Ce){var Ge=ne!==null?ne.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return Ge!==null?null:Z(ae,ne,""+ie,Ce);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case F:return ie.key===Ge?ee(ae,ne,ie,Ce):null;case L:return ie.key===Ge?fe(ae,ne,ie,Ce):null;case te:return Ge=ie._init,Se(ae,ne,Ge(ie._payload),Ce)}if(ut(ie)||W(ie))return Ge!==null?null:Ee(ae,ne,ie,Ce,null);$l(ae,ie)}return null}function Me(ae,ne,ie,Ce,Ge){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return ae=ae.get(ie)||null,Z(ne,ae,""+Ce,Ge);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case F:return ae=ae.get(Ce.key===null?ie:Ce.key)||null,ee(ne,ae,Ce,Ge);case L:return ae=ae.get(Ce.key===null?ie:Ce.key)||null,fe(ne,ae,Ce,Ge);case te:var Xe=Ce._init;return Me(ae,ne,ie,Xe(Ce._payload),Ge)}if(ut(Ce)||W(Ce))return ae=ae.get(ie)||null,Ee(ne,ae,Ce,Ge,null);$l(ne,Ce)}return null}function ze(ae,ne,ie,Ce){for(var Ge=null,Xe=null,Je=ne,Ye=ne=0,ir=null;Je!==null&&Ye<ie.length;Ye++){Je.index>Ye?(ir=Je,Je=null):ir=Je.sibling;var ft=Se(ae,Je,ie[Ye],Ce);if(ft===null){Je===null&&(Je=ir);break}s&&Je&&ft.alternate===null&&o(ae,Je),ne=_(ft,ne,Ye),Xe===null?Ge=ft:Xe.sibling=ft,Xe=ft,Je=ir}if(Ye===ie.length)return u(ae,Je),Ft&&oa(ae,Ye),Ge;if(Je===null){for(;Ye<ie.length;Ye++)Je=be(ae,ie[Ye],Ce),Je!==null&&(ne=_(Je,ne,Ye),Xe===null?Ge=Je:Xe.sibling=Je,Xe=Je);return Ft&&oa(ae,Ye),Ge}for(Je=h(ae,Je);Ye<ie.length;Ye++)ir=Me(Je,ae,Ye,ie[Ye],Ce),ir!==null&&(s&&ir.alternate!==null&&Je.delete(ir.key===null?Ye:ir.key),ne=_(ir,ne,Ye),Xe===null?Ge=ir:Xe.sibling=ir,Xe=ir);return s&&Je.forEach(function(Os){return o(ae,Os)}),Ft&&oa(ae,Ye),Ge}function Ve(ae,ne,ie,Ce){var Ge=W(ie);if(typeof Ge!="function")throw Error(r(150));if(ie=Ge.call(ie),ie==null)throw Error(r(151));for(var Xe=Ge=null,Je=ne,Ye=ne=0,ir=null,ft=ie.next();Je!==null&&!ft.done;Ye++,ft=ie.next()){Je.index>Ye?(ir=Je,Je=null):ir=Je.sibling;var Os=Se(ae,Je,ft.value,Ce);if(Os===null){Je===null&&(Je=ir);break}s&&Je&&Os.alternate===null&&o(ae,Je),ne=_(Os,ne,Ye),Xe===null?Ge=Os:Xe.sibling=Os,Xe=Os,Je=ir}if(ft.done)return u(ae,Je),Ft&&oa(ae,Ye),Ge;if(Je===null){for(;!ft.done;Ye++,ft=ie.next())ft=be(ae,ft.value,Ce),ft!==null&&(ne=_(ft,ne,Ye),Xe===null?Ge=ft:Xe.sibling=ft,Xe=ft);return Ft&&oa(ae,Ye),Ge}for(Je=h(ae,Je);!ft.done;Ye++,ft=ie.next())ft=Me(Je,ae,Ye,ft.value,Ce),ft!==null&&(s&&ft.alternate!==null&&Je.delete(ft.key===null?Ye:ft.key),ne=_(ft,ne,Ye),Xe===null?Ge=ft:Xe.sibling=ft,Xe=ft);return s&&Je.forEach(function(Ky){return o(ae,Ky)}),Ft&&oa(ae,Ye),Ge}function Vt(ae,ne,ie,Ce){if(typeof ie=="object"&&ie!==null&&ie.type===N&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case F:e:{for(var Ge=ie.key,Xe=ne;Xe!==null;){if(Xe.key===Ge){if(Ge=ie.type,Ge===N){if(Xe.tag===7){u(ae,Xe.sibling),ne=x(Xe,ie.props.children),ne.return=ae,ae=ne;break e}}else if(Xe.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===te&&E0(Ge)===Xe.type){u(ae,Xe.sibling),ne=x(Xe,ie.props),ne.ref=uo(ae,Xe,ie),ne.return=ae,ae=ne;break e}u(ae,Xe);break}else o(ae,Xe);Xe=Xe.sibling}ie.type===N?(ne=pa(ie.props.children,ae.mode,Ce,ie.key),ne.return=ae,ae=ne):(Ce=fc(ie.type,ie.key,ie.props,null,ae.mode,Ce),Ce.ref=uo(ae,ne,ie),Ce.return=ae,ae=Ce)}return O(ae);case L:e:{for(Xe=ie.key;ne!==null;){if(ne.key===Xe)if(ne.tag===4&&ne.stateNode.containerInfo===ie.containerInfo&&ne.stateNode.implementation===ie.implementation){u(ae,ne.sibling),ne=x(ne,ie.children||[]),ne.return=ae,ae=ne;break e}else{u(ae,ne);break}else o(ae,ne);ne=ne.sibling}ne=Vd(ie,ae.mode,Ce),ne.return=ae,ae=ne}return O(ae);case te:return Xe=ie._init,Vt(ae,ne,Xe(ie._payload),Ce)}if(ut(ie))return ze(ae,ne,ie,Ce);if(W(ie))return Ve(ae,ne,ie,Ce);$l(ae,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,ne!==null&&ne.tag===6?(u(ae,ne.sibling),ne=x(ne,ie),ne.return=ae,ae=ne):(u(ae,ne),ne=Wd(ie,ae.mode,Ce),ne.return=ae,ae=ne),O(ae)):u(ae,ne)}return Vt}var Ja=N0(!0),b0=N0(!1),Wl=_s(null),Vl=null,Ya=null,Zu=null;function ed(){Zu=Ya=Vl=null}function td(s){var o=Wl.current;At(Wl),s._currentValue=o}function rd(s,o,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===u)break;s=s.return}}function Qa(s,o){Vl=s,Zu=Ya=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&o)!==0&&(Ur=!0),s.firstContext=null)}function dn(s){var o=s._currentValue;if(Zu!==s)if(s={context:s,memoizedValue:o,next:null},Ya===null){if(Vl===null)throw Error(r(308));Ya=s,Vl.dependencies={lanes:0,firstContext:s}}else Ya=Ya.next=s;return o}var la=null;function nd(s){la===null?la=[s]:la.push(s)}function T0(s,o,u,h){var x=o.interleaved;return x===null?(u.next=u,nd(o)):(u.next=x.next,x.next=u),o.interleaved=u,Kn(s,h)}function Kn(s,o){s.lanes|=o;var u=s.alternate;for(u!==null&&(u.lanes|=o),u=s,s=s.return;s!==null;)s.childLanes|=o,u=s.alternate,u!==null&&(u.childLanes|=o),u=s,s=s.return;return u.tag===3?u.stateNode:null}var Ss=!1;function sd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k0(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function Xn(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function Es(s,o,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(dt&2)!==0){var x=h.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),h.pending=o,Kn(s,u)}return x=h.interleaved,x===null?(o.next=o,nd(h)):(o.next=x.next,x.next=o),h.interleaved=o,Kn(s,u)}function Hl(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var h=o.lanes;h&=s.pendingLanes,u|=h,o.lanes=u,vu(s,u)}}function C0(s,o){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var x=null,_=null;if(u=u.firstBaseUpdate,u!==null){do{var O={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};_===null?x=_=O:_=_.next=O,u=u.next}while(u!==null);_===null?x=_=o:_=_.next=o}else x=_=o;u={baseState:h.baseState,firstBaseUpdate:x,lastBaseUpdate:_,shared:h.shared,effects:h.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}function ql(s,o,u,h){var x=s.updateQueue;Ss=!1;var _=x.firstBaseUpdate,O=x.lastBaseUpdate,Z=x.shared.pending;if(Z!==null){x.shared.pending=null;var ee=Z,fe=ee.next;ee.next=null,O===null?_=fe:O.next=fe,O=ee;var Ee=s.alternate;Ee!==null&&(Ee=Ee.updateQueue,Z=Ee.lastBaseUpdate,Z!==O&&(Z===null?Ee.firstBaseUpdate=fe:Z.next=fe,Ee.lastBaseUpdate=ee))}if(_!==null){var be=x.baseState;O=0,Ee=fe=ee=null,Z=_;do{var Se=Z.lane,Me=Z.eventTime;if((h&Se)===Se){Ee!==null&&(Ee=Ee.next={eventTime:Me,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var ze=s,Ve=Z;switch(Se=o,Me=u,Ve.tag){case 1:if(ze=Ve.payload,typeof ze=="function"){be=ze.call(Me,be,Se);break e}be=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ve.payload,Se=typeof ze=="function"?ze.call(Me,be,Se):ze,Se==null)break e;be=re({},be,Se);break e;case 2:Ss=!0}}Z.callback!==null&&Z.lane!==0&&(s.flags|=64,Se=x.effects,Se===null?x.effects=[Z]:Se.push(Z))}else Me={eventTime:Me,lane:Se,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Ee===null?(fe=Ee=Me,ee=be):Ee=Ee.next=Me,O|=Se;if(Z=Z.next,Z===null){if(Z=x.shared.pending,Z===null)break;Se=Z,Z=Se.next,Se.next=null,x.lastBaseUpdate=Se,x.shared.pending=null}}while(!0);if(Ee===null&&(ee=be),x.baseState=ee,x.firstBaseUpdate=fe,x.lastBaseUpdate=Ee,o=x.shared.interleaved,o!==null){x=o;do O|=x.lane,x=x.next;while(x!==o)}else _===null&&(x.shared.lanes=0);da|=O,s.lanes=O,s.memoizedState=be}}function A0(s,o,u){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var h=s[o],x=h.callback;if(x!==null){if(h.callback=null,h=u,typeof x!="function")throw Error(r(191,x));x.call(h)}}}var fo={},Dn=_s(fo),ho=_s(fo),mo=_s(fo);function ca(s){if(s===fo)throw Error(r(174));return s}function ad(s,o){switch(Nt(mo,o),Nt(ho,s),Nt(Dn,fo),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:It(null,"");break;default:s=s===8?o.parentNode:o,o=s.namespaceURI||null,s=s.tagName,o=It(o,s)}At(Dn),Nt(Dn,o)}function Za(){At(Dn),At(ho),At(mo)}function O0(s){ca(mo.current);var o=ca(Dn.current),u=It(o,s.type);o!==u&&(Nt(ho,s),Nt(Dn,u))}function id(s){ho.current===s&&(At(Dn),At(ho))}var Dt=_s(0);function Gl(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var od=[];function ld(){for(var s=0;s<od.length;s++)od[s]._workInProgressVersionPrimary=null;od.length=0}var Kl=P.ReactCurrentDispatcher,cd=P.ReactCurrentBatchConfig,ua=0,Lt=null,Qt=null,sr=null,Xl=!1,po=!1,xo=0,xy=0;function Er(){throw Error(r(321))}function ud(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!wn(s[u],o[u]))return!1;return!0}function dd(s,o,u,h,x,_){if(ua=_,Lt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Kl.current=s===null||s.memoizedState===null?_y:wy,s=u(h,x),po){_=0;do{if(po=!1,xo=0,25<=_)throw Error(r(301));_+=1,sr=Qt=null,o.updateQueue=null,Kl.current=jy,s=u(h,x)}while(po)}if(Kl.current=Ql,o=Qt!==null&&Qt.next!==null,ua=0,sr=Qt=Lt=null,Xl=!1,o)throw Error(r(300));return s}function fd(){var s=xo!==0;return xo=0,s}function Ln(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sr===null?Lt.memoizedState=sr=s:sr=sr.next=s,sr}function fn(){if(Qt===null){var s=Lt.alternate;s=s!==null?s.memoizedState:null}else s=Qt.next;var o=sr===null?Lt.memoizedState:sr.next;if(o!==null)sr=o,Qt=s;else{if(s===null)throw Error(r(310));Qt=s,s={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},sr===null?Lt.memoizedState=sr=s:sr=sr.next=s}return sr}function go(s,o){return typeof o=="function"?o(s):o}function hd(s){var o=fn(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var h=Qt,x=h.baseQueue,_=u.pending;if(_!==null){if(x!==null){var O=x.next;x.next=_.next,_.next=O}h.baseQueue=x=_,u.pending=null}if(x!==null){_=x.next,h=h.baseState;var Z=O=null,ee=null,fe=_;do{var Ee=fe.lane;if((ua&Ee)===Ee)ee!==null&&(ee=ee.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),h=fe.hasEagerState?fe.eagerState:s(h,fe.action);else{var be={lane:Ee,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};ee===null?(Z=ee=be,O=h):ee=ee.next=be,Lt.lanes|=Ee,da|=Ee}fe=fe.next}while(fe!==null&&fe!==_);ee===null?O=h:ee.next=Z,wn(h,o.memoizedState)||(Ur=!0),o.memoizedState=h,o.baseState=O,o.baseQueue=ee,u.lastRenderedState=h}if(s=u.interleaved,s!==null){x=s;do _=x.lane,Lt.lanes|=_,da|=_,x=x.next;while(x!==s)}else x===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function md(s){var o=fn(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var h=u.dispatch,x=u.pending,_=o.memoizedState;if(x!==null){u.pending=null;var O=x=x.next;do _=s(_,O.action),O=O.next;while(O!==x);wn(_,o.memoizedState)||(Ur=!0),o.memoizedState=_,o.baseQueue===null&&(o.baseState=_),u.lastRenderedState=_}return[_,h]}function P0(){}function R0(s,o){var u=Lt,h=fn(),x=o(),_=!wn(h.memoizedState,x);if(_&&(h.memoizedState=x,Ur=!0),h=h.queue,pd(L0.bind(null,u,h,s),[s]),h.getSnapshot!==o||_||sr!==null&&sr.memoizedState.tag&1){if(u.flags|=2048,vo(9,D0.bind(null,u,h,x,o),void 0,null),ar===null)throw Error(r(349));(ua&30)!==0||F0(u,o,x)}return x}function F0(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=Lt.updateQueue,o===null?(o={lastEffect:null,stores:null},Lt.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function D0(s,o,u,h){o.value=u,o.getSnapshot=h,I0(o)&&M0(s)}function L0(s,o,u){return u(function(){I0(o)&&M0(s)})}function I0(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!wn(s,u)}catch{return!0}}function M0(s){var o=Kn(s,1);o!==null&&bn(o,s,1,-1)}function B0(s){var o=Ln();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:s},o.queue=s,s=s.dispatch=yy.bind(null,Lt,s),[o.memoizedState,s]}function vo(s,o,u,h){return s={tag:s,create:o,destroy:u,deps:h,next:null},o=Lt.updateQueue,o===null?(o={lastEffect:null,stores:null},Lt.updateQueue=o,o.lastEffect=s.next=s):(u=o.lastEffect,u===null?o.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,o.lastEffect=s)),s}function U0(){return fn().memoizedState}function Jl(s,o,u,h){var x=Ln();Lt.flags|=s,x.memoizedState=vo(1|o,u,void 0,h===void 0?null:h)}function Yl(s,o,u,h){var x=fn();h=h===void 0?null:h;var _=void 0;if(Qt!==null){var O=Qt.memoizedState;if(_=O.destroy,h!==null&&ud(h,O.deps)){x.memoizedState=vo(o,u,_,h);return}}Lt.flags|=s,x.memoizedState=vo(1|o,u,_,h)}function z0(s,o){return Jl(8390656,8,s,o)}function pd(s,o){return Yl(2048,8,s,o)}function $0(s,o){return Yl(4,2,s,o)}function W0(s,o){return Yl(4,4,s,o)}function V0(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function H0(s,o,u){return u=u!=null?u.concat([s]):null,Yl(4,4,V0.bind(null,o,s),u)}function xd(){}function q0(s,o){var u=fn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&ud(o,h[1])?h[0]:(u.memoizedState=[s,o],s)}function G0(s,o){var u=fn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&ud(o,h[1])?h[0]:(s=s(),u.memoizedState=[s,o],s)}function K0(s,o,u){return(ua&21)===0?(s.baseState&&(s.baseState=!1,Ur=!0),s.memoizedState=u):(wn(u,o)||(u=Eh(),Lt.lanes|=u,da|=u,s.baseState=!0),o)}function gy(s,o){var u=xt;xt=u!==0&&4>u?u:4,s(!0);var h=cd.transition;cd.transition={};try{s(!1),o()}finally{xt=u,cd.transition=h}}function X0(){return fn().memoizedState}function vy(s,o,u){var h=ks(s);if(u={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null},J0(s))Y0(o,u);else if(u=T0(s,o,u,h),u!==null){var x=Fr();bn(u,s,h,x),Q0(u,o,h)}}function yy(s,o,u){var h=ks(s),x={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null};if(J0(s))Y0(o,x);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=o.lastRenderedReducer,_!==null))try{var O=o.lastRenderedState,Z=_(O,u);if(x.hasEagerState=!0,x.eagerState=Z,wn(Z,O)){var ee=o.interleaved;ee===null?(x.next=x,nd(o)):(x.next=ee.next,ee.next=x),o.interleaved=x;return}}catch{}finally{}u=T0(s,o,x,h),u!==null&&(x=Fr(),bn(u,s,h,x),Q0(u,o,h))}}function J0(s){var o=s.alternate;return s===Lt||o!==null&&o===Lt}function Y0(s,o){po=Xl=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function Q0(s,o,u){if((u&4194240)!==0){var h=o.lanes;h&=s.pendingLanes,u|=h,o.lanes=u,vu(s,u)}}var Ql={readContext:dn,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useInsertionEffect:Er,useLayoutEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useMutableSource:Er,useSyncExternalStore:Er,useId:Er,unstable_isNewReconciler:!1},_y={readContext:dn,useCallback:function(s,o){return Ln().memoizedState=[s,o===void 0?null:o],s},useContext:dn,useEffect:z0,useImperativeHandle:function(s,o,u){return u=u!=null?u.concat([s]):null,Jl(4194308,4,V0.bind(null,o,s),u)},useLayoutEffect:function(s,o){return Jl(4194308,4,s,o)},useInsertionEffect:function(s,o){return Jl(4,2,s,o)},useMemo:function(s,o){var u=Ln();return o=o===void 0?null:o,s=s(),u.memoizedState=[s,o],s},useReducer:function(s,o,u){var h=Ln();return o=u!==void 0?u(o):o,h.memoizedState=h.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},h.queue=s,s=s.dispatch=vy.bind(null,Lt,s),[h.memoizedState,s]},useRef:function(s){var o=Ln();return s={current:s},o.memoizedState=s},useState:B0,useDebugValue:xd,useDeferredValue:function(s){return Ln().memoizedState=s},useTransition:function(){var s=B0(!1),o=s[0];return s=gy.bind(null,s[1]),Ln().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,u){var h=Lt,x=Ln();if(Ft){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),ar===null)throw Error(r(349));(ua&30)!==0||F0(h,o,u)}x.memoizedState=u;var _={value:u,getSnapshot:o};return x.queue=_,z0(L0.bind(null,h,_,s),[s]),h.flags|=2048,vo(9,D0.bind(null,h,_,u,o),void 0,null),u},useId:function(){var s=Ln(),o=ar.identifierPrefix;if(Ft){var u=Gn,h=qn;u=(h&~(1<<32-Wt(h)-1)).toString(32)+u,o=":"+o+"R"+u,u=xo++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=xy++,o=":"+o+"r"+u.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},wy={readContext:dn,useCallback:q0,useContext:dn,useEffect:pd,useImperativeHandle:H0,useInsertionEffect:$0,useLayoutEffect:W0,useMemo:G0,useReducer:hd,useRef:U0,useState:function(){return hd(go)},useDebugValue:xd,useDeferredValue:function(s){var o=fn();return K0(o,Qt.memoizedState,s)},useTransition:function(){var s=hd(go)[0],o=fn().memoizedState;return[s,o]},useMutableSource:P0,useSyncExternalStore:R0,useId:X0,unstable_isNewReconciler:!1},jy={readContext:dn,useCallback:q0,useContext:dn,useEffect:pd,useImperativeHandle:H0,useInsertionEffect:$0,useLayoutEffect:W0,useMemo:G0,useReducer:md,useRef:U0,useState:function(){return md(go)},useDebugValue:xd,useDeferredValue:function(s){var o=fn();return Qt===null?o.memoizedState=s:K0(o,Qt.memoizedState,s)},useTransition:function(){var s=md(go)[0],o=fn().memoizedState;return[s,o]},useMutableSource:P0,useSyncExternalStore:R0,useId:X0,unstable_isNewReconciler:!1};function Sn(s,o){if(s&&s.defaultProps){o=re({},o),s=s.defaultProps;for(var u in s)o[u]===void 0&&(o[u]=s[u]);return o}return o}function gd(s,o,u,h){o=s.memoizedState,u=u(h,o),u=u==null?o:re({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Zl={isMounted:function(s){return(s=s._reactInternals)?J(s)===s:!1},enqueueSetState:function(s,o,u){s=s._reactInternals;var h=Fr(),x=ks(s),_=Xn(h,x);_.payload=o,u!=null&&(_.callback=u),o=Es(s,_,x),o!==null&&(bn(o,s,x,h),Hl(o,s,x))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var h=Fr(),x=ks(s),_=Xn(h,x);_.tag=1,_.payload=o,u!=null&&(_.callback=u),o=Es(s,_,x),o!==null&&(bn(o,s,x,h),Hl(o,s,x))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=Fr(),h=ks(s),x=Xn(u,h);x.tag=2,o!=null&&(x.callback=o),o=Es(s,x,h),o!==null&&(bn(o,s,h,u),Hl(o,s,h))}};function Z0(s,o,u,h,x,_,O){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,_,O):o.prototype&&o.prototype.isPureReactComponent?!no(u,h)||!no(x,_):!0}function em(s,o,u){var h=!1,x=ws,_=o.contextType;return typeof _=="object"&&_!==null?_=dn(_):(x=Br(o)?aa:Sr.current,h=o.contextTypes,_=(h=h!=null)?qa(s,x):ws),o=new o(u,_),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Zl,s.stateNode=o,o._reactInternals=s,h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=x,s.__reactInternalMemoizedMaskedChildContext=_),o}function tm(s,o,u,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==s&&Zl.enqueueReplaceState(o,o.state,null)}function vd(s,o,u,h){var x=s.stateNode;x.props=u,x.state=s.memoizedState,x.refs={},sd(s);var _=o.contextType;typeof _=="object"&&_!==null?x.context=dn(_):(_=Br(o)?aa:Sr.current,x.context=qa(s,_)),x.state=s.memoizedState,_=o.getDerivedStateFromProps,typeof _=="function"&&(gd(s,o,_,u),x.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(o=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),o!==x.state&&Zl.enqueueReplaceState(x,x.state,null),ql(s,u,x,h),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308)}function ei(s,o){try{var u="",h=o;do u+=G(h),h=h.return;while(h);var x=u}catch(_){x=`
Error generating stack: `+_.message+`
`+_.stack}return{value:s,source:o,stack:x,digest:null}}function yd(s,o,u){return{value:s,source:null,stack:u??null,digest:o??null}}function _d(s,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var Sy=typeof WeakMap=="function"?WeakMap:Map;function rm(s,o,u){u=Xn(-1,u),u.tag=3,u.payload={element:null};var h=o.value;return u.callback=function(){ic||(ic=!0,Dd=h),_d(s,o)},u}function nm(s,o,u){u=Xn(-1,u),u.tag=3;var h=s.type.getDerivedStateFromError;if(typeof h=="function"){var x=o.value;u.payload=function(){return h(x)},u.callback=function(){_d(s,o)}}var _=s.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(u.callback=function(){_d(s,o),typeof h!="function"&&(bs===null?bs=new Set([this]):bs.add(this));var O=o.stack;this.componentDidCatch(o.value,{componentStack:O!==null?O:""})}),u}function sm(s,o,u){var h=s.pingCache;if(h===null){h=s.pingCache=new Sy;var x=new Set;h.set(o,x)}else x=h.get(o),x===void 0&&(x=new Set,h.set(o,x));x.has(u)||(x.add(u),s=Iy.bind(null,s,o,u),o.then(s,s))}function am(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function im(s,o,u,h,x){return(s.mode&1)===0?(s===o?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=Xn(-1,1),o.tag=2,Es(u,o,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=x,s)}var Ey=P.ReactCurrentOwner,Ur=!1;function Rr(s,o,u,h){o.child=s===null?b0(o,null,u,h):Ja(o,s.child,u,h)}function om(s,o,u,h,x){u=u.render;var _=o.ref;return Qa(o,x),h=dd(s,o,u,h,_,x),u=fd(),s!==null&&!Ur?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~x,Jn(s,o,x)):(Ft&&u&&Ku(o),o.flags|=1,Rr(s,o,h,x),o.child)}function lm(s,o,u,h,x){if(s===null){var _=u.type;return typeof _=="function"&&!$d(_)&&_.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=_,cm(s,o,_,h,x)):(s=fc(u.type,null,h,o,o.mode,x),s.ref=o.ref,s.return=o,o.child=s)}if(_=s.child,(s.lanes&x)===0){var O=_.memoizedProps;if(u=u.compare,u=u!==null?u:no,u(O,h)&&s.ref===o.ref)return Jn(s,o,x)}return o.flags|=1,s=As(_,h),s.ref=o.ref,s.return=o,o.child=s}function cm(s,o,u,h,x){if(s!==null){var _=s.memoizedProps;if(no(_,h)&&s.ref===o.ref)if(Ur=!1,o.pendingProps=h=_,(s.lanes&x)!==0)(s.flags&131072)!==0&&(Ur=!0);else return o.lanes=s.lanes,Jn(s,o,x)}return wd(s,o,u,h,x)}function um(s,o,u){var h=o.pendingProps,x=h.children,_=s!==null?s.memoizedState:null;if(h.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(ri,Zr),Zr|=u;else{if((u&1073741824)===0)return s=_!==null?_.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,Nt(ri,Zr),Zr|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=_!==null?_.baseLanes:u,Nt(ri,Zr),Zr|=h}else _!==null?(h=_.baseLanes|u,o.memoizedState=null):h=u,Nt(ri,Zr),Zr|=h;return Rr(s,o,x,u),o.child}function dm(s,o){var u=o.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function wd(s,o,u,h,x){var _=Br(u)?aa:Sr.current;return _=qa(o,_),Qa(o,x),u=dd(s,o,u,h,_,x),h=fd(),s!==null&&!Ur?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~x,Jn(s,o,x)):(Ft&&h&&Ku(o),o.flags|=1,Rr(s,o,u,x),o.child)}function fm(s,o,u,h,x){if(Br(u)){var _=!0;Il(o)}else _=!1;if(Qa(o,x),o.stateNode===null)tc(s,o),em(o,u,h),vd(o,u,h,x),h=!0;else if(s===null){var O=o.stateNode,Z=o.memoizedProps;O.props=Z;var ee=O.context,fe=u.contextType;typeof fe=="object"&&fe!==null?fe=dn(fe):(fe=Br(u)?aa:Sr.current,fe=qa(o,fe));var Ee=u.getDerivedStateFromProps,be=typeof Ee=="function"||typeof O.getSnapshotBeforeUpdate=="function";be||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(Z!==h||ee!==fe)&&tm(o,O,h,fe),Ss=!1;var Se=o.memoizedState;O.state=Se,ql(o,h,O,x),ee=o.memoizedState,Z!==h||Se!==ee||Mr.current||Ss?(typeof Ee=="function"&&(gd(o,u,Ee,h),ee=o.memoizedState),(Z=Ss||Z0(o,u,Z,h,Se,ee,fe))?(be||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(o.flags|=4194308)):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=ee),O.props=h,O.state=ee,O.context=fe,h=Z):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{O=o.stateNode,k0(s,o),Z=o.memoizedProps,fe=o.type===o.elementType?Z:Sn(o.type,Z),O.props=fe,be=o.pendingProps,Se=O.context,ee=u.contextType,typeof ee=="object"&&ee!==null?ee=dn(ee):(ee=Br(u)?aa:Sr.current,ee=qa(o,ee));var Me=u.getDerivedStateFromProps;(Ee=typeof Me=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(Z!==be||Se!==ee)&&tm(o,O,h,ee),Ss=!1,Se=o.memoizedState,O.state=Se,ql(o,h,O,x);var ze=o.memoizedState;Z!==be||Se!==ze||Mr.current||Ss?(typeof Me=="function"&&(gd(o,u,Me,h),ze=o.memoizedState),(fe=Ss||Z0(o,u,fe,h,Se,ze,ee)||!1)?(Ee||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(h,ze,ee),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(h,ze,ee)),typeof O.componentDidUpdate=="function"&&(o.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof O.componentDidUpdate!="function"||Z===s.memoizedProps&&Se===s.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||Z===s.memoizedProps&&Se===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=ze),O.props=h,O.state=ze,O.context=ee,h=fe):(typeof O.componentDidUpdate!="function"||Z===s.memoizedProps&&Se===s.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||Z===s.memoizedProps&&Se===s.memoizedState||(o.flags|=1024),h=!1)}return jd(s,o,u,h,_,x)}function jd(s,o,u,h,x,_){dm(s,o);var O=(o.flags&128)!==0;if(!h&&!O)return x&&g0(o,u,!1),Jn(s,o,_);h=o.stateNode,Ey.current=o;var Z=O&&typeof u.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,s!==null&&O?(o.child=Ja(o,s.child,null,_),o.child=Ja(o,null,Z,_)):Rr(s,o,Z,_),o.memoizedState=h.state,x&&g0(o,u,!0),o.child}function hm(s){var o=s.stateNode;o.pendingContext?p0(s,o.pendingContext,o.pendingContext!==o.context):o.context&&p0(s,o.context,!1),ad(s,o.containerInfo)}function mm(s,o,u,h,x){return Xa(),Qu(x),o.flags|=256,Rr(s,o,u,h),o.child}var Sd={dehydrated:null,treeContext:null,retryLane:0};function Ed(s){return{baseLanes:s,cachePool:null,transitions:null}}function pm(s,o,u){var h=o.pendingProps,x=Dt.current,_=!1,O=(o.flags&128)!==0,Z;if((Z=O)||(Z=s!==null&&s.memoizedState===null?!1:(x&2)!==0),Z?(_=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(x|=1),Nt(Dt,x&1),s===null)return Yu(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((o.mode&1)===0?o.lanes=1:s.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(O=h.children,s=h.fallback,_?(h=o.mode,_=o.child,O={mode:"hidden",children:O},(h&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=O):_=hc(O,h,0,null),s=pa(s,h,u,null),_.return=o,s.return=o,_.sibling=s,o.child=_,o.child.memoizedState=Ed(u),o.memoizedState=Sd,s):Nd(o,O));if(x=s.memoizedState,x!==null&&(Z=x.dehydrated,Z!==null))return Ny(s,o,O,h,Z,x,u);if(_){_=h.fallback,O=o.mode,x=s.child,Z=x.sibling;var ee={mode:"hidden",children:h.children};return(O&1)===0&&o.child!==x?(h=o.child,h.childLanes=0,h.pendingProps=ee,o.deletions=null):(h=As(x,ee),h.subtreeFlags=x.subtreeFlags&14680064),Z!==null?_=As(Z,_):(_=pa(_,O,u,null),_.flags|=2),_.return=o,h.return=o,h.sibling=_,o.child=h,h=_,_=o.child,O=s.child.memoizedState,O=O===null?Ed(u):{baseLanes:O.baseLanes|u,cachePool:null,transitions:O.transitions},_.memoizedState=O,_.childLanes=s.childLanes&~u,o.memoizedState=Sd,h}return _=s.child,s=_.sibling,h=As(_,{mode:"visible",children:h.children}),(o.mode&1)===0&&(h.lanes=u),h.return=o,h.sibling=null,s!==null&&(u=o.deletions,u===null?(o.deletions=[s],o.flags|=16):u.push(s)),o.child=h,o.memoizedState=null,h}function Nd(s,o){return o=hc({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function ec(s,o,u,h){return h!==null&&Qu(h),Ja(o,s.child,null,u),s=Nd(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Ny(s,o,u,h,x,_,O){if(u)return o.flags&256?(o.flags&=-257,h=yd(Error(r(422))),ec(s,o,O,h)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(_=h.fallback,x=o.mode,h=hc({mode:"visible",children:h.children},x,0,null),_=pa(_,x,O,null),_.flags|=2,h.return=o,_.return=o,h.sibling=_,o.child=h,(o.mode&1)!==0&&Ja(o,s.child,null,O),o.child.memoizedState=Ed(O),o.memoizedState=Sd,_);if((o.mode&1)===0)return ec(s,o,O,null);if(x.data==="$!"){if(h=x.nextSibling&&x.nextSibling.dataset,h)var Z=h.dgst;return h=Z,_=Error(r(419)),h=yd(_,h,void 0),ec(s,o,O,h)}if(Z=(O&s.childLanes)!==0,Ur||Z){if(h=ar,h!==null){switch(O&-O){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=(x&(h.suspendedLanes|O))!==0?0:x,x!==0&&x!==_.retryLane&&(_.retryLane=x,Kn(s,x),bn(h,s,x,-1))}return zd(),h=yd(Error(r(421))),ec(s,o,O,h)}return x.data==="$?"?(o.flags|=128,o.child=s.child,o=My.bind(null,s),x._reactRetry=o,null):(s=_.treeContext,Qr=ys(x.nextSibling),Yr=o,Ft=!0,jn=null,s!==null&&(cn[un++]=qn,cn[un++]=Gn,cn[un++]=ia,qn=s.id,Gn=s.overflow,ia=o),o=Nd(o,h.children),o.flags|=4096,o)}function xm(s,o,u){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),rd(s.return,o,u)}function bd(s,o,u,h,x){var _=s.memoizedState;_===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:x}:(_.isBackwards=o,_.rendering=null,_.renderingStartTime=0,_.last=h,_.tail=u,_.tailMode=x)}function gm(s,o,u){var h=o.pendingProps,x=h.revealOrder,_=h.tail;if(Rr(s,o,h.children,u),h=Dt.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&xm(s,u,o);else if(s.tag===19)xm(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}if(Nt(Dt,h),(o.mode&1)===0)o.memoizedState=null;else switch(x){case"forwards":for(u=o.child,x=null;u!==null;)s=u.alternate,s!==null&&Gl(s)===null&&(x=u),u=u.sibling;u=x,u===null?(x=o.child,o.child=null):(x=u.sibling,u.sibling=null),bd(o,!1,x,u,_);break;case"backwards":for(u=null,x=o.child,o.child=null;x!==null;){if(s=x.alternate,s!==null&&Gl(s)===null){o.child=x;break}s=x.sibling,x.sibling=u,u=x,x=s}bd(o,!0,u,null,_);break;case"together":bd(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function tc(s,o){(o.mode&1)===0&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function Jn(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),da|=o.lanes,(u&o.childLanes)===0)return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,u=As(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=As(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function by(s,o,u){switch(o.tag){case 3:hm(o),Xa();break;case 5:O0(o);break;case 1:Br(o.type)&&Il(o);break;case 4:ad(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,x=o.memoizedProps.value;Nt(Wl,h._currentValue),h._currentValue=x;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(Nt(Dt,Dt.current&1),o.flags|=128,null):(u&o.child.childLanes)!==0?pm(s,o,u):(Nt(Dt,Dt.current&1),s=Jn(s,o,u),s!==null?s.sibling:null);Nt(Dt,Dt.current&1);break;case 19:if(h=(u&o.childLanes)!==0,(s.flags&128)!==0){if(h)return gm(s,o,u);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Nt(Dt,Dt.current),h)break;return null;case 22:case 23:return o.lanes=0,um(s,o,u)}return Jn(s,o,u)}var vm,Td,ym,_m;vm=function(s,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},Td=function(){},ym=function(s,o,u,h){var x=s.memoizedProps;if(x!==h){s=o.stateNode,ca(Dn.current);var _=null;switch(u){case"input":x=Ke(s,x),h=Ke(s,h),_=[];break;case"select":x=re({},x,{value:void 0}),h=re({},h,{value:void 0}),_=[];break;case"textarea":x=hr(s,x),h=hr(s,h),_=[];break;default:typeof x.onClick!="function"&&typeof h.onClick=="function"&&(s.onclick=Fl)}Ui(u,h);var O;u=null;for(fe in x)if(!h.hasOwnProperty(fe)&&x.hasOwnProperty(fe)&&x[fe]!=null)if(fe==="style"){var Z=x[fe];for(O in Z)Z.hasOwnProperty(O)&&(u||(u={}),u[O]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(i.hasOwnProperty(fe)?_||(_=[]):(_=_||[]).push(fe,null));for(fe in h){var ee=h[fe];if(Z=x!=null?x[fe]:void 0,h.hasOwnProperty(fe)&&ee!==Z&&(ee!=null||Z!=null))if(fe==="style")if(Z){for(O in Z)!Z.hasOwnProperty(O)||ee&&ee.hasOwnProperty(O)||(u||(u={}),u[O]="");for(O in ee)ee.hasOwnProperty(O)&&Z[O]!==ee[O]&&(u||(u={}),u[O]=ee[O])}else u||(_||(_=[]),_.push(fe,u)),u=ee;else fe==="dangerouslySetInnerHTML"?(ee=ee?ee.__html:void 0,Z=Z?Z.__html:void 0,ee!=null&&Z!==ee&&(_=_||[]).push(fe,ee)):fe==="children"?typeof ee!="string"&&typeof ee!="number"||(_=_||[]).push(fe,""+ee):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(i.hasOwnProperty(fe)?(ee!=null&&fe==="onScroll"&&Ct("scroll",s),_||Z===ee||(_=[])):(_=_||[]).push(fe,ee))}u&&(_=_||[]).push("style",u);var fe=_;(o.updateQueue=fe)&&(o.flags|=4)}},_m=function(s,o,u,h){u!==h&&(o.flags|=4)};function yo(s,o){if(!Ft)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function Nr(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(o)for(var x=s.child;x!==null;)u|=x.lanes|x.childLanes,h|=x.subtreeFlags&14680064,h|=x.flags&14680064,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)u|=x.lanes|x.childLanes,h|=x.subtreeFlags,h|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=h,s.childLanes=u,o}function Ty(s,o,u){var h=o.pendingProps;switch(Xu(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(o),null;case 1:return Br(o.type)&&Ll(),Nr(o),null;case 3:return h=o.stateNode,Za(),At(Mr),At(Sr),ld(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(zl(o)?o.flags|=4:s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,jn!==null&&(Md(jn),jn=null))),Td(s,o),Nr(o),null;case 5:id(o);var x=ca(mo.current);if(u=o.type,s!==null&&o.stateNode!=null)ym(s,o,u,h,x),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(r(166));return Nr(o),null}if(s=ca(Dn.current),zl(o)){h=o.stateNode,u=o.type;var _=o.memoizedProps;switch(h[Fn]=o,h[lo]=_,s=(o.mode&1)!==0,u){case"dialog":Ct("cancel",h),Ct("close",h);break;case"iframe":case"object":case"embed":Ct("load",h);break;case"video":case"audio":for(x=0;x<ao.length;x++)Ct(ao[x],h);break;case"source":Ct("error",h);break;case"img":case"image":case"link":Ct("error",h),Ct("load",h);break;case"details":Ct("toggle",h);break;case"input":tt(h,_),Ct("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!_.multiple},Ct("invalid",h);break;case"textarea":ln(h,_),Ct("invalid",h)}Ui(u,_),x=null;for(var O in _)if(_.hasOwnProperty(O)){var Z=_[O];O==="children"?typeof Z=="string"?h.textContent!==Z&&(_.suppressHydrationWarning!==!0&&Rl(h.textContent,Z,s),x=["children",Z]):typeof Z=="number"&&h.textContent!==""+Z&&(_.suppressHydrationWarning!==!0&&Rl(h.textContent,Z,s),x=["children",""+Z]):i.hasOwnProperty(O)&&Z!=null&&O==="onScroll"&&Ct("scroll",h)}switch(u){case"input":Ie(h),Qe(h,_,!0);break;case"textarea":Ie(h),rr(h);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(h.onclick=Fl)}h=x,o.updateQueue=h,h!==null&&(o.flags|=4)}else{O=x.nodeType===9?x:x.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=kt(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=O.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof h.is=="string"?s=O.createElement(u,{is:h.is}):(s=O.createElement(u),u==="select"&&(O=s,h.multiple?O.multiple=!0:h.size&&(O.size=h.size))):s=O.createElementNS(s,u),s[Fn]=o,s[lo]=h,vm(s,o,!1,!1),o.stateNode=s;e:{switch(O=zi(u,h),u){case"dialog":Ct("cancel",s),Ct("close",s),x=h;break;case"iframe":case"object":case"embed":Ct("load",s),x=h;break;case"video":case"audio":for(x=0;x<ao.length;x++)Ct(ao[x],s);x=h;break;case"source":Ct("error",s),x=h;break;case"img":case"image":case"link":Ct("error",s),Ct("load",s),x=h;break;case"details":Ct("toggle",s),x=h;break;case"input":tt(s,h),x=Ke(s,h),Ct("invalid",s);break;case"option":x=h;break;case"select":s._wrapperState={wasMultiple:!!h.multiple},x=re({},h,{value:void 0}),Ct("invalid",s);break;case"textarea":ln(s,h),x=hr(s,h),Ct("invalid",s);break;default:x=h}Ui(u,x),Z=x;for(_ in Z)if(Z.hasOwnProperty(_)){var ee=Z[_];_==="style"?cs(s,ee):_==="dangerouslySetInnerHTML"?(ee=ee?ee.__html:void 0,ee!=null&&ls(s,ee)):_==="children"?typeof ee=="string"?(u!=="textarea"||ee!=="")&&yn(s,ee):typeof ee=="number"&&yn(s,""+ee):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(i.hasOwnProperty(_)?ee!=null&&_==="onScroll"&&Ct("scroll",s):ee!=null&&C(s,_,ee,O))}switch(u){case"input":Ie(s),Qe(s,h,!1);break;case"textarea":Ie(s),rr(s);break;case"option":h.value!=null&&s.setAttribute("value",""+me(h.value));break;case"select":s.multiple=!!h.multiple,_=h.value,_!=null?qt(s,!!h.multiple,_,!1):h.defaultValue!=null&&qt(s,!!h.multiple,h.defaultValue,!0);break;default:typeof x.onClick=="function"&&(s.onclick=Fl)}switch(u){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Nr(o),null;case 6:if(s&&o.stateNode!=null)_m(s,o,s.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(r(166));if(u=ca(mo.current),ca(Dn.current),zl(o)){if(h=o.stateNode,u=o.memoizedProps,h[Fn]=o,(_=h.nodeValue!==u)&&(s=Yr,s!==null))switch(s.tag){case 3:Rl(h.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Rl(h.nodeValue,u,(s.mode&1)!==0)}_&&(o.flags|=4)}else h=(u.nodeType===9?u:u.ownerDocument).createTextNode(h),h[Fn]=o,o.stateNode=h}return Nr(o),null;case 13:if(At(Dt),h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Ft&&Qr!==null&&(o.mode&1)!==0&&(o.flags&128)===0)S0(),Xa(),o.flags|=98560,_=!1;else if(_=zl(o),h!==null&&h.dehydrated!==null){if(s===null){if(!_)throw Error(r(318));if(_=o.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(r(317));_[Fn]=o}else Xa(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Nr(o),_=!1}else jn!==null&&(Md(jn),jn=null),_=!0;if(!_)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=u,o):(h=h!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(s===null||(Dt.current&1)!==0?Zt===0&&(Zt=3):zd())),o.updateQueue!==null&&(o.flags|=4),Nr(o),null);case 4:return Za(),Td(s,o),s===null&&io(o.stateNode.containerInfo),Nr(o),null;case 10:return td(o.type._context),Nr(o),null;case 17:return Br(o.type)&&Ll(),Nr(o),null;case 19:if(At(Dt),_=o.memoizedState,_===null)return Nr(o),null;if(h=(o.flags&128)!==0,O=_.rendering,O===null)if(h)yo(_,!1);else{if(Zt!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(O=Gl(s),O!==null){for(o.flags|=128,yo(_,!1),h=O.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=u,u=o.child;u!==null;)_=u,s=h,_.flags&=14680066,O=_.alternate,O===null?(_.childLanes=0,_.lanes=s,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=O.childLanes,_.lanes=O.lanes,_.child=O.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=O.memoizedProps,_.memoizedState=O.memoizedState,_.updateQueue=O.updateQueue,_.type=O.type,s=O.dependencies,_.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Nt(Dt,Dt.current&1|2),o.child}s=s.sibling}_.tail!==null&&Te()>ni&&(o.flags|=128,h=!0,yo(_,!1),o.lanes=4194304)}else{if(!h)if(s=Gl(O),s!==null){if(o.flags|=128,h=!0,u=s.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),yo(_,!0),_.tail===null&&_.tailMode==="hidden"&&!O.alternate&&!Ft)return Nr(o),null}else 2*Te()-_.renderingStartTime>ni&&u!==1073741824&&(o.flags|=128,h=!0,yo(_,!1),o.lanes=4194304);_.isBackwards?(O.sibling=o.child,o.child=O):(u=_.last,u!==null?u.sibling=O:o.child=O,_.last=O)}return _.tail!==null?(o=_.tail,_.rendering=o,_.tail=o.sibling,_.renderingStartTime=Te(),o.sibling=null,u=Dt.current,Nt(Dt,h?u&1|2:u&1),o):(Nr(o),null);case 22:case 23:return Ud(),h=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(Zr&1073741824)!==0&&(Nr(o),o.subtreeFlags&6&&(o.flags|=8192)):Nr(o),null;case 24:return null;case 25:return null}throw Error(r(156,o.tag))}function ky(s,o){switch(Xu(o),o.tag){case 1:return Br(o.type)&&Ll(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Za(),At(Mr),At(Sr),ld(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 5:return id(o),null;case 13:if(At(Dt),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Xa()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return At(Dt),null;case 4:return Za(),null;case 10:return td(o.type._context),null;case 22:case 23:return Ud(),null;case 24:return null;default:return null}}var rc=!1,br=!1,Cy=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function ti(s,o){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(h){Bt(s,o,h)}else u.current=null}function kd(s,o,u){try{u()}catch(h){Bt(s,o,h)}}var wm=!1;function Ay(s,o){if(Uu=jl,s=Zh(),Pu(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var x=h.anchorOffset,_=h.focusNode;h=h.focusOffset;try{u.nodeType,_.nodeType}catch{u=null;break e}var O=0,Z=-1,ee=-1,fe=0,Ee=0,be=s,Se=null;t:for(;;){for(var Me;be!==u||x!==0&&be.nodeType!==3||(Z=O+x),be!==_||h!==0&&be.nodeType!==3||(ee=O+h),be.nodeType===3&&(O+=be.nodeValue.length),(Me=be.firstChild)!==null;)Se=be,be=Me;for(;;){if(be===s)break t;if(Se===u&&++fe===x&&(Z=O),Se===_&&++Ee===h&&(ee=O),(Me=be.nextSibling)!==null)break;be=Se,Se=be.parentNode}be=Me}u=Z===-1||ee===-1?null:{start:Z,end:ee}}else u=null}u=u||{start:0,end:0}}else u=null;for(zu={focusedElem:s,selectionRange:u},jl=!1,Ue=o;Ue!==null;)if(o=Ue,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Ue=s;else for(;Ue!==null;){o=Ue;try{var ze=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var Ve=ze.memoizedProps,Vt=ze.memoizedState,ae=o.stateNode,ne=ae.getSnapshotBeforeUpdate(o.elementType===o.type?Ve:Sn(o.type,Ve),Vt);ae.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var ie=o.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ce){Bt(o,o.return,Ce)}if(s=o.sibling,s!==null){s.return=o.return,Ue=s;break}Ue=o.return}return ze=wm,wm=!1,ze}function _o(s,o,u){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var x=h=h.next;do{if((x.tag&s)===s){var _=x.destroy;x.destroy=void 0,_!==void 0&&kd(o,u,_)}x=x.next}while(x!==h)}}function nc(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&s)===s){var h=u.create;u.destroy=h()}u=u.next}while(u!==o)}}function Cd(s){var o=s.ref;if(o!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof o=="function"?o(s):o.current=s}}function jm(s){var o=s.alternate;o!==null&&(s.alternate=null,jm(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&(delete o[Fn],delete o[lo],delete o[Hu],delete o[fy],delete o[hy])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Sm(s){return s.tag===5||s.tag===3||s.tag===4}function Em(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Sm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Ad(s,o,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(s,o):u.insertBefore(s,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(s,u)):(o=u,o.appendChild(s)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Fl));else if(h!==4&&(s=s.child,s!==null))for(Ad(s,o,u),s=s.sibling;s!==null;)Ad(s,o,u),s=s.sibling}function Od(s,o,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(h!==4&&(s=s.child,s!==null))for(Od(s,o,u),s=s.sibling;s!==null;)Od(s,o,u),s=s.sibling}var mr=null,En=!1;function Ns(s,o,u){for(u=u.child;u!==null;)Nm(s,o,u),u=u.sibling}function Nm(s,o,u){if(nr&&typeof nr.onCommitFiberUnmount=="function")try{nr.onCommitFiberUnmount(Rn,u)}catch{}switch(u.tag){case 5:br||ti(u,o);case 6:var h=mr,x=En;mr=null,Ns(s,o,u),mr=h,En=x,mr!==null&&(En?(s=mr,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):mr.removeChild(u.stateNode));break;case 18:mr!==null&&(En?(s=mr,u=u.stateNode,s.nodeType===8?Vu(s.parentNode,u):s.nodeType===1&&Vu(s,u),Yi(s)):Vu(mr,u.stateNode));break;case 4:h=mr,x=En,mr=u.stateNode.containerInfo,En=!0,Ns(s,o,u),mr=h,En=x;break;case 0:case 11:case 14:case 15:if(!br&&(h=u.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){x=h=h.next;do{var _=x,O=_.destroy;_=_.tag,O!==void 0&&((_&2)!==0||(_&4)!==0)&&kd(u,o,O),x=x.next}while(x!==h)}Ns(s,o,u);break;case 1:if(!br&&(ti(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=u.memoizedProps,h.state=u.memoizedState,h.componentWillUnmount()}catch(Z){Bt(u,o,Z)}Ns(s,o,u);break;case 21:Ns(s,o,u);break;case 22:u.mode&1?(br=(h=br)||u.memoizedState!==null,Ns(s,o,u),br=h):Ns(s,o,u);break;default:Ns(s,o,u)}}function bm(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new Cy),o.forEach(function(h){var x=By.bind(null,s,h);u.has(h)||(u.add(h),h.then(x,x))})}}function Nn(s,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var x=u[h];try{var _=s,O=o,Z=O;e:for(;Z!==null;){switch(Z.tag){case 5:mr=Z.stateNode,En=!1;break e;case 3:mr=Z.stateNode.containerInfo,En=!0;break e;case 4:mr=Z.stateNode.containerInfo,En=!0;break e}Z=Z.return}if(mr===null)throw Error(r(160));Nm(_,O,x),mr=null,En=!1;var ee=x.alternate;ee!==null&&(ee.return=null),x.return=null}catch(fe){Bt(x,o,fe)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Tm(o,s),o=o.sibling}function Tm(s,o){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Nn(o,s),In(s),h&4){try{_o(3,s,s.return),nc(3,s)}catch(Ve){Bt(s,s.return,Ve)}try{_o(5,s,s.return)}catch(Ve){Bt(s,s.return,Ve)}}break;case 1:Nn(o,s),In(s),h&512&&u!==null&&ti(u,u.return);break;case 5:if(Nn(o,s),In(s),h&512&&u!==null&&ti(u,u.return),s.flags&32){var x=s.stateNode;try{yn(x,"")}catch(Ve){Bt(s,s.return,Ve)}}if(h&4&&(x=s.stateNode,x!=null)){var _=s.memoizedProps,O=u!==null?u.memoizedProps:_,Z=s.type,ee=s.updateQueue;if(s.updateQueue=null,ee!==null)try{Z==="input"&&_.type==="radio"&&_.name!=null&&$e(x,_),zi(Z,O);var fe=zi(Z,_);for(O=0;O<ee.length;O+=2){var Ee=ee[O],be=ee[O+1];Ee==="style"?cs(x,be):Ee==="dangerouslySetInnerHTML"?ls(x,be):Ee==="children"?yn(x,be):C(x,Ee,be,fe)}switch(Z){case"input":Fe(x,_);break;case"textarea":pt(x,_);break;case"select":var Se=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!_.multiple;var Me=_.value;Me!=null?qt(x,!!_.multiple,Me,!1):Se!==!!_.multiple&&(_.defaultValue!=null?qt(x,!!_.multiple,_.defaultValue,!0):qt(x,!!_.multiple,_.multiple?[]:"",!1))}x[lo]=_}catch(Ve){Bt(s,s.return,Ve)}}break;case 6:if(Nn(o,s),In(s),h&4){if(s.stateNode===null)throw Error(r(162));x=s.stateNode,_=s.memoizedProps;try{x.nodeValue=_}catch(Ve){Bt(s,s.return,Ve)}}break;case 3:if(Nn(o,s),In(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{Yi(o.containerInfo)}catch(Ve){Bt(s,s.return,Ve)}break;case 4:Nn(o,s),In(s);break;case 13:Nn(o,s),In(s),x=s.child,x.flags&8192&&(_=x.memoizedState!==null,x.stateNode.isHidden=_,!_||x.alternate!==null&&x.alternate.memoizedState!==null||(Fd=Te())),h&4&&bm(s);break;case 22:if(Ee=u!==null&&u.memoizedState!==null,s.mode&1?(br=(fe=br)||Ee,Nn(o,s),br=fe):Nn(o,s),In(s),h&8192){if(fe=s.memoizedState!==null,(s.stateNode.isHidden=fe)&&!Ee&&(s.mode&1)!==0)for(Ue=s,Ee=s.child;Ee!==null;){for(be=Ue=Ee;Ue!==null;){switch(Se=Ue,Me=Se.child,Se.tag){case 0:case 11:case 14:case 15:_o(4,Se,Se.return);break;case 1:ti(Se,Se.return);var ze=Se.stateNode;if(typeof ze.componentWillUnmount=="function"){h=Se,u=Se.return;try{o=h,ze.props=o.memoizedProps,ze.state=o.memoizedState,ze.componentWillUnmount()}catch(Ve){Bt(h,u,Ve)}}break;case 5:ti(Se,Se.return);break;case 22:if(Se.memoizedState!==null){Am(be);continue}}Me!==null?(Me.return=Se,Ue=Me):Am(be)}Ee=Ee.sibling}e:for(Ee=null,be=s;;){if(be.tag===5){if(Ee===null){Ee=be;try{x=be.stateNode,fe?(_=x.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(Z=be.stateNode,ee=be.memoizedProps.style,O=ee!=null&&ee.hasOwnProperty("display")?ee.display:null,Z.style.display=_n("display",O))}catch(Ve){Bt(s,s.return,Ve)}}}else if(be.tag===6){if(Ee===null)try{be.stateNode.nodeValue=fe?"":be.memoizedProps}catch(Ve){Bt(s,s.return,Ve)}}else if((be.tag!==22&&be.tag!==23||be.memoizedState===null||be===s)&&be.child!==null){be.child.return=be,be=be.child;continue}if(be===s)break e;for(;be.sibling===null;){if(be.return===null||be.return===s)break e;Ee===be&&(Ee=null),be=be.return}Ee===be&&(Ee=null),be.sibling.return=be.return,be=be.sibling}}break;case 19:Nn(o,s),In(s),h&4&&bm(s);break;case 21:break;default:Nn(o,s),In(s)}}function In(s){var o=s.flags;if(o&2){try{e:{for(var u=s.return;u!==null;){if(Sm(u)){var h=u;break e}u=u.return}throw Error(r(160))}switch(h.tag){case 5:var x=h.stateNode;h.flags&32&&(yn(x,""),h.flags&=-33);var _=Em(s);Od(s,_,x);break;case 3:case 4:var O=h.stateNode.containerInfo,Z=Em(s);Ad(s,Z,O);break;default:throw Error(r(161))}}catch(ee){Bt(s,s.return,ee)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Oy(s,o,u){Ue=s,km(s)}function km(s,o,u){for(var h=(s.mode&1)!==0;Ue!==null;){var x=Ue,_=x.child;if(x.tag===22&&h){var O=x.memoizedState!==null||rc;if(!O){var Z=x.alternate,ee=Z!==null&&Z.memoizedState!==null||br;Z=rc;var fe=br;if(rc=O,(br=ee)&&!fe)for(Ue=x;Ue!==null;)O=Ue,ee=O.child,O.tag===22&&O.memoizedState!==null?Om(x):ee!==null?(ee.return=O,Ue=ee):Om(x);for(;_!==null;)Ue=_,km(_),_=_.sibling;Ue=x,rc=Z,br=fe}Cm(s)}else(x.subtreeFlags&8772)!==0&&_!==null?(_.return=x,Ue=_):Cm(s)}}function Cm(s){for(;Ue!==null;){var o=Ue;if((o.flags&8772)!==0){var u=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:br||nc(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!br)if(u===null)h.componentDidMount();else{var x=o.elementType===o.type?u.memoizedProps:Sn(o.type,u.memoizedProps);h.componentDidUpdate(x,u.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var _=o.updateQueue;_!==null&&A0(o,_,h);break;case 3:var O=o.updateQueue;if(O!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}A0(o,O,u)}break;case 5:var Z=o.stateNode;if(u===null&&o.flags&4){u=Z;var ee=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":ee.autoFocus&&u.focus();break;case"img":ee.src&&(u.src=ee.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var fe=o.alternate;if(fe!==null){var Ee=fe.memoizedState;if(Ee!==null){var be=Ee.dehydrated;be!==null&&Yi(be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}br||o.flags&512&&Cd(o)}catch(Se){Bt(o,o.return,Se)}}if(o===s){Ue=null;break}if(u=o.sibling,u!==null){u.return=o.return,Ue=u;break}Ue=o.return}}function Am(s){for(;Ue!==null;){var o=Ue;if(o===s){Ue=null;break}var u=o.sibling;if(u!==null){u.return=o.return,Ue=u;break}Ue=o.return}}function Om(s){for(;Ue!==null;){var o=Ue;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{nc(4,o)}catch(ee){Bt(o,u,ee)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var x=o.return;try{h.componentDidMount()}catch(ee){Bt(o,x,ee)}}var _=o.return;try{Cd(o)}catch(ee){Bt(o,_,ee)}break;case 5:var O=o.return;try{Cd(o)}catch(ee){Bt(o,O,ee)}}}catch(ee){Bt(o,o.return,ee)}if(o===s){Ue=null;break}var Z=o.sibling;if(Z!==null){Z.return=o.return,Ue=Z;break}Ue=o.return}}var Py=Math.ceil,sc=P.ReactCurrentDispatcher,Pd=P.ReactCurrentOwner,hn=P.ReactCurrentBatchConfig,dt=0,ar=null,Gt=null,pr=0,Zr=0,ri=_s(0),Zt=0,wo=null,da=0,ac=0,Rd=0,jo=null,zr=null,Fd=0,ni=1/0,Yn=null,ic=!1,Dd=null,bs=null,oc=!1,Ts=null,lc=0,So=0,Ld=null,cc=-1,uc=0;function Fr(){return(dt&6)!==0?Te():cc!==-1?cc:cc=Te()}function ks(s){return(s.mode&1)===0?1:(dt&2)!==0&&pr!==0?pr&-pr:py.transition!==null?(uc===0&&(uc=Eh()),uc):(s=xt,s!==0||(s=window.event,s=s===void 0?16:Rh(s.type)),s)}function bn(s,o,u,h){if(50<So)throw So=0,Ld=null,Error(r(185));qi(s,u,h),((dt&2)===0||s!==ar)&&(s===ar&&((dt&2)===0&&(ac|=u),Zt===4&&Cs(s,pr)),$r(s,h),u===1&&dt===0&&(o.mode&1)===0&&(ni=Te()+500,Ml&&js()))}function $r(s,o){var u=s.callbackNode;p1(s,o);var h=yl(s,s===ar?pr:0);if(h===0)u!==null&&Le(u),s.callbackNode=null,s.callbackPriority=0;else if(o=h&-h,s.callbackPriority!==o){if(u!=null&&Le(u),o===1)s.tag===0?my(Rm.bind(null,s)):v0(Rm.bind(null,s)),uy(function(){(dt&6)===0&&js()}),u=null;else{switch(Nh(h)){case 1:u=St;break;case 4:u=Et;break;case 16:u=$t;break;case 536870912:u=fs;break;default:u=$t}u=zm(u,Pm.bind(null,s))}s.callbackPriority=o,s.callbackNode=u}}function Pm(s,o){if(cc=-1,uc=0,(dt&6)!==0)throw Error(r(327));var u=s.callbackNode;if(si()&&s.callbackNode!==u)return null;var h=yl(s,s===ar?pr:0);if(h===0)return null;if((h&30)!==0||(h&s.expiredLanes)!==0||o)o=dc(s,h);else{o=h;var x=dt;dt|=2;var _=Dm();(ar!==s||pr!==o)&&(Yn=null,ni=Te()+500,ha(s,o));do try{Dy();break}catch(Z){Fm(s,Z)}while(!0);ed(),sc.current=_,dt=x,Gt!==null?o=0:(ar=null,pr=0,o=Zt)}if(o!==0){if(o===2&&(x=xu(s),x!==0&&(h=x,o=Id(s,x))),o===1)throw u=wo,ha(s,0),Cs(s,h),$r(s,Te()),u;if(o===6)Cs(s,h);else{if(x=s.current.alternate,(h&30)===0&&!Ry(x)&&(o=dc(s,h),o===2&&(_=xu(s),_!==0&&(h=_,o=Id(s,_))),o===1))throw u=wo,ha(s,0),Cs(s,h),$r(s,Te()),u;switch(s.finishedWork=x,s.finishedLanes=h,o){case 0:case 1:throw Error(r(345));case 2:ma(s,zr,Yn);break;case 3:if(Cs(s,h),(h&130023424)===h&&(o=Fd+500-Te(),10<o)){if(yl(s,0)!==0)break;if(x=s.suspendedLanes,(x&h)!==h){Fr(),s.pingedLanes|=s.suspendedLanes&x;break}s.timeoutHandle=Wu(ma.bind(null,s,zr,Yn),o);break}ma(s,zr,Yn);break;case 4:if(Cs(s,h),(h&4194240)===h)break;for(o=s.eventTimes,x=-1;0<h;){var O=31-Wt(h);_=1<<O,O=o[O],O>x&&(x=O),h&=~_}if(h=x,h=Te()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*Py(h/1960))-h,10<h){s.timeoutHandle=Wu(ma.bind(null,s,zr,Yn),h);break}ma(s,zr,Yn);break;case 5:ma(s,zr,Yn);break;default:throw Error(r(329))}}}return $r(s,Te()),s.callbackNode===u?Pm.bind(null,s):null}function Id(s,o){var u=jo;return s.current.memoizedState.isDehydrated&&(ha(s,o).flags|=256),s=dc(s,o),s!==2&&(o=zr,zr=u,o!==null&&Md(o)),s}function Md(s){zr===null?zr=s:zr.push.apply(zr,s)}function Ry(s){for(var o=s;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var h=0;h<u.length;h++){var x=u[h],_=x.getSnapshot;x=x.value;try{if(!wn(_(),x))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Cs(s,o){for(o&=~Rd,o&=~ac,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var u=31-Wt(o),h=1<<u;s[u]=-1,o&=~h}}function Rm(s){if((dt&6)!==0)throw Error(r(327));si();var o=yl(s,0);if((o&1)===0)return $r(s,Te()),null;var u=dc(s,o);if(s.tag!==0&&u===2){var h=xu(s);h!==0&&(o=h,u=Id(s,h))}if(u===1)throw u=wo,ha(s,0),Cs(s,o),$r(s,Te()),u;if(u===6)throw Error(r(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,ma(s,zr,Yn),$r(s,Te()),null}function Bd(s,o){var u=dt;dt|=1;try{return s(o)}finally{dt=u,dt===0&&(ni=Te()+500,Ml&&js())}}function fa(s){Ts!==null&&Ts.tag===0&&(dt&6)===0&&si();var o=dt;dt|=1;var u=hn.transition,h=xt;try{if(hn.transition=null,xt=1,s)return s()}finally{xt=h,hn.transition=u,dt=o,(dt&6)===0&&js()}}function Ud(){Zr=ri.current,At(ri)}function ha(s,o){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,cy(u)),Gt!==null)for(u=Gt.return;u!==null;){var h=u;switch(Xu(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ll();break;case 3:Za(),At(Mr),At(Sr),ld();break;case 5:id(h);break;case 4:Za();break;case 13:At(Dt);break;case 19:At(Dt);break;case 10:td(h.type._context);break;case 22:case 23:Ud()}u=u.return}if(ar=s,Gt=s=As(s.current,null),pr=Zr=o,Zt=0,wo=null,Rd=ac=da=0,zr=jo=null,la!==null){for(o=0;o<la.length;o++)if(u=la[o],h=u.interleaved,h!==null){u.interleaved=null;var x=h.next,_=u.pending;if(_!==null){var O=_.next;_.next=x,h.next=O}u.pending=h}la=null}return s}function Fm(s,o){do{var u=Gt;try{if(ed(),Kl.current=Ql,Xl){for(var h=Lt.memoizedState;h!==null;){var x=h.queue;x!==null&&(x.pending=null),h=h.next}Xl=!1}if(ua=0,sr=Qt=Lt=null,po=!1,xo=0,Pd.current=null,u===null||u.return===null){Zt=1,wo=o,Gt=null;break}e:{var _=s,O=u.return,Z=u,ee=o;if(o=pr,Z.flags|=32768,ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var fe=ee,Ee=Z,be=Ee.tag;if((Ee.mode&1)===0&&(be===0||be===11||be===15)){var Se=Ee.alternate;Se?(Ee.updateQueue=Se.updateQueue,Ee.memoizedState=Se.memoizedState,Ee.lanes=Se.lanes):(Ee.updateQueue=null,Ee.memoizedState=null)}var Me=am(O);if(Me!==null){Me.flags&=-257,im(Me,O,Z,_,o),Me.mode&1&&sm(_,fe,o),o=Me,ee=fe;var ze=o.updateQueue;if(ze===null){var Ve=new Set;Ve.add(ee),o.updateQueue=Ve}else ze.add(ee);break e}else{if((o&1)===0){sm(_,fe,o),zd();break e}ee=Error(r(426))}}else if(Ft&&Z.mode&1){var Vt=am(O);if(Vt!==null){(Vt.flags&65536)===0&&(Vt.flags|=256),im(Vt,O,Z,_,o),Qu(ei(ee,Z));break e}}_=ee=ei(ee,Z),Zt!==4&&(Zt=2),jo===null?jo=[_]:jo.push(_),_=O;do{switch(_.tag){case 3:_.flags|=65536,o&=-o,_.lanes|=o;var ae=rm(_,ee,o);C0(_,ae);break e;case 1:Z=ee;var ne=_.type,ie=_.stateNode;if((_.flags&128)===0&&(typeof ne.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(bs===null||!bs.has(ie)))){_.flags|=65536,o&=-o,_.lanes|=o;var Ce=nm(_,Z,o);C0(_,Ce);break e}}_=_.return}while(_!==null)}Im(u)}catch(Ge){o=Ge,Gt===u&&u!==null&&(Gt=u=u.return);continue}break}while(!0)}function Dm(){var s=sc.current;return sc.current=Ql,s===null?Ql:s}function zd(){(Zt===0||Zt===3||Zt===2)&&(Zt=4),ar===null||(da&268435455)===0&&(ac&268435455)===0||Cs(ar,pr)}function dc(s,o){var u=dt;dt|=2;var h=Dm();(ar!==s||pr!==o)&&(Yn=null,ha(s,o));do try{Fy();break}catch(x){Fm(s,x)}while(!0);if(ed(),dt=u,sc.current=h,Gt!==null)throw Error(r(261));return ar=null,pr=0,Zt}function Fy(){for(;Gt!==null;)Lm(Gt)}function Dy(){for(;Gt!==null&&!Be();)Lm(Gt)}function Lm(s){var o=Um(s.alternate,s,Zr);s.memoizedProps=s.pendingProps,o===null?Im(s):Gt=o,Pd.current=null}function Im(s){var o=s;do{var u=o.alternate;if(s=o.return,(o.flags&32768)===0){if(u=Ty(u,o,Zr),u!==null){Gt=u;return}}else{if(u=ky(u,o),u!==null){u.flags&=32767,Gt=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Zt=6,Gt=null;return}}if(o=o.sibling,o!==null){Gt=o;return}Gt=o=s}while(o!==null);Zt===0&&(Zt=5)}function ma(s,o,u){var h=xt,x=hn.transition;try{hn.transition=null,xt=1,Ly(s,o,u,h)}finally{hn.transition=x,xt=h}return null}function Ly(s,o,u,h){do si();while(Ts!==null);if((dt&6)!==0)throw Error(r(327));u=s.finishedWork;var x=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(r(177));s.callbackNode=null,s.callbackPriority=0;var _=u.lanes|u.childLanes;if(x1(s,_),s===ar&&(Gt=ar=null,pr=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||oc||(oc=!0,zm($t,function(){return si(),null})),_=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||_){_=hn.transition,hn.transition=null;var O=xt;xt=1;var Z=dt;dt|=4,Pd.current=null,Ay(s,u),Tm(u,s),ry(zu),jl=!!Uu,zu=Uu=null,s.current=u,Oy(u),ke(),dt=Z,xt=O,hn.transition=_}else s.current=u;if(oc&&(oc=!1,Ts=s,lc=x),_=s.pendingLanes,_===0&&(bs=null),Vi(u.stateNode),$r(s,Te()),o!==null)for(h=s.onRecoverableError,u=0;u<o.length;u++)x=o[u],h(x.value,{componentStack:x.stack,digest:x.digest});if(ic)throw ic=!1,s=Dd,Dd=null,s;return(lc&1)!==0&&s.tag!==0&&si(),_=s.pendingLanes,(_&1)!==0?s===Ld?So++:(So=0,Ld=s):So=0,js(),null}function si(){if(Ts!==null){var s=Nh(lc),o=hn.transition,u=xt;try{if(hn.transition=null,xt=16>s?16:s,Ts===null)var h=!1;else{if(s=Ts,Ts=null,lc=0,(dt&6)!==0)throw Error(r(331));var x=dt;for(dt|=4,Ue=s.current;Ue!==null;){var _=Ue,O=_.child;if((Ue.flags&16)!==0){var Z=_.deletions;if(Z!==null){for(var ee=0;ee<Z.length;ee++){var fe=Z[ee];for(Ue=fe;Ue!==null;){var Ee=Ue;switch(Ee.tag){case 0:case 11:case 15:_o(8,Ee,_)}var be=Ee.child;if(be!==null)be.return=Ee,Ue=be;else for(;Ue!==null;){Ee=Ue;var Se=Ee.sibling,Me=Ee.return;if(jm(Ee),Ee===fe){Ue=null;break}if(Se!==null){Se.return=Me,Ue=Se;break}Ue=Me}}}var ze=_.alternate;if(ze!==null){var Ve=ze.child;if(Ve!==null){ze.child=null;do{var Vt=Ve.sibling;Ve.sibling=null,Ve=Vt}while(Ve!==null)}}Ue=_}}if((_.subtreeFlags&2064)!==0&&O!==null)O.return=_,Ue=O;else e:for(;Ue!==null;){if(_=Ue,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:_o(9,_,_.return)}var ae=_.sibling;if(ae!==null){ae.return=_.return,Ue=ae;break e}Ue=_.return}}var ne=s.current;for(Ue=ne;Ue!==null;){O=Ue;var ie=O.child;if((O.subtreeFlags&2064)!==0&&ie!==null)ie.return=O,Ue=ie;else e:for(O=ne;Ue!==null;){if(Z=Ue,(Z.flags&2048)!==0)try{switch(Z.tag){case 0:case 11:case 15:nc(9,Z)}}catch(Ge){Bt(Z,Z.return,Ge)}if(Z===O){Ue=null;break e}var Ce=Z.sibling;if(Ce!==null){Ce.return=Z.return,Ue=Ce;break e}Ue=Z.return}}if(dt=x,js(),nr&&typeof nr.onPostCommitFiberRoot=="function")try{nr.onPostCommitFiberRoot(Rn,s)}catch{}h=!0}return h}finally{xt=u,hn.transition=o}}return!1}function Mm(s,o,u){o=ei(u,o),o=rm(s,o,1),s=Es(s,o,1),o=Fr(),s!==null&&(qi(s,1,o),$r(s,o))}function Bt(s,o,u){if(s.tag===3)Mm(s,s,u);else for(;o!==null;){if(o.tag===3){Mm(o,s,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(bs===null||!bs.has(h))){s=ei(u,s),s=nm(o,s,1),o=Es(o,s,1),s=Fr(),o!==null&&(qi(o,1,s),$r(o,s));break}}o=o.return}}function Iy(s,o,u){var h=s.pingCache;h!==null&&h.delete(o),o=Fr(),s.pingedLanes|=s.suspendedLanes&u,ar===s&&(pr&u)===u&&(Zt===4||Zt===3&&(pr&130023424)===pr&&500>Te()-Fd?ha(s,0):Rd|=u),$r(s,o)}function Bm(s,o){o===0&&((s.mode&1)===0?o=1:(o=vl,vl<<=1,(vl&130023424)===0&&(vl=4194304)));var u=Fr();s=Kn(s,o),s!==null&&(qi(s,o,u),$r(s,u))}function My(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),Bm(s,u)}function By(s,o){var u=0;switch(s.tag){case 13:var h=s.stateNode,x=s.memoizedState;x!==null&&(u=x.retryLane);break;case 19:h=s.stateNode;break;default:throw Error(r(314))}h!==null&&h.delete(o),Bm(s,u)}var Um;Um=function(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps||Mr.current)Ur=!0;else{if((s.lanes&u)===0&&(o.flags&128)===0)return Ur=!1,by(s,o,u);Ur=(s.flags&131072)!==0}else Ur=!1,Ft&&(o.flags&1048576)!==0&&y0(o,Ul,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;tc(s,o),s=o.pendingProps;var x=qa(o,Sr.current);Qa(o,u),x=dd(null,o,h,s,x,u);var _=fd();return o.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Br(h)?(_=!0,Il(o)):_=!1,o.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,sd(o),x.updater=Zl,o.stateNode=x,x._reactInternals=o,vd(o,h,s,u),o=jd(null,o,h,!0,_,u)):(o.tag=0,Ft&&_&&Ku(o),Rr(null,o,x,u),o=o.child),o;case 16:h=o.elementType;e:{switch(tc(s,o),s=o.pendingProps,x=h._init,h=x(h._payload),o.type=h,x=o.tag=zy(h),s=Sn(h,s),x){case 0:o=wd(null,o,h,s,u);break e;case 1:o=fm(null,o,h,s,u);break e;case 11:o=om(null,o,h,s,u);break e;case 14:o=lm(null,o,h,Sn(h.type,s),u);break e}throw Error(r(306,h,""))}return o;case 0:return h=o.type,x=o.pendingProps,x=o.elementType===h?x:Sn(h,x),wd(s,o,h,x,u);case 1:return h=o.type,x=o.pendingProps,x=o.elementType===h?x:Sn(h,x),fm(s,o,h,x,u);case 3:e:{if(hm(o),s===null)throw Error(r(387));h=o.pendingProps,_=o.memoizedState,x=_.element,k0(s,o),ql(o,h,null,u);var O=o.memoizedState;if(h=O.element,_.isDehydrated)if(_={element:h,isDehydrated:!1,cache:O.cache,pendingSuspenseBoundaries:O.pendingSuspenseBoundaries,transitions:O.transitions},o.updateQueue.baseState=_,o.memoizedState=_,o.flags&256){x=ei(Error(r(423)),o),o=mm(s,o,h,u,x);break e}else if(h!==x){x=ei(Error(r(424)),o),o=mm(s,o,h,u,x);break e}else for(Qr=ys(o.stateNode.containerInfo.firstChild),Yr=o,Ft=!0,jn=null,u=b0(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Xa(),h===x){o=Jn(s,o,u);break e}Rr(s,o,h,u)}o=o.child}return o;case 5:return O0(o),s===null&&Yu(o),h=o.type,x=o.pendingProps,_=s!==null?s.memoizedProps:null,O=x.children,$u(h,x)?O=null:_!==null&&$u(h,_)&&(o.flags|=32),dm(s,o),Rr(s,o,O,u),o.child;case 6:return s===null&&Yu(o),null;case 13:return pm(s,o,u);case 4:return ad(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=Ja(o,null,h,u):Rr(s,o,h,u),o.child;case 11:return h=o.type,x=o.pendingProps,x=o.elementType===h?x:Sn(h,x),om(s,o,h,x,u);case 7:return Rr(s,o,o.pendingProps,u),o.child;case 8:return Rr(s,o,o.pendingProps.children,u),o.child;case 12:return Rr(s,o,o.pendingProps.children,u),o.child;case 10:e:{if(h=o.type._context,x=o.pendingProps,_=o.memoizedProps,O=x.value,Nt(Wl,h._currentValue),h._currentValue=O,_!==null)if(wn(_.value,O)){if(_.children===x.children&&!Mr.current){o=Jn(s,o,u);break e}}else for(_=o.child,_!==null&&(_.return=o);_!==null;){var Z=_.dependencies;if(Z!==null){O=_.child;for(var ee=Z.firstContext;ee!==null;){if(ee.context===h){if(_.tag===1){ee=Xn(-1,u&-u),ee.tag=2;var fe=_.updateQueue;if(fe!==null){fe=fe.shared;var Ee=fe.pending;Ee===null?ee.next=ee:(ee.next=Ee.next,Ee.next=ee),fe.pending=ee}}_.lanes|=u,ee=_.alternate,ee!==null&&(ee.lanes|=u),rd(_.return,u,o),Z.lanes|=u;break}ee=ee.next}}else if(_.tag===10)O=_.type===o.type?null:_.child;else if(_.tag===18){if(O=_.return,O===null)throw Error(r(341));O.lanes|=u,Z=O.alternate,Z!==null&&(Z.lanes|=u),rd(O,u,o),O=_.sibling}else O=_.child;if(O!==null)O.return=_;else for(O=_;O!==null;){if(O===o){O=null;break}if(_=O.sibling,_!==null){_.return=O.return,O=_;break}O=O.return}_=O}Rr(s,o,x.children,u),o=o.child}return o;case 9:return x=o.type,h=o.pendingProps.children,Qa(o,u),x=dn(x),h=h(x),o.flags|=1,Rr(s,o,h,u),o.child;case 14:return h=o.type,x=Sn(h,o.pendingProps),x=Sn(h.type,x),lm(s,o,h,x,u);case 15:return cm(s,o,o.type,o.pendingProps,u);case 17:return h=o.type,x=o.pendingProps,x=o.elementType===h?x:Sn(h,x),tc(s,o),o.tag=1,Br(h)?(s=!0,Il(o)):s=!1,Qa(o,u),em(o,h,x),vd(o,h,x,u),jd(null,o,h,!0,s,u);case 19:return gm(s,o,u);case 22:return um(s,o,u)}throw Error(r(156,o.tag))};function zm(s,o){return Ne(s,o)}function Uy(s,o,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(s,o,u,h){return new Uy(s,o,u,h)}function $d(s){return s=s.prototype,!(!s||!s.isReactComponent)}function zy(s){if(typeof s=="function")return $d(s)?1:0;if(s!=null){if(s=s.$$typeof,s===B)return 11;if(s===we)return 14}return 2}function As(s,o){var u=s.alternate;return u===null?(u=mn(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function fc(s,o,u,h,x,_){var O=2;if(h=s,typeof s=="function")$d(s)&&(O=1);else if(typeof s=="string")O=5;else e:switch(s){case N:return pa(u.children,x,_,o);case j:O=8,x|=8;break;case T:return s=mn(12,u,o,x|2),s.elementType=T,s.lanes=_,s;case Y:return s=mn(13,u,o,x),s.elementType=Y,s.lanes=_,s;case pe:return s=mn(19,u,o,x),s.elementType=pe,s.lanes=_,s;case he:return hc(u,x,_,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case k:O=10;break e;case q:O=9;break e;case B:O=11;break e;case we:O=14;break e;case te:O=16,h=null;break e}throw Error(r(130,s==null?s:typeof s,""))}return o=mn(O,u,o,x),o.elementType=s,o.type=h,o.lanes=_,o}function pa(s,o,u,h){return s=mn(7,s,h,o),s.lanes=u,s}function hc(s,o,u,h){return s=mn(22,s,h,o),s.elementType=he,s.lanes=u,s.stateNode={isHidden:!1},s}function Wd(s,o,u){return s=mn(6,s,null,o),s.lanes=u,s}function Vd(s,o,u){return o=mn(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function $y(s,o,u,h,x){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gu(0),this.expirationTimes=gu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gu(0),this.identifierPrefix=h,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function Hd(s,o,u,h,x,_,O,Z,ee){return s=new $y(s,o,u,Z,ee),o===1?(o=1,_===!0&&(o|=8)):o=0,_=mn(3,null,null,o),s.current=_,_.stateNode=s,_.memoizedState={element:h,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},sd(_),s}function Wy(s,o,u){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:h==null?null:""+h,children:s,containerInfo:o,implementation:u}}function $m(s){if(!s)return ws;s=s._reactInternals;e:{if(J(s)!==s||s.tag!==1)throw Error(r(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Br(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(r(171))}if(s.tag===1){var u=s.type;if(Br(u))return x0(s,u,o)}return o}function Wm(s,o,u,h,x,_,O,Z,ee){return s=Hd(u,h,!0,s,x,_,O,Z,ee),s.context=$m(null),u=s.current,h=Fr(),x=ks(u),_=Xn(h,x),_.callback=o??null,Es(u,_,x),s.current.lanes=x,qi(s,x,h),$r(s,h),s}function mc(s,o,u,h){var x=o.current,_=Fr(),O=ks(x);return u=$m(u),o.context===null?o.context=u:o.pendingContext=u,o=Xn(_,O),o.payload={element:s},h=h===void 0?null:h,h!==null&&(o.callback=h),s=Es(x,o,O),s!==null&&(bn(s,x,O,_),Hl(s,x,O)),O}function pc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Vm(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function qd(s,o){Vm(s,o),(s=s.alternate)&&Vm(s,o)}function Vy(){return null}var Hm=typeof reportError=="function"?reportError:function(s){console.error(s)};function Gd(s){this._internalRoot=s}xc.prototype.render=Gd.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));mc(s,o,null,null)},xc.prototype.unmount=Gd.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;fa(function(){mc(null,s,null,null)}),o[Vn]=null}};function xc(s){this._internalRoot=s}xc.prototype.unstable_scheduleHydration=function(s){if(s){var o=kh();s={blockedOn:null,target:s,priority:o};for(var u=0;u<xs.length&&o!==0&&o<xs[u].priority;u++);xs.splice(u,0,s),u===0&&Oh(s)}};function Kd(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function gc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function qm(){}function Hy(s,o,u,h,x){if(x){if(typeof h=="function"){var _=h;h=function(){var fe=pc(O);_.call(fe)}}var O=Wm(o,h,s,0,null,!1,!1,"",qm);return s._reactRootContainer=O,s[Vn]=O.current,io(s.nodeType===8?s.parentNode:s),fa(),O}for(;x=s.lastChild;)s.removeChild(x);if(typeof h=="function"){var Z=h;h=function(){var fe=pc(ee);Z.call(fe)}}var ee=Hd(s,0,!1,null,null,!1,!1,"",qm);return s._reactRootContainer=ee,s[Vn]=ee.current,io(s.nodeType===8?s.parentNode:s),fa(function(){mc(o,ee,u,h)}),ee}function vc(s,o,u,h,x){var _=u._reactRootContainer;if(_){var O=_;if(typeof x=="function"){var Z=x;x=function(){var ee=pc(O);Z.call(ee)}}mc(o,O,s,x)}else O=Hy(u,o,s,x,h);return pc(O)}bh=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var u=Hi(o.pendingLanes);u!==0&&(vu(o,u|1),$r(o,Te()),(dt&6)===0&&(ni=Te()+500,js()))}break;case 13:fa(function(){var h=Kn(s,1);if(h!==null){var x=Fr();bn(h,s,1,x)}}),qd(s,1)}},yu=function(s){if(s.tag===13){var o=Kn(s,134217728);if(o!==null){var u=Fr();bn(o,s,134217728,u)}qd(s,134217728)}},Th=function(s){if(s.tag===13){var o=ks(s),u=Kn(s,o);if(u!==null){var h=Fr();bn(u,s,o,h)}qd(s,o)}},kh=function(){return xt},Ch=function(s,o){var u=xt;try{return xt=s,o()}finally{xt=u}},Da=function(s,o,u){switch(o){case"input":if(Fe(s,u),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==s&&h.form===s.form){var x=Dl(h);if(!x)throw Error(r(90));qe(h),Fe(h,x)}}}break;case"textarea":pt(s,u);break;case"select":o=u.value,o!=null&&qt(s,!!u.multiple,o,!1)}},ml=Bd,pl=fa;var qy={usingClientEntryPoint:!1,Events:[co,Va,Dl,fl,hl,Bd]},Eo={findFiberByHostInstance:sa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gy={bundleType:Eo.bundleType,version:Eo.version,rendererPackageName:Eo.rendererPackageName,rendererConfig:Eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:P.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=ce(s),s===null?null:s.stateNode},findFiberByHostInstance:Eo.findFiberByHostInstance||Vy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yc.isDisabled&&yc.supportsFiber)try{Rn=yc.inject(Gy),nr=yc}catch{}}return Wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qy,Wr.createPortal=function(s,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kd(o))throw Error(r(200));return Wy(s,o,null,u)},Wr.createRoot=function(s,o){if(!Kd(s))throw Error(r(299));var u=!1,h="",x=Hm;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),o=Hd(s,1,!1,null,null,u,!1,h,x),s[Vn]=o.current,io(s.nodeType===8?s.parentNode:s),new Gd(o)},Wr.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=ce(o),s=s===null?null:s.stateNode,s},Wr.flushSync=function(s){return fa(s)},Wr.hydrate=function(s,o,u){if(!gc(o))throw Error(r(200));return vc(null,s,o,!0,u)},Wr.hydrateRoot=function(s,o,u){if(!Kd(s))throw Error(r(405));var h=u!=null&&u.hydratedSources||null,x=!1,_="",O=Hm;if(u!=null&&(u.unstable_strictMode===!0&&(x=!0),u.identifierPrefix!==void 0&&(_=u.identifierPrefix),u.onRecoverableError!==void 0&&(O=u.onRecoverableError)),o=Wm(o,null,s,1,u??null,x,!1,_,O),s[Vn]=o.current,io(s),h)for(s=0;s<h.length;s++)u=h[s],x=u._getVersion,x=x(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,x]:o.mutableSourceEagerHydrationData.push(u,x);return new xc(o)},Wr.render=function(s,o,u){if(!gc(o))throw Error(r(200));return vc(null,s,o,!1,u)},Wr.unmountComponentAtNode=function(s){if(!gc(s))throw Error(r(40));return s._reactRootContainer?(fa(function(){vc(null,null,s,!1,function(){s._reactRootContainer=null,s[Vn]=null})}),!0):!1},Wr.unstable_batchedUpdates=Bd,Wr.unstable_renderSubtreeIntoContainer=function(s,o,u,h){if(!gc(u))throw Error(r(200));if(s==null||s._reactInternals===void 0)throw Error(r(38));return vc(s,o,u,!1,h)},Wr.version="18.3.1-next-f1338f8080-20240426",Wr}var ep;function Mx(){if(ep)return Yd.exports;ep=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Yd.exports=n_(),Yd.exports}var tp;function s_(){if(tp)return _c;tp=1;var t=Mx();return _c.createRoot=t.createRoot,_c.hydrateRoot=t.hydrateRoot,_c}var a_=s_();const i_=tu(a_);Mx();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vo(){return Vo=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Vo.apply(this,arguments)}var Ms;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ms||(Ms={}));const rp="popstate";function o_(t){t===void 0&&(t={});function e(n,i){let{pathname:l,search:c,hash:d}=n.location;return _f("",{pathname:l,search:c,hash:d},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Dc(i)}return c_(e,r,null,t)}function Ht(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Bx(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function l_(){return Math.random().toString(36).substr(2,8)}function np(t,e){return{usr:t.state,key:t.key,idx:e}}function _f(t,e,r,n){return r===void 0&&(r=null),Vo({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Oi(e):e,{state:r,key:e&&e.key||n||l_()})}function Dc(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Oi(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function c_(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:l=!1}=n,c=i.history,d=Ms.Pop,m=null,f=p();f==null&&(f=0,c.replaceState(Vo({},c.state,{idx:f}),""));function p(){return(c.state||{idx:null}).idx}function g(){d=Ms.Pop;let E=p(),D=E==null?null:E-f;f=E,m&&m({action:d,location:y.location,delta:D})}function v(E,D){d=Ms.Push;let A=_f(y.location,E,D);f=p()+1;let C=np(A,f),P=y.createHref(A);try{c.pushState(C,"",P)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;i.location.assign(P)}l&&m&&m({action:d,location:y.location,delta:1})}function w(E,D){d=Ms.Replace;let A=_f(y.location,E,D);f=p();let C=np(A,f),P=y.createHref(A);c.replaceState(C,"",P),l&&m&&m({action:d,location:y.location,delta:0})}function S(E){let D=i.location.origin!=="null"?i.location.origin:i.location.href,A=typeof E=="string"?E:Dc(E);return A=A.replace(/ $/,"%20"),Ht(D,"No window.location.(origin|href) available to create URL for href: "+A),new URL(A,D)}let y={get action(){return d},get location(){return t(i,c)},listen(E){if(m)throw new Error("A history only accepts one active listener");return i.addEventListener(rp,g),m=E,()=>{i.removeEventListener(rp,g),m=null}},createHref(E){return e(i,E)},createURL:S,encodeLocation(E){let D=S(E);return{pathname:D.pathname,search:D.search,hash:D.hash}},push:v,replace:w,go(E){return c.go(E)}};return y}var sp;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(sp||(sp={}));function u_(t,e,r){return r===void 0&&(r="/"),d_(t,e,r)}function d_(t,e,r,n){let i=typeof e=="string"?Oi(e):e,l=Wf(i.pathname||"/",r);if(l==null)return null;let c=Ux(t);f_(c);let d=null;for(let m=0;d==null&&m<c.length;++m){let f=E_(l);d=w_(c[m],f)}return d}function Ux(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(l,c,d)=>{let m={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};m.relativePath.startsWith("/")&&(Ht(m.relativePath.startsWith(n),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(n.length));let f=zs([n,m.relativePath]),p=r.concat(m);l.children&&l.children.length>0&&(Ht(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),Ux(l.children,e,p,f)),!(l.path==null&&!l.index)&&e.push({path:f,score:y_(f,l.index),routesMeta:p})};return t.forEach((l,c)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))i(l,c);else for(let m of zx(l.path))i(l,c,m)}),e}function zx(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return i?[l,""]:[l];let c=zx(n.join("/")),d=[];return d.push(...c.map(m=>m===""?l:[l,m].join("/"))),i&&d.push(...c),d.map(m=>t.startsWith("/")&&m===""?"/":m)}function f_(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:__(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const h_=/^:[\w-]+$/,m_=3,p_=2,x_=1,g_=10,v_=-2,ap=t=>t==="*";function y_(t,e){let r=t.split("/"),n=r.length;return r.some(ap)&&(n+=v_),e&&(n+=p_),r.filter(i=>!ap(i)).reduce((i,l)=>i+(h_.test(l)?m_:l===""?x_:g_),n)}function __(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function w_(t,e,r){let{routesMeta:n}=t,i={},l="/",c=[];for(let d=0;d<n.length;++d){let m=n[d],f=d===n.length-1,p=l==="/"?e:e.slice(l.length)||"/",g=j_({path:m.relativePath,caseSensitive:m.caseSensitive,end:f},p),v=m.route;if(!g)return null;Object.assign(i,g.params),c.push({params:i,pathname:zs([l,g.pathname]),pathnameBase:k_(zs([l,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(l=zs([l,g.pathnameBase]))}return c}function j_(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=S_(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let l=i[0],c=l.replace(/(.)\/+$/,"$1"),d=i.slice(1);return{params:n.reduce((f,p,g)=>{let{paramName:v,isOptional:w}=p;if(v==="*"){let y=d[g]||"";c=l.slice(0,l.length-y.length).replace(/(.)\/+$/,"$1")}const S=d[g];return w&&!S?f[v]=void 0:f[v]=(S||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:t}}function S_(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Bx(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,m)=>(n.push({paramName:d,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function E_(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bx(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Wf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function N_(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Oi(t):t;return{pathname:r?r.startsWith("/")?r:b_(r,e):e,search:C_(n),hash:A_(i)}}function b_(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function ef(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function T_(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Vf(t,e){let r=T_(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Hf(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Oi(t):(i=Vo({},t),Ht(!i.pathname||!i.pathname.includes("?"),ef("?","pathname","search",i)),Ht(!i.pathname||!i.pathname.includes("#"),ef("#","pathname","hash",i)),Ht(!i.search||!i.search.includes("#"),ef("#","search","hash",i)));let l=t===""||i.pathname==="",c=l?"/":i.pathname,d;if(c==null)d=r;else{let g=e.length-1;if(!n&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),g-=1;i.pathname=v.join("/")}d=g>=0?e[g]:"/"}let m=N_(i,d),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&r.endsWith("/");return!m.pathname.endsWith("/")&&(f||p)&&(m.pathname+="/"),m}const zs=t=>t.join("/").replace(/\/\/+/g,"/"),k_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),C_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,A_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function O_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const $x=["post","put","patch","delete"];new Set($x);const P_=["get",...$x];new Set(P_);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ho(){return Ho=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ho.apply(this,arguments)}const qf=U.createContext(null),R_=U.createContext(null),Ks=U.createContext(null),ru=U.createContext(null),Xs=U.createContext({outlet:null,matches:[],isDataRoute:!1}),Wx=U.createContext(null);function F_(t,e){let{relative:r}=e===void 0?{}:e;Pi()||Ht(!1);let{basename:n,navigator:i}=U.useContext(Ks),{hash:l,pathname:c,search:d}=Hx(t,{relative:r}),m=c;return n!=="/"&&(m=c==="/"?n:zs([n,c])),i.createHref({pathname:m,search:d,hash:l})}function Pi(){return U.useContext(ru)!=null}function as(){return Pi()||Ht(!1),U.useContext(ru).location}function Vx(t){U.useContext(Ks).static||U.useLayoutEffect(t)}function tl(){let{isDataRoute:t}=U.useContext(Xs);return t?G_():D_()}function D_(){Pi()||Ht(!1);let t=U.useContext(qf),{basename:e,future:r,navigator:n}=U.useContext(Ks),{matches:i}=U.useContext(Xs),{pathname:l}=as(),c=JSON.stringify(Vf(i,r.v7_relativeSplatPath)),d=U.useRef(!1);return Vx(()=>{d.current=!0}),U.useCallback(function(f,p){if(p===void 0&&(p={}),!d.current)return;if(typeof f=="number"){n.go(f);return}let g=Hf(f,JSON.parse(c),l,p.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:zs([e,g.pathname])),(p.replace?n.replace:n.push)(g,p.state,p)},[e,n,c,l,t])}function Hx(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=U.useContext(Ks),{matches:i}=U.useContext(Xs),{pathname:l}=as(),c=JSON.stringify(Vf(i,n.v7_relativeSplatPath));return U.useMemo(()=>Hf(t,JSON.parse(c),l,r==="path"),[t,c,l,r])}function L_(t,e){return I_(t,e)}function I_(t,e,r,n){Pi()||Ht(!1);let{navigator:i,static:l}=U.useContext(Ks),{matches:c}=U.useContext(Xs),d=c[c.length-1],m=d?d.params:{};d&&d.pathname;let f=d?d.pathnameBase:"/";d&&d.route;let p=as(),g;if(e){var v;let D=typeof e=="string"?Oi(e):e;f==="/"||(v=D.pathname)!=null&&v.startsWith(f)||Ht(!1),g=D}else g=p;let w=g.pathname||"/",S=w;if(f!=="/"){let D=f.replace(/^\//,"").split("/");S="/"+w.replace(/^\//,"").split("/").slice(D.length).join("/")}let y=u_(t,{pathname:S}),E=$_(y&&y.map(D=>Object.assign({},D,{params:Object.assign({},m,D.params),pathname:zs([f,i.encodeLocation?i.encodeLocation(D.pathname).pathname:D.pathname]),pathnameBase:D.pathnameBase==="/"?f:zs([f,i.encodeLocation?i.encodeLocation(D.pathnameBase).pathname:D.pathnameBase])})),c,r,n);return e&&E?U.createElement(ru.Provider,{value:{location:Ho({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Ms.Pop}},E):E}function M_(){let t=q_(),e=O_(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),r?U.createElement("pre",{style:i},r):null,null)}const B_=U.createElement(M_,null);class U_ extends U.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?U.createElement(Xs.Provider,{value:this.props.routeContext},U.createElement(Wx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function z_(t){let{routeContext:e,match:r,children:n}=t,i=U.useContext(qf);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),U.createElement(Xs.Provider,{value:e},n)}function $_(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var l;if(!r)return null;if(r.errors)t=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let c=t,d=(i=r)==null?void 0:i.errors;if(d!=null){let p=c.findIndex(g=>g.route.id&&(d==null?void 0:d[g.route.id])!==void 0);p>=0||Ht(!1),c=c.slice(0,Math.min(c.length,p+1))}let m=!1,f=-1;if(r&&n&&n.v7_partialHydration)for(let p=0;p<c.length;p++){let g=c[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(f=p),g.route.id){let{loaderData:v,errors:w}=r,S=g.route.loader&&v[g.route.id]===void 0&&(!w||w[g.route.id]===void 0);if(g.route.lazy||S){m=!0,f>=0?c=c.slice(0,f+1):c=[c[0]];break}}}return c.reduceRight((p,g,v)=>{let w,S=!1,y=null,E=null;r&&(w=d&&g.route.id?d[g.route.id]:void 0,y=g.route.errorElement||B_,m&&(f<0&&v===0?(K_("route-fallback"),S=!0,E=null):f===v&&(S=!0,E=g.route.hydrateFallbackElement||null)));let D=e.concat(c.slice(0,v+1)),A=()=>{let C;return w?C=y:S?C=E:g.route.Component?C=U.createElement(g.route.Component,null):g.route.element?C=g.route.element:C=p,U.createElement(z_,{match:g,routeContext:{outlet:p,matches:D,isDataRoute:r!=null},children:C})};return r&&(g.route.ErrorBoundary||g.route.errorElement||v===0)?U.createElement(U_,{location:r.location,revalidation:r.revalidation,component:y,error:w,children:A(),routeContext:{outlet:null,matches:D,isDataRoute:!0}}):A()},null)}var qx=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(qx||{}),Gx=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Gx||{});function W_(t){let e=U.useContext(qf);return e||Ht(!1),e}function V_(t){let e=U.useContext(R_);return e||Ht(!1),e}function H_(t){let e=U.useContext(Xs);return e||Ht(!1),e}function Kx(t){let e=H_(),r=e.matches[e.matches.length-1];return r.route.id||Ht(!1),r.route.id}function q_(){var t;let e=U.useContext(Wx),r=V_(),n=Kx();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function G_(){let{router:t}=W_(qx.UseNavigateStable),e=Kx(Gx.UseNavigateStable),r=U.useRef(!1);return Vx(()=>{r.current=!0}),U.useCallback(function(i,l){l===void 0&&(l={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Ho({fromRouteId:e},l)))},[t,e])}const ip={};function K_(t,e,r){ip[t]||(ip[t]=!0)}function X_(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Fo(t){let{to:e,replace:r,state:n,relative:i}=t;Pi()||Ht(!1);let{future:l,static:c}=U.useContext(Ks),{matches:d}=U.useContext(Xs),{pathname:m}=as(),f=tl(),p=Hf(e,Vf(d,l.v7_relativeSplatPath),m,i==="path"),g=JSON.stringify(p);return U.useEffect(()=>f(JSON.parse(g),{replace:r,state:n,relative:i}),[f,g,i,r,n]),null}function lr(t){Ht(!1)}function J_(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ms.Pop,navigator:l,static:c=!1,future:d}=t;Pi()&&Ht(!1);let m=e.replace(/^\/*/,"/"),f=U.useMemo(()=>({basename:m,navigator:l,static:c,future:Ho({v7_relativeSplatPath:!1},d)}),[m,d,l,c]);typeof n=="string"&&(n=Oi(n));let{pathname:p="/",search:g="",hash:v="",state:w=null,key:S="default"}=n,y=U.useMemo(()=>{let E=Wf(p,m);return E==null?null:{location:{pathname:E,search:g,hash:v,state:w,key:S},navigationType:i}},[m,p,g,v,w,S,i]);return y==null?null:U.createElement(Ks.Provider,{value:f},U.createElement(ru.Provider,{children:r,value:y}))}function Y_(t){let{children:e,location:r}=t;return L_(wf(e),r)}new Promise(()=>{});function wf(t,e){e===void 0&&(e=[]);let r=[];return U.Children.forEach(t,(n,i)=>{if(!U.isValidElement(n))return;let l=[...e,i];if(n.type===U.Fragment){r.push.apply(r,wf(n.props.children,l));return}n.type!==lr&&Ht(!1),!n.props.index||!n.props.children||Ht(!1);let c={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=wf(n.props.children,l)),r.push(c)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jf(){return jf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jf.apply(this,arguments)}function Q_(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,l;for(l=0;l<n.length;l++)i=n[l],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function Z_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function ew(t,e){return t.button===0&&(!e||e==="_self")&&!Z_(t)}function Sf(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function tw(t,e){let r=Sf(t);return e&&e.forEach((n,i)=>{r.has(i)||e.getAll(i).forEach(l=>{r.append(i,l)})}),r}const rw=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],nw="6";try{window.__reactRouterVersion=nw}catch{}const sw="startTransition",op=e_[sw];function aw(t){let{basename:e,children:r,future:n,window:i}=t,l=U.useRef();l.current==null&&(l.current=o_({window:i,v5Compat:!0}));let c=l.current,[d,m]=U.useState({action:c.action,location:c.location}),{v7_startTransition:f}=n||{},p=U.useCallback(g=>{f&&op?op(()=>m(g)):m(g)},[m,f]);return U.useLayoutEffect(()=>c.listen(p),[c,p]),U.useEffect(()=>X_(n),[n]),U.createElement(J_,{basename:e,children:r,location:d.location,navigationType:d.action,navigator:c,future:n})}const iw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ow=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xx=U.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:l,replace:c,state:d,target:m,to:f,preventScrollReset:p,viewTransition:g}=e,v=Q_(e,rw),{basename:w}=U.useContext(Ks),S,y=!1;if(typeof f=="string"&&ow.test(f)&&(S=f,iw))try{let C=new URL(window.location.href),P=f.startsWith("//")?new URL(C.protocol+f):new URL(f),F=Wf(P.pathname,w);P.origin===C.origin&&F!=null?f=F+P.search+P.hash:y=!0}catch{}let E=F_(f,{relative:i}),D=lw(f,{replace:c,state:d,target:m,preventScrollReset:p,relative:i,viewTransition:g});function A(C){n&&n(C),C.defaultPrevented||D(C)}return U.createElement("a",jf({},v,{href:S||E,onClick:y||l?n:A,ref:r,target:m}))});var lp;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(lp||(lp={}));var cp;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(cp||(cp={}));function lw(t,e){let{target:r,replace:n,state:i,preventScrollReset:l,relative:c,viewTransition:d}=e===void 0?{}:e,m=tl(),f=as(),p=Hx(t,{relative:c});return U.useCallback(g=>{if(ew(g,r)){g.preventDefault();let v=n!==void 0?n:Dc(f)===Dc(p);m(t,{replace:v,state:i,preventScrollReset:l,relative:c,viewTransition:d})}},[f,m,p,n,i,r,t,l,c,d])}function cw(t){let e=U.useRef(Sf(t)),r=U.useRef(!1),n=as(),i=U.useMemo(()=>tw(n.search,r.current?null:e.current),[n.search]),l=tl(),c=U.useCallback((d,m)=>{const f=Sf(typeof d=="function"?d(i):d);r.current=!0,l("?"+f,m)},[l,i]);return[i,c]}const uw="modulepreload",dw=function(t){return"/"+t},up={},rl=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(r.map(m=>{if(m=dw(m),m in up)return;up[m]=!0;const f=m.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${p}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":uw,f||(g.as="script"),g.crossOrigin="",g.href=m,d&&g.setAttribute("nonce",d),document.head.appendChild(g),f)return new Promise((v,w)=>{g.addEventListener("load",v),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},fw=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>rl(async()=>{const{default:n}=await Promise.resolve().then(()=>Ri);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class Gf extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class dp extends Gf{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class fp extends Gf{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class hp extends Gf{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ef;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Ef||(Ef={}));var hw=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};class mw{constructor(e,{headers:r={},customFetch:n,region:i=Ef.Any}={}){this.url=e,this.headers=r,this.region=i,this.fetch=fw(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return hw(this,void 0,void 0,function*(){try{const{headers:i,method:l,body:c,signal:d}=r;let m={},{region:f}=r;f||(f=this.region);const p=new URL(`${this.url}/${e}`);f&&f!=="any"&&(m["x-region"]=f,p.searchParams.set("forceFunctionRegion",f));let g;c&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(m["Content-Type"]="application/octet-stream",g=c):typeof c=="string"?(m["Content-Type"]="text/plain",g=c):typeof FormData<"u"&&c instanceof FormData?g=c:(m["Content-Type"]="application/json",g=JSON.stringify(c)));const v=yield this.fetch(p.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},m),this.headers),i),body:g,signal:d}).catch(E=>{throw E.name==="AbortError"?E:new dp(E)}),w=v.headers.get("x-relay-error");if(w&&w==="true")throw new fp(v);if(!v.ok)throw new hp(v);let S=((n=v.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),y;return S==="application/json"?y=yield v.json():S==="application/octet-stream"?y=yield v.blob():S==="text/event-stream"?y=v:S==="multipart/form-data"?y=yield v.formData():y=yield v.text(),{data:y,error:null,response:v}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new dp(i)}:{data:null,error:i,response:i instanceof hp||i instanceof fp?i.context:void 0}}})}}var or={},ai={},ii={},oi={},li={},ci={},pw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ti=pw();const xw=Ti.fetch,Jx=Ti.fetch.bind(Ti),Yx=Ti.Headers,gw=Ti.Request,vw=Ti.Response,Ri=Object.freeze(Object.defineProperty({__proto__:null,Headers:Yx,Request:gw,Response:vw,default:Jx,fetch:xw},Symbol.toStringTag,{value:"Module"})),yw=Jy(Ri);var wc={},mp;function Qx(){if(mp)return wc;mp=1,Object.defineProperty(wc,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return wc.default=t,wc}var pp;function Zx(){if(pp)return ci;pp=1;var t=ci&&ci.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ci,"__esModule",{value:!0});const e=t(yw),r=t(Qx());class n{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let m=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var p,g,v,w;let S=null,y=null,E=null,D=f.status,A=f.statusText;if(f.ok){if(this.method!=="HEAD"){const L=await f.text();L===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?y=L:y=JSON.parse(L))}const P=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),F=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");P&&F&&F.length>1&&(E=parseInt(F[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(S={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,E=null,D=406,A="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const P=await f.text();try{S=JSON.parse(P),Array.isArray(S)&&f.status===404&&(y=[],S=null,D=200,A="OK")}catch{f.status===404&&P===""?(D=204,A="No Content"):S={message:P}}if(S&&this.isMaybeSingle&&(!((w=S==null?void 0:S.details)===null||w===void 0)&&w.includes("0 rows"))&&(S=null,D=200,A="OK"),S&&this.shouldThrowOnError)throw new r.default(S)}return{error:S,data:y,count:E,status:D,statusText:A}});return this.shouldThrowOnError||(m=m.catch(f=>{var p,g,v;return{error:{message:`${(p=f==null?void 0:f.name)!==null&&p!==void 0?p:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(g=f==null?void 0:f.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(v=f==null?void 0:f.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),m.then(l,c)}returns(){return this}overrideTypes(){return this}}return ci.default=n,ci}var xp;function eg(){if(xp)return li;xp=1;var t=li&&li.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(li,"__esModule",{value:!0});const e=t(Zx());class r extends e.default{select(i){let l=!1;const c=(i??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:m=d}={}){const f=m?`${m}.order`:"order",p=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${p?`${p},`:""}${i}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${i}`),this}range(i,l,{foreignTable:c,referencedTable:d=c}={}){const m=typeof d>"u"?"offset":`${d}.offset`,f=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(m,`${i}`),this.url.searchParams.set(f,`${l-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:m=!1,format:f="text"}={}){var p;const g=[i?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,m?"wal":null].filter(Boolean).join("|"),v=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${v}"; options=${g};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return li.default=r,li}var gp;function Kf(){if(gp)return oi;gp=1;var t=oi&&oi.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(oi,"__esModule",{value:!0});const e=t(eg());class r extends e.default{eq(i,l){return this.url.searchParams.append(i,`eq.${l}`),this}neq(i,l){return this.url.searchParams.append(i,`neq.${l}`),this}gt(i,l){return this.url.searchParams.append(i,`gt.${l}`),this}gte(i,l){return this.url.searchParams.append(i,`gte.${l}`),this}lt(i,l){return this.url.searchParams.append(i,`lt.${l}`),this}lte(i,l){return this.url.searchParams.append(i,`lte.${l}`),this}like(i,l){return this.url.searchParams.append(i,`like.${l}`),this}likeAllOf(i,l){return this.url.searchParams.append(i,`like(all).{${l.join(",")}}`),this}likeAnyOf(i,l){return this.url.searchParams.append(i,`like(any).{${l.join(",")}}`),this}ilike(i,l){return this.url.searchParams.append(i,`ilike.${l}`),this}ilikeAllOf(i,l){return this.url.searchParams.append(i,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(i,l){return this.url.searchParams.append(i,`ilike(any).{${l.join(",")}}`),this}is(i,l){return this.url.searchParams.append(i,`is.${l}`),this}in(i,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(i,`in.(${c})`),this}contains(i,l){return typeof l=="string"?this.url.searchParams.append(i,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(i,`cs.{${l.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(l)}`),this}containedBy(i,l){return typeof l=="string"?this.url.searchParams.append(i,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(i,`cd.{${l.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(l)}`),this}rangeGt(i,l){return this.url.searchParams.append(i,`sr.${l}`),this}rangeGte(i,l){return this.url.searchParams.append(i,`nxl.${l}`),this}rangeLt(i,l){return this.url.searchParams.append(i,`sl.${l}`),this}rangeLte(i,l){return this.url.searchParams.append(i,`nxr.${l}`),this}rangeAdjacent(i,l){return this.url.searchParams.append(i,`adj.${l}`),this}overlaps(i,l){return typeof l=="string"?this.url.searchParams.append(i,`ov.${l}`):this.url.searchParams.append(i,`ov.{${l.join(",")}}`),this}textSearch(i,l,{config:c,type:d}={}){let m="";d==="plain"?m="pl":d==="phrase"?m="ph":d==="websearch"&&(m="w");const f=c===void 0?"":`(${c})`;return this.url.searchParams.append(i,`${m}fts${f}.${l}`),this}match(i){return Object.entries(i).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(i,l,c){return this.url.searchParams.append(i,`not.${l}.${c}`),this}or(i,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${i})`),this}filter(i,l,c){return this.url.searchParams.append(i,`${l}.${c}`),this}}return oi.default=r,oi}var vp;function tg(){if(vp)return ii;vp=1;var t=ii&&ii.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ii,"__esModule",{value:!0});const e=t(Kf());class r{constructor(i,{headers:l={},schema:c,fetch:d}){this.url=i,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(i,{head:l=!1,count:c}={}){const d=l?"HEAD":"GET";let m=!1;const f=(i??"*").split("").map(p=>/\s/.test(p)&&!m?"":(p==='"'&&(m=!m),p)).join("");return this.url.searchParams.set("select",f),c&&this.headers.append("Prefer",`count=${c}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:l,defaultToNull:c=!0}={}){var d;const m="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(i,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:m=!0}={}){var f;const p="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const g=i.reduce((v,w)=>v.concat(Object.keys(w)),[]);if(g.length>0){const v=[...new Set(g)].map(w=>`"${w}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(i,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:i}={}){var l;const c="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ii.default=r,ii}var yp;function _w(){if(yp)return ai;yp=1;var t=ai&&ai.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ai,"__esModule",{value:!0});const e=t(tg()),r=t(Kf());class n{constructor(l,{headers:c={},schema:d,fetch:m}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=m}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new n(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:m=!1,count:f}={}){var p;let g;const v=new URL(`${this.url}/rpc/${l}`);let w;d||m?(g=d?"HEAD":"GET",Object.entries(c).filter(([y,E])=>E!==void 0).map(([y,E])=>[y,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([y,E])=>{v.searchParams.append(y,E)})):(g="POST",w=c);const S=new Headers(this.headers);return f&&S.set("Prefer",`count=${f}`),new r.default({method:g,url:v,headers:S,schema:this.schemaName,body:w,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return ai.default=n,ai}var _p;function ww(){if(_p)return or;_p=1;var t=or&&or.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(or,"__esModule",{value:!0}),or.PostgrestError=or.PostgrestBuilder=or.PostgrestTransformBuilder=or.PostgrestFilterBuilder=or.PostgrestQueryBuilder=or.PostgrestClient=void 0;const e=t(_w());or.PostgrestClient=e.default;const r=t(tg());or.PostgrestQueryBuilder=r.default;const n=t(Kf());or.PostgrestFilterBuilder=n.default;const i=t(eg());or.PostgrestTransformBuilder=i.default;const l=t(Zx());or.PostgrestBuilder=l.default;const c=t(Qx());return or.PostgrestError=c.default,or.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:l.default,PostgrestError:c.default},or}var jw=ww();const Sw=tu(jw),{PostgrestClient:Ew,PostgrestQueryBuilder:GC,PostgrestFilterBuilder:KC,PostgrestTransformBuilder:XC,PostgrestBuilder:JC,PostgrestError:YC}=Sw;class Nw{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const bw="2.15.5",Tw=`realtime-js/${bw}`,kw="1.0.0",Nf=1e4,Cw=1e3,Aw=100;var Do;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Do||(Do={}));var er;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(er||(er={}));var Cn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Cn||(Cn={}));var bf;(function(t){t.websocket="websocket"})(bf||(bf={}));var ya;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ya||(ya={}));class Ow{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const i=r.getUint8(1),l=r.getUint8(2);let c=this.HEADER_LENGTH+2;const d=n.decode(e.slice(c,c+i));c=c+i;const m=n.decode(e.slice(c,c+l));c=c+l;const f=JSON.parse(n.decode(e.slice(c,e.byteLength)));return{ref:null,topic:d,event:m,payload:f}}}class rg{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var bt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(bt||(bt={}));const wp=(t,e,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((l,c)=>(l[c]=Pw(c,t,e,i),l),{})},Pw=(t,e,r,n)=>{const i=e.find(d=>d.name===t),l=i==null?void 0:i.type,c=r[t];return l&&!n.includes(l)?ng(l,c):Tf(c)},ng=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Lw(e,r)}switch(t){case bt.bool:return Rw(e);case bt.float4:case bt.float8:case bt.int2:case bt.int4:case bt.int8:case bt.numeric:case bt.oid:return Fw(e);case bt.json:case bt.jsonb:return Dw(e);case bt.timestamp:return Iw(e);case bt.abstime:case bt.date:case bt.daterange:case bt.int4range:case bt.int8range:case bt.money:case bt.reltime:case bt.text:case bt.time:case bt.timestamptz:case bt.timetz:case bt.tsrange:case bt.tstzrange:return Tf(e);default:return Tf(e)}},Tf=t=>t,Rw=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Fw=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Dw=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Lw=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let l;const c=t.slice(1,r);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>ng(e,d))}return t},Iw=t=>typeof t=="string"?t.replace(" ","T"):t,sg=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class tf{constructor(e,r,n={},i=Nf){this.channel=e,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var jp;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(jp||(jp={}));class Lo{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Lo.syncState(this.state,i,l,c),this.pendingDiffs.forEach(m=>{this.state=Lo.syncDiff(this.state,m,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},i=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Lo.syncDiff(this.state,i,l,c),d())}),this.onJoin((i,l,c)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:l,newPresences:c})}),this.onLeave((i,l,c)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,i){const l=this.cloneDeep(e),c=this.transformState(r),d={},m={};return this.map(l,(f,p)=>{c[f]||(m[f]=p)}),this.map(c,(f,p)=>{const g=l[f];if(g){const v=p.map(E=>E.presence_ref),w=g.map(E=>E.presence_ref),S=p.filter(E=>w.indexOf(E.presence_ref)<0),y=g.filter(E=>v.indexOf(E.presence_ref)<0);S.length>0&&(d[f]=S),y.length>0&&(m[f]=y)}else d[f]=p}),this.syncDiff(l,{joins:d,leaves:m},n,i)}static syncDiff(e,r,n,i){const{joins:l,leaves:c}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(l,(d,m)=>{var f;const p=(f=e[d])!==null&&f!==void 0?f:[];if(e[d]=this.cloneDeep(m),p.length>0){const g=e[d].map(w=>w.presence_ref),v=p.filter(w=>g.indexOf(w.presence_ref)<0);e[d].unshift(...v)}n(d,p,m)}),this.map(c,(d,m)=>{let f=e[d];if(!f)return;const p=m.map(g=>g.presence_ref);f=f.filter(g=>p.indexOf(g.presence_ref)<0),e[d]=f,i(d,f,m),f.length===0&&delete e[d]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const i=e[n];return"metas"in i?r[n]=i.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[n]=i,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Sp;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Sp||(Sp={}));var Io;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Io||(Io={}));var Zn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Zn||(Zn={}));class Xf{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=er.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new tf(this,Cn.join,this.params,this.timeout),this.rejoinTimer=new rg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=er.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=er.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=er.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=er.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=er.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Cn.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Lo(this),this.broadcastEndpointURL=sg(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,i,l;if(this.socket.isConnected()||this.socket.connect(),this.state==er.closed){const{config:{broadcast:c,presence:d,private:m}}=this.params,f=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(w=>w.filter))!==null&&i!==void 0?i:[],p=!!this.bindings[Io.PRESENCE]&&this.bindings[Io.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},v={broadcast:c,presence:Object.assign(Object.assign({},d),{enabled:p}),postgres_changes:f,private:m};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(w=>e==null?void 0:e(Zn.CHANNEL_ERROR,w)),this._onClose(()=>e==null?void 0:e(Zn.CLOSED)),this.updateJoinPayload(Object.assign({config:v},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:w})=>{var S;if(this.socket.setAuth(),w===void 0){e==null||e(Zn.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,E=(S=y==null?void 0:y.length)!==null&&S!==void 0?S:0,D=[];for(let A=0;A<E;A++){const C=y[A],{filter:{event:P,schema:F,table:L,filter:N}}=C,j=w&&w[A];if(j&&j.event===P&&j.schema===F&&j.table===L&&j.filter===N)D.push(Object.assign(Object.assign({},C),{id:j.id}));else{this.unsubscribe(),this.state=er.errored,e==null||e(Zn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=D,e&&e(Zn.SUBSCRIBED);return}}).receive("error",w=>{this.state=er.errored,e==null||e(Zn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Zn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===er.joined&&e===Io.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:l,payload:c}=e,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=f.body)===null||i===void 0?void 0:i.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,m;const f=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((m=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||m===void 0)&&m.ack)&&l("ok"),f.receive("ok",()=>l("ok")),f.receive("error",()=>l("error")),f.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=er.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Cn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new tf(this,Cn.leave,{},e),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=er.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const i=new AbortController,l=setTimeout(()=>i.abort(),n),c=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(l),c}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new tf(this,e,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Aw){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var i,l;const c=e.toLocaleLowerCase(),{close:d,error:m,leave:f,join:p}=Cn;if(n&&[d,m,f,p].indexOf(c)>=0&&n!==this._joinRef())return;let v=this._onMessage(c,r,n);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(w=>{var S,y,E;return((S=w.filter)===null||S===void 0?void 0:S.event)==="*"||((E=(y=w.filter)===null||y===void 0?void 0:y.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===c}).map(w=>w.callback(v,n)):(l=this.bindings[c])===null||l===void 0||l.filter(w=>{var S,y,E,D,A,C;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in w){const P=w.id,F=(S=w.filter)===null||S===void 0?void 0:S.event;return P&&((y=r.ids)===null||y===void 0?void 0:y.includes(P))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const P=(A=(D=w==null?void 0:w.filter)===null||D===void 0?void 0:D.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return P==="*"||P===((C=r==null?void 0:r.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===c}).map(w=>{if(typeof v=="object"&&"ids"in v){const S=v.data,{schema:y,table:E,commit_timestamp:D,type:A,errors:C}=S;v=Object.assign(Object.assign({},{schema:y,table:E,commit_timestamp:D,eventType:A,new:{},old:{},errors:C}),this._getPayloadRecords(S))}w.callback(v,n)})}_isClosed(){return this.state===er.closed}_isJoined(){return this.state===er.joined}_isJoining(){return this.state===er.joining}_isLeaving(){return this.state===er.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const i=e.toLocaleLowerCase(),l={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(l):this.bindings[i]=[l],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var l;return!(((l=i.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&Xf.isEqual(i.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Cn.close,{},e)}_onError(e){this._on(Cn.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=er.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=wp(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=wp(e.columns,e.old_record)),r}}const rf=()=>{},jc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Mw=[1e3,2e3,5e3,1e4],Bw=1e4,Uw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zw{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Nf,this.transport=null,this.heartbeatIntervalMs=jc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=rf,this.ref=0,this.reconnectTimer=null,this.logger=rf,this.conn=null,this.sendBuffer=[],this.serializer=new Ow,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...c)=>rl(async()=>{const{default:d}=await Promise.resolve().then(()=>Ri);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${bf.websocket}`,this.httpEndpoint=sg(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Nw.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:kw}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Do.connecting:return ya.Connecting;case Do.open:return ya.Open;case Do.closing:return ya.Closing;default:return ya.Closed}}isConnected(){return this.connectionState()===ya.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(l=>l.topic===n);if(i)return i;{const l=new Xf(`realtime:${e}`,r,this);return this.channels.push(l),l}}push(e){const{topic:r,event:n,payload:i,ref:l}=e,c=()=>{this.encode(e,d=>{var m;(m=this.conn)===null||m===void 0||m.send(d)})};this.log("push",`${r} ${n} (${l})`,i),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Cw,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},jc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:l,ref:c}=r,d=c?`(${c})`:"",m=l.status||"";this.log("receive",`${m} ${n} ${i} ${d}`.trim(),l),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(i,l,c)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Cn.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${e}${n}${i}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([Uw],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:Tw};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Cn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new rg(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},jc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,i,l,c,d,m,f,p;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Nf,this.heartbeatIntervalMs=(i=e==null?void 0:e.heartbeatIntervalMs)!==null&&i!==void 0?i:jc.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(d=e==null?void 0:e.heartbeatCallback)!==null&&d!==void 0?d:rf,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=e==null?void 0:e.reconnectAfterMs)!==null&&m!==void 0?m:g=>Mw[g-1]||Bw,this.encode=(f=e==null?void 0:e.encode)!==null&&f!==void 0?f:(g,v)=>v(JSON.stringify(g)),this.decode=(p=e==null?void 0:e.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Jf extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Xt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class $w extends Jf{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class kf extends Jf{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Ww=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};const ag=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>rl(async()=>{const{default:n}=await Promise.resolve().then(()=>Ri);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Vw=()=>Ww(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield rl(()=>Promise.resolve().then(()=>Ri),void 0)).Response:Response}),Cf=t=>{if(Array.isArray(t))return t.map(r=>Cf(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[i]=Cf(n)}),e},Hw=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ta=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};const nf=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),qw=(t,e,r)=>Ta(void 0,void 0,void 0,function*(){const n=yield Vw();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(i=>{const l=t.status||500,c=(i==null?void 0:i.statusCode)||l+"";e(new $w(nf(i),l,c))}).catch(i=>{e(new kf(nf(i),i))}):e(new kf(nf(t),t))}),Gw=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?i:(Hw(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(n)):i.body=n,e!=null&&e.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),r))};function nl(t,e,r,n,i,l){return Ta(this,void 0,void 0,function*(){return new Promise((c,d)=>{t(r,Gw(e,n,i,l)).then(m=>{if(!m.ok)throw m;return n!=null&&n.noResolveJson?m:m.json()}).then(m=>c(m)).catch(m=>qw(m,d,n))})})}function Lc(t,e,r,n){return Ta(this,void 0,void 0,function*(){return nl(t,"GET",e,r,n)})}function zn(t,e,r,n,i){return Ta(this,void 0,void 0,function*(){return nl(t,"POST",e,n,i,r)})}function Af(t,e,r,n,i){return Ta(this,void 0,void 0,function*(){return nl(t,"PUT",e,n,i,r)})}function Kw(t,e,r,n){return Ta(this,void 0,void 0,function*(){return nl(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function ig(t,e,r,n,i){return Ta(this,void 0,void 0,function*(){return nl(t,"DELETE",e,n,i,r)})}var Xw=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};class Jw{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return Xw(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Xt(e))return{data:null,error:e};throw e}})}}var Yw=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};class Qw{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}asStream(){return new Jw(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.execute().then(e,r)}execute(){return Yw(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Xt(e))return{data:null,error:e};throw e}})}}var Vr=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};const Zw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ep={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class e2{constructor(e,r={},n,i){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=ag(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,i){return Vr(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Ep),i);let d=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const m=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m))):(l=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,m&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),i!=null&&i.headers&&(d=Object.assign(Object.assign({},d),i.headers));const f=this._removeEmptyFolders(r),p=this._getFinalPath(f),g=yield(e=="PUT"?Af:zn)(this.fetch,`${this.url}/object/${p}`,l,Object.assign({headers:d},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Xt(l))return{data:null,error:l};throw l}})}upload(e,r,n){return Vr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,i){return Vr(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",r);try{let m;const f=Object.assign({upsert:Ep.upsert},i),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",f.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",f.cacheControl)):(m=n,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType);const g=yield Af(this.fetch,d.toString(),m,{headers:p});return{data:{path:l,fullPath:g.Key},error:null}}catch(m){if(this.shouldThrowOnError)throw m;if(Xt(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(e,r){return Vr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const l=yield zn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new Jf("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:d},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Xt(n))return{data:null,error:n};throw n}})}update(e,r,n){return Vr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Vr(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Xt(i))return{data:null,error:i};throw i}})}copy(e,r,n){return Vr(this,void 0,void 0,function*(){try{return{data:{path:(yield zn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Xt(i))return{data:null,error:i};throw i}})}createSignedUrl(e,r,n){return Vr(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),l=yield zn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Xt(i))return{data:null,error:i};throw i}})}createSignedUrls(e,r,n){return Vr(this,void 0,void 0,function*(){try{const i=yield zn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Xt(i))return{data:null,error:i};throw i}})}download(e,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),c=l?`?${l}`:"",d=this._getFinalPath(e),m=()=>Lc(this.fetch,`${this.url}/${i}/${d}${c}`,{headers:this.headers,noResolveJson:!0});return new Qw(m,this.shouldThrowOnError)}info(e){return Vr(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Lc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Cf(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Xt(n))return{data:null,error:n};throw n}})}exists(e){return Vr(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Kw(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Xt(n)&&n instanceof kf){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),i=[],l=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";l!==""&&i.push(l);const d=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",m=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});m!==""&&i.push(m);let f=i.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${n}${f}`)}}}remove(e){return Vr(this,void 0,void 0,function*(){try{return{data:yield ig(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}})}list(e,r,n){return Vr(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Zw),r),{prefix:e||""});return{data:yield zn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Xt(i))return{data:null,error:i};throw i}})}listV2(e,r){return Vr(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield zn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Xt(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const t2="2.12.2",r2={"X-Client-Info":`storage-js/${t2}`};var ui=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};class n2{constructor(e,r={},n,i){this.shouldThrowOnError=!1;const l=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},r2),r),this.fetch=ag(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ui(this,void 0,void 0,function*(){try{return{data:yield Lc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Xt(e))return{data:null,error:e};throw e}})}getBucket(e){return ui(this,void 0,void 0,function*(){try{return{data:yield Lc(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return ui(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Xt(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return ui(this,void 0,void 0,function*(){try{return{data:yield Af(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Xt(n))return{data:null,error:n};throw n}})}emptyBucket(e){return ui(this,void 0,void 0,function*(){try{return{data:yield zn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ui(this,void 0,void 0,function*(){try{return{data:yield ig(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xt(r))return{data:null,error:r};throw r}})}}class s2 extends n2{constructor(e,r={},n,i){super(e,r,n,i)}from(e){return new e2(this.url,this.headers,e,this.fetch)}}const a2="2.58.0";let Oo="";typeof Deno<"u"?Oo="deno":typeof document<"u"?Oo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Oo="react-native":Oo="node";const i2={"X-Client-Info":`supabase-js-${Oo}/${a2}`},o2={headers:i2},l2={schema:"public"},c2={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},u2={};var d2=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};const f2=t=>{let e;return t?e=t:typeof fetch>"u"?e=Jx:e=fetch,(...r)=>e(...r)},h2=()=>typeof Headers>"u"?Yx:Headers,m2=(t,e,r)=>{const n=f2(r),i=h2();return(l,c)=>d2(void 0,void 0,void 0,function*(){var d;const m=(d=yield e())!==null&&d!==void 0?d:t;let f=new i(c==null?void 0:c.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${m}`),n(l,Object.assign(Object.assign({},c),{headers:f}))})};var p2=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};function x2(t){return t.endsWith("/")?t:t+"/"}function g2(t,e){var r,n;const{db:i,auth:l,realtime:c,global:d}=t,{db:m,auth:f,realtime:p,global:g}=e,v={db:Object.assign(Object.assign({},m),i),auth:Object.assign(Object.assign({},f),l),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},g),d),{headers:Object.assign(Object.assign({},(r=g==null?void 0:g.headers)!==null&&r!==void 0?r:{}),(n=d==null?void 0:d.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>p2(this,void 0,void 0,function*(){return""})};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}function v2(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(x2(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const og="2.72.0",vi=30*1e3,Of=3,sf=Of*vi,y2="http://localhost:9999",_2="supabase.auth.token",w2={"X-Client-Info":`gotrue-js/${og}`},Pf="X-Supabase-Api-Version",lg={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},j2=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,S2=10*60*1e3;class Yf extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function et(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class E2 extends Yf{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function N2(t){return et(t)&&t.name==="AuthApiError"}class cg extends Yf{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Js extends Yf{constructor(e,r,n,i){super(e,n,i),this.name=r,this.status=n}}class Ls extends Js{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function b2(t){return et(t)&&t.name==="AuthSessionMissingError"}class bo extends Js{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Sc extends Js{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ec extends Js{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function T2(t){return et(t)&&t.name==="AuthImplicitGrantRedirectError"}class Np extends Js{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rf extends Js{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function af(t){return et(t)&&t.name==="AuthRetryableFetchError"}class bp extends Js{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Ff extends Js{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ic="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Tp=` 	
\r=`.split(""),k2=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Tp.length;e+=1)t[Tp[e].charCodeAt(0)]=-2;for(let e=0;e<Ic.length;e+=1)t[Ic[e].charCodeAt(0)]=e;return t})();function kp(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Ic[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Ic[n]),e.queuedBits-=6}}function ug(t,e,r){const n=k2[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Cp(t){const e=[],r=c=>{e.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},l=c=>{O2(c,n,r)};for(let c=0;c<t.length;c+=1)ug(t.charCodeAt(c),i,l);return e.join("")}function C2(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function A2(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}C2(n,e)}}function O2(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if((t>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function P2(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)ug(t.charCodeAt(i),r,n);return new Uint8Array(e)}function R2(t){const e=[];return A2(t,r=>e.push(r)),new Uint8Array(e)}function F2(t){const e=[],r={queue:0,queuedBits:0},n=i=>{e.push(i)};return t.forEach(i=>kp(i,r,n)),kp(null,r,n),e.join("")}function D2(t){return Math.round(Date.now()/1e3)+t}function L2(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const pn=()=>typeof window<"u"&&typeof document<"u",xa={tested:!1,writable:!1},dg=()=>{if(!pn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(xa.tested)return xa.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),xa.tested=!0,xa.writable=!0}catch{xa.tested=!0,xa.writable=!1}return xa.writable};function I2(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,l)=>{e[l]=i})}catch{}return r.searchParams.forEach((n,i)=>{e[i]=n}),e}const fg=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>rl(async()=>{const{default:n}=await Promise.resolve().then(()=>Ri);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},M2=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",yi=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},ga=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ps=async(t,e)=>{await t.removeItem(e)};class nu{constructor(){this.promise=new nu.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}nu.promiseConstructor=Promise;function of(t){const e=t.split(".");if(e.length!==3)throw new Ff("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!j2.test(e[n]))throw new Ff("JWT not in base64url format");return{header:JSON.parse(Cp(e[0])),payload:JSON.parse(Cp(e[1])),signature:P2(e[2]),raw:{header:e[0],payload:e[1]}}}async function B2(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function U2(t,e){return new Promise((n,i)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await t(l);if(!e(l,null,c)){n(c);return}}catch(c){if(!e(l,c)){i(c);return}}})()})}function z2(t){return("0"+t.toString(16)).substr(-2)}function $2(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let l=0;l<56;l++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,z2).join("")}async function W2(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(l=>String.fromCharCode(l)).join("")}async function V2(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await W2(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function di(t,e,r=!1){const n=$2();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await yi(t,`${e}-code-verifier`,i);const l=await V2(n);return[l,n===l?"plain":"s256"]}const H2=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function q2(t){const e=t.headers.get(Pf);if(!e||!e.match(H2))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function G2(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function K2(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const X2=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function fi(t){if(!X2.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function lf(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ap(t){return JSON.parse(JSON.stringify(t))}var J2=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const va=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Y2=[502,503,504];async function Op(t){var e;if(!M2(t))throw new Rf(va(t),0);if(Y2.includes(t.status))throw new Rf(va(t),t.status);let r;try{r=await t.json()}catch(l){throw new cg(va(l),l)}let n;const i=q2(t);if(i&&i.getTime()>=lg["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new bp(va(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ls}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new bp(va(r),t.status,r.weak_password.reasons);throw new E2(va(r),t.status||500,n)}const Q2=(t,e,r,n)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function ct(t,e,r,n){var i;const l=Object.assign({},n==null?void 0:n.headers);l[Pf]||(l[Pf]=lg["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(c.redirect_to=n.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",m=await Z2(t,e,r+d,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(m):{data:Object.assign({},m),error:null}}async function Z2(t,e,r,n,i,l){const c=Q2(e,n,i,l);let d;try{d=await t(r,Object.assign({},c))}catch(m){throw console.error(m),new Rf(va(m),0)}if(d.ok||await Op(d),n!=null&&n.noResolveJson)return d;try{return await d.json()}catch(m){await Op(m)}}function Mn(t){var e;let r=null;nj(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=D2(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Pp(t){const e=Mn(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Is(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function ej(t){return{data:t,error:null}}function tj(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:l}=t,c=J2(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:e,email_otp:r,hashed_token:n,redirect_to:i,verification_type:l},m=Object.assign({},c);return{data:{properties:d,user:m},error:null}}function rj(t){return t}function nj(t){return t.access_token&&t.refresh_token&&t.expires_in}const cf=["global","local","others"];var sj=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};class aj{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=fg(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=cf[0]){if(cf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${cf.join(", ")}`);try{return await ct(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(et(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await ct(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Is})}catch(n){if(et(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=sj(e,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await ct(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:tj,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(et(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await ct(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Is})}catch(r){if(et(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,i,l,c,d,m;try{const f={nextPage:null,lastPage:0,total:0},p=await ct(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(l=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:rj});if(p.error)throw p.error;const g=await p.json(),v=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,w=(m=(d=p.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&m!==void 0?m:[];return w.length>0&&(w.forEach(S=>{const y=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(S.split(";")[1].split("=")[1]);f[`${E}Page`]=y}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(et(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){fi(e);try{return await ct(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Is})}catch(r){if(et(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){fi(e);try{return await ct(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Is})}catch(n){if(et(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){fi(e);try{return await ct(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Is})}catch(n){if(et(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){fi(e.userId);try{const{data:r,error:n}=await ct(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(et(r))return{data:null,error:r};throw r}}async _deleteFactor(e){fi(e.userId),fi(e.id);try{return{data:await ct(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(et(r))return{data:null,error:r};throw r}}}function Rp(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function ij(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const hi={debug:!!(globalThis&&dg()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class hg extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class oj extends hg{}async function lj(t,e,r){hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),hi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await r()}finally{hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new oj(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(hi.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function mg(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function cj(t){return parseInt(t,16)}function uj(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function dj(t){var e;const{chainId:r,domain:n,expirationTime:i,issuedAt:l=new Date,nonce:c,notBefore:d,requestId:m,resources:f,scheme:p,uri:g,version:v}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!g)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const w=mg(t.address),S=p?`${p}://${n}`:n,y=t.statement?`${t.statement}
`:"",E=`${S} wants you to sign in with your Ethereum account:
${w}

${y}`;let D=`URI: ${g}
Version: ${v}
Chain ID: ${r}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(i&&(D+=`
Expiration Time: ${i.toISOString()}`),d&&(D+=`
Not Before: ${d.toISOString()}`),m&&(D+=`
Request ID: ${m}`),f){let A=`
Resources:`;for(const C of f){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);A+=`
- ${C}`}D+=A}return`${E}
${D}`}ij();const fj={url:y2,storageKey:_2,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:w2,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Fp(t,e,r){return await r()}const mi={};class qo{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=qo.nextInstanceID,qo.nextInstanceID+=1,this.instanceID>0&&pn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},fj),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new aj({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=fg(i.fetch),this.lock=i.lock||Fp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:pn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=lj:this.lock=Fp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:dg()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Rp(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Rp(this.memoryStorage)),pn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=mi[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){mi[this.storageKey]=Object.assign(Object.assign({},mi[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=mi[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){mi[this.storageKey]=Object.assign(Object.assign({},mi[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${og}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=I2(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),pn()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:l}=await this._getSessionFromURL(r,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),T2(l)){const m=(e=l.details)===null||e===void 0?void 0:e.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=i;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return et(r)?{error:r}:{error:new cg("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,i;try{const l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Mn}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:f,session:m},error:null}}catch(l){if(et(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(e){var r,n,i;try{let l;if("email"in e){const{email:p,password:g,options:v}=e;let w=null,S=null;this.flowType==="pkce"&&([w,S]=await di(this.storage,this.storageKey)),l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:p,password:g,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:w,code_challenge_method:S},xform:Mn})}else if("phone"in e){const{phone:p,password:g,options:v}=e;l=await ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},channel:(i=v==null?void 0:v.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:Mn})}else throw new Sc("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:f,session:m},error:null}}catch(l){if(et(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(e){try{let r;if("email"in e){const{email:l,password:c,options:d}=e;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Pp})}else if("phone"in e){const{phone:l,password:c,options:d}=e;r=await ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Pp})}else throw new Sc("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new bo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(et(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,i,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,i,l,c,d,m,f,p,g,v;let w,S;if("message"in e)w=e.message,S=e.signature;else{const{chain:y,wallet:E,statement:D,options:A}=e;let C;if(pn())if(typeof E=="object")C=E;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")C=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!(A!=null&&A.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=E}const P=new URL((r=A==null?void 0:A.url)!==null&&r!==void 0?r:window.location.href),F=await C.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=mg(F[0]);let N=(n=A==null?void 0:A.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!N){const T=await C.request({method:"eth_chainId"});N=cj(T)}const j={domain:P.host,address:L,statement:D,uri:P.href,version:"1",chainId:N,nonce:(i=A==null?void 0:A.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(c=(l=A==null?void 0:A.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(d=A==null?void 0:A.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(m=A==null?void 0:A.signInWithEthereum)===null||m===void 0?void 0:m.notBefore,requestId:(f=A==null?void 0:A.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(p=A==null?void 0:A.signInWithEthereum)===null||p===void 0?void 0:p.resources};w=dj(j),S=await C.request({method:"personal_sign",params:[uj(w),L]})}try{const{data:y,error:E}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:w,signature:S},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Mn});if(E)throw E;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new bo}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:E})}catch(y){if(et(y))return{data:{user:null,session:null},error:y};throw y}}async signInWithSolana(e){var r,n,i,l,c,d,m,f,p,g,v,w;let S,y;if("message"in e)S=e.message,y=e.signature;else{const{chain:E,wallet:D,statement:A,options:C}=e;let P;if(pn())if(typeof D=="object")P=D;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))P=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof D!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=D}const F=new URL((r=C==null?void 0:C.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in P&&P.signIn){const L=await P.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C==null?void 0:C.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),A?{statement:A}:null));let N;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")N=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)N=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)S=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),y=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in P)||typeof P.signMessage!="function"||!("publicKey"in P)||typeof P!="object"||!P.publicKey||!("toBase58"in P.publicKey)||typeof P.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${F.host} wants you to sign in with your Solana account:`,P.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(i=(n=C==null?void 0:C.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((l=C==null?void 0:C.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((c=C==null?void 0:C.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((d=C==null?void 0:C.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((m=C==null?void 0:C.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C==null?void 0:C.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((g=(p=C==null?void 0:C.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...C.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const L=await P.signMessage(new TextEncoder().encode(S),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=L}}try{const{data:E,error:D}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:F2(y)},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:Mn});if(D)throw D;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new bo}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:D})}catch(E){if(et(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(e){const r=await ga(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:l,error:c}=await ct(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Mn});if(await Ps(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new bo}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:i??null}),error:c})}catch(l){if(et(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(e){try{const{options:r,provider:n,token:i,access_token:l,nonce:c}=e,d=await ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Mn}),{data:m,error:f}=d;return f?{data:{user:null,session:null},error:f}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new bo}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:f})}catch(r){if(et(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,i,l,c;try{if("email"in e){const{email:d,options:m}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await di(this.storage,this.storageKey));const{error:g}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},create_user:(n=m==null?void 0:m.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:m==null?void 0:m.emailRedirectTo});return{data:{user:null,session:null},error:g}}if("phone"in e){const{phone:d,options:m}=e,{data:f,error:p}=await ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(i=m==null?void 0:m.data)!==null&&i!==void 0?i:{},create_user:(l=m==null?void 0:m.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},channel:(c=m==null?void 0:m.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:p}}throw new Sc("You must provide either an email or phone number.")}catch(d){if(et(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(e){var r,n;try{let i,l;"options"in e&&(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo,l=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:d}=await ct(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:i,xform:Mn});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const m=c.session,f=c.user;return m!=null&&m.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:f,session:m},error:null}}catch(i){if(et(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var r,n,i;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await di(this.storage,this.storageKey)),await ct(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:ej})}catch(l){if(et(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Ls;const{error:i}=await ct(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(et(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:l}=e,{error:c}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in e){const{phone:n,type:i,options:l}=e,{data:c,error:d}=await ct(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Sc("You must provide either an email or phone number and a type")}catch(r){if(et(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await ga(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<sf:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const c=await ga(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=lf()}if(this.storage.isServer&&e.user){let c=this.suppressGetSessionWarning;e=new Proxy(e,{get:(m,f,p)=>(!c&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,f,p))})}return{data:{session:e},error:null}}const{session:i,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{session:null},error:l}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Is}):await this._useSession(async r=>{var n,i,l;const{data:c,error:d}=r;if(d)throw d;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ls}:await ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0,xform:Is})})}catch(r){if(et(r))return b2(r)&&(await this._removeSession(),await Ps(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:i,error:l}=n;if(l)throw l;if(!i.session)throw new Ls;const c=i.session;let d=null,m=null;this.flowType==="pkce"&&e.email!=null&&([d,m]=await di(this.storage,this.storageKey));const{data:f,error:p}=await ct(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:d,code_challenge_method:m}),jwt:c.access_token,xform:Is});if(p)throw p;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(et(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ls;const r=Date.now()/1e3;let n=r,i=!0,l=null;const{payload:c}=of(e.access_token);if(c.exp&&(n=c.exp,i=n<=r),i){const{session:d,error:m}=await this._callRefreshToken(e.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:m}=await this._getUser(e.access_token);if(m)throw m;l={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(r){if(et(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:c,error:d}=r;if(d)throw d;e=(n=c.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ls;const{session:i,error:l}=await this._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(et(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!pn())throw new Ec("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ec(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Np("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ec("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Np("No code detected.");const{data:A,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:l,refresh_token:c,expires_in:d,expires_at:m,token_type:f}=e;if(!l||!d||!c||!f)throw new Ec("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(d);let v=p+g;m&&(v=parseInt(m));const w=v-p;w*1e3<=vi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${g}s`);const S=v-g;p-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,v,p):p-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,v,p);const{data:y,error:E}=await this._getUser(l);if(E)throw E;const D={provider_token:n,provider_refresh_token:i,access_token:l,expires_in:g,expires_at:v,refresh_token:c,token_type:f,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:D,redirectType:e.type},error:null}}catch(n){if(et(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await ga(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return{error:l};const c=(n=i.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:d}=await this.admin.signOut(c,e);if(d&&!(N2(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return e!=="others"&&(await this._removeSession(),await Ps(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=L2(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,i;try{const{data:{session:l},error:c}=r;if(c)throw c;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await di(this.storage,this.storageKey,!0));try{return await ct(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(et(l))return{data:null,error:l};throw l}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(et(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:i}=await this._useSession(async l=>{var c,d,m,f,p;const{data:g,error:v}=l;if(v)throw v;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=e.options)===null||d===void 0?void 0:d.scopes,queryParams:(m=e.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await ct(this.fetch,"GET",w,{headers:this.headers,jwt:(p=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return pn()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(et(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,i;const{data:l,error:c}=r;if(c)throw c;return await ct(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(et(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await U2(async i=>(i>0&&await B2(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await ct(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Mn})),(i,l)=>{const c=200*Math.pow(2,i);return l&&af(l)&&Date.now()+c-n<vi})}catch(n){if(this._debug(r,"error",n),et(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),pn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await ga(this.storage,this.storageKey);if(i&&this.userStorage){let c=await ga(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:i.user},await yi(this.userStorage,this.storageKey+"-user",c)),i.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:lf()}else if(i&&!i.user&&!i.user){const c=await ga(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(i.user=c.user,await Ps(this.storage,this.storageKey+"-user"),await yi(this.storage,this.storageKey,i)):i.user=lf()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const l=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<sf;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${sf}s`),l){if(this.autoRefreshToken&&i.refresh_token){const{error:c}=await this._callRefreshToken(i.refresh_token);c&&(console.error(c),af(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(i.access_token);!d&&(c!=null&&c.user)?(i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Ls;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new nu;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new Ls;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={session:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(i,"error",l),et(l)){const c={session:null,error:l};return af(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,r,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(e,r)}catch(m){l.push(m)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await yi(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const l=Ap(i);await yi(this.storage,this.storageKey,l)}else{const i=Ap(r);await yi(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Ps(this.storage,this.storageKey),await Ps(this.storage,this.storageKey+"-code-verifier"),await Ps(this.storage,this.storageKey+"-user"),this.userStorage&&await Ps(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&pn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),vi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/vi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${vi}ms, refresh threshold is ${Of} ticks`),i<=Of&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof hg)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await di(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});i.push(d.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);i.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;return l?{data:null,error:l}:await ct(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(et(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,i;const{data:l,error:c}=r;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:m,error:f}=await ct(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((i=m==null?void 0:m.totp)===null||i===void 0)&&i.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(r){if(et(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;if(l)return{data:null,error:l};const{data:c,error:d}=await ct(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(r){if(et(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:l}=r;return l?{data:null,error:l}:await ct(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(et(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],i=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:i,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:i},error:l}=e;if(l)return{data:null,error:l};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=of(i.access_token);let d=null;c.aal&&(d=c.aal);let m=d;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(g=>g.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const p=c.amr||[];return{data:{currentLevel:d,nextLevel:m,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(d=>d.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(d=>d.kid===e),n&&this.jwks_cached_at+S2>i)return n;const{data:l,error:c}=await ct(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=i,n=l.keys.find(d=>d.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:w,error:S}=await this.getSession();if(S||!w.session)return{data:null,error:S};n=w.session.access_token}const{header:i,payload:l,signature:c,raw:{header:d,payload:m}}=of(n);r!=null&&r.allowExpired||G2(l.exp);const f=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!f){const{error:w}=await this.getUser(n);if(w)throw w;return{data:{claims:l,header:i,signature:c},error:null}}const p=K2(i.alg),g=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,c,R2(`${d}.${m}`)))throw new Ff("Invalid JWT signature");return{data:{claims:l,header:i,signature:c},error:null}}catch(n){if(et(n))return{data:null,error:n};throw n}}}qo.nextInstanceID=0;const hj=qo;class mj extends hj{constructor(e){super(e)}}var pj=function(t,e,r,n){function i(l){return l instanceof r?l:new r(function(c){c(l)})}return new(r||(r=Promise))(function(l,c){function d(p){try{f(n.next(p))}catch(g){c(g)}}function m(p){try{f(n.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):i(p.value).then(d,m)}f((n=n.apply(t,e||[])).next())})};class xj{constructor(e,r,n){var i,l,c;this.supabaseUrl=e,this.supabaseKey=r;const d=v2(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const m=`sb-${d.hostname.split(".")[0]}-auth-token`,f={db:l2,realtime:u2,auth:Object.assign(Object.assign({},c2),{storageKey:m}),global:o2},p=g2(n??{},f);this.storageKey=(i=p.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(g,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=m2(r,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new Ew(new URL("rest/v1",d).href,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),this.storage=new s2(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),p.accessToken||this._listenForAuthEvents()}get functions(){return new mw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return pj(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:l,storageKey:c,flowType:d,lock:m,debug:f},p,g){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new mj({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),p),storageKey:c,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:l,flowType:d,lock:m,debug:f,fetch:g,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new zw(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const gj=(t,e,r)=>new xj(t,e,r);function vj(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}vj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const yj="https://poppadzpyftjkergccpn.supabase.co",_j="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvcHBhZHpweWZ0amtlcmdjY3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDUzODYsImV4cCI6MjA3MTE4MTM4Nn0.ExLR9dipmd8XvOzSafxYFF9Y5JFBoUfLia8splbgaVc",Pe=gj(yj,_j),pg=U.createContext(void 0);function wj({children:t}){const[e,r]=U.useState(null),[n,i]=U.useState(!0);async function l(){var f;try{console.log("Starting getUserProfile...");const{data:{user:p},error:g}=await Pe.auth.getUser();if(g||!p)return console.log("No authenticated user found:",(g==null?void 0:g.message)||"No user"),null;console.log("Auth user found:",p.email);const{data:v,error:w}=await Pe.from("users").select("*").eq("email",p.email).maybeSingle();if(v)return console.log("User found in database:",v.email,"Role:",v.role),v;console.log("User not in database, creating fallback profile for:",p.email);let S="consultor";(p.email==="drhpozkc@minimax.com"||p.email==="joao@seusdados.com.br"||p.email==="marcelo@seusdados.com")&&(S="admin");const y={id:p.id,email:p.email,full_name:((f=p.user_metadata)==null?void 0:f.full_name)||p.email.split("@")[0],role:S,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),is_active:!0};return console.log("Fallback user created:",y.email,"Role:",y.role),y}catch(p){return console.error("Error in getUserProfile:",p),null}}async function c(){console.log("Loading user..."),i(!0);try{const f=await l();r(f),console.log("User loaded:",f?f.email:"null")}catch(f){console.error("Error loading user:",f),r(null)}finally{i(!1),console.log("Loading finished")}}U.useEffect(()=>{console.log("AuthProvider initializing..."),c();const{data:{subscription:f}}=Pe.auth.onAuthStateChange(async(p,g)=>{if(console.log("Auth state changed:",p,g?"user exists":"no user"),g!=null&&g.user){const v=await l();r(v),i(!1)}else r(null),i(!1)});return()=>{f.unsubscribe(),console.log("AuthProvider cleanup")}},[]);async function d(f,p){console.log("Attempting sign in for:",f);const g=await Pe.auth.signInWithPassword({email:f,password:p});return console.log("Sign in result:",g.error?"Error: "+g.error.message:"Success"),g}async function m(){console.log("Signing out...");const f=await Pe.auth.signOut();return r(null),i(!1),f}return a.jsx(pg.Provider,{value:{user:e,loading:n,signIn:d,signOut:m,getUserProfile:l},children:t})}function Rt(){const t=U.useContext(pg);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function Hr({children:t,roles:e}){const{user:r,loading:n}=Rt(),i=as(),[l,c]=U.useState(!1);return U.useEffect(()=>{const d=setTimeout(()=>{n&&(console.error("ProtectedRoute: Loading timeout reached (15 seconds)"),c(!0))},15e3);return()=>clearTimeout(d)},[n]),n&&!l?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f5f5fa]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando..."}),a.jsx("p",{className:"text-xs text-[#5a647e] mt-2",children:"Verificando autenticao"})]})}):l&&n?(console.log("ProtectedRoute: Timeout reached, redirecting to login"),a.jsx(Fo,{to:"/login",state:{from:i,error:"Timeout na autenticao"},replace:!0})):r?e&&!e.includes(r.role)?(console.log("ProtectedRoute: User role not authorized:",r.role,"Required:",e),a.jsx(Fo,{to:"/unauthorized",replace:!0})):(console.log("ProtectedRoute: Access granted for user:",r.email,"Role:",r.role),a.jsx(a.Fragment,{children:t})):(console.log("ProtectedRoute: No user found, redirecting to login"),a.jsx(Fo,{to:"/login",state:{from:i},replace:!0}))}function xg(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=xg(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function gg(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=xg(t))&&(n&&(n+=" "),n+=e);return n}const Dp=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Lp=gg,jj=(t,e)=>r=>{var n;if((e==null?void 0:e.variants)==null)return Lp(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:i,defaultVariants:l}=e,c=Object.keys(i).map(f=>{const p=r==null?void 0:r[f],g=l==null?void 0:l[f];if(p===null)return null;const v=Dp(p)||Dp(g);return i[f][v]}),d=r&&Object.entries(r).reduce((f,p)=>{let[g,v]=p;return v===void 0||(f[g]=v),f},{}),m=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((f,p)=>{let{class:g,className:v,...w}=p;return Object.entries(w).every(S=>{let[y,E]=S;return Array.isArray(E)?E.includes({...l,...d}[y]):{...l,...d}[y]===E})?[...f,g,v]:f},[]);return Lp(t,c,m,r==null?void 0:r.class,r==null?void 0:r.className)},Qf="-",Sj=t=>{const e=Nj(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:c=>{const d=c.split(Qf);return d[0]===""&&d.length!==1&&d.shift(),vg(d,e)||Ej(c)},getConflictingClassGroupIds:(c,d)=>{const m=r[c]||[];return d&&n[c]?[...m,...n[c]]:m}}},vg=(t,e)=>{var c;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),i=n?vg(t.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const l=t.join(Qf);return(c=e.validators.find(({validator:d})=>d(l)))==null?void 0:c.classGroupId},Ip=/^\[(.+)\]$/,Ej=t=>{if(Ip.test(t)){const e=Ip.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},Nj=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return Tj(Object.entries(t.classGroups),r).forEach(([l,c])=>{Df(c,n,l,e)}),n},Df=(t,e,r,n)=>{t.forEach(i=>{if(typeof i=="string"){const l=i===""?e:Mp(e,i);l.classGroupId=r;return}if(typeof i=="function"){if(bj(i)){Df(i(n),e,r,n);return}e.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([l,c])=>{Df(c,Mp(e,l),r,n)})})},Mp=(t,e)=>{let r=t;return e.split(Qf).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},bj=t=>t.isThemeGetter,Tj=(t,e)=>e?t.map(([r,n])=>{const i=n.map(l=>typeof l=="string"?e+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([c,d])=>[e+c,d])):l);return[r,i]}):t,kj=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const i=(l,c)=>{r.set(l,c),e++,e>t&&(e=0,n=r,r=new Map)};return{get(l){let c=r.get(l);if(c!==void 0)return c;if((c=n.get(l))!==void 0)return i(l,c),c},set(l,c){r.has(l)?r.set(l,c):i(l,c)}}},yg="!",Cj=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,i=e[0],l=e.length,c=d=>{const m=[];let f=0,p=0,g;for(let E=0;E<d.length;E++){let D=d[E];if(f===0){if(D===i&&(n||d.slice(E,E+l)===e)){m.push(d.slice(p,E)),p=E+l;continue}if(D==="/"){g=E;continue}}D==="["?f++:D==="]"&&f--}const v=m.length===0?d:d.substring(p),w=v.startsWith(yg),S=w?v.substring(1):v,y=g&&g>p?g-p:void 0;return{modifiers:m,hasImportantModifier:w,baseClassName:S,maybePostfixModifierPosition:y}};return r?d=>r({className:d,parseClassName:c}):c},Aj=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},Oj=t=>({cache:kj(t.cacheSize),parseClassName:Cj(t),...Sj(t)}),Pj=/\s+/,Rj=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=e,l=[],c=t.trim().split(Pj);let d="";for(let m=c.length-1;m>=0;m-=1){const f=c[m],{modifiers:p,hasImportantModifier:g,baseClassName:v,maybePostfixModifierPosition:w}=r(f);let S=!!w,y=n(S?v.substring(0,w):v);if(!y){if(!S){d=f+(d.length>0?" "+d:d);continue}if(y=n(v),!y){d=f+(d.length>0?" "+d:d);continue}S=!1}const E=Aj(p).join(":"),D=g?E+yg:E,A=D+y;if(l.includes(A))continue;l.push(A);const C=i(y,S);for(let P=0;P<C.length;++P){const F=C[P];l.push(D+F)}d=f+(d.length>0?" "+d:d)}return d};function Fj(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=_g(e))&&(n&&(n+=" "),n+=r);return n}const _g=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=_g(t[n]))&&(r&&(r+=" "),r+=e);return r};function Dj(t,...e){let r,n,i,l=c;function c(m){const f=e.reduce((p,g)=>g(p),t());return r=Oj(f),n=r.cache.get,i=r.cache.set,l=d,d(m)}function d(m){const f=n(m);if(f)return f;const p=Rj(m,r);return i(m,p),p}return function(){return l(Fj.apply(null,arguments))}}const Ot=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},wg=/^\[(?:([a-z-]+):)?(.+)\]$/i,Lj=/^\d+\/\d+$/,Ij=new Set(["px","full","screen"]),Mj=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Bj=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Uj=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,zj=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$j=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Qn=t=>ji(t)||Ij.has(t)||Lj.test(t),Rs=t=>Fi(t,"length",Jj),ji=t=>!!t&&!Number.isNaN(Number(t)),uf=t=>Fi(t,"number",ji),To=t=>!!t&&Number.isInteger(Number(t)),Wj=t=>t.endsWith("%")&&ji(t.slice(0,-1)),rt=t=>wg.test(t),Fs=t=>Mj.test(t),Vj=new Set(["length","size","percentage"]),Hj=t=>Fi(t,Vj,jg),qj=t=>Fi(t,"position",jg),Gj=new Set(["image","url"]),Kj=t=>Fi(t,Gj,Qj),Xj=t=>Fi(t,"",Yj),ko=()=>!0,Fi=(t,e,r)=>{const n=wg.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},Jj=t=>Bj.test(t)&&!Uj.test(t),jg=()=>!1,Yj=t=>zj.test(t),Qj=t=>$j.test(t),Zj=()=>{const t=Ot("colors"),e=Ot("spacing"),r=Ot("blur"),n=Ot("brightness"),i=Ot("borderColor"),l=Ot("borderRadius"),c=Ot("borderSpacing"),d=Ot("borderWidth"),m=Ot("contrast"),f=Ot("grayscale"),p=Ot("hueRotate"),g=Ot("invert"),v=Ot("gap"),w=Ot("gradientColorStops"),S=Ot("gradientColorStopPositions"),y=Ot("inset"),E=Ot("margin"),D=Ot("opacity"),A=Ot("padding"),C=Ot("saturate"),P=Ot("scale"),F=Ot("sepia"),L=Ot("skew"),N=Ot("space"),j=Ot("translate"),T=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],q=()=>["auto",rt,e],B=()=>[rt,e],Y=()=>["",Qn,Rs],pe=()=>["auto",ji,rt],we=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],te=()=>["solid","dashed","dotted","double","none"],he=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Q=()=>["start","end","center","between","around","evenly","stretch"],W=()=>["","0",rt],re=()=>["auto","avoid","all","avoid-page","page","left","right","column"],M=()=>[ji,rt];return{cacheSize:500,separator:":",theme:{colors:[ko],spacing:[Qn,Rs],blur:["none","",Fs,rt],brightness:M(),borderColor:[t],borderRadius:["none","","full",Fs,rt],borderSpacing:B(),borderWidth:Y(),contrast:M(),grayscale:W(),hueRotate:M(),invert:W(),gap:B(),gradientColorStops:[t],gradientColorStopPositions:[Wj,Rs],inset:q(),margin:q(),opacity:M(),padding:B(),saturate:M(),scale:M(),sepia:W(),skew:M(),space:B(),translate:B()},classGroups:{aspect:[{aspect:["auto","square","video",rt]}],container:["container"],columns:[{columns:[Fs]}],"break-after":[{"break-after":re()}],"break-before":[{"break-before":re()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...we(),rt]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:T()}],"overscroll-x":[{"overscroll-x":T()}],"overscroll-y":[{"overscroll-y":T()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",To,rt]}],basis:[{basis:q()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",rt]}],grow:[{grow:W()}],shrink:[{shrink:W()}],order:[{order:["first","last","none",To,rt]}],"grid-cols":[{"grid-cols":[ko]}],"col-start-end":[{col:["auto",{span:["full",To,rt]},rt]}],"col-start":[{"col-start":pe()}],"col-end":[{"col-end":pe()}],"grid-rows":[{"grid-rows":[ko]}],"row-start-end":[{row:["auto",{span:[To,rt]},rt]}],"row-start":[{"row-start":pe()}],"row-end":[{"row-end":pe()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",rt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",rt]}],gap:[{gap:[v]}],"gap-x":[{"gap-x":[v]}],"gap-y":[{"gap-y":[v]}],"justify-content":[{justify:["normal",...Q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[A]}],px:[{px:[A]}],py:[{py:[A]}],ps:[{ps:[A]}],pe:[{pe:[A]}],pt:[{pt:[A]}],pr:[{pr:[A]}],pb:[{pb:[A]}],pl:[{pl:[A]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",rt,e]}],"min-w":[{"min-w":[rt,e,"min","max","fit"]}],"max-w":[{"max-w":[rt,e,"none","full","min","max","fit","prose",{screen:[Fs]},Fs]}],h:[{h:[rt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[rt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[rt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[rt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Fs,Rs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",uf]}],"font-family":[{font:[ko]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",rt]}],"line-clamp":[{"line-clamp":["none",ji,uf]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Qn,rt]}],"list-image":[{"list-image":["none",rt]}],"list-style-type":[{list:["none","disc","decimal",rt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[D]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[D]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...te(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Qn,Rs]}],"underline-offset":[{"underline-offset":["auto",Qn,rt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:B()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",rt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",rt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[D]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...we(),qj]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Hj]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Kj]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[S]}],"gradient-via-pos":[{via:[S]}],"gradient-to-pos":[{to:[S]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[D]}],"border-style":[{border:[...te(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[D]}],"divide-style":[{divide:te()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...te()]}],"outline-offset":[{"outline-offset":[Qn,rt]}],"outline-w":[{outline:[Qn,Rs]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:Y()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[D]}],"ring-offset-w":[{"ring-offset":[Qn,Rs]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Fs,Xj]}],"shadow-color":[{shadow:[ko]}],opacity:[{opacity:[D]}],"mix-blend":[{"mix-blend":[...he(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":he()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[m]}],"drop-shadow":[{"drop-shadow":["","none",Fs,rt]}],grayscale:[{grayscale:[f]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[g]}],saturate:[{saturate:[C]}],sepia:[{sepia:[F]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[m]}],"backdrop-grayscale":[{"backdrop-grayscale":[f]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[g]}],"backdrop-opacity":[{"backdrop-opacity":[D]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[F]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",rt]}],duration:[{duration:M()}],ease:[{ease:["linear","in","out","in-out",rt]}],delay:[{delay:M()}],animate:[{animate:["none","spin","ping","pulse","bounce",rt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[P]}],"scale-x":[{"scale-x":[P]}],"scale-y":[{"scale-y":[P]}],rotate:[{rotate:[To,rt]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[L]}],"skew-y":[{"skew-y":[L]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",rt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",rt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":B()}],"scroll-mx":[{"scroll-mx":B()}],"scroll-my":[{"scroll-my":B()}],"scroll-ms":[{"scroll-ms":B()}],"scroll-me":[{"scroll-me":B()}],"scroll-mt":[{"scroll-mt":B()}],"scroll-mr":[{"scroll-mr":B()}],"scroll-mb":[{"scroll-mb":B()}],"scroll-ml":[{"scroll-ml":B()}],"scroll-p":[{"scroll-p":B()}],"scroll-px":[{"scroll-px":B()}],"scroll-py":[{"scroll-py":B()}],"scroll-ps":[{"scroll-ps":B()}],"scroll-pe":[{"scroll-pe":B()}],"scroll-pt":[{"scroll-pt":B()}],"scroll-pr":[{"scroll-pr":B()}],"scroll-pb":[{"scroll-pb":B()}],"scroll-pl":[{"scroll-pl":B()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",rt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Qn,Rs,uf]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},e3=Dj(Zj);function Ys(...t){return e3(gg(t))}const t3=jj("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-white transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] text-white hover:from-[#4a148c] hover:to-[#38106c] shadow",primary:"bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] text-white hover:from-[#4a148c] hover:to-[#38106c] shadow",destructive:"bg-red-500 text-white hover:bg-red-600",outline:"border border-slate-200 bg-white hover:bg-slate-100 hover:text-slate-900",secondary:"bg-slate-100 text-slate-900 hover:bg-slate-200",ghost:"hover:bg-slate-100 hover:text-slate-900",link:"text-slate-900 underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),ue=U.forwardRef(({className:t,variant:e,size:r,loading:n,children:i,...l},c)=>a.jsxs("button",{className:Ys(t3({variant:e,size:r,className:t})),ref:c,disabled:n||l.disabled,...l,children:[n&&a.jsxs("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]}));ue.displayName="Button";const We=U.forwardRef(({className:t,label:e,error:r,icon:n,...i},l)=>a.jsxs("div",{className:"w-full",children:[e&&a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:e}),a.jsxs("div",{className:"relative",children:[n&&a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-[#5a647e]",children:n}),a.jsx("input",{className:Ys("flex h-10 w-full rounded-md border border-[#e0e4e8] bg-white px-3 py-2 text-sm ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-[#a0aec0] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#6a1b9a] focus-visible:ring-offset-0 disabled:cursor-not-allowed disabled:opacity-50",{"pl-10":n},t),ref:l,...i})]}),r&&a.jsx("p",{className:"mt-2 text-xs text-red-600",children:r})]}));We.displayName="Input";function Ae({className:t,children:e,variant:r="default",onClick:n}){const i={default:"bg-white rounded-lg border border-[#e0e4e8] shadow-sm",elevated:"bg-white rounded-lg border border-[#e0e4e8] shadow-lg",outlined:"bg-white rounded-lg border-2 border-[#e0e4e8] shadow-sm opacity-70"};return a.jsx("div",{className:Ys(i[r],t,n&&"cursor-pointer"),onClick:n,children:e})}function at({className:t,children:e}){return a.jsx("div",{className:Ys("p-6",t),children:e})}function it({className:t,children:e}){return a.jsx("h3",{className:Ys("text-xl font-semibold leading-none tracking-tight text-[#333333]",t),children:e})}function jt({className:t,children:e}){return a.jsx("p",{className:Ys("text-sm text-[#5a647e]",t),children:e})}function Oe({className:t,children:e}){return a.jsx("div",{className:Ys("p-6 pt-0",t),children:e})}/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var r3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=(t,e)=>{const r=U.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:d="",children:m,...f},p)=>U.createElement("svg",{ref:p,...r3,width:i,height:i,stroke:n,strokeWidth:c?Number(l)*24/Number(i):l,className:["lucide",`lucide-${n3(t)}`,d].join(" "),...f},[...e.map(([g,v])=>U.createElement(g,v)),...Array.isArray(m)?m:[m]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=He("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=He("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=He("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=He("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Up=He("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=He("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=He("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=He("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=He("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eg=He("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=He("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=He("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=He("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=He("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=He("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=He("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=He("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sl=He("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=He("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=He("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=He("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=He("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=He("FileQuestion",[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=He("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=He("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=He("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=He("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zf=He("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=He("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=He("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=He("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=He("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=He("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=He("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=He("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=He("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=He("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=He("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=He("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=He("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=He("Presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=He("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=He("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=He("ScrollText",[["path",{d:"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4",key:"13a6an"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M15 12h-5",key:"r7krc0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=He("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=He("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=He("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tg=He("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=He("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=He("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y3=He("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=He("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=He("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=He("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=He("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=He("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=He("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iu=He("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=He("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=He("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=He("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=He("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function j3(){const{signIn:t,user:e}=Rt(),r=as(),[n,i]=U.useState({email:"",password:""}),[l,c]=U.useState(!1),[d,m]=U.useState("");if(U.useEffect(()=>{var p;(p=r.state)!=null&&p.error&&(m(r.state.error),console.log("Login page - Error from redirect:",r.state.error))},[r.state]),e)return console.log("User already authenticated, redirecting to dashboard"),a.jsx(Fo,{to:"/dashboard",replace:!0});const f=async p=>{p.preventDefault(),c(!0),m(""),console.log("Attempting login for:",n.email);const g=setTimeout(()=>{l&&(c(!1),m("Login est demorando muito. Tente novamente."))},3e3);try{const{data:v,error:w}=await t(n.email,n.password);clearTimeout(g),w?(console.error("Login error:",w.message),w.message.includes("Invalid login credentials")?m("Email ou senha incorretos. Verifique suas credenciais."):w.message.includes("Email not confirmed")?m("Email no confirmado. Verifique seu email."):w.message.includes("Too many requests")?m("Muitas tentativas. Aguarde alguns minutos e tente novamente."):m("Erro de autenticao: "+w.message)):v!=null&&v.user&&(console.log("Login successful for:",v.user.email),i({email:"",password:""}))}catch(v){clearTimeout(g),console.error("Login exception:",v),m("Erro ao fazer login. Tente novamente.")}finally{c(!1)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-[#f5f5fa] to-[#e0e4e8] flex items-center justify-center p-6",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("img",{src:"/5693A_SEUSDADOS_LOGO_ORIGINAL.png",alt:"Seusdados",className:"h-12 mx-auto mb-6"}),a.jsx("h1",{className:"text-3xl font-bold text-[#1a237e] mb-2",children:"Sistema de Gesto"}),a.jsx("p",{className:"text-[#5a647e]",children:"Faa login para acessar sua conta"})]}),a.jsxs(Ae,{variant:"elevated",children:[a.jsxs(at,{children:[a.jsx(it,{children:"Entrar"}),a.jsx(jt,{children:"Digite suas credenciais para acessar o sistema"})]}),a.jsxs(Oe,{children:[a.jsxs("form",{onSubmit:f,className:"space-y-4",children:[a.jsx(We,{type:"email",label:"Email",placeholder:"seu@email.com",icon:a.jsx(Ci,{size:18}),value:n.email,onChange:p=>i({...n,email:p.target.value}),required:!0}),a.jsx(We,{type:"password",label:"Senha",placeholder:"",icon:a.jsx(f3,{size:18}),value:n.password,onChange:p=>i({...n,password:p.target.value}),required:!0}),d&&a.jsxs("div",{className:"flex items-center space-x-2 text-red-600 bg-red-50 p-3 rounded-lg border border-red-200",children:[a.jsx(Di,{size:18,className:"flex-shrink-0"}),a.jsx("span",{className:"text-sm",children:d})]}),l&&a.jsxs("div",{className:"flex items-center space-x-2 text-blue-600 bg-blue-50 p-3 rounded-lg border border-blue-200",children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"}),a.jsx("span",{className:"text-sm",children:"Autenticando em 3s..."})]}),a.jsx(ue,{type:"submit",className:"w-full",loading:l,size:"lg",disabled:l,children:l?"Autenticando...":"Entrar"})]}),!1,a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Esqueceu sua senha?",a.jsx(Xx,{to:"/forgot-password",className:"text-[#6a1b9a] hover:text-[#4a148c] font-medium ml-1",children:"Clique aqui"})]})})]})]})]})})}const S3=[{to:"/dashboard",icon:Zf,label:"Dashboard"},{to:"/consultores",icon:iu,label:"Consultores"},{to:"/clientes",icon:qr,label:"Clientes"},{to:"/servicos",icon:ja,label:"Servios"},{to:"/documentos",icon:Tt,label:"Documentos"},{to:"/apresentacoes",icon:th,label:"Apresentaes"},{to:"/questionarios",icon:ki,label:"Questionrios"},{to:"/relatorios",icon:wa,label:"Relatrios"}],E3=[{to:"/dashboard",icon:Zf,label:"Dashboard"},{to:"/meus-clientes",icon:qr,label:"Meus Clientes"},{to:"/propostas",icon:Tt,label:"Propostas"},{to:"/contratos",icon:wa,label:"Contratos"},{to:"/documentos",icon:Tt,label:"Documentos"},{to:"/apresentacoes",icon:th,label:"Apresentaes"},{to:"/questionarios",icon:ki,label:"Questionrios"}],N3=[{to:"/area-cliente",icon:Zf,label:"rea do Cliente"},{to:"/minhas-propostas",icon:Tt,label:"Minhas Propostas"},{to:"/meus-contratos",icon:wa,label:"Meus Contratos"}];function b3({isOpen:t,onClose:e}){var m,f;const{user:r,signOut:n}=Rt(),i=as(),l=tl(),c=()=>{switch(console.log("Getting nav items for user role:",r==null?void 0:r.role),r==null?void 0:r.role){case"admin":return console.log("Returning admin nav items"),S3;case"consultor":return console.log("Returning consultor nav items"),E3;case"cliente":return console.log("Returning cliente nav items"),N3;default:return console.log("No role found, returning empty nav items. User:",r),[]}},d=async()=>{await n(),l("/login")};return a.jsxs(a.Fragment,{children:[t&&a.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-50 lg:hidden",onClick:e}),a.jsx("div",{className:`
        fixed top-0 left-0 z-50 h-full w-64 bg-white border-r border-[#e0e4e8] transform transition-transform duration-300
        ${t?"translate-x-0":"-translate-x-full"} lg:translate-x-0
      `,children:a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"p-6 border-b border-[#e0e4e8] flex items-center justify-between",children:[a.jsx("img",{src:"/5693A_SEUSDADOS_LOGO_ORIGINAL.png",alt:"Seusdados",className:"h-8"}),a.jsx("button",{onClick:e,className:"lg:hidden text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]}),a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-full flex items-center justify-center text-white font-medium",children:(f=(m=r==null?void 0:r.full_name)==null?void 0:m[0])==null?void 0:f.toUpperCase()}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333] text-sm",children:r==null?void 0:r.full_name}),a.jsx("p",{className:"text-xs text-[#5a647e] capitalize",children:r==null?void 0:r.role}),(r==null?void 0:r.role)==="admin"&&a.jsx("span",{className:"inline-block px-2 py-1 text-xs font-medium text-white bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-full mt-1",children:"Administrador"})]})]})}),a.jsx("nav",{className:"flex-1 p-4 space-y-1",children:c().length>0?c().map(p=>{const g=p.icon,v=i.pathname===p.to;return a.jsxs(Xx,{to:p.to,className:`
                      flex items-center space-x-3 px-3 py-2.5 rounded-lg transition-all duration-200
                      ${v?"bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] text-white shadow-lg":"text-[#5a647e] hover:bg-[#f7f8fc] hover:text-[#333333]"}
                    `,onClick:()=>e(),children:[a.jsx(g,{size:20}),a.jsx("span",{className:"font-medium",children:p.label})]},p.to)}):a.jsxs("div",{className:"text-center text-[#5a647e] text-sm py-4",children:[a.jsx("p",{children:"Menu no disponvel"}),a.jsx("p",{className:"text-xs mt-1",children:"Aguarde o carregamento..."})]})}),a.jsx("div",{className:"p-4 border-t border-[#e0e4e8]",children:a.jsxs(ue,{variant:"ghost",className:"w-full justify-start text-red-600 hover:bg-red-50 hover:text-red-700",onClick:d,children:[a.jsx(h3,{size:20,className:"mr-3"}),"Sair"]})})]})})]})}function wr({children:t}){const[e,r]=U.useState(!1);return a.jsxs("div",{className:"min-h-screen bg-[#f5f5fa]",children:[a.jsx(b3,{isOpen:e,onClose:()=>r(!1)}),a.jsxs("div",{className:"lg:ml-64",children:[a.jsx("header",{className:"bg-white border-b border-[#e0e4e8] px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("button",{onClick:()=>r(!0),className:"lg:hidden text-[#5a647e] hover:text-[#333333]",children:a.jsx(m3,{size:24})}),a.jsx("div",{className:"flex items-center space-x-4",children:a.jsx("img",{src:"/5693A_SEUSDADOS_LOGO_ORIGINAL.png",alt:"Seusdados",className:"h-8 lg:hidden"})})]})}),a.jsx("main",{className:"p-6",children:t})]})]})}function Ag({isOpen:t,onClose:e,onSuccess:r}){const{user:n}=Rt(),[i,l]=U.useState(1),[c,d]=U.useState([]),[m,f]=U.useState([]),[p,g]=U.useState(null),[v,w]=U.useState([]),[S,y]=U.useState(""),[E,D]=U.useState(""),[A,C]=U.useState(!1),[P,F]=U.useState(""),[L,N]=U.useState({paymentMethod:"boleto",notes:"",installmentConfig:{enabled:!1,type:"equal",installments:12,downPayment:0}});U.useEffect(()=>{t&&(j(),T())},[t]);const j=async()=>{try{const{data:b,error:I}=await Pe.from("clients").select("*").eq("status","active").order("company_name");if(I)throw I;d(b||[])}catch(b){console.error("Erro ao carregar clientes:",b)}},T=async()=>{try{const{data:b,error:I}=await Pe.from("services").select("*").eq("is_active",!0).order("name");if(I)throw I;f(b||[])}catch(b){console.error("Erro ao carregar servios:",b)}},k=b=>{const I={service:b,paymentMethod:b.price_type,durationType:"indefinite"};w([...v,I])},q=b=>{w(v.filter((I,H)=>H!==b))},B=(b,I)=>{const H=[...v];H[b]={...H[b],...I},w(H)},Y=()=>v.reduce((b,I)=>{const H=I.customPrice||I.service.base_price||0,G=I.discountPercentage||0,se=H*(1-G/100);return b+se},0),pe=()=>{const b=Y(),I=L.installmentConfig;if(!I.enabled)return{total:b,installments:[]};if(I.type==="equal"){const H=b/I.installments;return{total:b,installments:Array.from({length:I.installments},(G,se)=>({number:se+1,value:H,description:`${se+1} parcela`}))}}else{const H=I.downPayment||0,se=(b-H)/I.installments,_e=[{number:0,value:H,description:"Entrada"}];for(let me=1;me<=I.installments;me++)_e.push({number:me,value:se,description:`${me} parcela`});return{total:b,installments:_e}}},we=()=>{const b=new Date,I=b.getFullYear(),H=String(b.getMonth()+1).padStart(2,"0"),G=String(b.getDate()).padStart(2,"0"),se=String(b.getTime()).slice(-4);return`PROP-${I}${H}${G}-${se}`},te=()=>Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),he=async()=>{if(!p||v.length===0){F("Selecione um cliente e pelo menos um servio");return}try{C(!0),F("");const b=we(),I=te(),H=Y(),G=new Date;G.setDate(G.getDate()+30);const{data:se,error:_e}=await Pe.from("proposals").insert([{proposal_number:b,client_id:p.id,consultant_id:n==null?void 0:n.id,status:"draft",total_amount:H,currency:"BRL",payment_method:L.paymentMethod,unique_link:I,expires_at:G.toISOString(),proposal_data:{services:v.map(xe=>({service_id:xe.service.id,service_name:xe.service.name,base_price:xe.service.base_price,custom_price:xe.customPrice,discount_percentage:xe.discountPercentage,payment_method:xe.paymentMethod,duration_type:xe.durationType,start_date:xe.startDate,end_date:xe.endDate})),notes:L.notes,installmentConfig:L.installmentConfig.enabled?{...L.installmentConfig,installments:pe().installments}:null}}]).select().single();if(_e)throw _e;const me=v.map(xe=>({proposal_id:se.id,service_id:xe.service.id,quantity:1,unit_price:xe.customPrice||xe.service.base_price||0,discount_percentage:xe.discountPercentage||0,payment_method:xe.paymentMethod,duration_type:xe.durationType,start_date:xe.startDate,end_date:xe.endDate})),{error:ye}=await Pe.from("proposal_services").insert(me);if(ye)throw ye;r(),e(),Q()}catch(b){F(b.message||"Erro ao criar proposta")}finally{C(!1)}},Q=()=>{l(1),g(null),w([]),y(""),D(""),N({paymentMethod:"boleto",notes:"",installmentConfig:{enabled:!1,type:"equal",installments:12,downPayment:0}}),F("")},W=c.filter(b=>b.company_name.toLowerCase().includes(S.toLowerCase())),re=m.filter(b=>b.name.toLowerCase().includes(E.toLowerCase())&&!v.some(I=>I.service.id===b.id)),M=b=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(b);return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-[#e0e4e8]",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Nova Proposta"}),a.jsxs("p",{className:"text-[#5a647e] mt-1",children:["Passo ",i," de 3: ",i===1?"Seleo do Cliente":i===2?"Seleo de Servios":"Reviso e Criao"]})]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]}),a.jsx("div",{className:"flex items-center space-x-2 mt-4",children:[1,2,3].map(b=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${b<i?"bg-green-500 text-white":b===i?"bg-[#6a1b9a] text-white":"bg-[#e0e4e8] text-[#5a647e]"}`,children:b<i?a.jsx(zp,{size:16}):b}),b<3&&a.jsx("div",{className:`w-16 h-1 mx-2 ${b<i?"bg-green-500":"bg-[#e0e4e8]"}`})]},b))})]}),a.jsxs("div",{className:"p-6",children:[i===1&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(We,{placeholder:"Buscar cliente por nome da empresa...",icon:a.jsx(an,{size:18}),value:S,onChange:b=>y(b.target.value)}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-96 overflow-y-auto",children:W.map(b=>a.jsx(Ae,{className:`cursor-pointer transition-all ${(p==null?void 0:p.id)===b.id?"ring-2 ring-[#6a1b9a] bg-[#f7f8fc]":"hover:bg-[#f7f8fc]"}`,onClick:()=>g(b),children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-[#6a1b9a] rounded-lg flex items-center justify-center text-white font-medium",children:a.jsx(qr,{size:20})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium text-[#333333]",children:b.company_name}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:b.legal_representative_name||"Sem representante"})]}),(p==null?void 0:p.id)===b.id&&a.jsx(zp,{className:"w-5 h-5 text-[#6a1b9a]"})]})})},b.id))})]}),i===2&&a.jsxs("div",{className:"space-y-6",children:[v.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-[#1a237e] mb-3",children:"Servios Selecionados"}),a.jsx("div",{className:"space-y-3",children:v.map((b,I)=>a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-[#333333]",children:b.service.name}),a.jsx("p",{className:"text-sm text-[#5a647e] mb-3",children:b.service.description}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-[#5a647e] block mb-1",children:"Preo (R$)"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full px-2 py-1 text-sm border border-[#e0e4e8] rounded",value:b.customPrice||b.service.base_price||"",onChange:H=>B(I,{customPrice:parseFloat(H.target.value)||void 0})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-[#5a647e] block mb-1",children:"Desconto (%)"}),a.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",className:"w-full px-2 py-1 text-sm border border-[#e0e4e8] rounded",value:b.discountPercentage||"",onChange:H=>B(I,{discountPercentage:parseFloat(H.target.value)||void 0})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-[#5a647e] block mb-1",children:"Tipo de Durao"}),a.jsxs("select",{className:"w-full px-2 py-1 text-sm border border-[#e0e4e8] rounded",value:b.durationType,onChange:H=>B(I,{durationType:H.target.value}),children:[a.jsx("option",{value:"indefinite",children:"Indeterminado"}),a.jsx("option",{value:"fixed_term",children:"Prazo Fixo"})]})]})]})]}),a.jsx("button",{onClick:()=>q(I),className:"ml-4 text-red-600 hover:text-red-800",children:a.jsx(Ar,{size:20})})]})})},I))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-[#1a237e] mb-3",children:"Adicionar Servios"}),a.jsx(We,{placeholder:"Buscar servios...",icon:a.jsx(an,{size:18}),value:E,onChange:b=>D(b.target.value),className:"mb-4"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-64 overflow-y-auto",children:re.map(b=>a.jsx(Ae,{className:"hover:bg-[#f7f8fc] cursor-pointer",onClick:()=>k(b),children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-[#6a1b9a] rounded-lg flex items-center justify-center text-white",children:a.jsx(Po,{size:16})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-[#333333]",children:b.name}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:b.base_price?M(b.base_price):"Preo sob consulta"})]}),a.jsx(cr,{className:"w-5 h-5 text-[#6a1b9a]"})]})})},b.id))})]})]}),i===3&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-[#1a237e] mb-3",children:"Resumo da Proposta"}),a.jsxs(Ae,{className:"mb-4",children:[a.jsx(at,{children:a.jsx(it,{className:"text-base",children:"Cliente"})}),a.jsxs(Oe,{children:[a.jsx("p",{className:"font-medium",children:p==null?void 0:p.company_name}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:p==null?void 0:p.legal_representative_name})]})]}),a.jsxs(Ae,{className:"mb-4",children:[a.jsx(at,{children:a.jsxs(it,{className:"text-base",children:["Servios (",v.length,")"]})}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-2",children:[v.map((b,I)=>{const H=b.customPrice||b.service.base_price||0,G=b.discountPercentage||0,se=H*(1-G/100);return a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:b.service.name}),G>0&&a.jsxs("span",{className:"ml-2 text-sm text-green-600",children:["(-",G,"%)"]})]}),a.jsx("span",{className:"font-medium",children:M(se)})]},I)}),a.jsxs("div",{className:"border-t pt-2 flex justify-between items-center font-bold text-lg",children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{className:"text-[#1a237e]",children:M(Y())})]})]})})]}),a.jsxs(Ae,{className:"mb-4",children:[a.jsx(at,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(it,{className:"text-base",children:"Opes de Parcelamento"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"enableInstallments",checked:L.installmentConfig.enabled,onChange:b=>N({...L,installmentConfig:{...L.installmentConfig,enabled:b.target.checked}}),className:"h-4 w-4 text-[#6a1b9a] focus:ring-[#6a1b9a] border-gray-300 rounded"}),a.jsx("label",{htmlFor:"enableInstallments",className:"text-sm font-medium text-[#333333]",children:"Habilitar Parcelamento"})]})]})}),L.installmentConfig.enabled&&a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Modalidade de Parcelamento"}),a.jsxs("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:L.installmentConfig.type,onChange:b=>N({...L,installmentConfig:{...L.installmentConfig,type:b.target.value}}),children:[a.jsx("option",{value:"equal",children:"Parcelas Iguais"}),a.jsx("option",{value:"down_payment_plus_installments",children:"Entrada + Parcelas Iguais"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Nmero de Parcelas"}),a.jsx("input",{type:"number",min:"1",max:"60",className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:L.installmentConfig.installments,onChange:b=>N({...L,installmentConfig:{...L.installmentConfig,installments:parseInt(b.target.value)||1}})})]})]}),L.installmentConfig.type==="down_payment_plus_installments"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Valor da Entrada (R$)"}),a.jsx("input",{type:"number",step:"0.01",min:"0",max:Y(),className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:L.installmentConfig.downPayment||"",onChange:b=>N({...L,installmentConfig:{...L.installmentConfig,downPayment:parseFloat(b.target.value)||0}}),placeholder:"0.00"})]}),a.jsxs("div",{className:"bg-[#f7f8fc] rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium text-[#1a237e] mb-3",children:"Preview do Parcelamento:"}),a.jsxs("div",{className:"space-y-2",children:[(()=>{const{installments:b}=pe();return b.map((I,H)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:"text-sm text-[#333333]",children:[I.description,":"]}),a.jsx("span",{className:"font-medium text-[#1a237e]",children:M(I.value)})]},H))})(),a.jsxs("div",{className:"border-t pt-2 mt-2 flex justify-between items-center font-bold",children:[a.jsx("span",{children:"Total Geral:"}),a.jsx("span",{className:"text-[#1a237e]",children:M(Y())})]})]})]})]})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Observaes (opcional)"}),a.jsx("textarea",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a] h-24 resize-none",placeholder:"Observaes adicionais sobre a proposta...",value:L.notes,onChange:b=>N({...L,notes:b.target.value})})]})]})}),P&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm mt-4",children:P})]}),a.jsxs("div",{className:"p-6 border-t border-[#e0e4e8] flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-3",children:i>1&&a.jsxs(ue,{variant:"outline",onClick:()=>l(i-1),children:[a.jsx(s3,{size:16,className:"mr-2"}),"Voltar"]})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(ue,{variant:"outline",onClick:e,children:"Cancelar"}),i<3?a.jsx(ue,{onClick:()=>l(i+1),disabled:i===1&&!p||i===2&&v.length===0,children:"Prximo"}):a.jsxs(ue,{onClick:he,loading:A,children:[a.jsx(g3,{size:16,className:"mr-2"}),"Criar Proposta"]})]})]})]})}):null}function Vp(){var w;const{user:t}=Rt(),[e,r]=U.useState({}),[n,i]=U.useState(!0),[l,c]=U.useState([]),[d,m]=U.useState(!1);U.useEffect(()=>{f()},[t]);const f=async()=>{if(t)try{i(!0),t.role==="admin"?await p():t.role==="consultor"?await g():t.role==="cliente"&&await v()}catch(S){console.error("Erro ao carregar dados do dashboard:",S)}finally{i(!1)}},p=async()=>{const[S,y,E]=await Promise.all([Pe.from("clients").select("id",{count:"exact"}),Pe.from("proposals").select("*"),Pe.from("contracts").select("*")]),D=y.data||[],A=E.data||[];r({totalClients:S.count||0,totalProposals:D.length,totalContracts:A.length,monthlyRevenue:A.filter(P=>P.status==="active").reduce((P,F)=>P+(F.monthly_value||0),0),pendingProposals:D.filter(P=>P.status==="sent").length,activeContracts:A.filter(P=>P.status==="active").length});const{data:C}=await Pe.from("proposals").select(`
        id, proposal_number, status, total_amount, created_at,
        clients!proposals_client_id_fkey(company_name)
      `).order("created_at",{ascending:!1}).limit(5);c(C||[])},g=async()=>{const[S,y,E]=await Promise.all([Pe.from("clients").select("id",{count:"exact"}),Pe.from("proposals").select("*").eq("consultant_id",t.id),Pe.from("contracts").select("*")]),D=y.data||[],C=(E.data||[]).filter(F=>D.some(L=>L.id===F.proposal_id));r({totalClients:S.count||0,totalProposals:D.length,totalContracts:C.length,monthlyRevenue:C.filter(F=>F.status==="active").reduce((F,L)=>F+(L.monthly_value||0),0),pendingProposals:D.filter(F=>F.status==="sent").length,activeContracts:C.filter(F=>F.status==="active").length});const{data:P}=await Pe.from("proposals").select(`
        id, proposal_number, status, total_amount, created_at,
        clients!proposals_client_id_fkey(company_name)
      `).eq("consultant_id",t.id).order("created_at",{ascending:!1}).limit(5);c(P||[])},v=async()=>{const[S,y]=await Promise.all([Pe.from("proposals").select("*").eq("client_id",t.id),Pe.from("contracts").select("*").eq("client_id",t.id)]),E=S.data||[],D=y.data||[];r({totalClients:1,totalProposals:E.length,totalContracts:D.length,monthlyRevenue:D.filter(A=>A.status==="active").reduce((A,C)=>A+(C.monthly_value||0),0),pendingProposals:E.filter(A=>A.status==="sent").length,activeContracts:D.filter(A=>A.status==="active").length}),c(E.slice(-5).reverse())};return n?a.jsx(wr,{children:a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando dashboard..."})]})})}):a.jsxs(wr,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-[#1a237e]",children:["Ol, ",t==null?void 0:t.full_name,"!"]}),a.jsxs("p",{className:"text-[#5a647e] mt-1",children:[(t==null?void 0:t.role)==="admin"&&"Viso geral do sistema",(t==null?void 0:t.role)==="consultor"&&"Seu pipeline de vendas",(t==null?void 0:t.role)==="cliente"&&"Sua rea exclusiva"]})]}),(t==null?void 0:t.role)==="consultor"&&a.jsxs(ue,{onClick:()=>m(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Nova Proposta"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(t==null?void 0:t.role)!=="cliente"&&a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Total de Clientes"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:e.totalClients})]}),a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-lg flex items-center justify-center",children:a.jsx(qr,{className:"w-6 h-6 text-white"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:(t==null?void 0:t.role)==="cliente"?"Minhas Propostas":"Propostas"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:e.totalProposals})]}),a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-6 h-6 text-white"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:(t==null?void 0:t.role)==="cliente"?"Meus Contratos":"Contratos Ativos"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:e.activeContracts})]}),a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-lg flex items-center justify-center",children:a.jsx(wa,{className:"w-6 h-6 text-white"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Receita Mensal"}),a.jsxs("p",{className:"text-2xl font-bold text-[#1a237e]",children:["R$ ",((w=e.monthlyRevenue)==null?void 0:w.toLocaleString("pt-BR"))||"0"]})]}),a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-lg flex items-center justify-center",children:a.jsx(sl,{className:"w-6 h-6 text-white"})})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Propostas Recentes"}),a.jsx(jt,{children:(t==null?void 0:t.role)==="cliente"?"Suas propostas mais recentes":"ltimas propostas criadas"})]}),a.jsx(Oe,{children:a.jsx("div",{className:"space-y-4",children:l.length>0?l.map(S=>{var y,E;return a.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#f7f8fc] rounded-lg",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-[#333333]",children:["#",S.proposal_number]}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:((y=S.clients)==null?void 0:y.company_name)||"Cliente no encontrado"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-medium text-[#1a237e]",children:["R$ ",(E=S.total_amount)==null?void 0:E.toLocaleString("pt-BR")]}),a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${S.status==="accepted"?"bg-green-100 text-green-800":S.status==="sent"?"bg-blue-100 text-blue-800":S.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:S.status==="accepted"?"Aceita":S.status==="sent"?"Enviada":S.status==="rejected"?"Rejeitada":S.status==="draft"?"Rascunho":S.status})]})]},S.id)}):a.jsx("p",{className:"text-center text-[#5a647e] py-6",children:"Nenhuma proposta encontrada"})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Aes Rpidas"}),a.jsx(jt,{children:"Acesse rapidamente as principais funcionalidades"})]}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-3",children:[(t==null?void 0:t.role)==="admin"&&a.jsxs(a.Fragment,{children:[a.jsxs(ue,{variant:"outline",className:"w-full justify-start",children:[a.jsx(iu,{size:18,className:"mr-3"}),"Cadastrar Consultor"]}),a.jsxs(ue,{variant:"outline",className:"w-full justify-start",children:[a.jsx(qr,{size:18,className:"mr-3"}),"Novo Cliente"]}),a.jsxs(ue,{variant:"outline",className:"w-full justify-start",children:[a.jsx(Cr,{size:18,className:"mr-3"}),"Ver Relatrios"]})]}),(t==null?void 0:t.role)==="consultor"&&a.jsxs(a.Fragment,{children:[a.jsxs(ue,{variant:"outline",className:"w-full justify-start",onClick:()=>m(!0),children:[a.jsx(cr,{size:18,className:"mr-3"}),"Nova Proposta"]}),a.jsxs(ue,{variant:"outline",className:"w-full justify-start",children:[a.jsx(qr,{size:18,className:"mr-3"}),"Meus Clientes"]}),a.jsxs(ue,{variant:"outline",className:"w-full justify-start",children:[a.jsx(wa,{size:18,className:"mr-3"}),"Ver Contratos"]})]}),(t==null?void 0:t.role)==="cliente"&&a.jsxs(a.Fragment,{children:[a.jsxs(ue,{variant:"outline",className:"w-full justify-start",children:[a.jsx(Tt,{size:18,className:"mr-3"}),"Minhas Propostas"]}),a.jsxs(ue,{variant:"outline",className:"w-full justify-start",children:[a.jsx(wa,{size:18,className:"mr-3"}),"Meus Contratos"]})]})]})})]})]})]}),(t==null?void 0:t.role)==="consultor"&&a.jsx(Ag,{isOpen:d,onClose:()=>m(!1),onSuccess:f})]})}function T3({clientId:t,onUploadSuccess:e,allowedTypes:r=["application/pdf","image/*","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],maxSizeMB:n=10}){const[i,l]=U.useState(!1),[c,d]=U.useState([]),[m,f]=U.useState(!1),p=U.useRef(null),[g,v]=U.useState(!1);$f.useEffect(()=>{w()},[t]);const w=async()=>{if(t)try{f(!0);const{data:N,error:j}=await Pe.from("client_documents").select("*").eq("client_id",t).order("uploaded_at",{ascending:!1});if(j)throw j;d(N||[])}catch(N){console.error("Erro ao carregar documentos:",N)}finally{f(!1)}},S=N=>{if(!N||N.length===0)return;const j=N[0];y(j)},y=async N=>{if(!N||!t)return;const j=n*1024*1024;if(N.size>j){alert(`Arquivo muito grande. Tamanho mximo: ${n}MB`);return}if(!r.some(k=>k.endsWith("/*")?N.type.startsWith(k.replace("/*","/")):N.type===k)){alert("Tipo de arquivo no permitido");return}try{l(!0);const k=await new Promise((pe,we)=>{const te=new FileReader;te.onloadend=()=>pe(te.result),te.onerror=we,te.readAsDataURL(N)}),q=E(N.name),{data:B,error:Y}=await Pe.functions.invoke("document-upload",{body:{fileData:k,fileName:N.name,clientId:t,documentType:q}});if(Y)throw new Error(Y.message||"Erro no upload");if(B!=null&&B.error)throw new Error(B.error.message||"Erro no upload");await w(),e==null||e(),p.current&&(p.current.value="")}catch(k){console.error("Erro no upload:",k),alert(k.message||"Erro ao fazer upload do documento")}finally{l(!1)}},E=N=>{var T;switch((T=N.split(".").pop())==null?void 0:T.toLowerCase()){case"pdf":return"contract";case"jpg":case"jpeg":case"png":case"gif":return"image";case"doc":case"docx":return"document";case"txt":return"text";default:return"other"}},D=N=>{if(N===0)return"0 Bytes";const j=1024,T=["Bytes","KB","MB","GB"],k=Math.floor(Math.log(N)/Math.log(j));return parseFloat((N/Math.pow(j,k)).toFixed(2))+" "+T[k]},A=N=>{switch(N){case"contract":return"Contrato";case"image":return"Imagem";case"document":return"Documento";case"text":return"Texto";default:return"Outro"}},C=N=>{N.preventDefault(),v(!0)},P=N=>{N.preventDefault(),v(!1)},F=N=>{N.preventDefault(),v(!1),S(N.dataTransfer.files)},L=async N=>{if(confirm("Tem certeza que deseja excluir este documento?"))try{const{error:j}=await Pe.from("client_documents").delete().eq("id",N);if(j)throw j;await w()}catch(j){console.error("Erro ao excluir documento:",j),alert("Erro ao excluir documento")}};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${g?"border-[#6a1b9a] bg-purple-50":"border-[#e0e4e8] hover:border-[#6a1b9a]"}`,onDragOver:C,onDragLeave:P,onDrop:F,children:[a.jsx("input",{ref:p,type:"file",className:"hidden",accept:r.join(","),onChange:N=>S(N.target.files),disabled:i}),a.jsx(Bc,{className:"w-12 h-12 text-[#6a1b9a] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-[#1a237e] mb-2",children:"Upload de Documentos"}),a.jsx("p",{className:"text-[#5a647e] mb-4",children:"Arraste e solte arquivos aqui ou clique para selecionar"}),a.jsxs(ue,{onClick:()=>{var N;return(N=p.current)==null?void 0:N.click()},disabled:i,loading:i,children:[a.jsx(Bc,{size:18,className:"mr-2"}),i?"Enviando...":"Selecionar Arquivo"]}),a.jsxs("p",{className:"text-xs text-[#5a647e] mt-2",children:["Mximo ",n,"MB  PDF, DOC, DOCX, TXT, Imagens"]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-[#1a237e] mb-3",children:["Documentos (",c.length,")"]}),m?a.jsxs("div",{className:"text-center py-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-[#6a1b9a] border-t-transparent mx-auto"}),a.jsx("p",{className:"text-[#5a647e] mt-2",children:"Carregando documentos..."})]}):c.length>0?a.jsx("div",{className:"space-y-2",children:c.map(N=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#f7f8fc] rounded-lg border border-[#e0e4e8]",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(Tt,{className:"w-5 h-5 text-[#6a1b9a]"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#1a237e]",children:N.document_name}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:[A(N.document_type),"  ",D(N.file_size)," ",new Date(N.uploaded_at).toLocaleDateString("pt-BR")]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>window.open(N.file_url,"_blank"),title:"Download",children:a.jsx(sn,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>L(N.id),className:"text-red-600 hover:text-red-700",title:"Excluir",children:a.jsx(Ar,{size:16})})]})]},N.id))}):a.jsxs("div",{className:"text-center py-8 text-[#5a647e]",children:[a.jsx(Tt,{className:"w-12 h-12 mx-auto mb-2 text-[#e0e4e8]"}),a.jsx("p",{children:"Nenhum documento enviado ainda"})]})]})]})}var Fc={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var k3=Fc.exports,Hp;function C3(){return Hp||(Hp=1,function(t,e){((r,n)=>{t.exports=n()})(k3,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,l=!n.document&&!!n.postMessage,c=n.IS_PAPA_WORKER||!1,d={},m=0,f={};function p(j){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(T){var k=F(T);k.chunkSize=parseInt(k.chunkSize),T.step||T.chunk||(k.chunkSize=null),this._handle=new y(k),(this._handle.streamer=this)._config=k}).call(this,j),this.parseChunk=function(T,k){var q=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<q){let Y=this._config.newline;Y||(B=this._config.quoteChar||'"',Y=this._handle.guessLineEndings(T,B)),T=[...T.split(Y).slice(q)].join(Y)}this.isFirstChunk&&N(this._config.beforeFirstChunk)&&(B=this._config.beforeFirstChunk(T))!==void 0&&(T=B),this.isFirstChunk=!1,this._halted=!1;var q=this._partialLine+T,B=(this._partialLine="",this._handle.parse(q,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(T=B.meta.cursor,q=(this._finished||(this._partialLine=q.substring(T-this._baseIndex),this._baseIndex=T),B&&B.data&&(this._rowCount+=B.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),c)n.postMessage({results:B,workerId:f.WORKER_ID,finished:q});else if(N(this._config.chunk)&&!k){if(this._config.chunk(B,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=B=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(B.data),this._completeResults.errors=this._completeResults.errors.concat(B.errors),this._completeResults.meta=B.meta),this._completed||!q||!N(this._config.complete)||B&&B.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),q||B&&B.meta.paused||this._nextChunk(),B}this._halted=!0},this._sendError=function(T){N(this._config.error)?this._config.error(T):c&&this._config.error&&n.postMessage({workerId:f.WORKER_ID,error:T,finished:!1})}}function g(j){var T;(j=j||{}).chunkSize||(j.chunkSize=f.RemoteChunkSize),p.call(this,j),this._nextChunk=l?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(k){this._input=k,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(T=new XMLHttpRequest,this._config.withCredentials&&(T.withCredentials=this._config.withCredentials),l||(T.onload=L(this._chunkLoaded,this),T.onerror=L(this._chunkError,this)),T.open(this._config.downloadRequestBody?"POST":"GET",this._input,!l),this._config.downloadRequestHeaders){var k,q=this._config.downloadRequestHeaders;for(k in q)T.setRequestHeader(k,q[k])}var B;this._config.chunkSize&&(B=this._start+this._config.chunkSize-1,T.setRequestHeader("Range","bytes="+this._start+"-"+B));try{T.send(this._config.downloadRequestBody)}catch(Y){this._chunkError(Y.message)}l&&T.status===0&&this._chunkError()}},this._chunkLoaded=function(){T.readyState===4&&(T.status<200||400<=T.status?this._chunkError():(this._start+=this._config.chunkSize||T.responseText.length,this._finished=!this._config.chunkSize||this._start>=(k=>(k=k.getResponseHeader("Content-Range"))!==null?parseInt(k.substring(k.lastIndexOf("/")+1)):-1)(T),this.parseChunk(T.responseText)))},this._chunkError=function(k){k=T.statusText||k,this._sendError(new Error(k))}}function v(j){(j=j||{}).chunkSize||(j.chunkSize=f.LocalChunkSize),p.call(this,j);var T,k,q=typeof FileReader<"u";this.stream=function(B){this._input=B,k=B.slice||B.webkitSlice||B.mozSlice,q?((T=new FileReader).onload=L(this._chunkLoaded,this),T.onerror=L(this._chunkError,this)):T=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var B=this._input,Y=(this._config.chunkSize&&(Y=Math.min(this._start+this._config.chunkSize,this._input.size),B=k.call(B,this._start,Y)),T.readAsText(B,this._config.encoding));q||this._chunkLoaded({target:{result:Y}})},this._chunkLoaded=function(B){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(B.target.result)},this._chunkError=function(){this._sendError(T.error)}}function w(j){var T;p.call(this,j=j||{}),this.stream=function(k){return T=k,this._nextChunk()},this._nextChunk=function(){var k,q;if(!this._finished)return k=this._config.chunkSize,T=k?(q=T.substring(0,k),T.substring(k)):(q=T,""),this._finished=!T,this.parseChunk(q)}}function S(j){p.call(this,j=j||{});var T=[],k=!0,q=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(B){this._input=B,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){q&&T.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),T.length?this.parseChunk(T.shift()):k=!0},this._streamData=L(function(B){try{T.push(typeof B=="string"?B:B.toString(this._config.encoding)),k&&(k=!1,this._checkIsFinished(),this.parseChunk(T.shift()))}catch(Y){this._streamError(Y)}},this),this._streamError=L(function(B){this._streamCleanUp(),this._sendError(B)},this),this._streamEnd=L(function(){this._streamCleanUp(),q=!0,this._streamData("")},this),this._streamCleanUp=L(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function y(j){var T,k,q,B,Y=Math.pow(2,53),pe=-Y,we=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,te=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,he=this,Q=0,W=0,re=!1,M=!1,b=[],I={data:[],errors:[],meta:{}};function H(me){return j.skipEmptyLines==="greedy"?me.join("").trim()==="":me.length===1&&me[0].length===0}function G(){if(I&&q&&(_e("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+f.DefaultDelimiter+"'"),q=!1),j.skipEmptyLines&&(I.data=I.data.filter(function(qe){return!H(qe)})),se()){let qe=function(st,Ke){N(j.transformHeader)&&(st=j.transformHeader(st,Ke)),b.push(st)};var Ie=qe;if(I)if(Array.isArray(I.data[0])){for(var me=0;se()&&me<I.data.length;me++)I.data[me].forEach(qe);I.data.splice(0,1)}else I.data.forEach(qe)}function ye(qe,st){for(var Ke=j.header?{}:[],tt=0;tt<qe.length;tt++){var $e=tt,Fe=qe[tt],Fe=((Qe,ot)=>(ut=>(j.dynamicTypingFunction&&j.dynamicTyping[ut]===void 0&&(j.dynamicTyping[ut]=j.dynamicTypingFunction(ut)),(j.dynamicTyping[ut]||j.dynamicTyping)===!0))(Qe)?ot==="true"||ot==="TRUE"||ot!=="false"&&ot!=="FALSE"&&((ut=>{if(we.test(ut)&&(ut=parseFloat(ut),pe<ut&&ut<Y))return 1})(ot)?parseFloat(ot):te.test(ot)?new Date(ot):ot===""?null:ot):ot)($e=j.header?tt>=b.length?"__parsed_extra":b[tt]:$e,Fe=j.transform?j.transform(Fe,$e):Fe);$e==="__parsed_extra"?(Ke[$e]=Ke[$e]||[],Ke[$e].push(Fe)):Ke[$e]=Fe}return j.header&&(tt>b.length?_e("FieldMismatch","TooManyFields","Too many fields: expected "+b.length+" fields but parsed "+tt,W+st):tt<b.length&&_e("FieldMismatch","TooFewFields","Too few fields: expected "+b.length+" fields but parsed "+tt,W+st)),Ke}var xe;I&&(j.header||j.dynamicTyping||j.transform)&&(xe=1,!I.data.length||Array.isArray(I.data[0])?(I.data=I.data.map(ye),xe=I.data.length):I.data=ye(I.data,0),j.header&&I.meta&&(I.meta.fields=b),W+=xe)}function se(){return j.header&&b.length===0}function _e(me,ye,xe,Ie){me={type:me,code:ye,message:xe},Ie!==void 0&&(me.row=Ie),I.errors.push(me)}N(j.step)&&(B=j.step,j.step=function(me){I=me,se()?G():(G(),I.data.length!==0&&(Q+=me.data.length,j.preview&&Q>j.preview?k.abort():(I.data=I.data[0],B(I,he))))}),this.parse=function(me,ye,xe){var Ie=j.quoteChar||'"',Ie=(j.newline||(j.newline=this.guessLineEndings(me,Ie)),q=!1,j.delimiter?N(j.delimiter)&&(j.delimiter=j.delimiter(me),I.meta.delimiter=j.delimiter):((Ie=((qe,st,Ke,tt,$e)=>{var Fe,Qe,ot,ut;$e=$e||[",","	","|",";",f.RECORD_SEP,f.UNIT_SEP];for(var qt=0;qt<$e.length;qt++){for(var hr,ln=$e[qt],pt=0,rr=0,kt=0,It=(ot=void 0,new D({comments:tt,delimiter:ln,newline:st,preview:10}).parse(qe)),Mt=0;Mt<It.data.length;Mt++)Ke&&H(It.data[Mt])?kt++:(hr=It.data[Mt].length,rr+=hr,ot===void 0?ot=hr:0<hr&&(pt+=Math.abs(hr-ot),ot=hr));0<It.data.length&&(rr/=It.data.length-kt),(Qe===void 0||pt<=Qe)&&(ut===void 0||ut<rr)&&1.99<rr&&(Qe=pt,Fe=ln,ut=rr)}return{successful:!!(j.delimiter=Fe),bestDelimiter:Fe}})(me,j.newline,j.skipEmptyLines,j.comments,j.delimitersToGuess)).successful?j.delimiter=Ie.bestDelimiter:(q=!0,j.delimiter=f.DefaultDelimiter),I.meta.delimiter=j.delimiter),F(j));return j.preview&&j.header&&Ie.preview++,T=me,k=new D(Ie),I=k.parse(T,ye,xe),G(),re?{meta:{paused:!0}}:I||{meta:{paused:!1}}},this.paused=function(){return re},this.pause=function(){re=!0,k.abort(),T=N(j.chunk)?"":T.substring(k.getCharIndex())},this.resume=function(){he.streamer._halted?(re=!1,he.streamer.parseChunk(T,!0)):setTimeout(he.resume,3)},this.aborted=function(){return M},this.abort=function(){M=!0,k.abort(),I.meta.aborted=!0,N(j.complete)&&j.complete(I),T=""},this.guessLineEndings=function(qe,Ie){qe=qe.substring(0,1048576);var Ie=new RegExp(E(Ie)+"([^]*?)"+E(Ie),"gm"),xe=(qe=qe.replace(Ie,"")).split("\r"),Ie=qe.split(`
`),qe=1<Ie.length&&Ie[0].length<xe[0].length;if(xe.length===1||qe)return`
`;for(var st=0,Ke=0;Ke<xe.length;Ke++)xe[Ke][0]===`
`&&st++;return st>=xe.length/2?`\r
`:"\r"}}function E(j){return j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function D(j){var T=(j=j||{}).delimiter,k=j.newline,q=j.comments,B=j.step,Y=j.preview,pe=j.fastMode,we=null,te=!1,he=j.quoteChar==null?'"':j.quoteChar,Q=he;if(j.escapeChar!==void 0&&(Q=j.escapeChar),(typeof T!="string"||-1<f.BAD_DELIMITERS.indexOf(T))&&(T=","),q===T)throw new Error("Comment character same as delimiter");q===!0?q="#":(typeof q!="string"||-1<f.BAD_DELIMITERS.indexOf(q))&&(q=!1),k!==`
`&&k!=="\r"&&k!==`\r
`&&(k=`
`);var W=0,re=!1;this.parse=function(M,b,I){if(typeof M!="string")throw new Error("Input must be a string");var H=M.length,G=T.length,se=k.length,_e=q.length,me=N(B),ye=[],xe=[],Ie=[],qe=W=0;if(!M)return pt();if(pe||pe!==!1&&M.indexOf(he)===-1){for(var st=M.split(k),Ke=0;Ke<st.length;Ke++){if(Ie=st[Ke],W+=Ie.length,Ke!==st.length-1)W+=k.length;else if(I)return pt();if(!q||Ie.substring(0,_e)!==q){if(me){if(ye=[],ut(Ie.split(T)),rr(),re)return pt()}else ut(Ie.split(T));if(Y&&Y<=Ke)return ye=ye.slice(0,Y),pt(!0)}}return pt()}for(var tt=M.indexOf(T,W),$e=M.indexOf(k,W),Fe=new RegExp(E(Q)+E(he),"g"),Qe=M.indexOf(he,W);;)if(M[W]===he)for(Qe=W,W++;;){if((Qe=M.indexOf(he,Qe+1))===-1)return I||xe.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ye.length,index:W}),hr();if(Qe===H-1)return hr(M.substring(W,Qe).replace(Fe,he));if(he===Q&&M[Qe+1]===Q)Qe++;else if(he===Q||Qe===0||M[Qe-1]!==Q){tt!==-1&&tt<Qe+1&&(tt=M.indexOf(T,Qe+1));var ot=qt(($e=$e!==-1&&$e<Qe+1?M.indexOf(k,Qe+1):$e)===-1?tt:Math.min(tt,$e));if(M.substr(Qe+1+ot,G)===T){Ie.push(M.substring(W,Qe).replace(Fe,he)),M[W=Qe+1+ot+G]!==he&&(Qe=M.indexOf(he,W)),tt=M.indexOf(T,W),$e=M.indexOf(k,W);break}if(ot=qt($e),M.substring(Qe+1+ot,Qe+1+ot+se)===k){if(Ie.push(M.substring(W,Qe).replace(Fe,he)),ln(Qe+1+ot+se),tt=M.indexOf(T,W),Qe=M.indexOf(he,W),me&&(rr(),re))return pt();if(Y&&ye.length>=Y)return pt(!0);break}xe.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ye.length,index:W}),Qe++}}else if(q&&Ie.length===0&&M.substring(W,W+_e)===q){if($e===-1)return pt();W=$e+se,$e=M.indexOf(k,W),tt=M.indexOf(T,W)}else if(tt!==-1&&(tt<$e||$e===-1))Ie.push(M.substring(W,tt)),W=tt+G,tt=M.indexOf(T,W);else{if($e===-1)break;if(Ie.push(M.substring(W,$e)),ln($e+se),me&&(rr(),re))return pt();if(Y&&ye.length>=Y)return pt(!0)}return hr();function ut(kt){ye.push(kt),qe=W}function qt(kt){var It=0;return It=kt!==-1&&(kt=M.substring(Qe+1,kt))&&kt.trim()===""?kt.length:It}function hr(kt){return I||(kt===void 0&&(kt=M.substring(W)),Ie.push(kt),W=H,ut(Ie),me&&rr()),pt()}function ln(kt){W=kt,ut(Ie),Ie=[],$e=M.indexOf(k,W)}function pt(kt){if(j.header&&!b&&ye.length&&!te){var It=ye[0],Mt=Object.create(null),ls=new Set(It);let yn=!1;for(let Or=0;Or<It.length;Or++){let Pr=It[Or];if(Mt[Pr=N(j.transformHeader)?j.transformHeader(Pr,Or):Pr]){let _n,cs=Mt[Pr];for(;_n=Pr+"_"+cs,cs++,ls.has(_n););ls.add(_n),It[Or]=_n,Mt[Pr]++,yn=!0,(we=we===null?{}:we)[_n]=Pr}else Mt[Pr]=1,It[Or]=Pr;ls.add(Pr)}yn&&console.warn("Duplicate headers found and renamed."),te=!0}return{data:ye,errors:xe,meta:{delimiter:T,linebreak:k,aborted:re,truncated:!!kt,cursor:qe+(b||0),renamedHeaders:we}}}function rr(){B(pt()),ye=[],xe=[]}},this.abort=function(){re=!0},this.getCharIndex=function(){return W}}function A(j){var T=j.data,k=d[T.workerId],q=!1;if(T.error)k.userError(T.error,T.file);else if(T.results&&T.results.data){var B={abort:function(){q=!0,C(T.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:P,resume:P};if(N(k.userStep)){for(var Y=0;Y<T.results.data.length&&(k.userStep({data:T.results.data[Y],errors:T.results.errors,meta:T.results.meta},B),!q);Y++);delete T.results}else N(k.userChunk)&&(k.userChunk(T.results,B,T.file),delete T.results)}T.finished&&!q&&C(T.workerId,T.results)}function C(j,T){var k=d[j];N(k.userComplete)&&k.userComplete(T),k.terminate(),delete d[j]}function P(){throw new Error("Not implemented.")}function F(j){if(typeof j!="object"||j===null)return j;var T,k=Array.isArray(j)?[]:{};for(T in j)k[T]=F(j[T]);return k}function L(j,T){return function(){j.apply(T,arguments)}}function N(j){return typeof j=="function"}return f.parse=function(j,T){var k=(T=T||{}).dynamicTyping||!1;if(N(k)&&(T.dynamicTypingFunction=k,k={}),T.dynamicTyping=k,T.transform=!!N(T.transform)&&T.transform,!T.worker||!f.WORKERS_SUPPORTED)return k=null,f.NODE_STREAM_INPUT,typeof j=="string"?(j=(q=>q.charCodeAt(0)!==65279?q:q.slice(1))(j),k=new(T.download?g:w)(T)):j.readable===!0&&N(j.read)&&N(j.on)?k=new S(T):(n.File&&j instanceof File||j instanceof Object)&&(k=new v(T)),k.stream(j);(k=(()=>{var q;return!!f.WORKERS_SUPPORTED&&(q=(()=>{var B=n.URL||n.webkitURL||null,Y=r.toString();return f.BLOB_URL||(f.BLOB_URL=B.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Y,")();"],{type:"text/javascript"})))})(),(q=new n.Worker(q)).onmessage=A,q.id=m++,d[q.id]=q)})()).userStep=T.step,k.userChunk=T.chunk,k.userComplete=T.complete,k.userError=T.error,T.step=N(T.step),T.chunk=N(T.chunk),T.complete=N(T.complete),T.error=N(T.error),delete T.worker,k.postMessage({input:j,config:T,workerId:k.id})},f.unparse=function(j,T){var k=!1,q=!0,B=",",Y=`\r
`,pe='"',we=pe+pe,te=!1,he=null,Q=!1,W=((()=>{if(typeof T=="object"){if(typeof T.delimiter!="string"||f.BAD_DELIMITERS.filter(function(b){return T.delimiter.indexOf(b)!==-1}).length||(B=T.delimiter),typeof T.quotes!="boolean"&&typeof T.quotes!="function"&&!Array.isArray(T.quotes)||(k=T.quotes),typeof T.skipEmptyLines!="boolean"&&typeof T.skipEmptyLines!="string"||(te=T.skipEmptyLines),typeof T.newline=="string"&&(Y=T.newline),typeof T.quoteChar=="string"&&(pe=T.quoteChar),typeof T.header=="boolean"&&(q=T.header),Array.isArray(T.columns)){if(T.columns.length===0)throw new Error("Option columns is empty");he=T.columns}T.escapeChar!==void 0&&(we=T.escapeChar+pe),T.escapeFormulae instanceof RegExp?Q=T.escapeFormulae:typeof T.escapeFormulae=="boolean"&&T.escapeFormulae&&(Q=/^[=+\-@\t\r].*$/)}})(),new RegExp(E(pe),"g"));if(typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(j)){if(!j.length||Array.isArray(j[0]))return re(null,j,te);if(typeof j[0]=="object")return re(he||Object.keys(j[0]),j,te)}else if(typeof j=="object")return typeof j.data=="string"&&(j.data=JSON.parse(j.data)),Array.isArray(j.data)&&(j.fields||(j.fields=j.meta&&j.meta.fields||he),j.fields||(j.fields=Array.isArray(j.data[0])?j.fields:typeof j.data[0]=="object"?Object.keys(j.data[0]):[]),Array.isArray(j.data[0])||typeof j.data[0]=="object"||(j.data=[j.data])),re(j.fields||[],j.data||[],te);throw new Error("Unable to serialize unrecognized input");function re(b,I,H){var G="",se=(typeof b=="string"&&(b=JSON.parse(b)),typeof I=="string"&&(I=JSON.parse(I)),Array.isArray(b)&&0<b.length),_e=!Array.isArray(I[0]);if(se&&q){for(var me=0;me<b.length;me++)0<me&&(G+=B),G+=M(b[me],me);0<I.length&&(G+=Y)}for(var ye=0;ye<I.length;ye++){var xe=(se?b:I[ye]).length,Ie=!1,qe=se?Object.keys(I[ye]).length===0:I[ye].length===0;if(H&&!se&&(Ie=H==="greedy"?I[ye].join("").trim()==="":I[ye].length===1&&I[ye][0].length===0),H==="greedy"&&se){for(var st=[],Ke=0;Ke<xe;Ke++){var tt=_e?b[Ke]:Ke;st.push(I[ye][tt])}Ie=st.join("").trim()===""}if(!Ie){for(var $e=0;$e<xe;$e++){0<$e&&!qe&&(G+=B);var Fe=se&&_e?b[$e]:$e;G+=M(I[ye][Fe],$e)}ye<I.length-1&&(!H||0<xe&&!qe)&&(G+=Y)}}return G}function M(b,I){var H,G;return b==null?"":b.constructor===Date?JSON.stringify(b).slice(1,25):(G=!1,Q&&typeof b=="string"&&Q.test(b)&&(b="'"+b,G=!0),H=b.toString().replace(W,we),(G=G||k===!0||typeof k=="function"&&k(b,I)||Array.isArray(k)&&k[I]||((se,_e)=>{for(var me=0;me<_e.length;me++)if(-1<se.indexOf(_e[me]))return!0;return!1})(H,f.BAD_DELIMITERS)||-1<H.indexOf(B)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?pe+H+pe:H)}},f.RECORD_SEP="",f.UNIT_SEP="",f.BYTE_ORDER_MARK="\uFEFF",f.BAD_DELIMITERS=["\r",`
`,'"',f.BYTE_ORDER_MARK],f.WORKERS_SUPPORTED=!l&&!!n.Worker,f.NODE_STREAM_INPUT=1,f.LocalChunkSize=10485760,f.RemoteChunkSize=5242880,f.DefaultDelimiter=",",f.Parser=D,f.ParserHandle=y,f.NetworkStreamer=g,f.FileStreamer=v,f.StringStreamer=w,f.ReadableStreamStreamer=S,n.jQuery&&((i=n.jQuery).fn.parse=function(j){var T=j.config||{},k=[];return this.each(function(Y){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var pe=0;pe<this.files.length;pe++)k.push({file:this.files[pe],inputElem:this,instanceConfig:i.extend({},T)})}),q(),this;function q(){if(k.length===0)N(j.complete)&&j.complete();else{var Y,pe,we,te,he=k[0];if(N(j.before)){var Q=j.before(he.file,he.inputElem);if(typeof Q=="object"){if(Q.action==="abort")return Y="AbortError",pe=he.file,we=he.inputElem,te=Q.reason,void(N(j.error)&&j.error({name:Y},pe,we,te));if(Q.action==="skip")return void B();typeof Q.config=="object"&&(he.instanceConfig=i.extend(he.instanceConfig,Q.config))}else if(Q==="skip")return void B()}var W=he.instanceConfig.complete;he.instanceConfig.complete=function(re){N(W)&&W(re,he.file,he.inputElem),B()},f.parse(he.file,he.instanceConfig)}}function B(){k.splice(0,1),q()}}),c&&(n.onmessage=function(j){j=j.data,f.WORKER_ID===void 0&&j&&(f.WORKER_ID=j.workerId),typeof j.input=="string"?n.postMessage({workerId:f.WORKER_ID,results:f.parse(j.input,j.config),finished:!0}):(n.File&&j.input instanceof File||j.input instanceof Object)&&(j=f.parse(j.input,j.config))&&n.postMessage({workerId:f.WORKER_ID,results:j,finished:!0})}),(g.prototype=Object.create(p.prototype)).constructor=g,(v.prototype=Object.create(p.prototype)).constructor=v,(w.prototype=Object.create(w.prototype)).constructor=w,(S.prototype=Object.create(p.prototype)).constructor=S,f})}(Fc)),Fc.exports}var A3=C3();const O3=tu(A3);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zc={};zc.version="0.18.5";var Og=1252,P3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Pg=function(t){P3.indexOf(t)!=-1&&(Og=t)};function R3(){Pg(1252)}var Ko=function(t){Pg(t)};function F3(){Ko(1200),R3()}var Nc=function(e){return String.fromCharCode(e)},qp=function(e){return String.fromCharCode(e)},Gp,Bs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xo(t){for(var e="",r=0,n=0,i=0,l=0,c=0,d=0,m=0,f=0;f<t.length;)r=t.charCodeAt(f++),l=r>>2,n=t.charCodeAt(f++),c=(r&3)<<4|n>>4,i=t.charCodeAt(f++),d=(n&15)<<2|i>>6,m=i&63,isNaN(n)?d=m=64:isNaN(i)&&(m=64),e+=Bs.charAt(l)+Bs.charAt(c)+Bs.charAt(d)+Bs.charAt(m);return e}function ns(t){var e="",r=0,n=0,i=0,l=0,c=0,d=0,m=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)l=Bs.indexOf(t.charAt(f++)),c=Bs.indexOf(t.charAt(f++)),r=l<<2|c>>4,e+=String.fromCharCode(r),d=Bs.indexOf(t.charAt(f++)),n=(c&15)<<4|d>>2,d!==64&&(e+=String.fromCharCode(n)),m=Bs.indexOf(t.charAt(f++)),i=(d&3)<<6|m,m!==64&&(e+=String.fromCharCode(i));return e}var mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),os=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ea(t){return mt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Kp(t){return mt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var An=function(e){return mt?os(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function ou(t){if(typeof ArrayBuffer>"u")return An(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function al(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function D3(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var vr=mt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:os(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function L3(t){for(var e=[],r=0,n=t.length+250,i=Ea(t.length+255),l=0;l<t.length;++l){var c=t.charCodeAt(l);if(c<128)i[r++]=c;else if(c<2048)i[r++]=192|c>>6&31,i[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var d=t.charCodeAt(++l)&1023;i[r++]=240|c>>8&7,i[r++]=128|c>>2&63,i[r++]=128|d>>6&15|(c&3)<<4,i[r++]=128|d&63}else i[r++]=224|c>>12&15,i[r++]=128|c>>6&63,i[r++]=128|c&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Ea(65535),n=65530)}return e.push(i.slice(0,r)),vr(e)}var Mo=/\u0000/g,bc=/[\u0001-\u0006]/g;function Si(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function On(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}function rh(t,e){var r=""+t;return r.length>=e?r:Ut(" ",e-r.length)+r}function $c(t,e){var r=""+t;return r.length>=e?r:r+Ut(" ",e-r.length)}function I3(t,e){var r=""+Math.round(t);return r.length>=e?r:Ut("0",e-r.length)+r}function M3(t,e){var r=""+t;return r.length>=e?r:Ut("0",e-r.length)+r}var Xp=Math.pow(2,32);function pi(t,e){if(t>Xp||t<-Xp)return I3(t,e);var r=Math.round(t);return M3(r,e)}function Wc(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Jp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ff=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function B3(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var zt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Yp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},U3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Vc(t,e,r){for(var n=t<0?-1:1,i=t*n,l=0,c=1,d=0,m=1,f=0,p=0,g=Math.floor(i);f<e&&(g=Math.floor(i),d=g*c+l,p=g*f+m,!(i-g<5e-8));)i=1/(i-g),l=c,c=d,m=f,f=p;if(p>e&&(f>e?(p=m,d=l):(p=f,d=c)),!r)return[0,n*d,p];var v=Math.floor(n*d/p);return[v,n*d-v*p,p]}function Tc(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),l=0,c=[],d={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),e&&e.date1904&&(n+=1462),d.u>.9999&&(d.u=0,++i==86400&&(d.T=i=0,++n,++d.D)),n===60)c=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),c=[m.getFullYear(),m.getMonth()+1,m.getDate()],l=m.getDay(),n<60&&(l=(l+6)%7),r&&(l=G3(m,c))}return d.y=c[0],d.m=c[1],d.d=c[2],d.S=i%60,i=Math.floor(i/60),d.M=i%60,i=Math.floor(i/60),d.H=i,d.q=l,d}var Rg=new Date(1899,11,31,0,0,0),z3=Rg.getTime(),$3=new Date(1900,2,1,0,0,0);function Fg(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=$3&&(r+=24*60*60*1e3),(r-(z3+(t.getTimezoneOffset()-Rg.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function nh(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function W3(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function V3(t){var e=t<0?12:11,r=nh(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function H3(t){var e=nh(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function q3(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=V3(t):e===10?r=t.toFixed(10).substr(0,12):r=H3(t),nh(W3(r.toUpperCase()))}function If(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):q3(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Hs(14,Fg(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function G3(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function K3(t,e,r,n){var i="",l=0,c=0,d=r.y,m,f=0;switch(t){case 98:d=r.y+543;case 121:switch(e.length){case 1:case 2:m=d%100,f=2;break;default:m=d%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:m=r.m,f=e.length;break;case 3:return ff[r.m-1][1];case 5:return ff[r.m-1][0];default:return ff[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:m=r.d,f=e.length;break;case 3:return Jp[r.q][0];default:return Jp[r.q][1]}break;case 104:switch(e.length){case 1:case 2:m=1+(r.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:m=r.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:m=r.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?On(r.S,e.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(r.S+r.u)),l>=60*c&&(l=0),e==="s"?l===0?"0":""+l/c:(i=On(l,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":m=r.D*24+r.H;break;case"[m]":case"[mm]":m=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":m=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:m=d,f=1;break}var p=f>0?On(m,f):"";return p}function Us(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Dg=/%/g;function X3(t,e,r){var n=e.replace(Dg,""),i=e.length-n.length;return es(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function J3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return es(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Lg(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Lg(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(e/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),r.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,f,p){return m+f+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ig=/# (\?+)( ?)\/( ?)(\d+)/;function Y3(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),l=Math.floor(i/n),c=i-l*n,d=n;return r+(l===0?"":""+l)+" "+(c===0?Ut(" ",t[1].length+1+t[4].length):rh(c,t[1].length)+t[2]+"/"+t[3]+On(d,t[4].length))}function Q3(t,e,r){return r+(e===0?"":""+e)+Ut(" ",t[1].length+2+t[4].length)}var Mg=/^#*0*\.([0#]+)/,Bg=/\).*[0#]/,Ug=/\(###\) ###\\?-####/;function Dr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Qp(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Zp(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Z3(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function eS(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function xn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Bg)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xn("n",n,r):"("+xn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return J3(t,e,r);if(e.indexOf("%")!==-1)return X3(t,e,r);if(e.indexOf("E")!==-1)return Lg(e,r);if(e.charCodeAt(0)===36)return"$"+xn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,l,c,d,m=Math.abs(r),f=r<0?"-":"";if(e.match(/^00+$/))return f+pi(m,e.length);if(e.match(/^[#?]+$/))return i=pi(r,0),i==="0"&&(i=""),i.length>e.length?i:Dr(e.substr(0,e.length-i.length))+i;if(l=e.match(Ig))return Y3(l,m,f);if(e.match(/^#+0+$/))return f+pi(m,e.length-e.indexOf("0"));if(l=e.match(Mg))return i=Qp(r,l[1].length).replace(/^([^\.]+)$/,"$1."+Dr(l[1])).replace(/\.$/,"."+Dr(l[1])).replace(/\.(\d*)$/,function(S,y){return"."+y+Ut("0",Dr(l[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return f+Qp(m,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return f+Us(pi(m,0));if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xn(t,e,-r):Us(""+(Math.floor(r)+Z3(r,l[1].length)))+"."+On(Zp(r,l[1].length),l[1].length);if(l=e.match(/^#,#*,#0/))return xn(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Si(xn(t,e.replace(/[\\-]/g,""),r)),c=0,Si(Si(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<i.length?i.charAt(c++):S==="0"?"0":""}));if(e.match(Ug))return i=xn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),d=Vc(m,Math.pow(10,c)-1,!1),i=""+f,p=es("n",l[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=$c(d[2],c),p.length<l[4].length&&(p=Dr(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),d=Vc(m,Math.pow(10,c)-1,!0),f+(d[0]||(d[1]?"":"0"))+" "+(d[1]?rh(d[1],c)+l[2]+"/"+l[3]+$c(d[2],c):Ut(" ",2*c+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return i=pi(r,0),e.length<=i.length?i:Dr(e.substr(0,e.length-i.length))+i;if(l=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var g=e.indexOf(".")-c,v=e.length-i.length-g;return Dr(e.substr(0,g)+i+e.substr(e.length-v))}if(l=e.match(/^00,000\.([#0]*0)$/))return c=Zp(r,l[1].length),r<0?"-"+xn(t,e,-r):Us(eS(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?On(0,3-S.length):"")+S})+"."+On(c,l[1].length);switch(e){case"###,##0.00":return xn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=Us(pi(m,0));return w!=="0"?f+w:"";case"###,###.00":return xn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function tS(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return es(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function rS(t,e,r){var n=e.replace(Dg,""),i=e.length-n.length;return es(t,n,r*Math.pow(10,2*i))+Ut("%",i)}function zg(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+zg(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%i;if(l<0&&(l+=i),r=(e/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),!r.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,f,p){return m+f+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Bn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Bg)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bn("n",n,r):"("+Bn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return tS(t,e,r);if(e.indexOf("%")!==-1)return rS(t,e,r);if(e.indexOf("E")!==-1)return zg(e,r);if(e.charCodeAt(0)===36)return"$"+Bn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,l,c,d,m=Math.abs(r),f=r<0?"-":"";if(e.match(/^00+$/))return f+On(m,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Dr(e.substr(0,e.length-i.length))+i;if(l=e.match(Ig))return Q3(l,m,f);if(e.match(/^#+0+$/))return f+On(m,e.length-e.indexOf("0"));if(l=e.match(Mg))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Dr(l[1])).replace(/\.$/,"."+Dr(l[1])),i=i.replace(/\.(\d*)$/,function(S,y){return"."+y+Ut("0",Dr(l[1]).length-y.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return f+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return f+Us(""+m);if(l=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bn(t,e,-r):Us(""+r)+"."+Ut("0",l[1].length);if(l=e.match(/^#,#*,#0/))return Bn(t,e.replace(/^#,#*,/,""),r);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Si(Bn(t,e.replace(/[\\-]/g,""),r)),c=0,Si(Si(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<i.length?i.charAt(c++):S==="0"?"0":""}));if(e.match(Ug))return i=Bn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),d=Vc(m,Math.pow(10,c)-1,!1),i=""+f,p=es("n",l[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=$c(d[2],c),p.length<l[4].length&&(p=Dr(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),d=Vc(m,Math.pow(10,c)-1,!0),f+(d[0]||(d[1]?"":"0"))+" "+(d[1]?rh(d[1],c)+l[2]+"/"+l[3]+$c(d[2],c):Ut(" ",2*c+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Dr(e.substr(0,e.length-i.length))+i;if(l=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var g=e.indexOf(".")-c,v=e.length-i.length-g;return Dr(e.substr(0,g)+i+e.substr(e.length-v))}if(l=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Bn(t,e,-r):Us(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?On(0,3-S.length):"")+S})+"."+On(0,l[1].length);switch(e){case"###,###":case"##,###":case"#,###":var w=Us(""+m);return w!=="0"?f+w:"";default:if(e.match(/\.[0#?]*$/))return Bn(t,e.slice(0,e.lastIndexOf(".")),r)+Dr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function es(t,e,r){return(r|0)===r?Bn(t,e,r):xn(t,e,r)}function nS(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var $g=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wg(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Wc(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match($g))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function sS(t,e,r,n){for(var i=[],l="",c=0,d="",m="t",f,p,g,v="H";c<t.length;)switch(d=t.charAt(c)){case"G":if(!Wc(t,c))throw new Error("unrecognized character "+d+" in "+t);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(g=t.charCodeAt(++c))!==34&&c<t.length;)l+=String.fromCharCode(g);i[i.length]={t:"t",v:l},++c;break;case"\\":var w=t.charAt(++c),S=w==="("||w===")"?w:"t";i[i.length]={t:S,v:w},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:e},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(f==null&&(f=Tc(e,r,t.charAt(c+1)==="2"),f==null))return"";i[i.length]={t:"X",v:t.substr(c,2)},m=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=Tc(e,r),f==null))return"";for(l=d;++c<t.length&&t.charAt(c).toLowerCase()===d;)l+=d;d==="m"&&m.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=v),i[i.length]={t:d,v:l},m=d;break;case"A":case"a":case"":var y={t:d,v:d};if(f==null&&(f=Tc(e,r)),t.substr(c,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",v="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",c+=5,v="h"):t.substr(c,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",c+=5,v="h"):(y.t="t",++c),f==null&&y.t==="T")return"";i[i.length]=y,m=d;break;case"[":for(l=d;t.charAt(c++)!=="]"&&c<t.length;)l+=t.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match($g)){if(f==null&&(f=Tc(e,r),f==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},m=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wg(t)||(i[i.length]={t:"t",v:l}));break;case".":if(f!=null){for(l=d;++c<t.length&&(d=t.charAt(c))==="0";)l+=d;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<t.length&&"0#?.,E+-%".indexOf(d=t.charAt(c))>-1;)l+=d;i[i.length]={t:"n",v:l};break;case"?":for(l=d;t.charAt(++c)===d;)l+=d;i[i.length]={t:d,v:l},m=d;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:n===1?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)l+=t.charAt(c);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:d,v:d},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+t);i[i.length]={t:"t",v:d},++c;break}var E=0,D=0,A;for(c=i.length-1,m="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=v,m="h",E<1&&(E=1);break;case"s":(A=i[c].v.match(/\.0+$/))&&(D=Math.max(D,A[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":m=i[c].t;break;case"m":m==="s"&&(i[c].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[c].v.match(/[Hh]/)&&(E=1),E<2&&i[c].v.match(/[Mm]/)&&(E=2),E<3&&i[c].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var C="",P;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=K3(i[c].t.charCodeAt(0),i[c].v,f,D),i[c].t="t";break;case"n":case"?":for(P=c+1;i[P]!=null&&((d=i[P].t)==="?"||d==="D"||(d===" "||d==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[c].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[c].v+=i[P].v,i[P]={v:"",t:";"},++P;C+=i[c].v,c=P-1;break;case"G":i[c].t="t",i[c].v=If(e,r);break}var F="",L,N;if(C.length>0){C.charCodeAt(0)==40?(L=e<0&&C.charCodeAt(0)===45?-e:e,N=es("n",C,L)):(L=e<0&&n>1?-e:e,N=es("n",C,L),L<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),P=N.length-1;var j=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){j=c;break}var T=i.length;if(j===i.length&&N.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(P>=i[c].v.length-1?(P-=i[c].v.length,i[c].v=N.substr(P+1,i[c].v.length)):P<0?i[c].v="":(i[c].v=N.substr(0,P+1),P=-1),i[c].t="t",T=c);P>=0&&T<i.length&&(i[T].v=N.substr(0,P+1)+i[T].v)}else if(j!==i.length&&N.indexOf("E")===-1){for(P=N.indexOf(".")-1,c=j;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(p=i[c].v.indexOf(".")>-1&&c===j?i[c].v.indexOf(".")-1:i[c].v.length-1,F=i[c].v.substr(p+1);p>=0;--p)P>=0&&(i[c].v.charAt(p)==="0"||i[c].v.charAt(p)==="#")&&(F=N.charAt(P--)+F);i[c].v=F,i[c].t="t",T=c}for(P>=0&&T<i.length&&(i[T].v=N.substr(0,P+1)+i[T].v),P=N.indexOf(".")+1,c=j;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==j)){for(p=i[c].v.indexOf(".")>-1&&c===j?i[c].v.indexOf(".")+1:0,F=i[c].v.substr(0,p);p<i[c].v.length;++p)P<N.length&&(F+=N.charAt(P++));i[c].v=F,i[c].t="t",T=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(L=n>1&&e<0&&c>0&&i[c-1].v==="-"?-e:e,i[c].v=es(i[c].t,i[c].v,L),i[c].t="t");var k="";for(c=0;c!==i.length;++c)i[c]!=null&&(k+=i[c].v);return k}var ex=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tx(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function aS(t,e){var r=nS(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(ex),d=r[1].match(ex);return tx(e,c)?[n,r[0]]:tx(e,d)?[n,r[1]]:[n,r[c!=null&&d!=null?2:1]]}return[n,l]}function Hs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:zt)[t],n==null&&(n=r.table&&r.table[Yp[t]]||zt[Yp[t]]),n==null&&(n=U3[t]||"General");break}if(Wc(n,0))return If(e,r);e instanceof Date&&(e=Fg(e,r.date1904));var i=aS(n,e);if(Wc(i[1]))return If(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return sS(i[1],e,r,i[0])}function Vg(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(zt[r]==null){e<0&&(e=r);continue}if(zt[r]==t){e=r;break}}e<0&&(e=391)}return zt[e]=t,e}function lu(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Vg(t[e],e)}function cu(){zt=B3()}var Hg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iS(t){var e=typeof t=="number"?zt[t]:t;return e=e.replace(Hg,"(\\d+)"),new RegExp("^"+e+"$")}function oS(t,e,r){var n=-1,i=-1,l=-1,c=-1,d=-1,m=-1;(e.match(Hg)||[]).forEach(function(g,v){var w=parseInt(r[v+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=w;break;case"d":l=w;break;case"h":c=w;break;case"s":m=w;break;case"m":c>=0?d=w:i=w;break}}),m>=0&&d==-1&&i>=0&&(d=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return c==-1&&d==-1&&m==-1?f:n==-1&&i==-1&&l==-1?p:f+"T"+p}var lS=function(){var t={};t.version="1.2.0";function e(){for(var N=0,j=new Array(256),T=0;T!=256;++T)N=T,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,j[T]=N;return typeof Int32Array<"u"?new Int32Array(j):j}var r=e();function n(N){var j=0,T=0,k=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(k=0;k!=256;++k)q[k]=N[k];for(k=0;k!=256;++k)for(T=N[k],j=256+k;j<4096;j+=256)T=q[j]=T>>>8^N[T&255];var B=[];for(k=1;k!=16;++k)B[k-1]=typeof Int32Array<"u"?q.subarray(k*256,k*256+256):q.slice(k*256,k*256+256);return B}var i=n(r),l=i[0],c=i[1],d=i[2],m=i[3],f=i[4],p=i[5],g=i[6],v=i[7],w=i[8],S=i[9],y=i[10],E=i[11],D=i[12],A=i[13],C=i[14];function P(N,j){for(var T=j^-1,k=0,q=N.length;k<q;)T=T>>>8^r[(T^N.charCodeAt(k++))&255];return~T}function F(N,j){for(var T=j^-1,k=N.length-15,q=0;q<k;)T=C[N[q++]^T&255]^A[N[q++]^T>>8&255]^D[N[q++]^T>>16&255]^E[N[q++]^T>>>24]^y[N[q++]]^S[N[q++]]^w[N[q++]]^v[N[q++]]^g[N[q++]]^p[N[q++]]^f[N[q++]]^m[N[q++]]^d[N[q++]]^c[N[q++]]^l[N[q++]]^r[N[q++]];for(k+=15;q<k;)T=T>>>8^r[(T^N[q++])&255];return~T}function L(N,j){for(var T=j^-1,k=0,q=N.length,B=0,Y=0;k<q;)B=N.charCodeAt(k++),B<128?T=T>>>8^r[(T^B)&255]:B<2048?(T=T>>>8^r[(T^(192|B>>6&31))&255],T=T>>>8^r[(T^(128|B&63))&255]):B>=55296&&B<57344?(B=(B&1023)+64,Y=N.charCodeAt(k++)&1023,T=T>>>8^r[(T^(240|B>>8&7))&255],T=T>>>8^r[(T^(128|B>>2&63))&255],T=T>>>8^r[(T^(128|Y>>6&15|(B&3)<<4))&255],T=T>>>8^r[(T^(128|Y&63))&255]):(T=T>>>8^r[(T^(224|B>>12&15))&255],T=T>>>8^r[(T^(128|B>>6&63))&255],T=T>>>8^r[(T^(128|B&63))&255]);return~T}return t.table=r,t.bstr=P,t.buf=F,t.str=L,t}(),wt=function(){var e={};e.version="1.2.1";function r(R,K){for(var z=R.split("/"),V=K.split("/"),X=0,J=0,le=Math.min(z.length,V.length);X<le;++X){if(J=z[X].length-V[X].length)return J;if(z[X]!=V[X])return z[X]<V[X]?-1:1}return z.length-V.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var K=R.lastIndexOf("/");return K===-1?R:R.slice(0,K+1)}function i(R){if(R.charAt(R.length-1)=="/")return i(R.slice(0,-1));var K=R.lastIndexOf("/");return K===-1?R:R.slice(K+1)}function l(R,K){typeof K=="string"&&(K=new Date(K));var z=K.getHours();z=z<<6|K.getMinutes(),z=z<<5|K.getSeconds()>>>1,R.write_shift(2,z);var V=K.getFullYear()-1980;V=V<<4|K.getMonth()+1,V=V<<5|K.getDate(),R.write_shift(2,V)}function c(R){var K=R.read_shift(2)&65535,z=R.read_shift(2)&65535,V=new Date,X=z&31;z>>>=5;var J=z&15;z>>>=4,V.setMilliseconds(0),V.setFullYear(z+1980),V.setMonth(J-1),V.setDate(X);var le=K&31;K>>>=5;var ve=K&63;return K>>>=6,V.setHours(K),V.setMinutes(ve),V.setSeconds(le<<1),V}function d(R){tn(R,0);for(var K={},z=0;R.l<=R.length-4;){var V=R.read_shift(2),X=R.read_shift(2),J=R.l+X,le={};switch(V){case 21589:z=R.read_shift(1),z&1&&(le.mtime=R.read_shift(4)),X>5&&(z&2&&(le.atime=R.read_shift(4)),z&4&&(le.ctime=R.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}R.l=J,K[V]=le}return K}var m;function f(){return m||(m={})}function p(R,K){if(R[0]==80&&R[1]==75)return Da(R,K);if((R[0]|32)==109&&(R[1]|32)==105)return xl(R,K);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var z=3,V=512,X=0,J=0,le=0,ve=0,oe=0,ce=[],de=R.slice(0,512);tn(de,0);var Ne=g(de);switch(z=Ne[0],z){case 3:V=512;break;case 4:V=4096;break;case 0:if(Ne[1]==0)return Da(R,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}V!==512&&(de=R.slice(0,V),tn(de,28));var Le=R.slice(0,V);v(de,z);var Be=de.read_shift(4,"i");if(z===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);de.l+=4,le=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),ve=de.read_shift(4,"i"),X=de.read_shift(4,"i"),oe=de.read_shift(4,"i"),J=de.read_shift(4,"i");for(var ke=-1,Te=0;Te<109&&(ke=de.read_shift(4,"i"),!(ke<0));++Te)ce[Te]=ke;var Ze=w(R,V);E(oe,J,Ze,V,ce);var St=A(Ze,le,ce,V);St[le].name="!Directory",X>0&&ve!==Y&&(St[ve].name="!MiniFAT"),St[ce[0]].name="!FAT",St.fat_addrs=ce,St.ssz=V;var Et={},$t=[],na=[],fs=[];C(le,St,Ze,$t,X,Et,na,ve),S(na,fs,$t),$t.shift();var Rn={FileIndex:na,FullPaths:fs};return K&&K.raw&&(Rn.raw={header:Le,sectors:Ze}),Rn}function g(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(pe,"Header Signature: "),R.l+=16;var K=R.read_shift(2,"u");return[R.read_shift(2,"u"),K]}function v(R,K){var z=9;switch(R.l+=2,z=R.read_shift(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function w(R,K){for(var z=Math.ceil(R.length/K)-1,V=[],X=1;X<z;++X)V[X-1]=R.slice(X*K,(X+1)*K);return V[z-1]=R.slice(z*K),V}function S(R,K,z){for(var V=0,X=0,J=0,le=0,ve=0,oe=z.length,ce=[],de=[];V<oe;++V)ce[V]=de[V]=V,K[V]=z[V];for(;ve<de.length;++ve)V=de[ve],X=R[V].L,J=R[V].R,le=R[V].C,ce[V]===V&&(X!==-1&&ce[X]!==X&&(ce[V]=ce[X]),J!==-1&&ce[J]!==J&&(ce[V]=ce[J])),le!==-1&&(ce[le]=V),X!==-1&&V!=ce[V]&&(ce[X]=ce[V],de.lastIndexOf(X)<ve&&de.push(X)),J!==-1&&V!=ce[V]&&(ce[J]=ce[V],de.lastIndexOf(J)<ve&&de.push(J));for(V=1;V<oe;++V)ce[V]===V&&(J!==-1&&ce[J]!==J?ce[V]=ce[J]:X!==-1&&ce[X]!==X&&(ce[V]=ce[X]));for(V=1;V<oe;++V)if(R[V].type!==0){if(ve=V,ve!=ce[ve])do ve=ce[ve],K[V]=K[ve]+"/"+K[V];while(ve!==0&&ce[ve]!==-1&&ve!=ce[ve]);ce[V]=-1}for(K[0]+="/",V=1;V<oe;++V)R[V].type!==2&&(K[V]+="/")}function y(R,K,z){for(var V=R.start,X=R.size,J=[],le=V;z&&X>0&&le>=0;)J.push(K.slice(le*B,le*B+B)),X-=B,le=_a(z,le*4);return J.length===0?ge(0):vr(J).slice(0,R.size)}function E(R,K,z,V,X){var J=Y;if(R===Y){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var le=z[R],ve=(V>>>2)-1;if(!le)return;for(var oe=0;oe<ve&&(J=_a(le,oe*4))!==Y;++oe)X.push(J);E(_a(le,V-4),K-1,z,V,X)}}function D(R,K,z,V,X){var J=[],le=[];X||(X=[]);var ve=V-1,oe=0,ce=0;for(oe=K;oe>=0;){X[oe]=!0,J[J.length]=oe,le.push(R[oe]);var de=z[Math.floor(oe*4/V)];if(ce=oe*4&ve,V<4+ce)throw new Error("FAT boundary crossed: "+oe+" 4 "+V);if(!R[de])break;oe=_a(R[de],ce)}return{nodes:J,data:cx([le])}}function A(R,K,z,V){var X=R.length,J=[],le=[],ve=[],oe=[],ce=V-1,de=0,Ne=0,Le=0,Be=0;for(de=0;de<X;++de)if(ve=[],Le=de+K,Le>=X&&(Le-=X),!le[Le]){oe=[];var ke=[];for(Ne=Le;Ne>=0;){ke[Ne]=!0,le[Ne]=!0,ve[ve.length]=Ne,oe.push(R[Ne]);var Te=z[Math.floor(Ne*4/V)];if(Be=Ne*4&ce,V<4+Be)throw new Error("FAT boundary crossed: "+Ne+" 4 "+V);if(!R[Te]||(Ne=_a(R[Te],Be),ke[Ne]))break}J[Le]={nodes:ve,data:cx([oe])}}return J}function C(R,K,z,V,X,J,le,ve){for(var oe=0,ce=V.length?2:0,de=K[R].data,Ne=0,Le=0,Be;Ne<de.length;Ne+=128){var ke=de.slice(Ne,Ne+128);tn(ke,64),Le=ke.read_shift(2),Be=lh(ke,0,Le-ce),V.push(Be);var Te={name:Be,type:ke.read_shift(1),color:ke.read_shift(1),L:ke.read_shift(4,"i"),R:ke.read_shift(4,"i"),C:ke.read_shift(4,"i"),clsid:ke.read_shift(16),state:ke.read_shift(4,"i"),start:0,size:0},Ze=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);Ze!==0&&(Te.ct=P(ke,ke.l-8));var St=ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2)+ke.read_shift(2);St!==0&&(Te.mt=P(ke,ke.l-8)),Te.start=ke.read_shift(4,"i"),Te.size=ke.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=Y,Te.name=""),Te.type===5?(oe=Te.start,X>0&&oe!==Y&&(K[oe].name="!StreamData")):Te.size>=4096?(Te.storage="fat",K[Te.start]===void 0&&(K[Te.start]=D(z,Te.start,K.fat_addrs,K.ssz)),K[Te.start].name=Te.name,Te.content=K[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:oe!==Y&&Te.start!==Y&&K[oe]&&(Te.content=y(Te,K[oe].data,(K[ve]||{}).data))),Te.content&&tn(Te.content,0),J[Be]=Te,le.push(Te)}}function P(R,K){return new Date((nn(R,K+4)/1e7*Math.pow(2,32)+nn(R,K)/1e7-11644473600)*1e3)}function F(R,K){return f(),p(m.readFileSync(R),K)}function L(R,K){var z=K&&K.type;switch(z||mt&&Buffer.isBuffer(R)&&(z="buffer"),z||"base64"){case"file":return F(R,K);case"base64":return p(An(ns(R)),K);case"binary":return p(An(R),K)}return p(R,K)}function N(R,K){var z=K||{},V=z.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=V+"/",R.FileIndex[0]={name:V,type:5}),z.CLSID&&(R.FileIndex[0].clsid=z.CLSID),j(R)}function j(R){var K="Sh33tJ5";if(!wt.find(R,"/"+K)){var z=ge(4);z[0]=55,z[1]=z[3]=50,z[2]=54,R.FileIndex.push({name:K,type:2,content:z,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+K),T(R)}}function T(R,K){N(R);for(var z=!1,V=!1,X=R.FullPaths.length-1;X>=0;--X){var J=R.FileIndex[X];switch(J.type){case 0:V?z=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(J.R*J.L*J.C)&&(z=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!K)){var le=new Date(1987,1,19),ve=0,oe=Object.create?Object.create(null):{},ce=[];for(X=0;X<R.FullPaths.length;++X)oe[R.FullPaths[X]]=!0,R.FileIndex[X].type!==0&&ce.push([R.FullPaths[X],R.FileIndex[X]]);for(X=0;X<ce.length;++X){var de=n(ce[X][0]);V=oe[de],V||(ce.push([de,{name:i(de).replace("/",""),type:1,clsid:te,ct:le,mt:le,content:null}]),oe[de]=!0)}for(ce.sort(function(Be,ke){return r(Be[0],ke[0])}),R.FullPaths=[],R.FileIndex=[],X=0;X<ce.length;++X)R.FullPaths[X]=ce[X][0],R.FileIndex[X]=ce[X][1];for(X=0;X<ce.length;++X){var Ne=R.FileIndex[X],Le=R.FullPaths[X];if(Ne.name=i(Le).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||te,X===0)Ne.C=ce.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Le.slice(-1)=="/"){for(ve=X+1;ve<ce.length&&n(R.FullPaths[ve])!=Le;++ve);for(Ne.C=ve>=ce.length?-1:ve,ve=X+1;ve<ce.length&&n(R.FullPaths[ve])!=n(Le);++ve);Ne.R=ve>=ce.length?-1:ve,Ne.type=1}else n(R.FullPaths[X+1]||"")==n(Le)&&(Ne.R=X+1),Ne.type=2}}}function k(R,K){var z=K||{};if(z.fileType=="mad")return ta(R,z);switch(T(R),z.fileType){case"zip":return ds(R,z)}var V=function(Be){for(var ke=0,Te=0,Ze=0;Ze<Be.FileIndex.length;++Ze){var St=Be.FileIndex[Ze];if(St.content){var Et=St.content.length;Et>0&&(Et<4096?ke+=Et+63>>6:Te+=Et+511>>9)}}for(var $t=Be.FullPaths.length+3>>2,na=ke+7>>3,fs=ke+127>>7,Rn=na+Te+$t+fs,nr=Rn+127>>7,Vi=nr<=109?0:Math.ceil((nr-109)/127);Rn+nr+Vi+127>>7>nr;)Vi=++nr<=109?0:Math.ceil((nr-109)/127);var Wt=[1,Vi,nr,fs,$t,Te,ke,0];return Be.FileIndex[0].size=ke<<6,Wt[7]=(Be.FileIndex[0].start=Wt[0]+Wt[1]+Wt[2]+Wt[3]+Wt[4]+Wt[5])+(Wt[6]+7>>3),Wt}(R),X=ge(V[7]<<9),J=0,le=0;{for(J=0;J<8;++J)X.write_shift(1,we[J]);for(J=0;J<8;++J)X.write_shift(2,0);for(X.write_shift(2,62),X.write_shift(2,3),X.write_shift(2,65534),X.write_shift(2,9),X.write_shift(2,6),J=0;J<3;++J)X.write_shift(2,0);for(X.write_shift(4,0),X.write_shift(4,V[2]),X.write_shift(4,V[0]+V[1]+V[2]+V[3]-1),X.write_shift(4,0),X.write_shift(4,4096),X.write_shift(4,V[3]?V[0]+V[1]+V[2]-1:Y),X.write_shift(4,V[3]),X.write_shift(-4,V[1]?V[0]-1:Y),X.write_shift(4,V[1]),J=0;J<109;++J)X.write_shift(-4,J<V[2]?V[1]+J:-1)}if(V[1])for(le=0;le<V[1];++le){for(;J<236+le*127;++J)X.write_shift(-4,J<V[2]?V[1]+J:-1);X.write_shift(-4,le===V[1]-1?Y:le+1)}var ve=function(Be){for(le+=Be;J<le-1;++J)X.write_shift(-4,J+1);Be&&(++J,X.write_shift(-4,Y))};for(le=J=0,le+=V[1];J<le;++J)X.write_shift(-4,he.DIFSECT);for(le+=V[2];J<le;++J)X.write_shift(-4,he.FATSECT);ve(V[3]),ve(V[4]);for(var oe=0,ce=0,de=R.FileIndex[0];oe<R.FileIndex.length;++oe)de=R.FileIndex[oe],de.content&&(ce=de.content.length,!(ce<4096)&&(de.start=le,ve(ce+511>>9)));for(ve(V[6]+7>>3);X.l&511;)X.write_shift(-4,he.ENDOFCHAIN);for(le=J=0,oe=0;oe<R.FileIndex.length;++oe)de=R.FileIndex[oe],de.content&&(ce=de.content.length,!(!ce||ce>=4096)&&(de.start=le,ve(ce+63>>6)));for(;X.l&511;)X.write_shift(-4,he.ENDOFCHAIN);for(J=0;J<V[4]<<2;++J){var Ne=R.FullPaths[J];if(!Ne||Ne.length===0){for(oe=0;oe<17;++oe)X.write_shift(4,0);for(oe=0;oe<3;++oe)X.write_shift(4,-1);for(oe=0;oe<12;++oe)X.write_shift(4,0);continue}de=R.FileIndex[J],J===0&&(de.start=de.size?de.start-1:Y);var Le=J===0&&z.root||de.name;if(ce=2*(Le.length+1),X.write_shift(64,Le,"utf16le"),X.write_shift(2,ce),X.write_shift(1,de.type),X.write_shift(1,de.color),X.write_shift(-4,de.L),X.write_shift(-4,de.R),X.write_shift(-4,de.C),de.clsid)X.write_shift(16,de.clsid,"hex");else for(oe=0;oe<4;++oe)X.write_shift(4,0);X.write_shift(4,de.state||0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,0),X.write_shift(4,de.start),X.write_shift(4,de.size),X.write_shift(4,0)}for(J=1;J<R.FileIndex.length;++J)if(de=R.FileIndex[J],de.size>=4096)if(X.l=de.start+1<<9,mt&&Buffer.isBuffer(de.content))de.content.copy(X,X.l,0,de.size),X.l+=de.size+511&-512;else{for(oe=0;oe<de.size;++oe)X.write_shift(1,de.content[oe]);for(;oe&511;++oe)X.write_shift(1,0)}for(J=1;J<R.FileIndex.length;++J)if(de=R.FileIndex[J],de.size>0&&de.size<4096)if(mt&&Buffer.isBuffer(de.content))de.content.copy(X,X.l,0,de.size),X.l+=de.size+63&-64;else{for(oe=0;oe<de.size;++oe)X.write_shift(1,de.content[oe]);for(;oe&63;++oe)X.write_shift(1,0)}if(mt)X.l=X.length;else for(;X.l<X.length;)X.write_shift(1,0);return X}function q(R,K){var z=R.FullPaths.map(function(oe){return oe.toUpperCase()}),V=z.map(function(oe){var ce=oe.split("/");return ce[ce.length-(oe.slice(-1)=="/"?2:1)]}),X=!1;K.charCodeAt(0)===47?(X=!0,K=z[0].slice(0,-1)+K):X=K.indexOf("/")!==-1;var J=K.toUpperCase(),le=X===!0?z.indexOf(J):V.indexOf(J);if(le!==-1)return R.FileIndex[le];var ve=!J.match(bc);for(J=J.replace(Mo,""),ve&&(J=J.replace(bc,"!")),le=0;le<z.length;++le)if((ve?z[le].replace(bc,"!"):z[le]).replace(Mo,"")==J||(ve?V[le].replace(bc,"!"):V[le]).replace(Mo,"")==J)return R.FileIndex[le];return null}var B=64,Y=-2,pe="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],te="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(R,K,z){f();var V=k(R,z);m.writeFileSync(K,V)}function W(R){for(var K=new Array(R.length),z=0;z<R.length;++z)K[z]=String.fromCharCode(R[z]);return K.join("")}function re(R,K){var z=k(R,K);switch(K&&K.type||"buffer"){case"file":return f(),m.writeFileSync(K.filename,z),z;case"binary":return typeof z=="string"?z:W(z);case"base64":return Xo(typeof z=="string"?z:W(z));case"buffer":if(mt)return Buffer.isBuffer(z)?z:os(z);case"array":return typeof z=="string"?An(z):z}return z}var M;function b(R){try{var K=R.InflateRaw,z=new K;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)M=R;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function I(R,K){if(!M)return Ra(R,K);var z=M.InflateRaw,V=new z,X=V._processChunk(R.slice(R.l),V._finishFlushFlag);return R.l+=V.bytesRead,X}function H(R){return M?M.deflateRawSync(R):yn(R)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(R){var K=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(K>>16|K>>8|K)&255}for(var ye=typeof Uint8Array<"u",xe=ye?new Uint8Array(256):[],Ie=0;Ie<256;++Ie)xe[Ie]=me(Ie);function qe(R,K){var z=xe[R&255];return K<=8?z>>>8-K:(z=z<<8|xe[R>>8&255],K<=16?z>>>16-K:(z=z<<8|xe[R>>16&255],z>>>24-K))}function st(R,K){var z=K&7,V=K>>>3;return(R[V]|(z<=6?0:R[V+1]<<8))>>>z&3}function Ke(R,K){var z=K&7,V=K>>>3;return(R[V]|(z<=5?0:R[V+1]<<8))>>>z&7}function tt(R,K){var z=K&7,V=K>>>3;return(R[V]|(z<=4?0:R[V+1]<<8))>>>z&15}function $e(R,K){var z=K&7,V=K>>>3;return(R[V]|(z<=3?0:R[V+1]<<8))>>>z&31}function Fe(R,K){var z=K&7,V=K>>>3;return(R[V]|(z<=1?0:R[V+1]<<8))>>>z&127}function Qe(R,K,z){var V=K&7,X=K>>>3,J=(1<<z)-1,le=R[X]>>>V;return z<8-V||(le|=R[X+1]<<8-V,z<16-V)||(le|=R[X+2]<<16-V,z<24-V)||(le|=R[X+3]<<24-V),le&J}function ot(R,K,z){var V=K&7,X=K>>>3;return V<=5?R[X]|=(z&7)<<V:(R[X]|=z<<V&255,R[X+1]=(z&7)>>8-V),K+3}function ut(R,K,z){var V=K&7,X=K>>>3;return z=(z&1)<<V,R[X]|=z,K+1}function qt(R,K,z){var V=K&7,X=K>>>3;return z<<=V,R[X]|=z&255,z>>>=8,R[X+1]=z,K+8}function hr(R,K,z){var V=K&7,X=K>>>3;return z<<=V,R[X]|=z&255,z>>>=8,R[X+1]=z&255,R[X+2]=z>>>8,K+16}function ln(R,K){var z=R.length,V=2*z>K?2*z:K+5,X=0;if(z>=K)return R;if(mt){var J=Kp(V);if(R.copy)R.copy(J);else for(;X<R.length;++X)J[X]=R[X];return J}else if(ye){var le=new Uint8Array(V);if(le.set)le.set(R);else for(;X<z;++X)le[X]=R[X];return le}return R.length=V,R}function pt(R){for(var K=new Array(R),z=0;z<R;++z)K[z]=0;return K}function rr(R,K,z){var V=1,X=0,J=0,le=0,ve=0,oe=R.length,ce=ye?new Uint16Array(32):pt(32);for(J=0;J<32;++J)ce[J]=0;for(J=oe;J<z;++J)R[J]=0;oe=R.length;var de=ye?new Uint16Array(oe):pt(oe);for(J=0;J<oe;++J)ce[X=R[J]]++,V<X&&(V=X),de[J]=0;for(ce[0]=0,J=1;J<=V;++J)ce[J+16]=ve=ve+ce[J-1]<<1;for(J=0;J<oe;++J)ve=R[J],ve!=0&&(de[J]=ce[ve+16]++);var Ne=0;for(J=0;J<oe;++J)if(Ne=R[J],Ne!=0)for(ve=qe(de[J],V)>>V-Ne,le=(1<<V+4-Ne)-1;le>=0;--le)K[ve|le<<Ne]=Ne&15|J<<4;return V}var kt=ye?new Uint16Array(512):pt(512),It=ye?new Uint16Array(32):pt(32);if(!ye){for(var Mt=0;Mt<512;++Mt)kt[Mt]=0;for(Mt=0;Mt<32;++Mt)It[Mt]=0}(function(){for(var R=[],K=0;K<32;K++)R.push(5);rr(R,It,32);var z=[];for(K=0;K<=143;K++)z.push(8);for(;K<=255;K++)z.push(9);for(;K<=279;K++)z.push(7);for(;K<=287;K++)z.push(8);rr(z,kt,288)})();var ls=function(){for(var K=ye?new Uint8Array(32768):[],z=0,V=0;z<_e.length-1;++z)for(;V<_e[z+1];++V)K[V]=z;for(;V<32768;++V)K[V]=29;var X=ye?new Uint8Array(259):[];for(z=0,V=0;z<se.length-1;++z)for(;V<se[z+1];++V)X[V]=z;function J(ve,oe){for(var ce=0;ce<ve.length;){var de=Math.min(65535,ve.length-ce),Ne=ce+de==ve.length;for(oe.write_shift(1,+Ne),oe.write_shift(2,de),oe.write_shift(2,~de&65535);de-- >0;)oe[oe.l++]=ve[ce++]}return oe.l}function le(ve,oe){for(var ce=0,de=0,Ne=ye?new Uint16Array(32768):[];de<ve.length;){var Le=Math.min(65535,ve.length-de);if(Le<10){for(ce=ot(oe,ce,+(de+Le==ve.length)),ce&7&&(ce+=8-(ce&7)),oe.l=ce/8|0,oe.write_shift(2,Le),oe.write_shift(2,~Le&65535);Le-- >0;)oe[oe.l++]=ve[de++];ce=oe.l*8;continue}ce=ot(oe,ce,+(de+Le==ve.length)+2);for(var Be=0;Le-- >0;){var ke=ve[de];Be=(Be<<5^ke)&32767;var Te=-1,Ze=0;if((Te=Ne[Be])&&(Te|=de&-32768,Te>de&&(Te-=32768),Te<de))for(;ve[Te+Ze]==ve[de+Ze]&&Ze<250;)++Ze;if(Ze>2){ke=X[Ze],ke<=22?ce=qt(oe,ce,xe[ke+1]>>1)-1:(qt(oe,ce,3),ce+=5,qt(oe,ce,xe[ke-23]>>5),ce+=3);var St=ke<8?0:ke-4>>2;St>0&&(hr(oe,ce,Ze-se[ke]),ce+=St),ke=K[de-Te],ce=qt(oe,ce,xe[ke]>>3),ce-=3;var Et=ke<4?0:ke-2>>1;Et>0&&(hr(oe,ce,de-Te-_e[ke]),ce+=Et);for(var $t=0;$t<Ze;++$t)Ne[Be]=de&32767,Be=(Be<<5^ve[de])&32767,++de;Le-=Ze-1}else ke<=143?ke=ke+48:ce=ut(oe,ce,1),ce=qt(oe,ce,xe[ke]),Ne[Be]=de&32767,++de}ce=qt(oe,ce,0)-1}return oe.l=(ce+7)/8|0,oe.l}return function(oe,ce){return oe.length<8?J(oe,ce):le(oe,ce)}}();function yn(R){var K=ge(50+Math.floor(R.length*1.1)),z=ls(R,K);return K.slice(0,z)}var Or=ye?new Uint16Array(32768):pt(32768),Pr=ye?new Uint16Array(32768):pt(32768),_n=ye?new Uint16Array(128):pt(128),cs=1,dl=1;function Ui(R,K){var z=$e(R,K)+257;K+=5;var V=$e(R,K)+1;K+=5;var X=tt(R,K)+4;K+=4;for(var J=0,le=ye?new Uint8Array(19):pt(19),ve=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],oe=1,ce=ye?new Uint8Array(8):pt(8),de=ye?new Uint8Array(8):pt(8),Ne=le.length,Le=0;Le<X;++Le)le[G[Le]]=J=Ke(R,K),oe<J&&(oe=J),ce[J]++,K+=3;var Be=0;for(ce[0]=0,Le=1;Le<=oe;++Le)de[Le]=Be=Be+ce[Le-1]<<1;for(Le=0;Le<Ne;++Le)(Be=le[Le])!=0&&(ve[Le]=de[Be]++);var ke=0;for(Le=0;Le<Ne;++Le)if(ke=le[Le],ke!=0){Be=xe[ve[Le]]>>8-ke;for(var Te=(1<<7-ke)-1;Te>=0;--Te)_n[Be|Te<<ke]=ke&7|Le<<3}var Ze=[];for(oe=1;Ze.length<z+V;)switch(Be=_n[Fe(R,K)],K+=Be&7,Be>>>=3){case 16:for(J=3+st(R,K),K+=2,Be=Ze[Ze.length-1];J-- >0;)Ze.push(Be);break;case 17:for(J=3+Ke(R,K),K+=3;J-- >0;)Ze.push(0);break;case 18:for(J=11+Fe(R,K),K+=7;J-- >0;)Ze.push(0);break;default:Ze.push(Be),oe<Be&&(oe=Be);break}var St=Ze.slice(0,z),Et=Ze.slice(z);for(Le=z;Le<286;++Le)St[Le]=0;for(Le=V;Le<30;++Le)Et[Le]=0;return cs=rr(St,Or,286),dl=rr(Et,Pr,30),K}function zi(R,K){if(R[0]==3&&!(R[1]&3))return[Ea(K),2];for(var z=0,V=0,X=Kp(K||1<<18),J=0,le=X.length>>>0,ve=0,oe=0;(V&1)==0;){if(V=Ke(R,z),z+=3,V>>>1)V>>1==1?(ve=9,oe=5):(z=Ui(R,z),ve=cs,oe=dl);else{z&7&&(z+=8-(z&7));var ce=R[z>>>3]|R[(z>>>3)+1]<<8;if(z+=32,ce>0)for(!K&&le<J+ce&&(X=ln(X,J+ce),le=X.length);ce-- >0;)X[J++]=R[z>>>3],z+=8;continue}for(;;){!K&&le<J+32767&&(X=ln(X,J+32767),le=X.length);var de=Qe(R,z,ve),Ne=V>>>1==1?kt[de]:Or[de];if(z+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)X[J++]=Ne;else{if(Ne==256)break;Ne-=257;var Le=Ne<8?0:Ne-4>>2;Le>5&&(Le=0);var Be=J+se[Ne];Le>0&&(Be+=Qe(R,z,Le),z+=Le),de=Qe(R,z,oe),Ne=V>>>1==1?It[de]:Pr[de],z+=Ne&15,Ne>>>=4;var ke=Ne<4?0:Ne-2>>1,Te=_e[Ne];for(ke>0&&(Te+=Qe(R,z,ke),z+=ke),!K&&le<Be&&(X=ln(X,Be+100),le=X.length);J<Be;)X[J]=X[J-Te],++J}}}return K?[X,z+7>>>3]:[X.slice(0,J),z+7>>>3]}function Ra(R,K){var z=R.slice(R.l||0),V=zi(z,K);return R.l+=V[1],V[0]}function Fa(R,K){if(R)typeof console<"u"&&console.error(K);else throw new Error(K)}function Da(R,K){var z=R;tn(z,0);var V=[],X=[],J={FileIndex:V,FullPaths:X};N(J,{root:K.root});for(var le=z.length-4;(z[le]!=80||z[le+1]!=75||z[le+2]!=5||z[le+3]!=6)&&le>=0;)--le;z.l=le+4,z.l+=4;var ve=z.read_shift(2);z.l+=6;var oe=z.read_shift(4);for(z.l=oe,le=0;le<ve;++le){z.l+=20;var ce=z.read_shift(4),de=z.read_shift(4),Ne=z.read_shift(2),Le=z.read_shift(2),Be=z.read_shift(2);z.l+=8;var ke=z.read_shift(4),Te=d(z.slice(z.l+Ne,z.l+Ne+Le));z.l+=Ne+Le+Be;var Ze=z.l;z.l=ke+4,us(z,ce,de,J,Te),z.l=Ze}return J}function us(R,K,z,V,X){R.l+=2;var J=R.read_shift(2),le=R.read_shift(2),ve=c(R);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var oe=R.read_shift(4),ce=R.read_shift(4),de=R.read_shift(4),Ne=R.read_shift(2),Le=R.read_shift(2),Be="",ke=0;ke<Ne;++ke)Be+=String.fromCharCode(R[R.l++]);if(Le){var Te=d(R.slice(R.l,R.l+Le));(Te[21589]||{}).mt&&(ve=Te[21589].mt),((X||{})[21589]||{}).mt&&(ve=X[21589].mt)}R.l+=Le;var Ze=R.slice(R.l,R.l+ce);switch(le){case 8:Ze=I(R,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var St=!1;J&8&&(oe=R.read_shift(4),oe==134695760&&(oe=R.read_shift(4),St=!0),ce=R.read_shift(4),de=R.read_shift(4)),ce!=K&&Fa(St,"Bad compressed size: "+K+" != "+ce),de!=z&&Fa(St,"Bad uncompressed size: "+z+" != "+de),Wn(V,Be,Ze,{unsafe:!0,mt:ve})}function ds(R,K){var z=K||{},V=[],X=[],J=ge(1),le=z.compression?8:0,ve=0,oe=0,ce=0,de=0,Ne=0,Le=R.FullPaths[0],Be=Le,ke=R.FileIndex[0],Te=[],Ze=0;for(oe=1;oe<R.FullPaths.length;++oe)if(Be=R.FullPaths[oe].slice(Le.length),ke=R.FileIndex[oe],!(!ke.size||!ke.content||Be=="Sh33tJ5")){var St=de,Et=ge(Be.length);for(ce=0;ce<Be.length;++ce)Et.write_shift(1,Be.charCodeAt(ce)&127);Et=Et.slice(0,Et.l),Te[Ne]=lS.buf(ke.content,0);var $t=ke.content;le==8&&($t=H($t)),J=ge(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,le),ke.mt?l(J,ke.mt):J.write_shift(4,0),J.write_shift(-4,Te[Ne]),J.write_shift(4,$t.length),J.write_shift(4,ke.content.length),J.write_shift(2,Et.length),J.write_shift(2,0),de+=J.length,V.push(J),de+=Et.length,V.push(Et),de+=$t.length,V.push($t),J=ge(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,ve),J.write_shift(2,le),J.write_shift(4,0),J.write_shift(-4,Te[Ne]),J.write_shift(4,$t.length),J.write_shift(4,ke.content.length),J.write_shift(2,Et.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,St),Ze+=J.l,X.push(J),Ze+=Et.length,X.push(Et),++Ne}return J=ge(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,Ne),J.write_shift(2,Ne),J.write_shift(4,Ze),J.write_shift(4,de),J.write_shift(2,0),vr([vr(V),vr(X),J])}var ea={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function fl(R,K){if(R.ctype)return R.ctype;var z=R.name||"",V=z.match(/\.([^\.]+)$/);return V&&ea[V[1]]||K&&(V=(z=K).match(/[\.\\]([^\.\\])+$/),V&&ea[V[1]])?ea[V[1]]:"application/octet-stream"}function hl(R){for(var K=Xo(R),z=[],V=0;V<K.length;V+=76)z.push(K.slice(V,V+76));return z.join(`\r
`)+`\r
`}function ml(R){var K=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var de=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});K=K.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var z=[],V=K.split(`\r
`),X=0;X<V.length;++X){var J=V[X];if(J.length==0){z.push("");continue}for(var le=0;le<J.length;){var ve=76,oe=J.slice(le,le+ve);oe.charAt(ve-1)=="="?ve--:oe.charAt(ve-2)=="="?ve-=2:oe.charAt(ve-3)=="="&&(ve-=3),oe=J.slice(le,le+ve),le+=ve,le<J.length&&(oe+="="),z.push(oe)}}return z.join(`\r
`)}function pl(R){for(var K=[],z=0;z<R.length;++z){for(var V=R[z];z<=R.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+R[++z];K.push(V)}for(var X=0;X<K.length;++X)K[X]=K[X].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return An(K.join(`\r
`))}function $i(R,K,z){for(var V="",X="",J="",le,ve=0;ve<10;++ve){var oe=K[ve];if(!oe||oe.match(/^\s*$/))break;var ce=oe.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":V=ce[2].trim();break;case"content-type":J=ce[2].trim();break;case"content-transfer-encoding":X=ce[2].trim();break}}switch(++ve,X.toLowerCase()){case"base64":le=An(ns(K.slice(ve).join("")));break;case"quoted-printable":le=pl(K.slice(ve));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+X)}var de=Wn(R,V.slice(z.length),le,{unsafe:!0});J&&(de.ctype=J)}function xl(R,K){if(W(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=K&&K.root||"",V=(mt&&Buffer.isBuffer(R)?R.toString("binary"):W(R)).split(`\r
`),X=0,J="";for(X=0;X<V.length;++X)if(J=V[X],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),z||(z=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),J.slice(0,z.length)!=z););var le=(V[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var ve="--"+(le[1]||""),oe=[],ce=[],de={FileIndex:oe,FullPaths:ce};N(de);var Ne,Le=0;for(X=0;X<V.length;++X){var Be=V[X];Be!==ve&&Be!==ve+"--"||(Le++&&$i(de,V.slice(Ne,X),z),Ne=X)}return de}function ta(R,K){var z=K||{},V=z.boundary||"SheetJS";V="------="+V;for(var X=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],J=R.FullPaths[0],le=J,ve=R.FileIndex[0],oe=1;oe<R.FullPaths.length;++oe)if(le=R.FullPaths[oe].slice(J.length),ve=R.FileIndex[oe],!(!ve.size||!ve.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var ce=ve.content,de=mt&&Buffer.isBuffer(ce)?ce.toString("binary"):W(ce),Ne=0,Le=Math.min(1024,de.length),Be=0,ke=0;ke<=Le;++ke)(Be=de.charCodeAt(ke))>=32&&Be<128&&++Ne;var Te=Ne>=Le*4/5;X.push(V),X.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+le),X.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),X.push("Content-Type: "+fl(ve,le)),X.push(""),X.push(Te?ml(de):hl(de))}return X.push(V+`--\r
`),X.join(`\r
`)}function Wi(R){var K={};return N(K,R),K}function Wn(R,K,z,V){var X=V&&V.unsafe;X||N(R);var J=!X&&wt.find(R,K);if(!J){var le=R.FullPaths[0];K.slice(0,le.length)==le?le=K:(le.slice(-1)!="/"&&(le+="/"),le=(le+K).replace("//","/")),J={name:i(K),type:2},R.FileIndex.push(J),R.FullPaths.push(le),X||wt.utils.cfb_gc(R)}return J.content=z,J.size=z?z.length:0,V&&(V.CLSID&&(J.clsid=V.CLSID),V.mt&&(J.mt=V.mt),V.ct&&(J.ct=V.ct)),J}function pu(R,K){N(R);var z=wt.find(R,K);if(z){for(var V=0;V<R.FileIndex.length;++V)if(R.FileIndex[V]==z)return R.FileIndex.splice(V,1),R.FullPaths.splice(V,1),!0}return!1}function ra(R,K,z){N(R);var V=wt.find(R,K);if(V){for(var X=0;X<R.FileIndex.length;++X)if(R.FileIndex[X]==V)return R.FileIndex[X].name=i(z),R.FullPaths[X]=z,!0}return!1}function La(R){T(R,!0)}return e.find=q,e.read=L,e.parse=p,e.write=re,e.writeFile=Q,e.utils={cfb_new:Wi,cfb_add:Wn,cfb_del:pu,cfb_mov:ra,cfb_gc:La,ReadShift:Uo,CheckField:cv,prep_blob:tn,bconcat:vr,use_zlib:b,_deflateRaw:yn,_inflateRaw:Ra,consts:he},e}();function cS(t){return typeof t=="string"?ou(t):Array.isArray(t)?D3(t):t}function il(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=ou(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Yo(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([cS(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:t,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=t,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(t);return d.open("w"),d.encoding="binary",Array.isArray(e)&&(e=al(e)),d.write(e),d.close(),e}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+t)}function jr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function rx(t,e){for(var r=[],n=jr(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function sh(t){for(var e=[],r=jr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function uu(t){for(var e=[],r=jr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function uS(t){for(var e=[],r=jr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Hc=new Date(1899,11,30,0,0,0);function Kr(t,e){var r=t.getTime(),n=Hc.getTime()+(t.getTimezoneOffset()-Hc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var qg=new Date,dS=Hc.getTime()+(qg.getTimezoneOffset()-Hc.getTimezoneOffset())*6e4,nx=qg.getTimezoneOffset();function Gg(t){var e=new Date;return e.setTime(t*24*60*60*1e3+dS),e.getTimezoneOffset()!==nx&&e.setTime(e.getTime()+(e.getTimezoneOffset()-nx)*6e4),e}var sx=new Date("2017-02-19T19:06:09.000Z"),Kg=isNaN(sx.getFullYear())?new Date("2/19/17"):sx,fS=Kg.getFullYear()==2017;function Ir(t,e){var r=new Date(t);if(fS)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Kg.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function du(t,e){if(mt&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Xr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Xr(t[r]));return e}function Ut(t,e){for(var r="";r.length<e;)r+=t;return r}function ts(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,l){return r=-r,l}),!isNaN(e=Number(n)))?e/r:e}var hS=["january","february","march","april","may","june","july","august","september","october","november","december"];function Jo(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),l=e.getDate();if(isNaN(l))return r;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&hS.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||l>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function nt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return mt?n=os(r):n=L3(r),wt.utils.cfb_add(t,e,n)}wt.utils.cfb_add(t,e,r)}else t.file(e,r)}function ah(){return wt.utils.cfb_new()}var Yt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ih=sh(mS),oh=/[&<>'"]/g,pS=/[\u0000-\u0008\u000b-\u001f]/g;function yt(t){var e=t+"";return e.replace(oh,function(r){return ih[r]}).replace(pS,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ax(t){return yt(t).replace(/ /g,"_x0020_")}var Xg=/[\u0000-\u001f]/g;function xS(t){var e=t+"";return e.replace(oh,function(r){return ih[r]}).replace(/\n/g,"<br/>").replace(Xg,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function gS(t){var e=t+"";return e.replace(oh,function(r){return ih[r]}).replace(Xg,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function vS(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function yS(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function hf(t){for(var e="",r=0,n=0,i=0,l=0,c=0,d=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=i&63,e+=String.fromCharCode(c);continue}if(l=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|l&63);continue}c=t.charCodeAt(r++),d=((n&7)<<18|(i&63)<<12|(l&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(d>>>10&1023)),e+=String.fromCharCode(56320+(d&1023))}return e}function ix(t){var e=Ea(2*t.length),r,n,i=1,l=0,c=0,d;for(n=0;n<t.length;n+=i)i=1,(d=t.charCodeAt(n))<128?r=d:d<224?(r=(d&31)*64+(t.charCodeAt(n+1)&63),i=2):d<240?(r=(d&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(d&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(e[l++]=c&255,e[l++]=c>>>8,c=0),e[l++]=r%256,e[l++]=r>>>8;return e.slice(0,l).toString("ucs2")}function ox(t){return os(t,"binary").toString("utf8")}var kc="foo bar baz",Bo=mt&&(ox(kc)==hf(kc)&&ox||ix(kc)==hf(kc)&&ix)||hf,Yo=mt?function(t){return os(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},_S=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Jg=/(^\s|\s$|\n)/;function yr(t,e){return"<"+t+(e.match(Jg)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Qo(t){return jr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Re(t,e,r){return"<"+t+(r!=null?Qo(r):"")+(e!=null?(e.match(Jg)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Mf(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function wS(t,e){switch(typeof t){case"string":var r=Re("vt:lpwstr",yt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Re((t|0)==t?"vt:i4":"vt:r8",yt(String(t)));case"boolean":return Re("vt:bool",t?"true":"false")}if(t instanceof Date)return Re("vt:filetime",Mf(t));throw new Error("Unable to serialize "+t)}var ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Li=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],rn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function jS(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,l=5;l>=0;--l)i=i*256+t[e+l];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function SS(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,l=0,c=n?-e:e;isFinite(c)?c==0?i=l=0:(i=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(e)?26985:0);for(var d=0;d<=5;++d,l/=256)t[r+d]=l&255;t[r+6]=(i&15)<<4|l&15,t[r+7]=i>>4|n}var lx=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,l=t[0][n].length;i<l;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},cx=mt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:os(e)})):lx(t)}:lx,ux=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ro(t,i)));return n.join("").replace(Mo,"")},lh=mt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Mo,""):ux(t,e,r)}:ux,dx=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Yg=mt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):dx(t,e,r)}:dx,fx=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(_i(t,i)));return n.join("")},ol=mt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):fx(e,r,n)}:fx,Qg=function(t,e){var r=nn(t,e);return r>0?ol(t,e+4,e+4+r-1):""},Zg=Qg,ev=function(t,e){var r=nn(t,e);return r>0?ol(t,e+4,e+4+r-1):""},tv=ev,rv=function(t,e){var r=2*nn(t,e);return r>0?ol(t,e+4,e+4+r-1):""},nv=rv,sv=function(e,r){var n=nn(e,r);return n>0?lh(e,r+4,r+4+n):""},av=sv,iv=function(t,e){var r=nn(t,e);return r>0?ol(t,e+4,e+4+r):""},ov=iv,lv=function(t,e){return jS(t,e)},qc=lv,ch=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};mt&&(Zg=function(e,r){if(!Buffer.isBuffer(e))return Qg(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},tv=function(e,r){if(!Buffer.isBuffer(e))return ev(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},nv=function(e,r){if(!Buffer.isBuffer(e))return rv(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},av=function(e,r){if(!Buffer.isBuffer(e))return sv(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},ov=function(e,r){if(!Buffer.isBuffer(e))return iv(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},qc=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):lv(e,r)},ch=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var _i=function(t,e){return t[e]},Ro=function(t,e){return t[e+1]*256+t[e]},ES=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},nn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},_a=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},NS=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Uo(t,e){var r="",n,i,l=[],c,d,m,f;switch(e){case"dbcs":if(f=this.l,mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(m=0;m<t;++m)r+=String.fromCharCode(Ro(this,f)),f+=2;t*=2;break;case"utf8":r=ol(this,this.l,this.l+t);break;case"utf16le":t*=2,r=lh(this,this.l,this.l+t);break;case"wstr":return Uo.call(this,t,"dbcs");case"lpstr-ansi":r=Zg(this,this.l),t=4+nn(this,this.l);break;case"lpstr-cp":r=tv(this,this.l),t=4+nn(this,this.l);break;case"lpwstr":r=nv(this,this.l),t=4+2*nn(this,this.l);break;case"lpp4":t=4+nn(this,this.l),r=av(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+nn(this,this.l),r=ov(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(c=_i(this,this.l+t++))!==0;)l.push(Nc(c));r=l.join("");break;case"_wstr":for(t=0,r="";(c=Ro(this,this.l+t))!==0;)l.push(Nc(c)),t+=2;t+=2,r=l.join("");break;case"dbcs-cont":for(r="",f=this.l,m=0;m<t;++m){if(this.lens&&this.lens.indexOf(f)!==-1)return c=_i(this,f),this.l=f+1,d=Uo.call(this,t-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Nc(Ro(this,f))),f+=2}r=l.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,m=0;m!=t;++m){if(this.lens&&this.lens.indexOf(f)!==-1)return c=_i(this,f),this.l=f+1,d=Uo.call(this,t-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(Nc(_i(this,f))),f+=1}r=l.join("");break;default:switch(t){case 1:return n=_i(this,this.l),this.l++,n;case 2:return n=(e==="i"?ES:Ro)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?_a:NS)(this,this.l),this.l+=4,n):(i=nn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=qc(this,this.l):i=qc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Yg(this,this.l,t);break}}return this.l+=t,r}var bS=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},TS=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},kS=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function CS(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)kS(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var c=e.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,bS(this,e,this.l);break;case 8:if(n=8,r==="f"){SS(this,e,this.l);break}case 16:break;case-4:n=4,TS(this,e,this.l);break}return this.l+=n,this}function cv(t,e){var r=Yg(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function tn(t,e){t.l=e,t.read_shift=Uo,t.chk=cv,t.write_shift=CS}function $n(t,e){t.l+=e}function ge(t){var e=Ea(t);return tn(e,0),e}function Gr(){var t=[],e=mt?256:2048,r=function(f){var p=ge(f);return tn(p,0),p},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},l=function(f){return n&&f<n.length-n.l?n:(i(),n=r(Math.max(f+1,e)))},c=function(){return i(),vr(t)},d=function(f){i(),n=f,n.l==null&&(n.l=n.length),l(e)};return{next:l,push:d,end:c,_bufs:t}}function je(t,e,r,n){var i=+e,l;if(!isNaN(i)){n||(n=jk[i].p||(r||[]).length||0),l=1+(i>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var c=t.next(l);i<=127?c.write_shift(1,i):(c.write_shift(1,(i&127)+128),c.write_shift(1,i>>7));for(var d=0;d!=4;++d)if(n>=128)c.write_shift(1,(n&127)+128),n>>=7;else{c.write_shift(1,n);break}n>0&&ch(r)&&t.push(r)}}function zo(t,e,r){var n=Xr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function hx(t,e,r){var n=Xr(t);return n.s=zo(n.s,e.s,r),n.e=zo(n.e,e.s,r),n}function $o(t,e){if(t.cRel&&t.c<0)for(t=Xr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Xr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=_t(t);return!t.cRel&&t.cRel!=null&&(r=PS(r)),!t.rRel&&t.rRel!=null&&(r=AS(r)),r}function mf(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Tr(t.s.c)+":"+(t.e.cRel?"":"$")+Tr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+_r(t.s.r)+":"+(t.e.rRel?"":"$")+_r(t.e.r):$o(t.s,e.biff)+":"+$o(t.e,e.biff)}function uh(t){return parseInt(OS(t),10)-1}function _r(t){return""+(t+1)}function AS(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function OS(t){return t.replace(/\$(\d+)$/,"$1")}function dh(t){for(var e=RS(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Tr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function PS(t){return t.replace(/^([A-Z])/,"$$$1")}function RS(t){return t.replace(/^\$([A-Z])/,"$1")}function FS(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function dr(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function _t(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function on(t){var e=t.indexOf(":");return e==-1?{s:dr(t),e:dr(t)}:{s:dr(t.slice(0,e)),e:dr(t.slice(e+1))}}function Jt(t,e){return typeof e>"u"||typeof e=="number"?Jt(t.s,t.e):(typeof t!="string"&&(t=_t(t)),typeof e!="string"&&(e=_t(e)),t==e?t:t+":"+e)}function Pt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,l=t.length;for(r=0;n<l&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<l&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===l||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=l&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=l&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function mx(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Hs(t.z,r?Kr(e):e)}catch{}try{return t.w=Hs((t.XF||{}).numFmtId||(r?14:0),r?Kr(e):e)}catch{return""+e}}function ss(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?ll[t.v]||t.v:e==null?mx(t,t.v):mx(t,e))}function ka(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function uv(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,l=t||(i?[]:{}),c=0,d=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?dr(n.origin):n.origin;c=m.r,d=m.c}l["!ref"]||(l["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=Pt(l["!ref"]);f.s.c=p.s.c,f.s.r=p.s.r,f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),c==-1&&(f.e.r=c=p.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=e[g].length;++v)if(!(typeof e[g][v]>"u")){var w={v:e[g][v]},S=c+g,y=d+v;if(f.s.r>S&&(f.s.r=S),f.s.c>y&&(f.s.c=y),f.e.r<S&&(f.e.r=S),f.e.c<y&&(f.e.c=y),e[g][v]&&typeof e[g][v]=="object"&&!Array.isArray(e[g][v])&&!(e[g][v]instanceof Date))w=e[g][v];else if(Array.isArray(w.v)&&(w.f=e[g][v][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(n.nullError)w.t="e",w.v=0;else if(n.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=n.dateNF||zt[14],n.cellDates?(w.t="d",w.w=Hs(w.z,Kr(w.v))):(w.t="n",w.v=Kr(w.v),w.w=Hs(w.z,w.v))):w.t="s";if(i)l[S]||(l[S]=[]),l[S][y]&&l[S][y].z&&(w.z=l[S][y].z),l[S][y]=w;else{var E=_t({c:y,r:S});l[E]&&l[E].z&&(w.z=l[E].z),l[E]=w}}}return f.s.c<1e7&&(l["!ref"]=Jt(f)),l}function Ii(t,e){return uv(null,t,e)}function DS(t){return t.read_shift(4,"i")}function Pn(t,e){return e||(e=ge(4)),e.write_shift(4,t),e}function kr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function fr(t,e){var r=!1;return e==null&&(r=!0,e=ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function LS(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function IS(t,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function fh(t,e){var r=t.l,n=t.read_shift(1),i=kr(t),l=[],c={t:i,h:i};if((n&1)!==0){for(var d=t.read_shift(4),m=0;m!=d;++m)l.push(LS(t));c.r=l}else c.r=[{ich:0,ifnt:0}];return t.l=r+e,c}function MS(t,e){var r=!1;return e==null&&(r=!0,e=ge(15+4*t.t.length)),e.write_shift(1,0),fr(t.t,e),r?e.slice(0,e.l):e}var BS=fh;function US(t,e){var r=!1;return e==null&&(r=!0,e=ge(23+4*t.t.length)),e.write_shift(1,1),fr(t.t,e),e.write_shift(4,1),IS({},e),r?e.slice(0,e.l):e}function vn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ca(t,e){return e==null&&(e=ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Aa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Oa(t,e){return e==null&&(e=ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var zS=kr,dv=fr;function hh(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Gc(t,e){var r=!1;return e==null&&(r=!0,e=ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var $S=kr,Bf=hh,mh=Gc;function fv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?qc([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_a(e,0)>>2;return r?i/100:i}function hv(t,e){e==null&&(e=ge(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function mv(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function WS(t,e){return e||(e=ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Pa=mv,Mi=WS;function Bi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Na(t,e){return(e||ge(8)).write_shift(8,t,"f")}function VS(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),l=t.read_shift(2,"i"),c=t.read_shift(1),d=t.read_shift(1),m=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var f=ZS[i];f&&(e.rgb=Nx(f));break;case 2:e.rgb=Nx([c,d,m]);break;case 3:e.theme=i;break}return l!=0&&(e.tint=l>0?l/32767:l/32768),e}function Kc(t,e){if(e||(e=ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function HS(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function qS(t,e){e||(e=ge(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var pv=2,en=3,Cc=11,Xc=19,Ac=64,GS=65,KS=71,XS=4108,JS=4126,gr=80,px={1:{n:"CodePage",t:pv},2:{n:"Category",t:gr},3:{n:"PresentationFormat",t:gr},4:{n:"ByteCount",t:en},5:{n:"LineCount",t:en},6:{n:"ParagraphCount",t:en},7:{n:"SlideCount",t:en},8:{n:"NoteCount",t:en},9:{n:"HiddenCount",t:en},10:{n:"MultimediaClipCount",t:en},11:{n:"ScaleCrop",t:Cc},12:{n:"HeadingPairs",t:XS},13:{n:"TitlesOfParts",t:JS},14:{n:"Manager",t:gr},15:{n:"Company",t:gr},16:{n:"LinksUpToDate",t:Cc},17:{n:"CharacterCount",t:en},19:{n:"SharedDoc",t:Cc},22:{n:"HyperlinksChanged",t:Cc},23:{n:"AppVersion",t:en,p:"version"},24:{n:"DigSig",t:GS},26:{n:"ContentType",t:gr},27:{n:"ContentStatus",t:gr},28:{n:"Language",t:gr},29:{n:"Version",t:gr},255:{},2147483648:{n:"Locale",t:Xc},2147483651:{n:"Behavior",t:Xc},1919054434:{}},xx={1:{n:"CodePage",t:pv},2:{n:"Title",t:gr},3:{n:"Subject",t:gr},4:{n:"Author",t:gr},5:{n:"Keywords",t:gr},6:{n:"Comments",t:gr},7:{n:"Template",t:gr},8:{n:"LastAuthor",t:gr},9:{n:"RevNumber",t:gr},10:{n:"EditTime",t:Ac},11:{n:"LastPrinted",t:Ac},12:{n:"CreatedDate",t:Ac},13:{n:"ModifiedDate",t:Ac},14:{n:"PageCount",t:en},15:{n:"WordCount",t:en},16:{n:"CharCount",t:en},17:{n:"Thumbnail",t:KS},18:{n:"Application",t:gr},19:{n:"DocSecurity",t:en},255:{},2147483648:{n:"Locale",t:Xc},2147483651:{n:"Behavior",t:Xc},1919054434:{}};function YS(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var QS=YS([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ZS=Xr(QS),ll={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},e4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Oc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function xv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gv(t,e){var r=uS(e4),n=[],i;n[n.length]=Yt,n[n.length]=Re("Types",null,{xmlns:ur.CT,"xmlns:xsd":ur.xsd,"xmlns:xsi":ur.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return Re("Default",null,{Extension:m[0],ContentType:m[1]})}));var l=function(m){t[m]&&t[m].length>0&&(i=t[m][0],n[n.length]=Re("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Oc[m][e.bookType]||Oc[m].xlsx}))},c=function(m){(t[m]||[]).forEach(function(f){n[n.length]=Re("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Oc[m][e.bookType]||Oc[m].xlsx})})},d=function(m){(t[m]||[]).forEach(function(f){n[n.length]=Re("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[m][0]})})};return l("workbooks"),c("sheets"),c("charts"),d("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),c("metadata"),d("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var ht={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vv(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ei(t){var e=[Yt,Re("Relationships",null,{xmlns:ur.RELS})];return jr(t["!id"]).forEach(function(r){e[e.length]=Re("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function vt(t,e,r,n,i,l){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[ht.HLINK,ht.XPATH,ht.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function t4(t){var e=[Yt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function gx(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function r4(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function n4(t){var e=[Yt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(gx(t[r][0],t[r][1])),e.push(r4("",t[r][0]));return e.push(gx("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function yv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+zc.version+"</meta:generator></office:meta></office:document-meta>"}var Sa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function pf(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=yt(e),n[n.length]=r?Re(t,e,r):yr(t,e))}function _v(t,e){var r=e||{},n=[Yt,Re("cp:coreProperties",null,{"xmlns:cp":ur.CORE_PROPS,"xmlns:dc":ur.dc,"xmlns:dcterms":ur.dcterms,"xmlns:dcmitype":ur.dcmitype,"xmlns:xsi":ur.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&pf("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Mf(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&pf("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Mf(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var l=0;l!=Sa.length;++l){var c=Sa[l],d=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:t?t[c[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&pf(c[0],d,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ni=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jv(t){var e=[],r=Re;return t||(t={}),t.Application="SheetJS",e[e.length]=Yt,e[e.length]=Re("Properties",null,{xmlns:ur.EXT_PROPS,"xmlns:vt":ur.vt}),Ni.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=yt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+yt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Sv(t){var e=[Yt,Re("Properties",null,{xmlns:ur.CUST_PROPS,"xmlns:vt":ur.vt})];if(!t)return e.join("");var r=1;return jr(t).forEach(function(i){++r,e[e.length]=Re("property",wS(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:yt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var vx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function s4(t,e){var r=[];return jr(vx).map(function(n){for(var i=0;i<Sa.length;++i)if(Sa[i][1]==n)return Sa[i];for(i=0;i<Ni.length;++i)if(Ni[i][1]==n)return Ni[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(yr(vx[n[1]]||n[1],i))}}),Re("DocumentProperties",r.join(""),{xmlns:rn.o})}function a4(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&jr(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)){for(var c=0;c<Sa.length;++c)if(l==Sa[c][1])return;for(c=0;c<Ni.length;++c)if(l==Ni[c][1])return;for(c=0;c<r.length;++c)if(l==r[c])return;var d=t[l],m="string";typeof d=="number"?(m="float",d=String(d)):d===!0||d===!1?(m="boolean",d=d?"1":"0"):d=String(d),i.push(Re(ax(l),d,{"dt:dt":m}))}}),e&&jr(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)&&!(t&&Object.prototype.hasOwnProperty.call(t,l))){var c=e[l],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c instanceof Date?(d="dateTime.tz",c=c.toISOString()):c=String(c),i.push(Re(ax(l),c,{"dt:dt":d}))}}),"<"+n+' xmlns="'+rn.o+'">'+i.join("")+"</"+n+">"}function i4(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),i+=l);var c=ge(8);return c.write_shift(4,n),c.write_shift(4,i),c}function yx(t,e){var r=ge(4),n=ge(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ge(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=i4(e);break;case 31:case 80:for(n=ge(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return vr([r,n])}var Ev=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function o4(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function _x(t,e,r){var n=ge(8),i=[],l=[],c=8,d=0,m=ge(8),f=ge(8);if(m.write_shift(4,2),m.write_shift(4,1200),f.write_shift(4,1),l.push(m),i.push(f),c+=8+m.length,!e){f=ge(8),f.write_shift(4,0),i.unshift(f);var p=[ge(4)];for(p[0].write_shift(4,t.length),d=0;d<t.length;++d){var g=t[d][0];for(m=ge(8+2*(g.length+1)+(g.length%2?0:2)),m.write_shift(4,d+2),m.write_shift(4,g.length+1),m.write_shift(0,g,"dbcs");m.l!=m.length;)m.write_shift(1,0);p.push(m)}m=vr(p),l.unshift(m),c+=8+m.length}for(d=0;d<t.length;++d)if(!(e&&!e[t[d][0]])&&!(Ev.indexOf(t[d][0])>-1||wv.indexOf(t[d][0])>-1)&&t[d][1]!=null){var v=t[d][1],w=0;if(e){w=+e[t[d][0]];var S=r[w];if(S.p=="version"&&typeof v=="string"){var y=v.split(".");v=(+y[0]<<16)+(+y[1]||0)}m=yx(S.t,v)}else{var E=o4(v);E==-1&&(E=31,v=String(v)),m=yx(E,v)}l.push(m),f=ge(8),f.write_shift(4,e?w:2+d),i.push(f),c+=8+m.length}var D=8*(l.length+1);for(d=0;d<l.length;++d)i[d].write_shift(4,D),D+=l[d].length;return n.write_shift(4,c),n.write_shift(4,l.length),vr([n].concat(i).concat(l))}function wx(t,e,r,n,i,l){var c=ge(i?68:48),d=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,wt.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,i?2:1),c.write_shift(16,e,"hex"),c.write_shift(4,i?68:48);var m=_x(t,r,n);if(d.push(m),i){var f=_x(i,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+m.length),d.push(f)}return vr(d)}function l4(t,e){e||(e=ge(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function c4(t,e){return t.read_shift(e)===1}function Lr(t,e){return e||(e=ge(2)),e.write_shift(2,+!!t),e}function Nv(t){return t.read_shift(2,"u")}function gn(t,e){return e||(e=ge(2)),e.write_shift(2,t),e}function bv(t,e,r){return r||(r=ge(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Tv(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=t.read_shift(1);l&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var c=n?t.read_shift(n,i):"";return c}function u4(t){var e=t.t||"",r=ge(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ge(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return vr(i)}function d4(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function f4(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):d4(t,n,r)}function h4(t,e,r){if(r.biff>5)return f4(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function kv(t,e,r){return r||(r=ge(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function jx(t,e){e||(e=ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function m4(t){var e=ge(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),l=i>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}e.write_shift(4,2),e.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)e.write_shift(4,c[r]);if(l==28)n=n.slice(1),jx(n,e);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)e.write_shift(1,parseInt(c[r],16));var d=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(d.length+1)),r=0;r<d.length;++r)e.write_shift(2,d.charCodeAt(r));e.write_shift(2,0),l&8&&jx(i>-1?n.slice(i+1):"",e)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)e.write_shift(1,parseInt(c[r],16));for(var m=0;n.slice(m*3,m*3+3)=="../"||n.slice(m*3,m*3+3)=="..\\";)++m;for(e.write_shift(2,m),e.write_shift(4,n.length-3*m+1),r=0;r<n.length-3*m;++r)e.write_shift(1,n.charCodeAt(r+3*m)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function ba(t,e,r,n){return n||(n=ge(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function p4(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),l=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[i,l,c]}function x4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function Cv(t,e){return e||(e=ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function ph(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=ge(i);return l.write_shift(2,n),l.write_shift(2,e),i>4&&l.write_shift(2,29282),i>6&&l.write_shift(2,1997),i>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function g4(t,e){var r=!e||e.biff==8,n=ge(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function v4(t,e){var r=!e||e.biff>=8?2:1,n=ge(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function y4(t,e){var r=ge(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=u4(t[i]);var l=vr([r].concat(n));return l.parts=[r.length].concat(n.map(function(c){return c.length})),l}function _4(){var t=ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function w4(t){var e=ge(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function j4(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,l=ge(i);return l.write_shift(2,t.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function S4(t,e,r,n){var i=ge(10);return ba(t,e,n,i),i.write_shift(4,r),i}function E4(t,e,r,n,i){var l=!i||i.biff==8,c=ge(8+ +l+(1+l)*r.length);return ba(t,e,n,c),c.write_shift(2,r.length),l&&c.write_shift(1,1),c.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),c}function N4(t,e,r,n){var i=r&&r.biff==5;n||(n=ge(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}function b4(t,e){var r=e.biff==8||!e.biff?4:2,n=ge(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Sx(t,e,r,n){var i=r&&r.biff==5;n||(n=ge(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var l=0;return t.numFmtId>0&&i&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function T4(t){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function k4(t,e,r,n,i,l){var c=ge(8);return ba(t,e,n,c),bv(r,l,c),c}function C4(t,e,r,n){var i=ge(14);return ba(t,e,n,i),Na(r,i),i}function A4(t,e,r){if(r.biff<8)return O4(t,e,r);for(var n=[],i=t.l+e,l=t.read_shift(r.biff>8?4:2);l--!==0;)n.push(p4(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function O4(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Tv(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function P4(t){var e=ge(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Cv(t[r],e);return e}function R4(t){var e=ge(24),r=dr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return vr([e,m4(t[1])])}function F4(t){var e=t[1].Tooltip,r=ge(10+2*(e.length+1));r.write_shift(2,2048);var n=dr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function D4(t){return t||(t=ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function L4(t,e,r){if(!r.cellStyles)return $n(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(n),d=t.read_shift(n),m=t.read_shift(2);n==2&&(t.l+=2);var f={s:i,e:l,w:c,ixfe:d,flags:m};return(r.biff>=5||!r.biff)&&(f.level=m>>8&7),f}function I4(t,e){var r=ge(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function M4(t){for(var e=ge(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function B4(t,e,r){var n=ge(15);return ul(n,t,e),n.write_shift(8,r,"f"),n}function U4(t,e,r){var n=ge(9);return ul(n,t,e),n.write_shift(2,r),n}var z4=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=sh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(d,m){var f=[],p=Ea(1);switch(m.type){case"base64":p=An(ns(d));break;case"binary":p=An(d);break;case"buffer":case"array":p=d;break}tn(p,0);var g=p.read_shift(1),v=!!(g&136),w=!1,S=!1;switch(g){case 2:break;case 3:break;case 48:w=!0,v=!0;break;case 49:w=!0,v=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var y=0,E=521;g==2&&(y=p.read_shift(2)),p.l+=3,g!=2&&(y=p.read_shift(4)),y>1048576&&(y=1e6),g!=2&&(E=p.read_shift(2));var D=p.read_shift(2),A=m.codepage||1252;g!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(A=t[p[p.l]]),p.l+=1,p.l+=2),S&&(p.l+=36);for(var C=[],P={},F=Math.min(p.length,g==2?521:E-10-(w?264:0)),L=S?32:11;p.l<F&&p[p.l]!=13;)switch(P={},P.name=Gp.utils.decode(A,p.slice(p.l,p.l+L)).replace(/[\u0000\r\n].*$/g,""),p.l+=L,P.type=String.fromCharCode(p.read_shift(1)),g!=2&&!S&&(P.offset=p.read_shift(4)),P.len=p.read_shift(1),g==2&&(P.offset=p.read_shift(2)),P.dec=p.read_shift(1),P.name.length&&C.push(P),g!=2&&(p.l+=S?13:14),P.type){case"B":(!w||P.len!=8)&&m.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(p[p.l]!==13&&(p.l=E-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=E;var N=0,j=0;for(f[0]=[],j=0;j!=C.length;++j)f[0][j]=C[j].name;for(;y-- >0;){if(p[p.l]===42){p.l+=D;continue}for(++p.l,f[++N]=[],j=0,j=0;j!=C.length;++j){var T=p.slice(p.l,p.l+C[j].len);p.l+=C[j].len,tn(T,0);var k=Gp.utils.decode(A,T);switch(C[j].type){case"C":k.trim().length&&(f[N][j]=k.replace(/\s+$/,""));break;case"D":k.length===8?f[N][j]=new Date(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8)):f[N][j]=k;break;case"F":f[N][j]=parseFloat(k.trim());break;case"+":case"I":f[N][j]=S?T.read_shift(-4,"i")^2147483648:T.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":f[N][j]=!0;break;case"N":case"F":f[N][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[N][j]="##MEMO##"+(S?parseInt(k.trim(),10):T.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(f[N][j]=+k||0);break;case"@":f[N][j]=new Date(T.read_shift(-8,"f")-621356832e5);break;case"T":f[N][j]=new Date((T.read_shift(4)-2440588)*864e5+T.read_shift(4));break;case"Y":f[N][j]=T.read_shift(4,"i")/1e4+T.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[N][j]=-T.read_shift(-8,"f");break;case"B":if(w&&C[j].len==8){f[N][j]=T.read_shift(8,"f");break}case"G":case"P":T.l+=C[j].len;break;case"0":if(C[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[j].type)}}}if(g!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return m&&m.sheetRows&&(f=f.slice(0,m.sheetRows)),m.DBF=C,f}function n(d,m){var f=m||{};f.dateNF||(f.dateNF="yyyymmdd");var p=Ii(r(d,f),f);return p["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,p}function i(d,m){try{return ka(n(d,m),m)}catch(f){if(m&&m.WTF)throw f}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(d,m){var f=m||{};if(+f.codepage>=0&&Ko(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=Gr(),g=eu(d,{header:1,raw:!0,cellDates:!0}),v=g[0],w=g.slice(1),S=d["!cols"]||[],y=0,E=0,D=0,A=1;for(y=0;y<v.length;++y){if(((S[y]||{}).DBF||{}).name){v[y]=S[y].DBF.name,++D;continue}if(v[y]!=null){if(++D,typeof v[y]=="number"&&(v[y]=v[y].toString(10)),typeof v[y]!="string")throw new Error("DBF Invalid column name "+v[y]+" |"+typeof v[y]+"|");if(v.indexOf(v[y])!==y){for(E=0;E<1024;++E)if(v.indexOf(v[y]+"_"+E)==-1){v[y]+="_"+E;break}}}}var C=Pt(d["!ref"]),P=[],F=[],L=[];for(y=0;y<=C.e.c-C.s.c;++y){var N="",j="",T=0,k=[];for(E=0;E<w.length;++E)w[E][y]!=null&&k.push(w[E][y]);if(k.length==0||v[y]==null){P[y]="?";continue}for(E=0;E<k.length;++E){switch(typeof k[E]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=k[E]instanceof Date?"D":"C";break;default:j="C"}T=Math.max(T,String(k[E]).length),N=N&&N!=j?"C":j}T>250&&(T=250),j=((S[y]||{}).DBF||{}).type,j=="C"&&S[y].DBF.len>T&&(T=S[y].DBF.len),N=="B"&&j=="N"&&(N="N",L[y]=S[y].DBF.dec,T=S[y].DBF.len),F[y]=N=="C"||j=="N"?T:l[N]||0,A+=F[y],P[y]=N}var q=p.next(32);for(q.write_shift(4,318902576),q.write_shift(4,w.length),q.write_shift(2,296+32*D),q.write_shift(2,A),y=0;y<4;++y)q.write_shift(4,0);for(q.write_shift(4,0|(+e[Og]||3)<<8),y=0,E=0;y<v.length;++y)if(v[y]!=null){var B=p.next(32),Y=(v[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);B.write_shift(1,Y,"sbcs"),B.write_shift(1,P[y]=="?"?"C":P[y],"sbcs"),B.write_shift(4,E),B.write_shift(1,F[y]||l[P[y]]||0),B.write_shift(1,L[y]||0),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(1,0),B.write_shift(4,0),B.write_shift(4,0),E+=F[y]||l[P[y]]||0}var pe=p.next(264);for(pe.write_shift(4,13),y=0;y<65;++y)pe.write_shift(4,0);for(y=0;y<w.length;++y){var we=p.next(A);for(we.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(P[E]){case"L":we.write_shift(1,w[y][E]==null?63:w[y][E]?84:70);break;case"B":we.write_shift(8,w[y][E]||0,"f");break;case"N":var te="0";for(typeof w[y][E]=="number"&&(te=w[y][E].toFixed(L[E]||0)),D=0;D<F[E]-te.length;++D)we.write_shift(1,32);we.write_shift(1,te,"sbcs");break;case"D":w[y][E]?(we.write_shift(4,("0000"+w[y][E].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(w[y][E].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+w[y][E].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var he=String(w[y][E]!=null?w[y][E]:"").slice(0,F[E]);for(we.write_shift(1,he,"sbcs"),D=0;D<F[E]-he.length;++D)we.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),$4=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+jr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,w){var S=t[w];return typeof S=="number"?qp(S):S},n=function(v,w,S){var y=w.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return y==59?v:qp(y)};t["|"]=254;function i(v,w){switch(w.type){case"base64":return l(ns(v),w);case"binary":return l(v,w);case"buffer":return l(mt&&Buffer.isBuffer(v)?v.toString("binary"):al(v),w);case"array":return l(du(v),w)}throw new Error("Unrecognized type "+w.type)}function l(v,w){var S=v.split(/[\n\r]+/),y=-1,E=-1,D=0,A=0,C=[],P=[],F=null,L={},N=[],j=[],T=[],k=0,q;for(+w.codepage>=0&&Ko(+w.codepage);D!==S.length;++D){k=0;var B=S[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),Y=B.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),pe=Y[0],we;if(B.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&P.push(B.slice(3).replace(/;;/g,";"));break;case"C":var te=!1,he=!1,Q=!1,W=!1,re=-1,M=-1;for(A=1;A<Y.length;++A)switch(Y[A].charAt(0)){case"A":break;case"X":E=parseInt(Y[A].slice(1))-1,he=!0;break;case"Y":for(y=parseInt(Y[A].slice(1))-1,he||(E=0),q=C.length;q<=y;++q)C[q]=[];break;case"K":we=Y[A].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(ts(we))?isNaN(Jo(we).getDate())||(we=Ir(we)):(we=ts(we),F!==null&&Wg(F)&&(we=Gg(we))),te=!0;break;case"E":W=!0;var b=UE(Y[A].slice(1),{r:y,c:E});C[y][E]=[C[y][E],b];break;case"S":Q=!0,C[y][E]=[C[y][E],"S5S"];break;case"G":break;case"R":re=parseInt(Y[A].slice(1))-1;break;case"C":M=parseInt(Y[A].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+B)}if(te&&(C[y][E]&&C[y][E].length==2?C[y][E][0]=we:C[y][E]=we,F=null),Q){if(W)throw new Error("SYLK shared formula cannot have own formula");var I=re>-1&&C[re][M];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");C[y][E][1]=zE(I[1],{r:y-re,c:E-M})}break;case"F":var H=0;for(A=1;A<Y.length;++A)switch(Y[A].charAt(0)){case"X":E=parseInt(Y[A].slice(1))-1,++H;break;case"Y":for(y=parseInt(Y[A].slice(1))-1,q=C.length;q<=y;++q)C[q]=[];break;case"M":k=parseInt(Y[A].slice(1))/20;break;case"F":break;case"G":break;case"P":F=P[parseInt(Y[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(T=Y[A].slice(1).split(" "),q=parseInt(T[0],10);q<=parseInt(T[1],10);++q)k=parseInt(T[2],10),j[q-1]=k===0?{hidden:!0}:{wch:k},xh(j[q-1]);break;case"C":E=parseInt(Y[A].slice(1))-1,j[E]||(j[E]={});break;case"R":y=parseInt(Y[A].slice(1))-1,N[y]||(N[y]={}),k>0?(N[y].hpt=k,N[y].hpx=Fv(k)):k===0&&(N[y].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+B)}H<1&&(F=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+B)}}return N.length>0&&(L["!rows"]=N),j.length>0&&(L["!cols"]=j),w&&w.sheetRows&&(C=C.slice(0,w.sheetRows)),[C,L]}function c(v,w){var S=i(v,w),y=S[0],E=S[1],D=Ii(y,w);return jr(E).forEach(function(A){D[A]=E[A]}),D}function d(v,w){return ka(c(v,w),w)}function m(v,w,S,y){var E="C;Y"+(S+1)+";X"+(y+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+vh(v.f,{r:S,c:y}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function f(v,w){w.forEach(function(S,y){var E="F;W"+(y+1)+" "+(y+1)+" ";S.hidden?E+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=Jc(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=Yc(S.wpx)),typeof S.wch=="number"&&(E+=Math.round(S.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function p(v,w){w.forEach(function(S,y){var E="F;";S.hidden?E+="M0;":S.hpt?E+="M"+20*S.hpt+";":S.hpx&&(E+="M"+20*Qc(S.hpx)+";"),E.length>2&&v.push(E+"R"+(y+1))})}function g(v,w){var S=["ID;PWXL;N;E"],y=[],E=Pt(v["!ref"]),D,A=Array.isArray(v),C=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),v["!cols"]&&f(S,v["!cols"]),v["!rows"]&&p(S,v["!rows"]),S.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var P=E.s.r;P<=E.e.r;++P)for(var F=E.s.c;F<=E.e.c;++F){var L=_t({r:P,c:F});D=A?(v[P]||[])[F]:v[L],!(!D||D.v==null&&(!D.f||D.F))&&y.push(m(D,v,P,F))}return S.join(C)+C+y.join(C)+C+"E"+C}return{to_workbook:d,to_sheet:c,from_sheet:g}}(),W4=function(){function t(l,c){switch(c.type){case"base64":return e(ns(l),c);case"binary":return e(l,c);case"buffer":return e(mt&&Buffer.isBuffer(l)?l.toString("binary"):al(l),c);case"array":return e(du(l),c)}throw new Error("Unrecognized type "+c.type)}function e(l,c){for(var d=l.split(`
`),m=-1,f=-1,p=0,g=[];p!==d.length;++p){if(d[p].trim()==="BOT"){g[++m]=[],f=0;continue}if(!(m<0)){var v=d[p].trim().split(","),w=v[0],S=v[1];++p;for(var y=d[p]||"";(y.match(/["]/g)||[]).length&1&&p<d.length-1;)y+=`
`+d[++p];switch(y=y.trim(),+w){case-1:if(y==="BOT"){g[++m]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?g[m][f]=!0:y==="FALSE"?g[m][f]=!1:isNaN(ts(S))?isNaN(Jo(S).getDate())?g[m][f]=S:g[m][f]=Ir(S):g[m][f]=ts(S),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),g[m][f++]=y!==""?y:null;break}if(y==="EOD")break}}return c&&c.sheetRows&&(g=g.slice(0,c.sheetRows)),g}function r(l,c){return Ii(t(l,c),c)}function n(l,c){return ka(r(l,c),c)}var i=function(){var l=function(m,f,p,g,v){m.push(f),m.push(p+","+g),m.push('"'+v.replace(/"/g,'""')+'"')},c=function(m,f,p,g){m.push(f+","+p),m.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(m){var f=[],p=Pt(m["!ref"]),g,v=Array.isArray(m);l(f,"TABLE",0,1,"sheetjs"),l(f,"VECTORS",0,p.e.r-p.s.r+1,""),l(f,"TUPLES",0,p.e.c-p.s.c+1,""),l(f,"DATA",0,0,"");for(var w=p.s.r;w<=p.e.r;++w){c(f,-1,0,"BOT");for(var S=p.s.c;S<=p.e.c;++S){var y=_t({r:w,c:S});if(g=v?(m[w]||[])[S]:m[y],!g){c(f,1,0,"");continue}switch(g.t){case"n":var E=g.w;!E&&g.v!=null&&(E=g.v),E==null?g.f&&!g.F?c(f,1,0,"="+g.f):c(f,1,0,""):c(f,0,E,"V");break;case"b":c(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":c(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Hs(g.z||zt[14],Kr(Ir(g.v)))),c(f,0,g.w,"V");break;default:c(f,1,0,"")}}}c(f,-1,0,"EOD");var D=`\r
`,A=f.join(D);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Av=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,v){for(var w=g.split(`
`),S=-1,y=-1,E=0,D=[];E!==w.length;++E){var A=w[E].trim().split(":");if(A[0]==="cell"){var C=dr(A[1]);if(D.length<=C.r)for(S=D.length;S<=C.r;++S)D[S]||(D[S]=[]);switch(S=C.r,y=C.c,A[2]){case"t":D[S][y]=t(A[3]);break;case"v":D[S][y]=+A[3];break;case"vtf":var P=A[A.length-1];case"vtc":switch(A[3]){case"nl":D[S][y]=!!+A[4];break;default:D[S][y]=+A[4];break}A[2]=="vtf"&&(D[S][y]=[D[S][y],P])}}}return v&&v.sheetRows&&(D=D.slice(0,v.sheetRows)),D}function n(g,v){return Ii(r(g,v),v)}function i(g,v){return ka(n(g,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var v=[],w=[],S,y="",E=on(g["!ref"]),D=Array.isArray(g),A=E.s.r;A<=E.e.r;++A)for(var C=E.s.c;C<=E.e.c;++C)if(y=_t({r:A,c:C}),S=D?(g[A]||[])[C]:g[y],!(!S||S.v==null||S.t==="z")){switch(w=["cell",y,"t"],S.t){case"s":case"str":w.push(e(S.v));break;case"n":S.f?(w[2]="vtf",w[3]="n",w[4]=S.v,w[5]=e(S.f)):(w[2]="v",w[3]=S.v);break;case"b":w[2]="vt"+(S.f?"f":"c"),w[3]="nl",w[4]=S.v?"1":"0",w[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var P=Kr(Ir(S.v));w[2]="vtc",w[3]="nd",w[4]=""+P,w[5]=S.w||Hs(S.z||zt[14],P);break;case"e":continue}v.push(w.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(g){return[l,c,d,c,f(g),m].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}}(),V4=function(){function t(p,g,v,w,S){S.raw?g[v][w]=p:p===""||(p==="TRUE"?g[v][w]=!0:p==="FALSE"?g[v][w]=!1:isNaN(ts(p))?isNaN(Jo(p).getDate())?g[v][w]=p:g[v][w]=Ir(p):g[v][w]=ts(p))}function e(p,g){var v=g||{},w=[];if(!p||p.length===0)return w;for(var S=p.split(/[\r\n]/),y=S.length-1;y>=0&&S[y].length===0;)--y;for(var E=10,D=0,A=0;A<=y;++A)D=S[A].indexOf(" "),D==-1?D=S[A].length:D++,E=Math.max(E,D);for(A=0;A<=y;++A){w[A]=[];var C=0;for(t(S[A].slice(0,E).trim(),w,A,C,v),C=1;C<=(S[A].length-E)/10+1;++C)t(S[A].slice(E+(C-1)*10,E+C*10).trim(),w,A,C,v)}return v.sheetRows&&(w=w.slice(0,v.sheetRows)),w}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var g={},v=!1,w=0,S=0;w<p.length;++w)(S=p.charCodeAt(w))==34?v=!v:!v&&S in r&&(g[S]=(g[S]||0)+1);S=[];for(w in g)Object.prototype.hasOwnProperty.call(g,w)&&S.push([g[w],w]);if(!S.length){g=n;for(w in g)Object.prototype.hasOwnProperty.call(g,w)&&S.push([g[w],w])}return S.sort(function(y,E){return y[0]-E[0]||n[y[1]]-n[E[1]]}),r[S.pop()[1]]||44}function l(p,g){var v=g||{},w="",S=v.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(w=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(w=p.charAt(4),p=p.slice(6)):w=i(p.slice(0,1024)):v&&v.FS?w=v.FS:w=i(p.slice(0,1024));var E=0,D=0,A=0,C=0,P=0,F=w.charCodeAt(0),L=!1,N=0,j=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var T=v.dateNF!=null?iS(v.dateNF):null;function k(){var q=p.slice(C,P),B={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)B.t="z";else if(v.raw)B.t="s",B.v=q;else if(q.trim().length===0)B.t="s",B.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(B.t="s",B.v=q.slice(2,-1).replace(/""/g,'"')):$E(q)?(B.t="n",B.f=q.slice(1)):(B.t="s",B.v=q);else if(q=="TRUE")B.t="b",B.v=!0;else if(q=="FALSE")B.t="b",B.v=!1;else if(!isNaN(A=ts(q)))B.t="n",v.cellText!==!1&&(B.w=q),B.v=A;else if(!isNaN(Jo(q).getDate())||T&&q.match(T)){B.z=v.dateNF||zt[14];var Y=0;T&&q.match(T)&&(q=oS(q,v.dateNF,q.match(T)||[]),Y=1),v.cellDates?(B.t="d",B.v=Ir(q,Y)):(B.t="n",B.v=Kr(Ir(q,Y))),v.cellText!==!1&&(B.w=Hs(B.z,B.v instanceof Date?Kr(B.v):B.v)),v.cellNF||delete B.z}else B.t="s",B.v=q;if(B.t=="z"||(v.dense?(S[E]||(S[E]=[]),S[E][D]=B):S[_t({c:D,r:E})]=B),C=P+1,j=p.charCodeAt(C),y.e.c<D&&(y.e.c=D),y.e.r<E&&(y.e.r=E),N==F)++D;else if(D=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}e:for(;P<p.length;++P)switch(N=p.charCodeAt(P)){case 34:j===34&&(L=!L);break;case F:case 10:case 13:if(!L&&k())break e;break}return P-C>0&&k(),S["!ref"]=Jt(y),S}function c(p,g){return!(g&&g.PRN)||g.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,g):Ii(e(p,g),g)}function d(p,g){var v="",w=g.type=="string"?[0,0,0,0]:rC(p,g);switch(g.type){case"base64":v=ns(p);break;case"binary":v=p;break;case"buffer":g.codepage==65001?v=p.toString("utf8"):(g.codepage,v=mt&&Buffer.isBuffer(p)?p.toString("binary"):al(p));break;case"array":v=du(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+g.type)}return w[0]==239&&w[1]==187&&w[2]==191?v=Bo(v.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?v=Bo(v):g.type=="binary",v.slice(0,19)=="socialcalc:version:"?Av.to_sheet(g.type=="string"?v:Bo(v),g):c(v,g)}function m(p,g){return ka(d(p,g),g)}function f(p){for(var g=[],v=Pt(p["!ref"]),w,S=Array.isArray(p),y=v.s.r;y<=v.e.r;++y){for(var E=[],D=v.s.c;D<=v.e.c;++D){var A=_t({r:y,c:D});if(w=S?(p[y]||[])[D]:p[A],!w||w.v==null){E.push("          ");continue}for(var C=(w.w||(ss(w),w.w)||"").slice(0,10);C.length<10;)C+=" ";E.push(C+(D===0?" ":""))}g.push(E.join(""))}return g.join(`
`)}return{to_workbook:m,to_sheet:d,from_sheet:f}}(),Ex=function(){function t(b,I,H){if(b){tn(b,b.l||0);for(var G=H.Enum||re;b.l<b.length;){var se=b.read_shift(2),_e=G[se]||G[65535],me=b.read_shift(2),ye=b.l+me,xe=_e.f&&_e.f(b,me,H);if(b.l=ye,I(xe,_e,se))return}}}function e(b,I){switch(I.type){case"base64":return r(An(ns(b)),I);case"binary":return r(An(b),I);case"buffer":case"array":return r(b,I)}throw"Unsupported type "+I.type}function r(b,I){if(!b)return b;var H=I||{},G=H.dense?[]:{},se="Sheet1",_e="",me=0,ye={},xe=[],Ie=[],qe={s:{r:0,c:0},e:{r:0,c:0}},st=H.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)H.Enum=re,t(b,function(Fe,Qe,ot){switch(ot){case 0:H.vers=Fe,Fe>=4096&&(H.qpro=!0);break;case 6:qe=Fe;break;case 204:Fe&&(_e=Fe);break;case 222:_e=Fe;break;case 15:case 51:H.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:ot==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=H.dateNF||zt[14],H.cellDates&&(Fe[1].t="d",Fe[1].v=Gg(Fe[1].v))),H.qpro&&Fe[3]>me&&(G["!ref"]=Jt(qe),ye[se]=G,xe.push(se),G=H.dense?[]:{},qe={s:{r:0,c:0},e:{r:0,c:0}},me=Fe[3],se=_e||"Sheet"+(me+1),_e="");var ut=H.dense?(G[Fe[0].r]||[])[Fe[0].c]:G[_t(Fe[0])];if(ut){ut.t=Fe[1].t,ut.v=Fe[1].v,Fe[1].z!=null&&(ut.z=Fe[1].z),Fe[1].f!=null&&(ut.f=Fe[1].f);break}H.dense?(G[Fe[0].r]||(G[Fe[0].r]=[]),G[Fe[0].r][Fe[0].c]=Fe[1]):G[_t(Fe[0])]=Fe[1];break}},H);else if(b[2]==26||b[2]==14)H.Enum=M,b[2]==14&&(H.qpro=!0,b.l=0),t(b,function(Fe,Qe,ot){switch(ot){case 204:se=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>me&&(G["!ref"]=Jt(qe),ye[se]=G,xe.push(se),G=H.dense?[]:{},qe={s:{r:0,c:0},e:{r:0,c:0}},me=Fe[3],se="Sheet"+(me+1)),st>0&&Fe[0].r>=st)break;H.dense?(G[Fe[0].r]||(G[Fe[0].r]=[]),G[Fe[0].r][Fe[0].c]=Fe[1]):G[_t(Fe[0])]=Fe[1],qe.e.c<Fe[0].c&&(qe.e.c=Fe[0].c),qe.e.r<Fe[0].r&&(qe.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(Ie[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:Ie[Fe[0]]=Fe[1],Fe[0]==me&&(se=Fe[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(G["!ref"]=Jt(qe),ye[_e||se]=G,xe.push(_e||se),!Ie.length)return{SheetNames:xe,Sheets:ye};for(var Ke={},tt=[],$e=0;$e<Ie.length;++$e)ye[xe[$e]]?(tt.push(Ie[$e]||xe[$e]),Ke[Ie[$e]]=ye[Ie[$e]]||ye[xe[$e]]):(tt.push(Ie[$e]),Ke[Ie[$e]]={"!ref":"A1"});return{SheetNames:tt,Sheets:Ke}}function n(b,I){var H=I||{};if(+H.codepage>=0&&Ko(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Gr(),se=Pt(b["!ref"]),_e=Array.isArray(b),me=[];De(G,0,l(1030)),De(G,6,m(se));for(var ye=Math.min(se.e.r,8191),xe=se.s.r;xe<=ye;++xe)for(var Ie=_r(xe),qe=se.s.c;qe<=se.e.c;++qe){xe===se.s.r&&(me[qe]=Tr(qe));var st=me[qe]+Ie,Ke=_e?(b[xe]||[])[qe]:b[st];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?De(G,13,w(xe,qe,Ke.v)):De(G,14,y(xe,qe,Ke.v));else{var tt=ss(Ke);De(G,15,g(xe,qe,tt.slice(0,239)))}}return De(G,1),G.end()}function i(b,I){var H=I||{};if(+H.codepage>=0&&Ko(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Gr();De(G,0,c(b));for(var se=0,_e=0;se<b.SheetNames.length;++se)(b.Sheets[b.SheetNames[se]]||{})["!ref"]&&De(G,27,W(b.SheetNames[se],_e++));var me=0;for(se=0;se<b.SheetNames.length;++se){var ye=b.Sheets[b.SheetNames[se]];if(!(!ye||!ye["!ref"])){for(var xe=Pt(ye["!ref"]),Ie=Array.isArray(ye),qe=[],st=Math.min(xe.e.r,8191),Ke=xe.s.r;Ke<=st;++Ke)for(var tt=_r(Ke),$e=xe.s.c;$e<=xe.e.c;++$e){Ke===xe.s.r&&(qe[$e]=Tr($e));var Fe=qe[$e]+tt,Qe=Ie?(ye[Ke]||[])[$e]:ye[Fe];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")De(G,23,k(Ke,$e,me,Qe.v));else{var ot=ss(Qe);De(G,22,N(Ke,$e,me,ot.slice(0,239)))}}++me}}return De(G,1),G.end()}function l(b){var I=ge(2);return I.write_shift(2,b),I}function c(b){var I=ge(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var H=0,G=0,se=0,_e=0;_e<b.SheetNames.length;++_e){var me=b.SheetNames[_e],ye=b.Sheets[me];if(!(!ye||!ye["!ref"])){++se;var xe=on(ye["!ref"]);H<xe.e.r&&(H=xe.e.r),G<xe.e.c&&(G=xe.e.c)}}return H>8191&&(H=8191),I.write_shift(2,H),I.write_shift(1,se),I.write_shift(1,G),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function d(b,I,H){var G={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&H.qpro?(G.s.c=b.read_shift(1),b.l++,G.s.r=b.read_shift(2),G.e.c=b.read_shift(1),b.l++,G.e.r=b.read_shift(2),G):(G.s.c=b.read_shift(2),G.s.r=b.read_shift(2),I==12&&H.qpro&&(b.l+=2),G.e.c=b.read_shift(2),G.e.r=b.read_shift(2),I==12&&H.qpro&&(b.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function m(b){var I=ge(8);return I.write_shift(2,b.s.c),I.write_shift(2,b.s.r),I.write_shift(2,b.e.c),I.write_shift(2,b.e.r),I}function f(b,I,H){var G=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(G[0].c=b.read_shift(1),G[3]=b.read_shift(1),G[0].r=b.read_shift(2),b.l+=2):(G[2]=b.read_shift(1),G[0].c=b.read_shift(2),G[0].r=b.read_shift(2)),G}function p(b,I,H){var G=b.l+I,se=f(b,I,H);if(se[1].t="s",H.vers==20768){b.l++;var _e=b.read_shift(1);return se[1].v=b.read_shift(_e,"utf8"),se}return H.qpro&&b.l++,se[1].v=b.read_shift(G-b.l,"cstr"),se}function g(b,I,H){var G=ge(7+H.length);G.write_shift(1,255),G.write_shift(2,I),G.write_shift(2,b),G.write_shift(1,39);for(var se=0;se<G.length;++se){var _e=H.charCodeAt(se);G.write_shift(1,_e>=128?95:_e)}return G.write_shift(1,0),G}function v(b,I,H){var G=f(b,I,H);return G[1].v=b.read_shift(2,"i"),G}function w(b,I,H){var G=ge(7);return G.write_shift(1,255),G.write_shift(2,I),G.write_shift(2,b),G.write_shift(2,H,"i"),G}function S(b,I,H){var G=f(b,I,H);return G[1].v=b.read_shift(8,"f"),G}function y(b,I,H){var G=ge(13);return G.write_shift(1,255),G.write_shift(2,I),G.write_shift(2,b),G.write_shift(8,H,"f"),G}function E(b,I,H){var G=b.l+I,se=f(b,I,H);if(se[1].v=b.read_shift(8,"f"),H.qpro)b.l=G;else{var _e=b.read_shift(2);P(b.slice(b.l,b.l+_e),se),b.l+=_e}return se}function D(b,I,H){var G=I&32768;return I&=-32769,I=(G?b:0)+(I>=8192?I-16384:I),(G?"":"$")+(H?Tr(I):_r(I))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(b,I){tn(b,0);for(var H=[],G=0,se="",_e="",me="",ye="";b.l<b.length;){var xe=b[b.l++];switch(xe){case 0:H.push(b.read_shift(8,"f"));break;case 1:_e=D(I[0].c,b.read_shift(2),!0),se=D(I[0].r,b.read_shift(2),!1),H.push(_e+se);break;case 2:{var Ie=D(I[0].c,b.read_shift(2),!0),qe=D(I[0].r,b.read_shift(2),!1);_e=D(I[0].c,b.read_shift(2),!0),se=D(I[0].r,b.read_shift(2),!1),H.push(Ie+qe+":"+_e+se)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(b.read_shift(2));break;case 6:{for(var st="";xe=b[b.l++];)st+=String.fromCharCode(xe);H.push('"'+st.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ye=H.pop(),me=H.pop(),H.push(["AND","OR"][xe-20]+"("+me+","+ye+")");break;default:if(xe<32&&C[xe])ye=H.pop(),me=H.pop(),H.push(me+C[xe]+ye);else if(A[xe]){if(G=A[xe][1],G==69&&(G=b[b.l++]),G>H.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+H.join("|")+"|");return}var Ke=H.slice(-G);H.length-=G,H.push(A[xe][0]+"("+Ke.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}H.length==1?I[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function F(b){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=b.read_shift(2),I[3]=b[b.l++],I[0].c=b[b.l++],I}function L(b,I){var H=F(b);return H[1].t="s",H[1].v=b.read_shift(I-4,"cstr"),H}function N(b,I,H,G){var se=ge(6+G.length);se.write_shift(2,b),se.write_shift(1,H),se.write_shift(1,I),se.write_shift(1,39);for(var _e=0;_e<G.length;++_e){var me=G.charCodeAt(_e);se.write_shift(1,me>=128?95:me)}return se.write_shift(1,0),se}function j(b,I){var H=F(b);H[1].v=b.read_shift(2);var G=H[1].v>>1;if(H[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return H[1].v=G,H}function T(b,I){var H=F(b),G=b.read_shift(4),se=b.read_shift(4),_e=b.read_shift(2);if(_e==65535)return G===0&&se===3221225472?(H[1].t="e",H[1].v=15):G===0&&se===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var me=_e&32768;return _e=(_e&32767)-16446,H[1].v=(1-me*2)*(se*Math.pow(2,_e+32)+G*Math.pow(2,_e)),H}function k(b,I,H,G){var se=ge(14);if(se.write_shift(2,b),se.write_shift(1,H),se.write_shift(1,I),G==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var _e=0,me=0,ye=0,xe=0;return G<0&&(_e=1,G=-G),me=Math.log2(G)|0,G/=Math.pow(2,me-31),xe=G>>>0,(xe&2147483648)==0&&(G/=2,++me,xe=G>>>0),G-=xe,xe|=2147483648,xe>>>=0,G*=Math.pow(2,32),ye=G>>>0,se.write_shift(4,ye),se.write_shift(4,xe),me+=16383+(_e?32768:0),se.write_shift(2,me),se}function q(b,I){var H=T(b);return b.l+=I-14,H}function B(b,I){var H=F(b),G=b.read_shift(4);return H[1].v=G>>6,H}function Y(b,I){var H=F(b),G=b.read_shift(8,"f");return H[1].v=G,H}function pe(b,I){var H=Y(b);return b.l+=I-10,H}function we(b,I){return b[b.l+I-1]==0?b.read_shift(I,"cstr"):""}function te(b,I){var H=b[b.l++];H>I-1&&(H=I-1);for(var G="";G.length<H;)G+=String.fromCharCode(b[b.l++]);return G}function he(b,I,H){if(!(!H.qpro||I<21)){var G=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var se=b.read_shift(I-21,"cstr");return[G,se]}}function Q(b,I){for(var H={},G=b.l+I;b.l<G;){var se=b.read_shift(2);if(se==14e3){for(H[se]=[0,""],H[se][0]=b.read_shift(2);b[b.l];)H[se][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return H}function W(b,I){var H=ge(5+b.length);H.write_shift(2,14e3),H.write_shift(2,I);for(var G=0;G<b.length;++G){var se=b.charCodeAt(G);H[H.l++]=se>127?95:se}return H[H.l++]=0,H}var re={0:{n:"BOF",f:Nv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:te},65535:{n:""}},M={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:T},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:B},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),H4=/^\s|\s$|[\t\n\r]/;function Ov(t,e){if(!e.bookSST)return"";var r=[Yt];r[r.length]=Re("sst",null,{xmlns:Li[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],l="<si>";i.r?l+=i.r:(l+="<t",i.t||(i.t=""),i.t.match(H4)&&(l+=' xml:space="preserve"'),l+=">"+yt(i.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function q4(t){return[t.read_shift(4),t.read_shift(4)]}function G4(t,e){return e||(e=ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var K4=MS;function X4(t){var e=Gr();je(e,159,G4(t));for(var r=0;r<t.length;++r)je(e,19,K4(t[r]));return je(e,160),e.end()}function J4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Pv(t){var e=0,r,n=J4(t),i=n.length+1,l,c,d,m,f;for(r=Ea(i),r[0]=n.length,l=1;l!=i;++l)r[l]=n[l-1];for(l=i-1;l>=0;--l)c=r[l],d=(e&16384)===0?0:1,m=e<<1&32767,f=d|m,e=f^c;return e^52811}var Y4=function(){function t(i,l){switch(l.type){case"base64":return e(ns(i),l);case"binary":return e(i,l);case"buffer":return e(mt&&Buffer.isBuffer(i)?i.toString("binary"):al(i),l);case"array":return e(du(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){var c=l||{},d=c.dense?[]:{},m=i.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(p,g){Array.isArray(d)&&(d[g]=[]);for(var v=/\\\w+\b/g,w=0,S,y=-1;S=v.exec(p);){switch(S[0]){case"\\cell":var E=p.slice(w,v.lastIndex-S[0].length);if(E[0]==" "&&(E=E.slice(1)),++y,E.length){var D={v:E,t:"s"};Array.isArray(d)?d[g][y]=D:d[_t({r:g,c:y})]=D}break}w=v.lastIndex}y>f.e.c&&(f.e.c=y)}),d["!ref"]=Jt(f),d}function r(i,l){return ka(t(i,l),l)}function n(i){for(var l=["{\\rtf1\\ansi"],c=Pt(i["!ref"]),d,m=Array.isArray(i),f=c.s.r;f<=c.e.r;++f){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var g=_t({r:f,c:p});d=m?(i[f]||[])[p]:i[g],!(!d||d.v==null&&(!d.f||d.F))&&(l.push(" "+(d.w||(ss(d),d.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Nx(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var Q4=6,rs=Q4;function Jc(t){return Math.floor((t+Math.round(128/rs)/256)*rs)}function Yc(t){return Math.floor((t-5)/rs*100+.5)/100}function Uf(t){return Math.round((t*rs+5)/rs*256)/256}function xh(t){t.width?(t.wpx=Jc(t.width),t.wch=Yc(t.wpx),t.MDW=rs):t.wpx?(t.wch=Yc(t.wpx),t.width=Uf(t.wch),t.MDW=rs):typeof t.wch=="number"&&(t.width=Uf(t.wch),t.wpx=Jc(t.width),t.MDW=rs),t.customWidth&&delete t.customWidth}var Z4=96,Rv=Z4;function Qc(t){return t*96/Rv}function Fv(t){return t*Rv/96}function eE(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Re("numFmt",null,{numFmtId:n,formatCode:yt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Re("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function tE(t){var e=[];return e[e.length]=Re("cellXfs",null),t.forEach(function(r){e[e.length]=Re("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Re("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Dv(t,e){var r=[Yt,Re("styleSheet",null,{xmlns:Li[0],"xmlns:vt":ur.vt})],n;return t.SSF&&(n=eE(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=tE(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function rE(t,e){var r=t.read_shift(2),n=kr(t);return[r,n]}function nE(t,e,r){r||(r=ge(6+4*e.length)),r.write_shift(2,t),fr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function sE(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=HS(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var l=t.read_shift(2);switch(l===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var d=t.read_shift(1);d>0&&(n.family=d);var m=t.read_shift(1);switch(m>0&&(n.charset=m),t.l++,n.color=VS(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=kr(t),n}function aE(t,e){e||(e=ge(25+4*32)),e.write_shift(2,t.sz*20),qS(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Kc(t.color,e);var n=0;return n=2,e.write_shift(1,n),fr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var iE=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],xf,oE=$n;function bx(t,e){e||(e=ge(4*3+8*7+16*1)),xf||(xf=sh(iE));var r=xf[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Kc({auto:1},e),Kc({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function lE(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function Lv(t,e,r){r||(r=ge(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Co(t,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var cE=$n;function uE(t,e){return e||(e=ge(51)),e.write_shift(1,0),Co(null,e),Co(null,e),Co(null,e),Co(null,e),Co(null,e),e.length>e.l?e.slice(0,e.l):e}function dE(t,e){return e||(e=ge(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Gc(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function fE(t,e,r){var n=ge(2052);return n.write_shift(4,t),Gc(e,n),Gc(r,n),n.length>n.l?n.slice(0,n.l):n}function hE(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(je(t,615,Pn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&je(t,44,nE(i,e[i]))}),je(t,616))}}function mE(t){var e=1;je(t,611,Pn(e)),je(t,43,aE({sz:12,color:{theme:1},name:"Calibri",family:2})),je(t,612)}function pE(t){var e=2;je(t,603,Pn(e)),je(t,45,bx({patternType:"none"})),je(t,45,bx({patternType:"gray125"})),je(t,604)}function xE(t){var e=1;je(t,613,Pn(e)),je(t,46,uE()),je(t,614)}function gE(t){var e=1;je(t,626,Pn(e)),je(t,47,Lv({numFmtId:0},65535)),je(t,627)}function vE(t,e){je(t,617,Pn(e.length)),e.forEach(function(r){je(t,47,Lv(r,0))}),je(t,618)}function yE(t){var e=1;je(t,619,Pn(e)),je(t,48,dE({xfId:0,name:"Normal"})),je(t,620)}function _E(t){var e=0;je(t,505,Pn(e)),je(t,506)}function wE(t){var e=0;je(t,508,fE(e,"TableStyleMedium9","PivotStyleMedium4")),je(t,509)}function jE(t,e){var r=Gr();return je(r,278),hE(r,t.SSF),mE(r),pE(r),xE(r),gE(r),vE(r,e.cellXfs),yE(r),_E(r),wE(r),je(r,279),r.end()}function Iv(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Yt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function SE(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:kr(t)}}function EE(t){var e=ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),fr(t.name,e),e.slice(0,e.l)}function NE(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function bE(t){var e=ge(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function TE(t,e){var r=ge(8+2*e.length);return r.write_shift(4,t),fr(e,r),r.slice(0,r.l)}function kE(t){return t.l+=4,t.read_shift(4)!=0}function CE(t,e){var r=ge(8);return r.write_shift(4,t),r.write_shift(4,1),r}function AE(){var t=Gr();return je(t,332),je(t,334,Pn(1)),je(t,335,EE({name:"XLDAPR",version:12e4,flags:3496657072})),je(t,336),je(t,339,TE(1,"XLDAPR")),je(t,52),je(t,35,Pn(514)),je(t,4096,Pn(0)),je(t,4097,gn(1)),je(t,36),je(t,53),je(t,340),je(t,337,CE(1)),je(t,51,bE([[1,0]])),je(t,338),je(t,333),t.end()}function Mv(){var t=[Yt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function OE(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=_t(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var wi=1024;function Bv(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Re("xml",null,{"xmlns:v":rn.v,"xmlns:o":rn.o,"xmlns:x":rn.x,"xmlns:mv":rn.mv}).replace(/\/>/,">"),Re("o:shapelayout",Re("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Re("v:shapetype",[Re("v:stroke",null,{joinstyle:"miter"}),Re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];wi<t*1e3;)wi+=1e3;return e.forEach(function(l){var c=dr(l[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var m=d.type=="gradient"?Re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Re("v:fill",m,d),p={on:"t",obscured:"t"};++wi,i=i.concat(["<v:shape"+Qo({id:"_x0000_s"+wi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Re("v:shadow",null,p),Re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",yr("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),yr("x:AutoFill","False"),yr("x:Row",String(c.r)),yr("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Uv(t){var e=[Yt,Re("comments",null,{xmlns:Li[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var l=yt(i.a);r.indexOf(l)==-1&&(r.push(l),e.push("<author>"+l+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(m){m.a&&(i=r.indexOf(yt(m.a))),l.push(m.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),l.length<=1)e.push(yr("t",yt(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,d=1;d<l.length;++d)c+=`Reply:
    `+l[d]+`
`;e.push(yr("t",yt(c)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function PE(t,e,r){var n=[Yt,Re("ThreadedComments",null,{xmlns:ur.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var l="";(i[1]||[]).forEach(function(c,d){if(!c.T){delete c.ID;return}c.a&&e.indexOf(c.a)==-1&&e.push(c.a);var m={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};d==0?l=m.id:m.parentId=l,c.ID=m.id,c.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(c.a)).slice(-12)+"}"),n.push(Re("threadedComment",yr("text",c.t||""),m))})}),n.push("</ThreadedComments>"),n.join("")}function RE(t){var e=[Yt,Re("personList",null,{xmlns:ur.TCMNT,"xmlns:x":Li[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Re("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function FE(t){var e={};e.iauthor=t.read_shift(4);var r=Pa(t);return e.rfx=r.s,e.ref=_t(r.s),t.l+=16,e}function DE(t,e){return e==null&&(e=ge(36)),e.write_shift(4,t[1].iauthor),Mi(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var LE=kr;function IE(t){return fr(t.slice(0,54))}function ME(t){var e=Gr(),r=[];return je(e,628),je(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),je(e,632,IE(i.a)))})}),je(e,631),je(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var l={s:dr(n[0]),e:dr(n[0])};je(e,635,DE([l,i])),i.t&&i.t.length>0&&je(e,637,US(i)),je(e,636),delete i.iauthor})}),je(e,634),je(e,629),e.end()}function BE(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&wt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var zv=["xlsb","xlsm","xlam","biff8","xla"],UE=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,l,c){var d=!1,m=!1;l.length==0?m=!0:l.charAt(0)=="["&&(m=!0,l=l.slice(1,-1)),c.length==0?d=!0:c.charAt(0)=="["&&(d=!0,c=c.slice(1,-1));var f=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return d?p+=e.c:--p,m?f+=e.r:--f,i+(d?"":"$")+Tr(p)+(m?"":"$")+_r(f)}return function(i,l){return e=l,i.replace(t,r)}}(),gh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vh=function(){return function(e,r){return e.replace(gh,function(n,i,l,c,d,m){var f=dh(c)-(l?0:r.c),p=uh(m)-(d?0:r.r),g=p==0?"":d?p+1:"["+p+"]",v=f==0?"":l?f+1:"["+f+"]";return i+"R"+g+"C"+v})}}();function zE(t,e){return t.replace(gh,function(r,n,i,l,c,d){return n+(i=="$"?i+l:Tr(dh(l)+e.c))+(c=="$"?c+d:_r(uh(d)+e.r))})}function $E(t){return t.length!=1}function Kt(t){t.l+=1}function qs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function $v(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Wv(t);r.biff==12&&(n=4)}var i=t.read_shift(n),l=t.read_shift(n),c=qs(t),d=qs(t);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function Wv(t){var e=qs(t),r=qs(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function WE(t,e,r){if(r.biff<8)return Wv(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),l=qs(t),c=qs(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function Vv(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return VE(t);var n=t.read_shift(r&&r.biff==12?4:2),i=qs(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function VE(t){var e=qs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function HE(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function qE(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return GE(t);var i=t.read_shift(n>=12?4:2),l=t.read_shift(2),c=(l&16384)>>14,d=(l&32768)>>15;if(l&=16383,d==1)for(;i>524287;)i-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:c,rRel:d}}function GE(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function KE(t,e,r){var n=(t[t.l++]&96)>>5,i=$v(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function XE(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}var c=$v(t,l,r);return[n,i,c]}function JE(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function YE(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}return t.l+=l,[n,i]}function QE(t,e,r){var n=(t[t.l++]&96)>>5,i=WE(t,e-1,r);return[n,i]}function ZE(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Tx(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function eN(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],l=0;l<=n;++l)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function tN(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function rN(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function nN(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function sN(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Hv(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function aN(t){return t.read_shift(2),Hv(t)}function iN(t){return t.read_shift(2),Hv(t)}function oN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Vv(t,0,r);return[n,i]}function lN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=qE(t,0,r);return[n,i]}function cN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var l=Vv(t,0,r);return[n,i,l]}function uN(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[ub[i],Kv[i],n]}function dN(t,e,r){var n=t[t.l++],i=t.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:fN(t);return[i,(l[0]===0?Kv:cb)[l[1]]]}function fN(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function hN(t,e,r){t.l+=r&&r.biff==2?3:4}function mN(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function pN(t){return t.l++,ll[t.read_shift(1)]}function xN(t){return t.l++,t.read_shift(2)}function gN(t){return t.l++,t.read_shift(1)!==0}function vN(t){return t.l++,Bi(t)}function yN(t,e,r){return t.l++,Tv(t,e-1,r)}function _N(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=c4(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=ll[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Bi(t);break;case 2:r[1]=h4(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function wN(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],l=0;l!=n;++l)i.push((r.biff==12?Pa:x4)(t));return i}function jN(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var d=0;d!=i;++d)c[l][d]=_N(t,r.biff);return c}function SN(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,l=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,l]}function EN(t,e,r){if(r.biff==5)return NN(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),l=t.read_shift(4);return[n,i,l]}function NN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function bN(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function TN(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function kN(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function CN(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return t.l+=l,[n,i]}var AN=$n,ON=$n,PN=$n;function cl(t,e,r){return t.l+=2,[HE(t)]}function yh(t){return t.l+=6,[]}var RN=cl,FN=yh,DN=yh,LN=cl;function qv(t){return t.l+=2,[Nv(t),t.read_shift(2)&1]}var IN=cl,MN=qv,BN=yh,UN=cl,zN=cl,$N=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function WN(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),l=t.read_shift(2),c=$N[r>>2&31];return{ixti:e,coltype:r&3,rt:c,idx:n,c:i,C:l}}function VN(t){return t.l+=2,[t.read_shift(4)]}function HN(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function qN(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function KN(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function XN(t){return t.l+=4,[0,0]}var kx={1:{n:"PtgExp",f:mN},2:{n:"PtgTbl",f:PN},3:{n:"PtgAdd",f:Kt},4:{n:"PtgSub",f:Kt},5:{n:"PtgMul",f:Kt},6:{n:"PtgDiv",f:Kt},7:{n:"PtgPower",f:Kt},8:{n:"PtgConcat",f:Kt},9:{n:"PtgLt",f:Kt},10:{n:"PtgLe",f:Kt},11:{n:"PtgEq",f:Kt},12:{n:"PtgGe",f:Kt},13:{n:"PtgGt",f:Kt},14:{n:"PtgNe",f:Kt},15:{n:"PtgIsect",f:Kt},16:{n:"PtgUnion",f:Kt},17:{n:"PtgRange",f:Kt},18:{n:"PtgUplus",f:Kt},19:{n:"PtgUminus",f:Kt},20:{n:"PtgPercent",f:Kt},21:{n:"PtgParen",f:Kt},22:{n:"PtgMissArg",f:Kt},23:{n:"PtgStr",f:yN},26:{n:"PtgSheet",f:HN},27:{n:"PtgEndSheet",f:qN},28:{n:"PtgErr",f:pN},29:{n:"PtgBool",f:gN},30:{n:"PtgInt",f:xN},31:{n:"PtgNum",f:vN},32:{n:"PtgArray",f:ZE},33:{n:"PtgFunc",f:uN},34:{n:"PtgFuncVar",f:dN},35:{n:"PtgName",f:SN},36:{n:"PtgRef",f:oN},37:{n:"PtgArea",f:KE},38:{n:"PtgMemArea",f:bN},39:{n:"PtgMemErr",f:AN},40:{n:"PtgMemNoMem",f:ON},41:{n:"PtgMemFunc",f:TN},42:{n:"PtgRefErr",f:kN},43:{n:"PtgAreaErr",f:JE},44:{n:"PtgRefN",f:lN},45:{n:"PtgAreaN",f:QE},46:{n:"PtgMemAreaN",f:GN},47:{n:"PtgMemNoMemN",f:KN},57:{n:"PtgNameX",f:EN},58:{n:"PtgRef3d",f:cN},59:{n:"PtgArea3d",f:XE},60:{n:"PtgRefErr3d",f:CN},61:{n:"PtgAreaErr3d",f:YE},255:{}},JN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YN={1:{n:"PtgElfLel",f:qv},2:{n:"PtgElfRw",f:UN},3:{n:"PtgElfCol",f:RN},6:{n:"PtgElfRwV",f:zN},7:{n:"PtgElfColV",f:LN},10:{n:"PtgElfRadical",f:IN},11:{n:"PtgElfRadicalS",f:BN},13:{n:"PtgElfColS",f:FN},15:{n:"PtgElfColSV",f:DN},16:{n:"PtgElfRadicalLel",f:MN},25:{n:"PtgList",f:WN},29:{n:"PtgSxName",f:VN},255:{}},QN={0:{n:"PtgAttrNoop",f:XN},1:{n:"PtgAttrSemi",f:sN},2:{n:"PtgAttrIf",f:rN},4:{n:"PtgAttrChoose",f:eN},8:{n:"PtgAttrGoto",f:tN},16:{n:"PtgAttrSum",f:hN},32:{n:"PtgAttrBaxcel",f:Tx},33:{n:"PtgAttrBaxcel",f:Tx},64:{n:"PtgAttrSpace",f:aN},65:{n:"PtgAttrSpaceSemi",f:iN},128:{n:"PtgAttrIfError",f:nN},255:{}};function ZN(t,e,r,n){if(n.biff<8)return $n(t,e);for(var i=t.l+e,l=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=jN(t,0,n),l.push(r[c][1]);break;case"PtgMemArea":r[c][2]=wN(t,r[c][1],n),l.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=t.read_shift(4),l.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return e=i-t.l,e!==0&&l.push($n(t,e)),l}function eb(t,e,r){for(var n=t.l+e,i,l,c=[];n!=t.l;)e=n-t.l,l=t[t.l],i=kx[l]||kx[JN[l]],(l===24||l===25)&&(i=(l===24?YN:QN)[t[t.l+1]]),!i||!i.f?$n(t,e):c.push([i.n,i.f(t,e,r)]);return c}function tb(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var rb={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nb(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Gv(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Cx(t,e,r){var n=Gv(t,e,r);return n=="#REF"?n:nb(n,r)}function Ai(t,e,r,n,i){var l=i&&i.biff||8,c={s:{c:0,r:0}},d=[],m,f,p,g=0,v=0,w,S="";if(!t[0]||!t[0][0])return"";for(var y=-1,E="",D=0,A=t[0].length;D<A;++D){var C=t[0][D];switch(C[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=d.pop(),f=d.pop(),y>=0){switch(t[0][y][1][0]){case 0:E=Ut(" ",t[0][y][1][1]);break;case 1:E=Ut("\r",t[0][y][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}f=f+E,y=-1}d.push(f+rb[C[0]]+m);break;case"PtgIsect":m=d.pop(),f=d.pop(),d.push(f+" "+m);break;case"PtgUnion":m=d.pop(),f=d.pop(),d.push(f+","+m);break;case"PtgRange":m=d.pop(),f=d.pop(),d.push(f+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=zo(C[1][1],c,i),d.push($o(p,l));break;case"PtgRefN":p=r?zo(C[1][1],r,i):C[1][1],d.push($o(p,l));break;case"PtgRef3d":g=C[1][1],p=zo(C[1][2],c,i),S=Cx(n,g,i),d.push(S+"!"+$o(p,l));break;case"PtgFunc":case"PtgFuncVar":var P=C[1][0],F=C[1][1];P||(P=0),P&=127;var L=P==0?[]:d.slice(-P);d.length-=P,F==="User"&&(F=L.shift()),d.push(F+"("+L.join(",")+")");break;case"PtgBool":d.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(C[1]);break;case"PtgNum":d.push(String(C[1]));break;case"PtgStr":d.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(C[1]);break;case"PtgAreaN":w=hx(C[1][1],r?{s:r}:c,i),d.push(mf(w,i));break;case"PtgArea":w=hx(C[1][1],c,i),d.push(mf(w,i));break;case"PtgArea3d":g=C[1][1],w=C[1][2],S=Cx(n,g,i),d.push(S+"!"+mf(w,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var N=(n.names||[])[v-1]||(n[0]||[])[v],j=N?N.Name:"SH33TJSNAME"+String(v);j&&j.slice(0,6)=="_xlfn."&&!i.xlfn&&(j=j.slice(6)),d.push(j);break;case"PtgNameX":var T=C[1][1];v=C[1][2];var k;if(i.biff<=5)T<0&&(T=-T),n[T]&&(k=n[T][v]);else{var q="";if(((n[T]||[])[0]||[])[0]==14849||(((n[T]||[])[0]||[])[0]==1025?n[T][v]&&n[T][v].itab>0&&(q=n.SheetNames[n[T][v].itab-1]+"!"):q=n.SheetNames[v-1]+"!"),n[T]&&n[T][v])q+=n[T][v].Name;else if(n[0]&&n[0][v])q+=n[0][v].Name;else{var B=(Gv(n,T,i)||"").split(";;");B[v-1]?q=B[v-1]:q+="SH33TJSERRX"}d.push(q);break}k||(k={Name:"SH33TJSERRY"}),d.push(k.Name);break;case"PtgParen":var Y="(",pe=")";if(y>=0){switch(E="",t[0][y][1][0]){case 2:Y=Ut(" ",t[0][y][1][1])+Y;break;case 3:Y=Ut("\r",t[0][y][1][1])+Y;break;case 4:pe=Ut(" ",t[0][y][1][1])+pe;break;case 5:pe=Ut("\r",t[0][y][1][1])+pe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}d.push(Y+d.pop()+pe);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[_t(p)]){var te=n.sharedf[_t(p)];d.push(Ai(te,c,we,n,i))}else{var he=!1;for(m=0;m!=n.arrayf.length;++m)if(f=n.arrayf[m],!(p.c<f[0].s.c||p.c>f[0].e.c)&&!(p.r<f[0].s.r||p.r>f[0].e.r)){d.push(Ai(f[1],c,we,n,i)),he=!0;break}he||d.push(C[1])}break;case"PtgArray":d.push("{"+tb(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&y>=0&&Q.indexOf(t[0][D][0])==-1){C=t[0][y];var W=!0;switch(C[1][0]){case 4:W=!1;case 0:E=Ut(" ",C[1][1]);break;case 5:W=!1;case 1:E=Ut("\r",C[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}d.push((W?E:"")+d.pop()+(W?"":E)),y=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function sb(t){if(t==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Na(t);return Na(0)}function ab(t,e,r,n,i){var l=ba(e,r,i),c=sb(t.v),d=ge(6),m=33;d.write_shift(2,m),d.write_shift(4,0);for(var f=ge(t.bf.length),p=0;p<t.bf.length;++p)f[p]=t.bf[p];var g=vr([l,c,d,f]);return g}function fu(t,e,r){var n=t.read_shift(4),i=eb(t,n,r),l=t.read_shift(4),c=l>0?ZN(t,l,i,r):null;return[i,c]}var ib=fu,hu=fu,ob=fu,lb=fu,cb={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Kv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ub={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function db(t){var e="of:="+t.replace(gh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function fb(t){return t.replace(/\./,"!")}var Wo=typeof Map<"u";function _h(t,e,r){var n=0,i=t.length;if(r){if(Wo?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var l=Wo?r.get(e):r[e];n<l.length;++n)if(t[l[n]].t===e)return t.Count++,l[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Wo?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function mu(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(rs=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Yc(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Uf(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Xv(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Zs(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,l=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Vg(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=l;++i)if(t[i].numFmtId===n)return i;return t[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function hb(t,e,r){if(t&&t["!ref"]){var n=Pt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function mb(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Jt(t[r])+'"/>';return e+"</mergeCells>"}function pb(t,e,r,n,i){var l=!1,c={},d=null;if(n.bookType!=="xlsx"&&e.vbaraw){var m=e.SheetNames[r];try{e.Workbook&&(m=e.Workbook.Sheets[r].CodeName||m)}catch{}l=!0,c.codeName=Yo(yt(m))}if(t&&t["!outline"]){var f={summaryBelow:1,summaryRight:1};t["!outline"].above&&(f.summaryBelow=0),t["!outline"].left&&(f.summaryRight=0),d=(d||"")+Re("outlinePr",null,f)}!l&&!d||(i[i.length]=Re("sheetPr",d,c))}var xb=["objects","scenarios","selectLockedCells","selectUnlockedCells"],gb=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function vb(t){var e={sheet:1};return xb.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),gb.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Pv(t.password).toString(16).toUpperCase()),Re("sheetProtection",null,e)}function yb(t){return Xv(t),Re("pageMargins",null,t)}function _b(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Re("col",null,mu(i,n)));return r[r.length]="</cols>",r.join("")}function wb(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Jt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=on(i);c.s.r==c.e.r&&(c.e.r=on(e["!ref"]).e.r,i=Jt(c));for(var d=0;d<l.length;++d){var m=l[d];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return d==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Re("autoFilter",null,{ref:i})}function jb(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Re("sheetViews",Re("sheetView",null,i),{})}function Sb(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",l=t.t,c=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=ll[t.v];break;case"d":n&&n.cellDates?i=Ir(t.v,-1).toISOString():(t=Xr(t),t.t="n",i=""+(t.v=Kr(Ir(t.v)))),typeof t.z>"u"&&(t.z=zt[14]);break;default:i=t.v;break}var d=yr("v",yt(i)),m={r:e},f=Zs(n.cellXfs,t,n);switch(f!==0&&(m.s=f),t.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){d=yr("v",""+_h(n.Strings,t.v,n.revStrings)),m.t="s";break}m.t="str";break}if(t.t!=l&&(t.t=l,t.v=c),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;d=Re("f",yt(t.f),p)+(t.v!=null?d:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(m.cm=1),Re("c",d,m)}function Eb(t,e,r,n){var i=[],l=[],c=Pt(t["!ref"]),d="",m,f="",p=[],g=0,v=0,w=t["!rows"],S=Array.isArray(t),y={r:f},E,D=-1;for(v=c.s.c;v<=c.e.c;++v)p[v]=Tr(v);for(g=c.s.r;g<=c.e.r;++g){for(l=[],f=_r(g),v=c.s.c;v<=c.e.c;++v){m=p[v]+f;var A=S?(t[g]||[])[v]:t[m];A!==void 0&&(d=Sb(A,m,t,e))!=null&&l.push(d)}(l.length>0||w&&w[g])&&(y={r:f},w&&w[g]&&(E=w[g],E.hidden&&(y.hidden=1),D=-1,E.hpx?D=Qc(E.hpx):E.hpt&&(D=E.hpt),D>-1&&(y.ht=D,y.customHeight=1),E.level&&(y.outlineLevel=E.level)),i[i.length]=Re("row",l.join(""),y))}if(w)for(;g<w.length;++g)w&&w[g]&&(y={r:g+1},E=w[g],E.hidden&&(y.hidden=1),D=-1,E.hpx?D=Qc(E.hpx):E.hpt&&(D=E.hpt),D>-1&&(y.ht=D,y.customHeight=1),E.level&&(y.outlineLevel=E.level),i[i.length]=Re("row","",y));return i.join("")}function Jv(t,e,r,n){var i=[Yt,Re("worksheet",null,{xmlns:Li[0],"xmlns:r":ur.r})],l=r.SheetNames[t],c=0,d="",m=r.Sheets[l];m==null&&(m={});var f=m["!ref"]||"A1",p=Pt(f);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),f=Jt(p)}n||(n={}),m["!comments"]=[];var g=[];pb(m,r,t,e,i),i[i.length]=Re("dimension",null,{ref:f}),i[i.length]=jb(m,e,t,r),e.sheetFormat&&(i[i.length]=Re("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(i[i.length]=_b(m,m["!cols"])),i[c=i.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(d=Eb(m,e),d.length>0&&(i[i.length]=d)),i.length>c+1&&(i[i.length]="</sheetData>",i[c]=i[c].replace("/>",">")),m["!protect"]&&(i[i.length]=vb(m["!protect"])),m["!autofilter"]!=null&&(i[i.length]=wb(m["!autofilter"],m,r,t)),m["!merges"]!=null&&m["!merges"].length>0&&(i[i.length]=mb(m["!merges"]));var v=-1,w,S=-1;return m["!links"].length>0&&(i[i.length]="<hyperlinks>",m["!links"].forEach(function(y){y[1].Target&&(w={ref:y[0]},y[1].Target.charAt(0)!="#"&&(S=vt(n,-1,yt(y[1].Target).replace(/#.*$/,""),ht.HLINK),w["r:id"]="rId"+S),(v=y[1].Target.indexOf("#"))>-1&&(w.location=yt(y[1].Target.slice(v+1))),y[1].Tooltip&&(w.tooltip=yt(y[1].Tooltip)),i[i.length]=Re("hyperlink",null,w))}),i[i.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(i[i.length]=yb(m["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=yr("ignoredErrors",Re("ignoredError",null,{numberStoredAsText:1,sqref:f}))),g.length>0&&(S=vt(n,-1,"../drawings/drawing"+(t+1)+".xml",ht.DRAW),i[i.length]=Re("drawing",null,{"r:id":"rId"+S}),m["!drawing"]=g),m["!comments"].length>0&&(S=vt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ht.VML),i[i.length]=Re("legacyDrawing",null,{"r:id":"rId"+S}),m["!legacy"]=S),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Nb(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var l=t.read_shift(1);return t.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=i/20),r}function bb(t,e,r){var n=ge(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var l=320;i.hpx?l=Qc(i.hpx)*20:i.hpt&&(l=i.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var c=0;i.level&&(c|=i.level),i.hidden&&(c|=16),(i.hpx||i.hpt)&&(c|=32),n.write_shift(1,c),n.write_shift(1,0);var d=0,m=n.l;n.l+=4;for(var f={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var g=-1,v=-1,w=p<<10;w<p+1<<10;++w){f.c=w;var S=Array.isArray(r)?(r[f.r]||[])[f.c]:r[_t(f)];S&&(g<0&&(g=w),v=w)}g<0||(++d,n.write_shift(4,g),n.write_shift(4,v))}var y=n.l;return n.l=m,n.write_shift(4,d),n.l=y,n.length>n.l?n.slice(0,n.l):n}function Tb(t,e,r,n){var i=bb(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&je(t,0,i)}var kb=Pa,Cb=Mi;function Ab(){}function Ob(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=zS(t),r}function Pb(t,e,r){r==null&&(r=ge(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Kc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),dv(t,r),r.slice(0,r.l)}function Rb(t){var e=vn(t);return[e]}function Fb(t,e,r){return r==null&&(r=ge(8)),Ca(e,r)}function Db(t){var e=Aa(t);return[e]}function Lb(t,e,r){return r==null&&(r=ge(4)),Oa(e,r)}function Ib(t){var e=vn(t),r=t.read_shift(1);return[e,r,"b"]}function Mb(t,e,r){return r==null&&(r=ge(9)),Ca(e,r),r.write_shift(1,t.v?1:0),r}function Bb(t){var e=Aa(t),r=t.read_shift(1);return[e,r,"b"]}function Ub(t,e,r){return r==null&&(r=ge(5)),Oa(e,r),r.write_shift(1,t.v?1:0),r}function zb(t){var e=vn(t),r=t.read_shift(1);return[e,r,"e"]}function $b(t,e,r){return r==null&&(r=ge(9)),Ca(e,r),r.write_shift(1,t.v),r}function Wb(t){var e=Aa(t),r=t.read_shift(1);return[e,r,"e"]}function Vb(t,e,r){return r==null&&(r=ge(8)),Oa(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function Hb(t){var e=vn(t),r=t.read_shift(4);return[e,r,"s"]}function qb(t,e,r){return r==null&&(r=ge(12)),Ca(e,r),r.write_shift(4,e.v),r}function Gb(t){var e=Aa(t),r=t.read_shift(4);return[e,r,"s"]}function Kb(t,e,r){return r==null&&(r=ge(8)),Oa(e,r),r.write_shift(4,e.v),r}function Xb(t){var e=vn(t),r=Bi(t);return[e,r,"n"]}function Jb(t,e,r){return r==null&&(r=ge(16)),Ca(e,r),Na(t.v,r),r}function Yb(t){var e=Aa(t),r=Bi(t);return[e,r,"n"]}function Qb(t,e,r){return r==null&&(r=ge(12)),Oa(e,r),Na(t.v,r),r}function Zb(t){var e=vn(t),r=fv(t);return[e,r,"n"]}function eT(t,e,r){return r==null&&(r=ge(12)),Ca(e,r),hv(t.v,r),r}function tT(t){var e=Aa(t),r=fv(t);return[e,r,"n"]}function rT(t,e,r){return r==null&&(r=ge(8)),Oa(e,r),hv(t.v,r),r}function nT(t){var e=vn(t),r=fh(t);return[e,r,"is"]}function sT(t){var e=vn(t),r=kr(t);return[e,r,"str"]}function aT(t,e,r){return r==null&&(r=ge(12+4*t.v.length)),Ca(e,r),fr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function iT(t){var e=Aa(t),r=kr(t);return[e,r,"str"]}function oT(t,e,r){return r==null&&(r=ge(8+4*t.v.length)),Oa(e,r),fr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function lT(t,e,r){var n=t.l+e,i=vn(t);i.r=r["!row"];var l=t.read_shift(1),c=[i,l,"b"];if(r.cellFormula){t.l+=2;var d=hu(t,n-t.l,r);c[3]=Ai(d,null,i,r.supbooks,r)}else t.l=n;return c}function cT(t,e,r){var n=t.l+e,i=vn(t);i.r=r["!row"];var l=t.read_shift(1),c=[i,l,"e"];if(r.cellFormula){t.l+=2;var d=hu(t,n-t.l,r);c[3]=Ai(d,null,i,r.supbooks,r)}else t.l=n;return c}function uT(t,e,r){var n=t.l+e,i=vn(t);i.r=r["!row"];var l=Bi(t),c=[i,l,"n"];if(r.cellFormula){t.l+=2;var d=hu(t,n-t.l,r);c[3]=Ai(d,null,i,r.supbooks,r)}else t.l=n;return c}function dT(t,e,r){var n=t.l+e,i=vn(t);i.r=r["!row"];var l=kr(t),c=[i,l,"str"];if(r.cellFormula){t.l+=2;var d=hu(t,n-t.l,r);c[3]=Ai(d,null,i,r.supbooks,r)}else t.l=n;return c}var fT=Pa,hT=Mi;function mT(t,e){return e==null&&(e=ge(4)),e.write_shift(4,t),e}function pT(t,e){var r=t.l+e,n=Pa(t),i=hh(t),l=kr(t),c=kr(t),d=kr(t);t.l=r;var m={rfx:n,relId:i,loc:l,display:d};return c&&(m.Tooltip=c),m}function xT(t,e){var r=ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Mi({s:dr(t[0]),e:dr(t[0])},r),mh("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return fr(i||"",r),fr(t[1].Tooltip||"",r),fr("",r),r.slice(0,r.l)}function gT(){}function vT(t,e,r){var n=t.l+e,i=mv(t),l=t.read_shift(1),c=[i];if(c[2]=l,r.cellFormula){var d=ib(t,n-t.l,r);c[1]=d}else t.l=n;return c}function yT(t,e,r){var n=t.l+e,i=Pa(t),l=[i];if(r.cellFormula){var c=lb(t,n-t.l,r);l[1]=c,t.l=n}else t.l=n;return l}function _T(t,e,r){r==null&&(r=ge(18));var n=mu(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var Yv=["left","right","top","bottom","header","footer"];function wT(t){var e={};return Yv.forEach(function(r){e[r]=Bi(t)}),e}function jT(t,e){return e==null&&(e=ge(6*8)),Xv(t),Yv.forEach(function(r){Na(t[r],e)}),e}function ST(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function ET(t,e,r){r==null&&(r=ge(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function NT(t){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),Mi(t,e),e}function bT(t,e){return e==null&&(e=ge(16*4+2)),e.write_shift(2,t.password?Pv(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function TT(){}function kT(){}function CT(t,e,r,n,i,l,c){if(e.v===void 0)return!1;var d="";switch(e.t){case"b":d=e.v?"1":"0";break;case"d":e=Xr(e),e.z=e.z||zt[14],e.v=Kr(Ir(e.v)),e.t="n";break;case"n":case"e":d=""+e.v;break;default:d=e.v;break}var m={r,c:n};switch(m.s=Zs(i.cellXfs,e,i),e.l&&l["!links"].push([_t(m),e.l]),e.c&&l["!comments"].push([_t(m),e.c]),e.t){case"s":case"str":return i.bookSST?(d=_h(i.Strings,e.v,i.revStrings),m.t="s",m.v=d,c?je(t,18,Kb(e,m)):je(t,7,qb(e,m))):(m.t="str",c?je(t,17,oT(e,m)):je(t,6,aT(e,m))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?c?je(t,13,rT(e,m)):je(t,2,eT(e,m)):c?je(t,16,Qb(e,m)):je(t,5,Jb(e,m)),!0;case"b":return m.t="b",c?je(t,15,Ub(e,m)):je(t,4,Mb(e,m)),!0;case"e":return m.t="e",c?je(t,14,Vb(e,m)):je(t,3,$b(e,m)),!0}return c?je(t,12,Lb(e,m)):je(t,1,Fb(e,m)),!0}function AT(t,e,r,n){var i=Pt(e["!ref"]||"A1"),l,c="",d=[];je(t,145);var m=Array.isArray(e),f=i.e.r;e["!rows"]&&(f=Math.max(i.e.r,e["!rows"].length-1));for(var p=i.s.r;p<=f;++p){c=_r(p),Tb(t,e,i,p);var g=!1;if(p<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){p===i.s.r&&(d[v]=Tr(v)),l=d[v]+c;var w=m?(e[p]||[])[v]:e[l];if(!w){g=!1;continue}g=CT(t,w,p,v,n,e,g)}}je(t,146)}function OT(t,e){!e||!e["!merges"]||(je(t,177,mT(e["!merges"].length)),e["!merges"].forEach(function(r){je(t,176,hT(r))}),je(t,178))}function PT(t,e){!e||!e["!cols"]||(je(t,390),e["!cols"].forEach(function(r,n){r&&je(t,60,_T(n,r))}),je(t,391))}function RT(t,e){!e||!e["!ref"]||(je(t,648),je(t,649,NT(Pt(e["!ref"]))),je(t,650))}function FT(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=vt(r,-1,n[1].Target.replace(/#.*$/,""),ht.HLINK);je(t,494,xT(n,i))}}),delete e["!links"]}function DT(t,e,r,n){if(e["!comments"].length>0){var i=vt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ht.VML);je(t,551,mh("rId"+i)),e["!legacy"]=i}}function LT(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],l=typeof i.ref=="string"?i.ref:Jt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,d=on(l);d.s.r==d.e.r&&(d.e.r=on(e["!ref"]).e.r,l=Jt(d));for(var m=0;m<c.length;++m){var f=c[m];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+l;break}}m==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),je(t,161,Mi(Pt(l))),je(t,162)}}function IT(t,e,r){je(t,133),je(t,137,ET(e,r)),je(t,138),je(t,134)}function MT(t,e){e["!protect"]&&je(t,535,bT(e["!protect"]))}function BT(t,e,r,n){var i=Gr(),l=r.SheetNames[t],c=r.Sheets[l]||{},d=l;try{r&&r.Workbook&&(d=r.Workbook.Sheets[t].CodeName||d)}catch{}var m=Pt(c["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],je(i,129),(r.vbaraw||c["!outline"])&&je(i,147,Pb(d,c["!outline"])),je(i,148,Cb(m)),IT(i,c,r.Workbook),PT(i,c),AT(i,c,t,e),MT(i,c),LT(i,c,r,t),OT(i,c),FT(i,c,n),c["!margins"]&&je(i,476,jT(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&RT(i,c),DT(i,c,t,n),je(i,130),i.end()}function UT(t,e){t.l+=10;var r=kr(t);return{name:r}}var zT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function $T(t){return!t.Workbook||!t.Workbook.WBProps?"false":yS(t.Workbook.WBProps.date1904)?"true":"false"}var WT="][*?/\\".split("");function Qv(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return WT.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function VT(t,e,r){t.forEach(function(n,i){Qv(n);for(var l=0;l<i;++l)if(n==t[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var c=e&&e[i]&&e[i].CodeName||n;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function HT(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];VT(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)hb(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function Zv(t){var e=[Yt];e[e.length]=Re("workbook",null,{xmlns:Li[0],"xmlns:r":ur.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(zT.forEach(function(d){t.Workbook.WBProps[d[0]]!=null&&t.Workbook.WBProps[d[0]]!=d[1]&&(n[d[0]]=t.Workbook.WBProps[d[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Re("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],l=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",l=0;l!=t.SheetNames.length&&!(!i[l]||!i[l].Hidden);++l);l==t.SheetNames.length&&(l=0),e[e.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",l=0;l!=t.SheetNames.length;++l){var c={name:yt(t.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),i[l])switch(i[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}e[e.length]=Re("sheet",null,c)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(d){var m={name:d.Name};d.Comment&&(m.comment=d.Comment),d.Sheet!=null&&(m.localSheetId=""+d.Sheet),d.Hidden&&(m.hidden="1"),d.Ref&&(e[e.length]=Re("definedName",yt(d.Ref),m))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function qT(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Bf(t),r.name=kr(t),r}function GT(t,e){return e||(e=ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),mh(t.strRelID,e),fr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function KT(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?kr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function XT(t,e){e||(e=ge(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),dv(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function JT(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),l=$S(t),c=ob(t,0,r),d=hh(t);t.l=n;var m={Name:l,Ptg:c};return i<268435455&&(m.Sheet=i),d&&(m.Comment=d),m}function YT(t,e){je(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};je(t,156,GT(i))}je(t,144)}function QT(t,e){e||(e=ge(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return fr("SheetJS",e),fr(zc.version,e),fr(zc.version,e),fr("7262",e),e.length>e.l?e.slice(0,e.l):e}function ZT(t,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function ek(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&l==-1&&(l=n);l>i||(je(t,135),je(t,158,ZT(i)),je(t,136))}}function tk(t,e){var r=Gr();return je(r,131),je(r,128,QT()),je(r,153,XT(t.Workbook&&t.Workbook.WBProps||null)),ek(r,t),YT(r,t),je(r,132),r.end()}function rk(t,e,r){return(e.slice(-4)===".bin"?tk:Zv)(t)}function nk(t,e,r,n,i){return(e.slice(-4)===".bin"?BT:Jv)(t,r,n,i)}function sk(t,e,r){return(e.slice(-4)===".bin"?jE:Dv)(t,r)}function ak(t,e,r){return(e.slice(-4)===".bin"?X4:Ov)(t,r)}function ik(t,e,r){return(e.slice(-4)===".bin"?ME:Uv)(t)}function ok(t){return(t.slice(-4)===".bin"?AE:Mv)()}function lk(t,e){var r=[];return t.Props&&r.push(s4(t.Props,e)),t.Custprops&&r.push(a4(t.Props,t.Custprops)),r.join("")}function ck(){return""}function uk(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var l=[];l.push(Re("NumberFormat",null,{"ss:Format":yt(zt[n.numFmtId])}));var c={"ss:ID":"s"+(21+i)};r.push(Re("Style",l.join(""),c))}),Re("Styles",r.join(""))}function e1(t){return Re("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+vh(t.Ref,{r:0,c:0})})}function dk(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(e1(i)))}return Re("Names",r.join(""))}function fk(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,l=[],c=0;c<i.length;++c){var d=i[c];d.Sheet==r&&(d.Name.match(/^_xlfn\./)||l.push(e1(d)))}return l.join("")}function hk(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Re("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Re("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Re("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Re("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(yr("ProtectContents","True")),t["!protect"].objects&&i.push(yr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(yr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(yr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(yr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){t["!protect"][c[0]]&&i.push("<"+c[1]+"/>")})),i.length==0?"":Re("WorksheetOptions",i.join(""),{xmlns:rn.x})}function mk(t){return t.map(function(e){var r=vS(e.t||""),n=Re("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Re("Comment",n,{"ss:Author":e.a})}).join("")}function pk(t,e,r,n,i,l,c){if(!t||t.v==null&&t.f==null)return"";var d={};if(t.f&&(d["ss:Formula"]="="+yt(vh(t.f,c))),t.F&&t.F.slice(0,e.length)==e){var m=dr(t.F.slice(e.length+1));d["ss:ArrayRange"]="RC:R"+(m.r==c.r?"":"["+(m.r-c.r)+"]")+"C"+(m.c==c.c?"":"["+(m.c-c.c)+"]")}if(t.l&&t.l.Target&&(d["ss:HRef"]=yt(t.l.Target),t.l.Tooltip&&(d["x:HRefScreenTip"]=yt(t.l.Tooltip))),r["!merges"])for(var f=r["!merges"],p=0;p!=f.length;++p)f[p].s.c!=c.c||f[p].s.r!=c.r||(f[p].e.c>f[p].s.c&&(d["ss:MergeAcross"]=f[p].e.c-f[p].s.c),f[p].e.r>f[p].s.r&&(d["ss:MergeDown"]=f[p].e.r-f[p].s.r));var g="",v="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",v=String(t.v);break;case"b":g="Boolean",v=t.v?"1":"0";break;case"e":g="Error",v=ll[t.v];break;case"d":g="DateTime",v=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||zt[14]);break;case"s":g="String",v=gS(t.v||"");break}var w=Zs(n.cellXfs,t,n);d["ss:StyleID"]="s"+(21+w),d["ss:Index"]=c.c+1;var S=t.v!=null?v:"",y=t.t=="z"?"":'<Data ss:Type="'+g+'">'+S+"</Data>";return(t.c||[]).length>0&&(y+=mk(t.c)),Re("Cell",y,d)}function xk(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Fv(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gk(t,e,r,n){if(!t["!ref"])return"";var i=Pt(t["!ref"]),l=t["!merges"]||[],c=0,d=[];t["!cols"]&&t["!cols"].forEach(function(E,D){xh(E);var A=!!E.width,C=mu(D,E),P={"ss:Index":D+1};A&&(P["ss:Width"]=Jc(C.width)),E.hidden&&(P["ss:Hidden"]="1"),d.push(Re("Column",null,P))});for(var m=Array.isArray(t),f=i.s.r;f<=i.e.r;++f){for(var p=[xk(f,(t["!rows"]||[])[f])],g=i.s.c;g<=i.e.c;++g){var v=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>g)&&!(l[c].s.r>f)&&!(l[c].e.c<g)&&!(l[c].e.r<f)){(l[c].s.c!=g||l[c].s.r!=f)&&(v=!0);break}if(!v){var w={r:f,c:g},S=_t(w),y=m?(t[f]||[])[g]:t[S];p.push(pk(y,S,t,e,r,n,w))}}p.push("</Row>"),p.length>2&&d.push(p.join(""))}return d.join("")}function vk(t,e,r){var n=[],i=r.SheetNames[t],l=r.Sheets[i],c=l?fk(l,e,t,r):"";return c.length>0&&n.push("<Names>"+c+"</Names>"),c=l?gk(l,e,t,r):"",c.length>0&&n.push("<Table>"+c+"</Table>"),n.push(hk(l,e,t,r)),n.join("")}function yk(t,e){e||(e={}),t.SSF||(t.SSF=Xr(zt)),t.SSF&&(cu(),lu(t.SSF),e.revssf=uu(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Zs(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(lk(t,e)),r.push(ck()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Re("Worksheet",vk(n,e,t),{"ss:Name":yt(t.SheetNames[n])}));return r[2]=uk(t,e),r[3]=dk(t),Yt+Re("Workbook",r.join(""),{xmlns:rn.ss,"xmlns:o":rn.o,"xmlns:x":rn.x,"xmlns:ss":rn.ss,"xmlns:dt":rn.dt,"xmlns:html":rn.html})}var gf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _k(t,e){var r=[],n=[],i=[],l=0,c,d=rx(px,"n"),m=rx(xx,"n");if(t.Props)for(c=jr(t.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(d,c[l])?r:Object.prototype.hasOwnProperty.call(m,c[l])?n:i).push([c[l],t.Props[c[l]]]);if(t.Custprops)for(c=jr(t.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(t.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(d,c[l])?r:Object.prototype.hasOwnProperty.call(m,c[l])?n:i).push([c[l],t.Custprops[c[l]]]);var f=[];for(l=0;l<i.length;++l)Ev.indexOf(i[l][0])>-1||wv.indexOf(i[l][0])>-1||i[l][1]!=null&&f.push(i[l]);n.length&&wt.utils.cfb_add(e,"/SummaryInformation",wx(n,gf.SI,m,xx)),(r.length||f.length)&&wt.utils.cfb_add(e,"/DocumentSummaryInformation",wx(r,gf.DSI,d,px,f.length?f:null,gf.UDI))}function wk(t,e){var r=e||{},n=wt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return wt.utils.cfb_add(n,i,t1(t,r)),r.biff==8&&(t.Props||t.Custprops)&&_k(t,n),r.biff==8&&t.vbaraw&&BE(n,wt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var jk={0:{f:Nb},1:{f:Rb},2:{f:Zb},3:{f:zb},4:{f:Ib},5:{f:Xb},6:{f:sT},7:{f:Hb},8:{f:dT},9:{f:uT},10:{f:lT},11:{f:cT},12:{f:Db},13:{f:tT},14:{f:Wb},15:{f:Bb},16:{f:Yb},17:{f:iT},18:{f:Gb},19:{f:fh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:JT},40:{},42:{},43:{f:sE},44:{f:rE},45:{f:oE},46:{f:cE},47:{f:lE},48:{},49:{f:DS},50:{},51:{f:NE},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L4},62:{f:nT},63:{f:OE},64:{f:TT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$n,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ST},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ob},148:{f:kb,p:16},151:{f:gT},152:{},153:{f:KT},154:{},155:{},156:{f:qT},157:{},158:{},159:{T:1,f:q4},160:{T:-1},161:{T:1,f:Pa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SE},336:{T:-1},337:{f:kE,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:A4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:vT},427:{f:yT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Ab},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:pT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:LE},633:{T:1},634:{T:-1},635:{T:1,f:FE},636:{T:-1},637:{f:BS},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:UT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:kT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function De(t,e,r,n){var i=e;if(!isNaN(i)){var l=n||(r||[]).length||0,c=t.next(4);c.write_shift(2,i),c.write_shift(2,l),l>0&&ch(r)&&t.push(r)}}function Sk(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return De(t,e,r,i);var l=e;if(!isNaN(l)){for(var c=r.parts||[],d=0,m=0,f=0;f+(c[d]||8224)<=8224;)f+=c[d]||8224,d++;var p=t.next(4);for(p.write_shift(2,l),p.write_shift(2,f),t.push(r.slice(m,m+f)),m+=f;m<i;){for(p=t.next(4),p.write_shift(2,60),f=0;f+(c[d]||8224)<=8224;)f+=c[d]||8224,d++;p.write_shift(2,f),t.push(r.slice(m,m+f)),m+=f}}}function ul(t,e,r){return t||(t=ge(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Ek(t,e,r,n){var i=ge(9);return ul(i,t,e),bv(r,n||"b",i),i}function Nk(t,e,r){var n=ge(8+2*r.length);return ul(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function bk(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Kr(Ir(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?De(t,2,U4(r,n,i)):De(t,3,B4(r,n,i));return;case"b":case"e":De(t,5,Ek(r,n,e.v,e.t));return;case"s":case"str":De(t,4,Nk(r,n,(e.v||"").slice(0,255)));return}De(t,1,ul(null,r,n))}function Tk(t,e,r,n){var i=Array.isArray(e),l=Pt(e["!ref"]||"A1"),c,d="",m=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=Jt(l)}for(var f=l.s.r;f<=l.e.r;++f){d=_r(f);for(var p=l.s.c;p<=l.e.c;++p){f===l.s.r&&(m[p]=Tr(p)),c=m[p]+d;var g=i?(e[f]||[])[p]:e[c];g&&bk(t,g,f,p)}}}function kk(t,e){for(var r=e||{},n=Gr(),i=0,l=0;l<t.SheetNames.length;++l)t.SheetNames[l]==r.sheet&&(i=l);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return De(n,r.biff==4?1033:r.biff==3?521:9,ph(t,16,r)),Tk(n,t.Sheets[t.SheetNames[i]],i,r),De(n,10),n.end()}function Ck(t,e,r){De(t,49,j4({sz:12,name:"Arial"},r))}function Ak(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&De(t,1054,N4(i,e[i],r))})}function Ok(t,e){var r=ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),De(t,2151,r),r=ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Cv(Pt(e["!ref"]||"A1"),r),r.write_shift(4,4),De(t,2152,r)}function Pk(t,e){for(var r=0;r<16;++r)De(t,224,Sx({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){De(t,224,Sx(n,0,e))})}function Rk(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];De(t,440,R4(n)),n[1].Tooltip&&De(t,2048,F4(n))}delete e["!links"]}function Fk(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&De(t,125,I4(mu(i,n),i))})}}function Dk(t,e,r,n,i){var l=16+Zs(i.cellXfs,e,i);if(e.v==null&&!e.bf){De(t,513,ba(r,n,l));return}if(e.bf)De(t,6,ab(e,r,n,i,l));else switch(e.t){case"d":case"n":var c=e.t=="d"?Kr(Ir(e.v)):e.v;De(t,515,C4(r,n,c,l));break;case"b":case"e":De(t,517,k4(r,n,e.v,l,i,e.t));break;case"s":case"str":if(i.bookSST){var d=_h(i.Strings,e.v,i.revStrings);De(t,253,S4(r,n,d,l))}else De(t,516,E4(r,n,(e.v||"").slice(0,255),l,i));break;default:De(t,513,ba(r,n,l))}}function Lk(t,e,r){var n=Gr(),i=r.SheetNames[t],l=r.Sheets[i]||{},c=(r||{}).Workbook||{},d=(c.Sheets||[])[t]||{},m=Array.isArray(l),f=e.biff==8,p,g="",v=[],w=Pt(l["!ref"]||"A1"),S=f?65536:16384;if(w.e.c>255||w.e.r>=S){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,S-1)}De(n,2057,ph(r,16,e)),De(n,13,gn(1)),De(n,12,gn(100)),De(n,15,Lr(!0)),De(n,17,Lr(!1)),De(n,16,Na(.001)),De(n,95,Lr(!0)),De(n,42,Lr(!1)),De(n,43,Lr(!1)),De(n,130,gn(1)),De(n,128,T4()),De(n,131,Lr(!1)),De(n,132,Lr(!1)),f&&Fk(n,l["!cols"]),De(n,512,b4(w,e)),f&&(l["!links"]=[]);for(var y=w.s.r;y<=w.e.r;++y){g=_r(y);for(var E=w.s.c;E<=w.e.c;++E){y===w.s.r&&(v[E]=Tr(E)),p=v[E]+g;var D=m?(l[y]||[])[E]:l[p];D&&(Dk(n,D,y,E,e),f&&D.l&&l["!links"].push([p,D.l]))}}var A=d.CodeName||d.name||i;return f&&De(n,574,w4((c.Views||[])[0])),f&&(l["!merges"]||[]).length&&De(n,229,P4(l["!merges"])),f&&Rk(n,l),De(n,442,kv(A)),f&&Ok(n,l),De(n,10),n.end()}function Ik(t,e,r){var n=Gr(),i=(t||{}).Workbook||{},l=i.Sheets||[],c=i.WBProps||{},d=r.biff==8,m=r.biff==5;if(De(n,2057,ph(t,5,r)),r.bookType=="xla"&&De(n,135),De(n,225,d?gn(1200):null),De(n,193,l4(2)),m&&De(n,191),m&&De(n,192),De(n,226),De(n,92,g4("SheetJS",r)),De(n,66,gn(d?1200:1252)),d&&De(n,353,gn(0)),d&&De(n,448),De(n,317,M4(t.SheetNames.length)),d&&t.vbaraw&&De(n,211),d&&t.vbaraw){var f=c.CodeName||"ThisWorkbook";De(n,442,kv(f))}De(n,156,gn(17)),De(n,25,Lr(!1)),De(n,18,Lr(!1)),De(n,19,gn(0)),d&&De(n,431,Lr(!1)),d&&De(n,444,gn(0)),De(n,61,_4()),De(n,64,Lr(!1)),De(n,141,gn(0)),De(n,34,Lr($T(t)=="true")),De(n,14,Lr(!0)),d&&De(n,439,Lr(!1)),De(n,218,gn(0)),Ck(n,t,r),Ak(n,t.SSF,r),Pk(n,r),d&&De(n,352,Lr(!1));var p=n.end(),g=Gr();d&&De(g,140,D4()),d&&r.Strings&&Sk(g,252,y4(r.Strings)),De(g,10);var v=g.end(),w=Gr(),S=0,y=0;for(y=0;y<t.SheetNames.length;++y)S+=(d?12:11)+(d?2:1)*t.SheetNames[y].length;var E=p.length+S+v.length;for(y=0;y<t.SheetNames.length;++y){var D=l[y]||{};De(w,133,v4({pos:E,hs:D.Hidden||0,dt:0,name:t.SheetNames[y]},r)),E+=e[y].length}var A=w.end();if(S!=A.length)throw new Error("BS8 "+S+" != "+A.length);var C=[];return p.length&&C.push(p),A.length&&C.push(A),v.length&&C.push(v),vr(C)}function Mk(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Xr(zt)),t&&t.SSF&&(cu(),lu(t.SSF),r.revssf=uu(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,wh(r),r.cellXfs=[],Zs(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=Lk(i,r,t);return n.unshift(Ik(t,n,r)),vr(n)}function t1(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=on(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=e||{};switch(l.biff||2){case 8:case 5:return Mk(t,e);case 4:case 3:case 2:return kk(t,e)}throw new Error("invalid type "+l.bookType+" for BIFF")}function Bk(t,e,r,n){for(var i=t["!merges"]||[],l=[],c=e.s.c;c<=e.e.c;++c){for(var d=0,m=0,f=0;f<i.length;++f)if(!(i[f].s.r>r||i[f].s.c>c)&&!(i[f].e.r<r||i[f].e.c<c)){if(i[f].s.r<r||i[f].s.c<c){d=-1;break}d=i[f].e.r-i[f].s.r+1,m=i[f].e.c-i[f].s.c+1;break}if(!(d<0)){var p=_t({r,c}),g=n.dense?(t[r]||[])[c]:t[p],v=g&&g.v!=null&&(g.h||xS(g.w||(ss(g),g.w)||""))||"",w={};d>1&&(w.rowspan=d),m>1&&(w.colspan=m),n.editable?v='<span contenteditable="true">'+v+"</span>":g&&(w["data-t"]=g&&g.t||"z",g.v!=null&&(w["data-v"]=g.v),g.z!=null&&(w["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+g.l.Target+'">'+v+"</a>")),w.id=(n.id||"sjs")+"-"+p,l.push(Re("td",v,w))}}var S="<tr>";return S+l.join("")+"</tr>"}var Uk='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',zk="</body></html>";function $k(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function r1(t,e){var r=e||{},n=r.header!=null?r.header:Uk,i=r.footer!=null?r.footer:zk,l=[n],c=on(t["!ref"]);r.dense=Array.isArray(t),l.push($k(t,c,r));for(var d=c.s.r;d<=c.e.r;++d)l.push(Bk(t,c,d,r));return l.push("</table>"+i),l.join("")}function n1(t,e,r){var n=r||{},i=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?dr(n.origin):n.origin;i=c.r,l=c.c}var d=e.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,d.length),f={s:{r:0,c:0},e:{r:i,c:l}};if(t["!ref"]){var p=on(t["!ref"]);f.s.r=Math.min(f.s.r,p.s.r),f.s.c=Math.min(f.s.c,p.s.c),f.e.r=Math.max(f.e.r,p.e.r),f.e.c=Math.max(f.e.c,p.e.c),i==-1&&(f.e.r=i=p.e.r+1)}var g=[],v=0,w=t["!rows"]||(t["!rows"]=[]),S=0,y=0,E=0,D=0,A=0,C=0;for(t["!cols"]||(t["!cols"]=[]);S<d.length&&y<m;++S){var P=d[S];if(Ax(P)){if(n.display)continue;w[y]={hidden:!0}}var F=P.children;for(E=D=0;E<F.length;++E){var L=F[E];if(!(n.display&&Ax(L))){var N=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):_S(L.innerHTML),j=L.getAttribute("data-z")||L.getAttribute("z");for(v=0;v<g.length;++v){var T=g[v];T.s.c==D+l&&T.s.r<y+i&&y+i<=T.e.r&&(D=T.e.c+1-l,v=-1)}C=+L.getAttribute("colspan")||1,((A=+L.getAttribute("rowspan")||1)>1||C>1)&&g.push({s:{r:y+i,c:D+l},e:{r:y+i+(A||1)-1,c:D+l+(C||1)-1}});var k={t:"s",v:N},q=L.getAttribute("data-t")||L.getAttribute("t")||"";N!=null&&(N.length==0?k.t=q||"z":n.raw||N.trim().length==0||q=="s"||(N==="TRUE"?k={t:"b",v:!0}:N==="FALSE"?k={t:"b",v:!1}:isNaN(ts(N))?isNaN(Jo(N).getDate())||(k={t:"d",v:Ir(N)},n.cellDates||(k={t:"n",v:Kr(k.v)}),k.z=n.dateNF||zt[14]):k={t:"n",v:ts(N)})),k.z===void 0&&j!=null&&(k.z=j);var B="",Y=L.getElementsByTagName("A");if(Y&&Y.length)for(var pe=0;pe<Y.length&&!(Y[pe].hasAttribute("href")&&(B=Y[pe].getAttribute("href"),B.charAt(0)!="#"));++pe);B&&B.charAt(0)!="#"&&(k.l={Target:B}),n.dense?(t[y+i]||(t[y+i]=[]),t[y+i][D+l]=k):t[_t({c:D+l,r:y+i})]=k,f.e.c<D+l&&(f.e.c=D+l),D+=C}}++y}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,y-1+i),t["!ref"]=Jt(f),y>=m&&(t["!fullref"]=Jt((f.e.r=d.length-S+y-1+i,f))),t}function s1(t,e){var r=e||{},n=r.dense?[]:{};return n1(n,t,e)}function Wk(t,e){return ka(s1(t,e),e)}function Ax(t){var e="",r=Vk(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Vk(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Hk=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Yt+e}}(),Ox=function(){var t=function(l){return yt(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,c,d){var m=[];m.push('      <table:table table:name="'+yt(c.SheetNames[d])+`" table:style-name="ta1">
`);var f=0,p=0,g=on(l["!ref"]||"A1"),v=l["!merges"]||[],w=0,S=Array.isArray(l);if(l["!cols"])for(p=0;p<=g.e.c;++p)m.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var y="",E=l["!rows"]||[];for(f=0;f<g.s.r;++f)y=E[f]?' table:style-name="ro'+E[f].ods+'"':"",m.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=g.e.r;++f){for(y=E[f]?' table:style-name="ro'+E[f].ods+'"':"",m.push("        <table:table-row"+y+`>
`),p=0;p<g.s.c;++p)m.push(e);for(;p<=g.e.c;++p){var D=!1,A={},C="";for(w=0;w!=v.length;++w)if(!(v[w].s.c>p)&&!(v[w].s.r>f)&&!(v[w].e.c<p)&&!(v[w].e.r<f)){(v[w].s.c!=p||v[w].s.r!=f)&&(D=!0),A["table:number-columns-spanned"]=v[w].e.c-v[w].s.c+1,A["table:number-rows-spanned"]=v[w].e.r-v[w].s.r+1;break}if(D){m.push(r);continue}var P=_t({r:f,c:p}),F=S?(l[f]||[])[p]:l[P];if(F&&F.f&&(A["table:formula"]=yt(db(F.f)),F.F&&F.F.slice(0,P.length)==P)){var L=on(F.F);A["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,A["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!F){m.push(e);continue}switch(F.t){case"b":C=F.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=F.v?"true":"false";break;case"n":C=F.w||String(F.v||0),A["office:value-type"]="float",A["office:value"]=F.v||0;break;case"s":case"str":C=F.v==null?"":F.v,A["office:value-type"]="string";break;case"d":C=F.w||Ir(F.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=Ir(F.v).toISOString(),A["table:style-name"]="ce1";break;default:m.push(e);continue}var N=t(C);if(F.l&&F.l.Target){var j=F.l.Target;j=j.charAt(0)=="#"?"#"+fb(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),N=Re("text:a",N,{"xlink:href":j.replace(/&/g,"&amp;")})}m.push("          "+Re("table:table-cell",Re("text:p",N,{}),A)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},i=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var d=0;c.SheetNames.map(function(f){return c.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var p=0;p<f["!cols"].length;++p)if(f["!cols"][p]){var g=f["!cols"][p];if(g.width==null&&g.wpx==null&&g.wch==null)continue;xh(g),g.ods=d;var v=f["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),l.push(`  </style:style>
`),++d}}});var m=0;c.SheetNames.map(function(f){return c.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var p=0;p<f["!rows"].length;++p)if(f["!rows"][p]){f["!rows"][p].ods=m;var g=f["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),l.push(`  </style:style>
`),++m}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,d){var m=[Yt],f=Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Qo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(m.push("<office:document"+f+p+`>
`),m.push(yv().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+f+`>
`),i(m,c),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var g=0;g!=c.SheetNames.length;++g)m.push(n(c.Sheets[c.SheetNames[g]],c,g));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),d.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function a1(t,e){if(e.bookType=="fods")return Ox(t,e);var r=ah(),n="",i=[],l=[];return n="mimetype",nt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",nt(r,n,Ox(t,e)),i.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",nt(r,n,Hk(t,e)),i.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",nt(r,n,Yt+yv()),i.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",nt(r,n,n4(l)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",nt(r,n,t4(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Zc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function qk(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):An(Yo(t))}function Gk(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Gs(t){var e=t.reduce(function(i,l){return i+l.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function Kk(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var l=0;i>=1;++l,i/=256)t[e+l]=i&255;t[e+15]|=r>=0?0:128}function Zo(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function gt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function bi(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function tr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=Zo(t,r),l=i&7;i=Math.floor(i/8);var c=0,d;if(i==0)break;switch(l){case 0:{for(var m=r[0];t[r[0]++]>=128;);d=t.slice(m,r[0])}break;case 5:c=4,d=t.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,d=t.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=Zo(t,r),d=t.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(n))}var f={data:d,type:l};e[i]==null?e[i]=[f]:e[i].push(f)}return e}function xr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(gt(n*8+i.type)),i.type==2&&e.push(gt(i.data.length)),e.push(i.data))})}),Gs(e)}function Tn(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=Zo(t,n),l=tr(t.slice(n[0],n[0]+i));n[0]+=i;var c={id:bi(l[1][0].data),messages:[]};l[2].forEach(function(d){var m=tr(d.data),f=bi(m[3][0].data);c.messages.push({meta:m,data:t.slice(n[0],n[0]+f)}),n[0]+=f}),(e=l[3])!=null&&e[0]&&(c.merge=bi(l[3][0].data)>>>0>0),r.push(c)}return r}function xi(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:gt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:gt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(c){i.push(c.data),c.meta[3]=[{type:0,data:gt(c.data.length)}],n[2].push({data:xr(c.meta),type:2})});var l=xr(n);e.push(gt(l.length)),e.push(l),i.forEach(function(c){return e.push(c)})}),Gs(e)}function Xk(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Zo(e,r),i=[];r[0]<e.length;){var l=e[r[0]]&3;if(l==0){var c=e[r[0]++]>>2;if(c<60)++c;else{var d=c-59;c=e[r[0]],d>1&&(c|=e[r[0]+1]<<8),d>2&&(c|=e[r[0]+2]<<16),d>3&&(c|=e[r[0]+3]<<24),c>>>=0,c++,r[0]+=d}i.push(e.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var m=0,f=0;if(l==1?(f=(e[r[0]]>>2&7)+4,m=(e[r[0]++]&224)<<3,m|=e[r[0]++]):(f=(e[r[0]++]>>2)+1,l==2?(m=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(m=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Gs(i)],m==0)throw new Error("Invalid offset 0");if(m>i[0].length)throw new Error("Invalid offset beyond length");if(f>=m)for(i.push(i[0].slice(-m)),f-=m;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-m,-m+f))}}var p=Gs(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function kn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Xk(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Gs(e)}function gi(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var l=gt(n),c=l.length;e.push(l),n<=60?(c++,e.push(new Uint8Array([n-1<<2]))):n<=256?(c+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(c+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(c+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(c+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),c+=n,i[0]=0,i[1]=c&255,i[2]=c>>8&255,i[3]=c>>16&255,r+=n}return Gs(e)}function vf(t,e){var r=new Uint8Array(32),n=Zc(r),i=12,l=0;switch(r[0]=5,t.t){case"n":r[1]=2,Kk(r,i,t.v),l|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),l|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),l|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,l,!0),r.slice(0,i)}function yf(t,e){var r=new Uint8Array(32),n=Zc(r),i=12,l=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),l|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),l|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),l|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,l,!0),r.slice(0,i)}function Ds(t){var e=tr(t);return Zo(e[1][0].data)}function Jk(t,e,r){var n,i,l,c;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var d=((c=(l=t[8])==null?void 0:l[0])==null?void 0:c.data)&&bi(t[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var m=0,f=Zc(t[7][0].data),p=0,g=[],v=Zc(t[4][0].data),w=0,S=[],y=0;y<e.length;++y){if(e[y]==null){f.setUint16(y*2,65535,!0),v.setUint16(y*2,65535);continue}f.setUint16(y*2,p,!0),v.setUint16(y*2,w,!0);var E,D;switch(typeof e[y]){case"string":E=vf({t:"s",v:e[y]},r),D=yf({t:"s",v:e[y]},r);break;case"number":E=vf({t:"n",v:e[y]},r),D=yf({t:"n",v:e[y]},r);break;case"boolean":E=vf({t:"b",v:e[y]},r),D=yf({t:"b",v:e[y]},r);break;default:throw new Error("Unsupported value "+e[y])}g.push(E),p+=E.length,S.push(D),w+=D.length,++m}for(t[2][0].data=gt(m);y<t[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),v.setUint16(y*2,65535,!0);return t[6][0].data=Gs(g),t[3][0].data=Gs(S),m}function Yk(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=on(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Jt(n)));var l=eu(r,{range:n,header:1}),c=["~Sh33tJ5~"];l.forEach(function(I){return I.forEach(function(H){typeof H=="string"&&c.push(H)})});var d={},m=[],f=wt.read(e.numbers,{type:"base64"});f.FileIndex.map(function(I,H){return[I,f.FullPaths[H]]}).forEach(function(I){var H=I[0],G=I[1];if(H.type==2&&H.name.match(/\.iwa/)){var se=H.content,_e=kn(se),me=Tn(_e);me.forEach(function(ye){m.push(ye.id),d[ye.id]={deps:[],location:G,type:bi(ye.messages[0].meta[1][0].data)}})}}),m.sort(function(I,H){return I-H});var p=m.filter(function(I){return I>1}).map(function(I){return[I,gt(I)]});f.FileIndex.map(function(I,H){return[I,f.FullPaths[H]]}).forEach(function(I){var H=I[0];if(I[1],!!H.name.match(/\.iwa/)){var G=Tn(kn(H.content));G.forEach(function(se){se.messages.forEach(function(_e){p.forEach(function(me){se.messages.some(function(ye){return bi(ye.meta[1][0].data)!=11006&&Gk(ye.data,me[1])})&&d[me[0]].deps.push(se.id)})})})}});for(var g=wt.find(f,d[1].location),v=Tn(kn(g.content)),w,S=0;S<v.length;++S){var y=v[S];y.id==1&&(w=y)}var E=Ds(tr(w.messages[0].data)[1][0].data);for(g=wt.find(f,d[E].location),v=Tn(kn(g.content)),S=0;S<v.length;++S)y=v[S],y.id==E&&(w=y);for(E=Ds(tr(w.messages[0].data)[2][0].data),g=wt.find(f,d[E].location),v=Tn(kn(g.content)),S=0;S<v.length;++S)y=v[S],y.id==E&&(w=y);for(E=Ds(tr(w.messages[0].data)[2][0].data),g=wt.find(f,d[E].location),v=Tn(kn(g.content)),S=0;S<v.length;++S)y=v[S],y.id==E&&(w=y);var D=tr(w.messages[0].data);{D[6][0].data=gt(n.e.r+1),D[7][0].data=gt(n.e.c+1);var A=Ds(D[46][0].data),C=wt.find(f,d[A].location),P=Tn(kn(C.content));{for(var F=0;F<P.length&&P[F].id!=A;++F);if(P[F].id!=A)throw"Bad ColumnRowUIDMapArchive";var L=tr(P[F].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var N=0;N<=n.e.c;++N){var j=[];j[1]=j[2]=[{type:0,data:gt(N+420690)}],L[1].push({type:2,data:xr(j)}),L[2].push({type:0,data:gt(N)}),L[3].push({type:0,data:gt(N)})}L[4]=[],L[5]=[],L[6]=[];for(var T=0;T<=n.e.r;++T)j=[],j[1]=j[2]=[{type:0,data:gt(T+726270)}],L[4].push({type:2,data:xr(j)}),L[5].push({type:0,data:gt(T)}),L[6].push({type:0,data:gt(T)});P[F].messages[0].data=xr(L)}C.content=gi(xi(P)),C.size=C.content.length,delete D[46];var k=tr(D[4][0].data);{k[7][0].data=gt(n.e.r+1);var q=tr(k[1][0].data),B=Ds(q[2][0].data);C=wt.find(f,d[B].location),P=Tn(kn(C.content));{if(P[0].id!=B)throw"Bad HeaderStorageBucket";var Y=tr(P[0].messages[0].data);for(T=0;T<l.length;++T){var pe=tr(Y[2][0].data);pe[1][0].data=gt(T),pe[4][0].data=gt(l[T].length),Y[2][T]={type:Y[2][0].type,data:xr(pe)}}P[0].messages[0].data=xr(Y)}C.content=gi(xi(P)),C.size=C.content.length;var we=Ds(k[2][0].data);C=wt.find(f,d[we].location),P=Tn(kn(C.content));{if(P[0].id!=we)throw"Bad HeaderStorageBucket";for(Y=tr(P[0].messages[0].data),N=0;N<=n.e.c;++N)pe=tr(Y[2][0].data),pe[1][0].data=gt(N),pe[4][0].data=gt(n.e.r+1),Y[2][N]={type:Y[2][0].type,data:xr(pe)};P[0].messages[0].data=xr(Y)}C.content=gi(xi(P)),C.size=C.content.length;var te=Ds(k[4][0].data);(function(){for(var I=wt.find(f,d[te].location),H=Tn(kn(I.content)),G,se=0;se<H.length;++se){var _e=H[se];_e.id==te&&(G=_e)}var me=tr(G.messages[0].data);{me[3]=[];var ye=[];c.forEach(function(qe,st){ye[1]=[{type:0,data:gt(st)}],ye[2]=[{type:0,data:gt(1)}],ye[3]=[{type:2,data:qk(qe)}],me[3].push({type:2,data:xr(ye)})})}G.messages[0].data=xr(me);var xe=xi(H),Ie=gi(xe);I.content=Ie,I.size=I.content.length})();var he=tr(k[3][0].data);{var Q=he[1][0];delete he[2];var W=tr(Q.data);{var re=Ds(W[2][0].data);(function(){for(var I=wt.find(f,d[re].location),H=Tn(kn(I.content)),G,se=0;se<H.length;++se){var _e=H[se];_e.id==re&&(G=_e)}var me=tr(G.messages[0].data);{delete me[6],delete he[7];var ye=new Uint8Array(me[5][0].data);me[5]=[];for(var xe=0,Ie=0;Ie<=n.e.r;++Ie){var qe=tr(ye);xe+=Jk(qe,l[Ie],c),qe[1][0].data=gt(Ie),me[5].push({data:xr(qe),type:2})}me[1]=[{type:0,data:gt(n.e.c+1)}],me[2]=[{type:0,data:gt(n.e.r+1)}],me[3]=[{type:0,data:gt(xe)}],me[4]=[{type:0,data:gt(n.e.r+1)}]}G.messages[0].data=xr(me);var st=xi(H),Ke=gi(st);I.content=Ke,I.size=I.content.length})()}Q.data=xr(W)}k[3][0].data=xr(he)}D[4][0].data=xr(k)}w.messages[0].data=xr(D);var M=xi(v),b=gi(M);return g.content=b,g.size=g.content.length,f}function Qk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function wh(t){Qk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Zk(t,e){return e.bookType=="ods"?a1(t,e):e.bookType=="numbers"?Yk(t,e):e.bookType=="xlsb"?eC(t,e):tC(t,e)}function eC(t,e){wi=1024,t&&!t.SSF&&(t.SSF=Xr(zt)),t&&t.SSF&&(cu(),lu(t.SSF),e.revssf=uu(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Wo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=zv.indexOf(e.bookType)>-1,i=xv();wh(e=e||{});var l=ah(),c="",d=0;if(e.cellXfs=[],Zs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),c="docProps/core.xml",nt(l,c,_v(t.Props,e)),i.coreprops.push(c),vt(e.rels,2,c,ht.CORE_PROPS),c="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var m=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&m.push(t.SheetNames[f]);t.Props.SheetNames=m}for(t.Props.Worksheets=t.Props.SheetNames.length,nt(l,c,jv(t.Props)),i.extprops.push(c),vt(e.rels,3,c,ht.EXT_PROPS),t.Custprops!==t.Props&&jr(t.Custprops||{}).length>0&&(c="docProps/custom.xml",nt(l,c,Sv(t.Custprops)),i.custprops.push(c),vt(e.rels,4,c,ht.CUST_PROPS)),d=1;d<=t.SheetNames.length;++d){var p={"!id":{}},g=t.Sheets[t.SheetNames[d-1]],v=(g||{})["!type"]||"sheet";switch(v){case"chart":default:c="xl/worksheets/sheet"+d+"."+r,nt(l,c,nk(d-1,c,e,t,p)),i.sheets.push(c),vt(e.wbrels,-1,"worksheets/sheet"+d+"."+r,ht.WS[0])}if(g){var w=g["!comments"],S=!1,y="";w&&w.length>0&&(y="xl/comments"+d+"."+r,nt(l,y,ik(w,y)),i.comments.push(y),vt(p,-1,"../comments"+d+"."+r,ht.CMNT),S=!0),g["!legacy"]&&S&&nt(l,"xl/drawings/vmlDrawing"+d+".vml",Bv(d,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&nt(l,vv(c),Ei(p))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+r,nt(l,c,ak(e.Strings,c,e)),i.strs.push(c),vt(e.wbrels,-1,"sharedStrings."+r,ht.SST)),c="xl/workbook."+r,nt(l,c,rk(t,c)),i.workbooks.push(c),vt(e.rels,1,c,ht.WB),c="xl/theme/theme1.xml",nt(l,c,Iv(t.Themes,e)),i.themes.push(c),vt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),c="xl/styles."+r,nt(l,c,sk(t,c,e)),i.styles.push(c),vt(e.wbrels,-1,"styles."+r,ht.STY),t.vbaraw&&n&&(c="xl/vbaProject.bin",nt(l,c,t.vbaraw),i.vba.push(c),vt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),c="xl/metadata."+r,nt(l,c,ok(c)),i.metadata.push(c),vt(e.wbrels,-1,"metadata."+r,ht.XLMETA),nt(l,"[Content_Types].xml",gv(i,e)),nt(l,"_rels/.rels",Ei(e.rels)),nt(l,"xl/_rels/workbook."+r+".rels",Ei(e.wbrels)),delete e.revssf,delete e.ssf,l}function tC(t,e){wi=1024,t&&!t.SSF&&(t.SSF=Xr(zt)),t&&t.SSF&&(cu(),lu(t.SSF),e.revssf=uu(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Wo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=zv.indexOf(e.bookType)>-1,i=xv();wh(e=e||{});var l=ah(),c="",d=0;if(e.cellXfs=[],Zs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),c="docProps/core.xml",nt(l,c,_v(t.Props,e)),i.coreprops.push(c),vt(e.rels,2,c,ht.CORE_PROPS),c="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var m=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&m.push(t.SheetNames[f]);t.Props.SheetNames=m}t.Props.Worksheets=t.Props.SheetNames.length,nt(l,c,jv(t.Props)),i.extprops.push(c),vt(e.rels,3,c,ht.EXT_PROPS),t.Custprops!==t.Props&&jr(t.Custprops||{}).length>0&&(c="docProps/custom.xml",nt(l,c,Sv(t.Custprops)),i.custprops.push(c),vt(e.rels,4,c,ht.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,d=1;d<=t.SheetNames.length;++d){var g={"!id":{}},v=t.Sheets[t.SheetNames[d-1]],w=(v||{})["!type"]||"sheet";switch(w){case"chart":default:c="xl/worksheets/sheet"+d+"."+r,nt(l,c,Jv(d-1,e,t,g)),i.sheets.push(c),vt(e.wbrels,-1,"worksheets/sheet"+d+"."+r,ht.WS[0])}if(v){var S=v["!comments"],y=!1,E="";if(S&&S.length>0){var D=!1;S.forEach(function(A){A[1].forEach(function(C){C.T==!0&&(D=!0)})}),D&&(E="xl/threadedComments/threadedComment"+d+"."+r,nt(l,E,PE(S,p,e)),i.threadedcomments.push(E),vt(g,-1,"../threadedComments/threadedComment"+d+"."+r,ht.TCMNT)),E="xl/comments"+d+"."+r,nt(l,E,Uv(S)),i.comments.push(E),vt(g,-1,"../comments"+d+"."+r,ht.CMNT),y=!0}v["!legacy"]&&y&&nt(l,"xl/drawings/vmlDrawing"+d+".vml",Bv(d,v["!comments"])),delete v["!comments"],delete v["!legacy"]}g["!id"].rId1&&nt(l,vv(c),Ei(g))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+r,nt(l,c,Ov(e.Strings,e)),i.strs.push(c),vt(e.wbrels,-1,"sharedStrings."+r,ht.SST)),c="xl/workbook."+r,nt(l,c,Zv(t)),i.workbooks.push(c),vt(e.rels,1,c,ht.WB),c="xl/theme/theme1.xml",nt(l,c,Iv(t.Themes,e)),i.themes.push(c),vt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),c="xl/styles."+r,nt(l,c,Dv(t,e)),i.styles.push(c),vt(e.wbrels,-1,"styles."+r,ht.STY),t.vbaraw&&n&&(c="xl/vbaProject.bin",nt(l,c,t.vbaraw),i.vba.push(c),vt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),c="xl/metadata."+r,nt(l,c,Mv()),i.metadata.push(c),vt(e.wbrels,-1,"metadata."+r,ht.XLMETA),p.length>1&&(c="xl/persons/person.xml",nt(l,c,RE(p)),i.people.push(c),vt(e.wbrels,-1,"persons/person.xml",ht.PEOPLE)),nt(l,"[Content_Types].xml",gv(i,e)),nt(l,"_rels/.rels",Ei(e.rels)),nt(l,"xl/_rels/workbook."+r+".rels",Ei(e.wbrels)),delete e.revssf,delete e.ssf,l}function rC(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ns(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function i1(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return il(e.file,wt.write(t,{type:mt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return wt.write(t,e)}function nC(t,e){var r=Xr(e||{}),n=Zk(t,r);return sC(n,r)}function sC(t,e){var r={},n=mt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?wt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(ou(i))}return e.password&&typeof encrypt_agile<"u"?i1(encrypt_agile(i,e.password),e):e.type==="file"?il(e.file,i):e.type=="string"?Bo(i):i}function aC(t,e){var r=e||{},n=wk(t,r);return i1(n,r)}function Un(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Xo(Yo(n));case"binary":return Yo(n);case"string":return t;case"file":return il(e.file,n,"utf8");case"buffer":return mt?os(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Un(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function iC(t,e){switch(e.type){case"base64":return Xo(t);case"binary":return t;case"string":return t;case"file":return il(e.file,t,"binary");case"buffer":return mt?os(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Pc(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Xo(r):e.type=="string"?Bo(r):r;case"file":return il(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function o1(t,e){F3(),HT(t);var r=Xr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=o1(t,r);return r.type="array",ou(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Un(yk(t,r),r);case"slk":case"sylk":return Un($4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Un(r1(t.Sheets[t.SheetNames[i]],r),r);case"txt":return iC(l1(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Un(jh(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Un(W4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Pc(z4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Un(V4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Un(Y4.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Un(Av.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Un(a1(t,r),r);case"wk1":return Pc(Ex.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Pc(Ex.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Pc(t1(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),aC(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nC(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function oC(t,e,r,n,i,l,c,d){var m=_r(r),f=d.defval,p=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),g=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!c||t[r])for(var w=e.s.c;w<=e.e.c;++w){var S=c?t[r][w]:t[n[w]+m];if(S===void 0||S.t===void 0){if(f===void 0)continue;l[w]!=null&&(v[l[w]]=f);continue}var y=S.v;switch(S.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(l[w]!=null){if(y==null)if(S.t=="e"&&y===null)v[l[w]]=null;else if(f!==void 0)v[l[w]]=f;else if(p&&y===null)v[l[w]]=null;else continue;else v[l[w]]=p&&(S.t!=="n"||S.t==="n"&&d.rawNumbers!==!1)?y:ss(S,y,d);y!=null&&(g=!1)}}return{row:v,isempty:g}}function eu(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,l=[],c=0,d="",m={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},p=f.range!=null?f.range:t["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof p){case"string":m=Pt(p);break;case"number":m=Pt(t["!ref"]),m.s.r=p;break;default:m=p}n>0&&(i=0);var g=_r(m.s.r),v=[],w=[],S=0,y=0,E=Array.isArray(t),D=m.s.r,A=0,C={};E&&!t[D]&&(t[D]=[]);var P=f.skipHidden&&t["!cols"]||[],F=f.skipHidden&&t["!rows"]||[];for(A=m.s.c;A<=m.e.c;++A)if(!(P[A]||{}).hidden)switch(v[A]=Tr(A),r=E?t[D][A]:t[v[A]+g],n){case 1:l[A]=A-m.s.c;break;case 2:l[A]=v[A];break;case 3:l[A]=f.header[A-m.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),d=c=ss(r,null,f),y=C[c]||0,!y)C[c]=1;else{do d=c+"_"+y++;while(C[d]);C[c]=y,C[d]=1}l[A]=d}for(D=m.s.r+i;D<=m.e.r;++D)if(!(F[D]||{}).hidden){var L=oC(t,m,D,v,n,l,E,f);(L.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(w[S++]=L.row)}return w.length=S,w}var Px=/"/g;function lC(t,e,r,n,i,l,c,d){for(var m=!0,f=[],p="",g=_r(r),v=e.s.c;v<=e.e.c;++v)if(n[v]){var w=d.dense?(t[r]||[])[v]:t[n[v]+g];if(w==null)p="";else if(w.v!=null){m=!1,p=""+(d.rawNumbers&&w.t=="n"?w.v:ss(w,null,d));for(var S=0,y=0;S!==p.length;++S)if((y=p.charCodeAt(S))===i||y===l||y===34||d.forceQuotes){p='"'+p.replace(Px,'""')+'"';break}p=="ID"&&(p='"ID"')}else w.f!=null&&!w.F?(m=!1,p="="+w.f,p.indexOf(",")>=0&&(p='"'+p.replace(Px,'""')+'"')):p="";f.push(p)}return d.blankrows===!1&&m?null:f.join(c)}function jh(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=Pt(t["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,m=d.charCodeAt(0),f=new RegExp((l=="|"?"\\|":l)+"+$"),p="",g=[];n.dense=Array.isArray(t);for(var v=n.skipHidden&&t["!cols"]||[],w=n.skipHidden&&t["!rows"]||[],S=i.s.c;S<=i.e.c;++S)(v[S]||{}).hidden||(g[S]=Tr(S));for(var y=0,E=i.s.r;E<=i.e.r;++E)(w[E]||{}).hidden||(p=lC(t,i,E,g,c,m,l,n),p!=null&&(n.strip&&(p=p.replace(f,"")),(p||n.blankrows!==!1)&&r.push((y++?d:"")+p)));return delete n.dense,r.join("")}function l1(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=jh(t,e);return r}function cC(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=Pt(t["!ref"]),l="",c=[],d,m=[],f=Array.isArray(t);for(d=i.s.c;d<=i.e.c;++d)c[d]=Tr(d);for(var p=i.s.r;p<=i.e.r;++p)for(l=_r(p),d=i.s.c;d<=i.e.c;++d)if(e=c[d]+l,r=f?(t[p]||[])[d]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}m[m.length]=e+"="+n}return m}function c1(t,e,r){var n=r||{},i=+!n.skipHeader,l=t||{},c=0,d=0;if(l&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?dr(n.origin):n.origin;c=m.r,d=m.c}var f,p={s:{c:0,r:0},e:{c:d,r:c+e.length-1+i}};if(l["!ref"]){var g=Pt(l["!ref"]);p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),c==-1&&(c=g.e.r+1,p.e.r=c+e.length-1+i)}else c==-1&&(c=0,p.e.r=e.length-1+i);var v=n.header||[],w=0;e.forEach(function(y,E){jr(y).forEach(function(D){(w=v.indexOf(D))==-1&&(v[w=v.length]=D);var A=y[D],C="z",P="",F=_t({c:d+w,r:c+E+i});f=el(l,F),A&&typeof A=="object"&&!(A instanceof Date)?l[F]=A:(typeof A=="number"?C="n":typeof A=="boolean"?C="b":typeof A=="string"?C="s":A instanceof Date?(C="d",n.cellDates||(C="n",A=Kr(A)),P=n.dateNF||zt[14]):A===null&&n.nullError&&(C="e",A=0),f?(f.t=C,f.v=A,delete f.w,delete f.R,P&&(f.z=P)):l[F]=f={t:C,v:A},P&&(f.z=P))})}),p.e.c=Math.max(p.e.c,d+v.length-1);var S=_r(c);if(i)for(w=0;w<v.length;++w)l[Tr(w+d)+S]={t:"s",v:v[w]};return l["!ref"]=Jt(p),l}function uC(t,e){return c1(null,t,e)}function el(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=dr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?el(t,_t(e)):el(t,_t({r:e,c:r||0}))}function dC(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function fC(){return{SheetNames:[],Sheets:{}}}function hC(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var c=l&&l[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=c+i)!=-1;++i);}if(Qv(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function mC(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=dC(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function pC(t,e){return t.z=e,t}function u1(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function xC(t,e,r){return u1(t,"#"+e,r)}function gC(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function vC(t,e,r,n){for(var i=typeof e!="string"?e:Pt(e),l=typeof e=="string"?e:Jt(e),c=i.s.r;c<=i.e.r;++c)for(var d=i.s.c;d<=i.e.c;++d){var m=el(t,c,d);m.t="n",m.F=l,delete m.v,c==i.s.r&&d==i.s.c&&(m.f=r,n&&(m.D=!0))}return t}var Ao={encode_col:Tr,encode_row:_r,encode_cell:_t,encode_range:Jt,decode_col:dh,decode_row:uh,split_cell:FS,decode_cell:dr,decode_range:on,format_cell:ss,sheet_add_aoa:uv,sheet_add_json:c1,sheet_add_dom:n1,aoa_to_sheet:Ii,json_to_sheet:uC,table_to_sheet:s1,table_to_book:Wk,sheet_to_csv:jh,sheet_to_txt:l1,sheet_to_json:eu,sheet_to_html:r1,sheet_to_formulae:cC,sheet_to_row_object_array:eu,sheet_get_cell:el,book_new:fC,book_append_sheet:hC,book_set_sheet_visibility:mC,cell_set_number_format:pC,cell_set_hyperlink:u1,cell_set_internal_link:xC,cell_add_comment:gC,sheet_set_array_formula:vC,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Sh(){const[t,e]=U.useState(!1),r=async(p,g={})=>{if(!p||p.length===0){alert("Nenhum dado para exportar");return}try{e(!0);const{filename:v="export",format:w="csv",columns:S}=g;let y=p;S&&S.length>0&&(y=p.map(E=>{const D={};return S.forEach(A=>{D[A.label]=c(E,A.key)}),D})),y=y.map(E=>{const D={};return Object.keys(E).forEach(A=>{let C=E[A];C==null?C="":C instanceof Date?C=C.toLocaleDateString("pt-BR"):typeof C=="string"&&d(C)?C=new Date(C).toLocaleDateString("pt-BR"):typeof C=="object"&&(C=JSON.stringify(C)),D[A]=C}),D}),w==="csv"?n(y,v):i(y,v)}catch(v){console.error("Erro na exportao:",v),alert("Erro ao exportar dados")}finally{e(!1)}},n=(p,g)=>{const v=O3.unparse(p,{header:!0,delimiter:";"}),w="\uFEFF",S=new Blob([w+v],{type:"text/csv;charset=utf-8;"});l(S,`${g}.csv`)},i=(p,g)=>{const v=Ao.json_to_sheet(p),w=Ao.book_new();Ao.book_append_sheet(w,v,"Dados");const S=Ao.decode_range(v["!ref"]||"A1"),y=[];for(let A=S.s.c;A<=S.e.c;++A){let C=10;for(let P=S.s.r;P<=S.e.r;++P){const F=Ao.encode_cell({r:P,c:A}),L=v[F];if(L&&L.v){const N=L.v.toString().length;C=Math.max(C,N)}}y.push({wch:Math.min(C+2,50)})}v["!cols"]=y;const E=o1(w,{bookType:"xlsx",type:"array"}),D=new Blob([E],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});l(D,`${g}.xlsx`)},l=(p,g)=>{const v=window.URL.createObjectURL(p),w=document.createElement("a");w.href=v,w.download=g,document.body.appendChild(w),w.click(),document.body.removeChild(w),window.URL.revokeObjectURL(v)},c=(p,g)=>g.split(".").reduce((v,w)=>v&&v[w]!==void 0?v[w]:null,p),d=p=>/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(p)&&!isNaN(Date.parse(p)),m=p=>{switch(p){case"clients":return[{key:"company_name",label:"Empresa"},{key:"cnpj",label:"CNPJ"},{key:"legal_representative_name",label:"Representante Legal"},{key:"legal_representative_email",label:"Email"},{key:"legal_representative_phone",label:"Telefone"},{key:"city",label:"Cidade"},{key:"state",label:"Estado"},{key:"status",label:"Status"},{key:"created_at",label:"Data de Cadastro"}];case"proposals":return[{key:"proposal_number",label:"Nmero da Proposta"},{key:"clients.company_name",label:"Cliente"},{key:"users.full_name",label:"Consultor"},{key:"total_amount",label:"Valor Total"},{key:"status",label:"Status"},{key:"payment_method",label:"Forma de Pagamento"},{key:"created_at",label:"Data de Criao"},{key:"accepted_at",label:"Data de Aceitao"}];case"contracts":return[{key:"contract_number",label:"Nmero do Contrato"},{key:"clients.company_name",label:"Cliente"},{key:"total_value",label:"Valor Total"},{key:"status",label:"Status"},{key:"start_date",label:"Data de Incio"},{key:"end_date",label:"Data de Trmino"},{key:"created_at",label:"Data de Criao"}];case"users":return[{key:"full_name",label:"Nome Completo"},{key:"email",label:"Email"},{key:"role",label:"Funo"},{key:"is_active",label:"Ativo"},{key:"created_at",label:"Data de Cadastro"}];default:return}};return{exportData:r,exportTable:async(p,g,v)=>{const w=m(p),S=v||`${p}_${new Date().toISOString().split("T")[0]}`;await r(g,{filename:S,format:"excel",columns:w})},exporting:t}}function yC(){const[t,e]=U.useState(!1),r=async(F,L)=>{try{e(!0);const{data:N,error:j}=await Pe.functions.invoke("validate-data",{body:{type:F,data:L}});if(j)throw new Error(j.message||"Erro na validao");if(N!=null&&N.error)throw new Error(N.error.message||"Erro na validao");return N.data||{valid:!1,message:"Resultado invlido"}}catch(N){return console.error("Erro na validao:",N),{valid:!1,message:N.message||"Erro interno na validao"}}finally{e(!1)}},n=async F=>await r("cpf",{cpf:F}),i=async F=>await r("cnpj",{cnpj:F}),l=async F=>await r("email",{email:F}),c=async F=>await r("phone",{phone:F}),d=async F=>await r("client",F),m=async F=>await r("proposal",F),f=async F=>await r("contract",F),p=(F,L)=>!F||typeof F=="string"&&F.trim().length===0?{valid:!1,message:`${L}  obrigatrio`}:{valid:!0},g=(F,L,N)=>!F||F.length<L?{valid:!1,message:`${N} deve ter pelo menos ${L} caracteres`}:{valid:!0},v=(F,L,N)=>F&&F.length>L?{valid:!1,message:`${N} deve ter no mximo ${L} caracteres`}:{valid:!0},w=(F,L)=>F&&(isNaN(F)||Number(F)<0)?{valid:!1,message:`${L} deve ser um nmero vlido`}:{valid:!0},S=(F,L)=>F&&isNaN(Date.parse(F))?{valid:!1,message:`${L} deve ser uma data vlida`}:{valid:!0};return{validating:t,validateData:r,validateCPF:n,validateCNPJ:i,validateEmail:l,validatePhone:c,validateClient:d,validateProposal:m,validateContract:f,validateRequired:p,validateMinLength:g,validateMaxLength:v,validateNumeric:w,validateDate:S,validateDateRange:(F,L)=>{if(F&&L){const N=new Date(F);if(new Date(L)<=N)return{valid:!1,message:"Data de fim deve ser posterior  data de incio"}}return{valid:!0}},validateForm:async(F,L)=>{const N={};for(const[j,T]of Object.entries(L)){const k=F[j];for(const q of T){let B;switch(q.type){case"required":B=p(k,q.message||j);break;case"minLength":B=g(k,q.value,q.message||j);break;case"maxLength":B=v(k,q.value,q.message||j);break;case"numeric":B=w(k,q.message||j);break;case"date":B=S(k,q.message||j);break;case"email":B=await l(k);break;case"cpf":B=await n(k);break;case"cnpj":B=await i(k);break;case"phone":B=await c(k);break;default:B={valid:!0}}if(!B.valid){N[j]=B.message||`${j} invlido`;break}}}return{valid:Object.keys(N).length===0,errors:N}},formatCPF:F=>F.replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),formatCNPJ:F=>F.replace(/\D/g,"").replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"),formatPhone:F=>{const L=F.replace(/\D/g,"");return L.length===10?L.replace(/(\d{2})(\d{4})(\d{4})/,"($1) $2-$3"):L.length===11?L.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):F},formatCurrency:F=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(F)}}function _C({clientId:t,isOpen:e,onClose:r,onEdit:n}){const[i,l]=U.useState(null),[c,d]=U.useState([]),[m,f]=U.useState([]),[p,g]=U.useState([]),[v,w]=U.useState(!0),[S,y]=U.useState("detalhes"),[E,D]=U.useState("");U.useEffect(()=>{e&&t&&A()},[e,t]);const A=async()=>{try{w(!0),D("");const{data:N,error:j}=await Pe.from("clients").select("*").eq("id",t).single();if(j)throw j;l(N);const{data:T,error:k}=await Pe.from("generated_documents").select("*").eq("client_id",t).order("created_at",{ascending:!1});k||d(T||[]);const{data:q,error:B}=await Pe.from("questionnaire_responses").select(`
          id,
          completed_at,
          score,
          completion_percentage,
          questionnaires(name)
        `).eq("client_id",t).order("completed_at",{ascending:!1});if(!B){const we=(q==null?void 0:q.map(te=>{var he;return{id:te.id,questionnaire_name:((he=te.questionnaires)==null?void 0:he.name)||"Questionrio sem nome",completed_at:te.completed_at,score:te.score,completion_percentage:te.completion_percentage||0}}))||[];f(we)}const{data:Y,error:pe}=await Pe.from("proposals").select("*").eq("client_id",t).order("created_at",{ascending:!1});pe||g(Y||[])}catch(N){console.error("Erro ao carregar dados do cliente:",N),D(N.message||"Erro ao carregar dados do cliente")}finally{w(!1)}},C=N=>{switch(N){case"active":return"bg-green-100 text-green-800";case"lead":return"bg-blue-100 text-blue-800";case"prospect":return"bg-yellow-100 text-yellow-800";case"inactive":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},P=N=>{switch(N){case"active":return"Ativo";case"lead":return"Lead";case"prospect":return"Prospect";case"inactive":return"Inativo";default:return N}},F=N=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(N),L=N=>{console.log("Download documento:",N.id)};return e?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:v?"Carregando...":(i==null?void 0:i.company_name)||"Cliente"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Visualizao completa dos dados do cliente"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[n&&a.jsxs(ue,{variant:"outline",onClick:n,children:[a.jsx(is,{size:16,className:"mr-2"}),"Editar"]}),a.jsx("button",{onClick:r,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})]})}),v?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando dados do cliente..."})]})}):E?a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-2",children:[a.jsx(Di,{className:"w-5 h-5 text-red-600"}),a.jsx("p",{className:"text-red-800",children:E})]})}):i?a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"border-b border-[#e0e4e8] mb-6",children:a.jsx("nav",{className:"flex space-x-8",children:[{id:"detalhes",label:"Detalhes",icon:Go},{id:"documentos",label:"Documentos",icon:Tt},{id:"questionarios",label:"Questionrios",icon:Bp},{id:"propostas",label:"Propostas",icon:Rc}].map(({id:N,label:j,icon:T})=>a.jsxs("button",{onClick:()=>y(N),className:`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${S===N?"border-[#6a1b9a] text-[#6a1b9a]":"border-transparent text-[#5a647e] hover:text-[#333333] hover:border-[#e0e4e8]"}`,children:[a.jsx(T,{size:16}),a.jsx("span",{children:j})]},N))})}),S==="detalhes"&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(Ae,{children:[a.jsx(at,{children:a.jsxs(it,{className:"flex items-center",children:[a.jsx(qr,{size:20,className:"mr-2"}),"Dados da Empresa"]})}),a.jsxs(Oe,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Nome da Empresa"}),a.jsx("p",{className:"text-[#333333] font-medium",children:i.company_name})]}),i.cnpj&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"CNPJ"}),a.jsx("p",{className:"text-[#333333]",children:i.cnpj})]}),i.company_type&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Tipo de Empresa"}),a.jsx("p",{className:"text-[#333333]",children:i.company_type})]}),i.main_activity&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Atividade Principal"}),a.jsx("p",{className:"text-[#333333]",children:i.main_activity})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Status"}),a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${C(i.status)}`,children:P(i.status)})]})]})]}),a.jsxs(Ae,{children:[a.jsx(at,{children:a.jsxs(it,{className:"flex items-center",children:[a.jsx(Go,{size:20,className:"mr-2"}),"Representante Legal"]})}),a.jsxs(Oe,{className:"space-y-4",children:[i.legal_representative_name&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Nome"}),a.jsx("p",{className:"text-[#333333]",children:i.legal_representative_name})]}),i.legal_representative_cpf&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"CPF"}),a.jsx("p",{className:"text-[#333333]",children:i.legal_representative_cpf})]}),i.legal_representative_email&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ci,{size:16,className:"text-[#5a647e]"}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Email"}),a.jsx("p",{className:"text-[#333333]",children:i.legal_representative_email})]})]}),i.legal_representative_phone&&a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(eh,{size:16,className:"text-[#5a647e]"}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Telefone"}),a.jsx("p",{className:"text-[#333333]",children:i.legal_representative_phone})]})]})]})]}),(i.address||i.city||i.state)&&a.jsxs(Ae,{children:[a.jsx(at,{children:a.jsxs(it,{className:"flex items-center",children:[a.jsx(bg,{size:20,className:"mr-2"}),"Endereo"]})}),a.jsxs(Oe,{className:"space-y-4",children:[i.address&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Endereo"}),a.jsx("p",{className:"text-[#333333]",children:i.address})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.city&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Cidade"}),a.jsx("p",{className:"text-[#333333]",children:i.city})]}),i.state&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Estado"}),a.jsx("p",{className:"text-[#333333]",children:i.state})]})]}),i.postal_code&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"CEP"}),a.jsx("p",{className:"text-[#333333]",children:i.postal_code})]})]})]}),a.jsxs(Ae,{children:[a.jsx(at,{children:a.jsxs(it,{className:"flex items-center",children:[a.jsx(Vs,{size:20,className:"mr-2"}),"Informaes Adicionais"]})}),a.jsxs(Oe,{className:"space-y-4",children:[i.lead_source&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Origem do Lead"}),a.jsx("p",{className:"text-[#333333]",children:i.lead_source})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Data de Cadastro"}),a.jsx("p",{className:"text-[#333333]",children:new Date(i.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),i.updated_at&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"ltima Atualizao"}),a.jsx("p",{className:"text-[#333333]",children:new Date(i.updated_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),i.notes&&a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Observaes"}),a.jsx("p",{className:"text-[#333333] whitespace-pre-wrap",children:i.notes})]})]})]})]}),S==="documentos"&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Documentos Gerados"}),a.jsx(jt,{children:"Histrico de documentos gerados para este cliente"})]}),a.jsx(Oe,{children:c.length>0?a.jsx("div",{className:"space-y-4",children:c.map(N=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-[#e0e4e8] rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-[#333333]",children:N.document_name}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Tipo: ",N.document_type]}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Cdigo: ",N.verification_code]}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Gerado em: ",new Date(N.created_at).toLocaleDateString("pt-BR")]})]}),a.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>L(N),children:[a.jsx(sn,{size:16,className:"mr-2"}),"Download"]})]},N.id))}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Tt,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Nenhum documento gerado ainda"})]})})]}),S==="questionarios"&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Questionrios Respondidos"}),a.jsx(jt,{children:"Histrico de questionrios e diagnsticos realizados"})]}),a.jsx(Oe,{children:m.length>0?a.jsx("div",{className:"space-y-4",children:m.map(N=>a.jsxs("div",{className:"p-4 border border-[#e0e4e8] rounded-lg",children:[a.jsx("h3",{className:"font-medium text-[#333333] mb-2",children:N.questionnaire_name}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-[#5a647e]",children:"Completado em:"}),a.jsx("p",{className:"text-[#333333]",children:new Date(N.completed_at).toLocaleDateString("pt-BR")})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-[#5a647e]",children:"Progresso:"}),a.jsxs("p",{className:"text-[#333333]",children:[N.completion_percentage,"%"]})]}),N.score&&a.jsxs("div",{children:[a.jsx("span",{className:"text-[#5a647e]",children:"Pontuao:"}),a.jsx("p",{className:"text-[#333333]",children:N.score})]})]})]},N.id))}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Bp,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Nenhum questionrio respondido ainda"})]})})]}),S==="propostas"&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Propostas"}),a.jsx(jt,{children:"Propostas comerciais enviadas para este cliente"})]}),a.jsx(Oe,{children:p.length>0?a.jsx("div",{className:"space-y-4",children:p.map(N=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-[#e0e4e8] rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-[#333333]",children:N.title}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Valor: ",F(N.total_value)]}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Status: ",N.status]}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Criada em: ",new Date(N.created_at).toLocaleDateString("pt-BR")]})]}),a.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>console.log("Ver proposta:",N.id),children:[a.jsx(Rc,{size:16,className:"mr-2"}),"Ver Proposta"]})]},N.id))}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Rc,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Nenhuma proposta criada ainda"})]})})]})]}):null,a.jsx("div",{className:"p-6 border-t border-[#e0e4e8]",children:a.jsx("div",{className:"flex justify-end",children:a.jsx(ue,{onClick:r,children:"Fechar"})})})]})}):null}function wC({isOpen:t,onClose:e,onSuccess:r,client:n}){const{user:i}=Rt(),{validateClient:l,formatCNPJ:c,formatCPF:d,formatPhone:m}=yC(),[f,p]=U.useState({company_name:"",cnpj:"",company_type:"",main_activity:"",address:"",city:"",state:"",postal_code:"",legal_representative_name:"",legal_representative_cpf:"",legal_representative_email:"",legal_representative_phone:"",status:"lead",lead_source:"",notes:""}),[g,v]=U.useState(!1),[w,S]=U.useState(""),[y,E]=U.useState([]),[D,A]=U.useState(!1);U.useEffect(()=>{p(n?{company_name:n.company_name,cnpj:n.cnpj||"",company_type:n.company_type||"",main_activity:n.main_activity||"",address:n.address||"",city:n.city||"",state:n.state||"",postal_code:n.postal_code||"",legal_representative_name:n.legal_representative_name||"",legal_representative_cpf:n.legal_representative_cpf||"",legal_representative_email:n.legal_representative_email||"",legal_representative_phone:n.legal_representative_phone||"",status:n.status,lead_source:n.lead_source||"",notes:n.notes||""}:{company_name:"",cnpj:"",company_type:"",main_activity:"",address:"",city:"",state:"",postal_code:"",legal_representative_name:"",legal_representative_cpf:"",legal_representative_email:"",legal_representative_phone:"",status:"lead",lead_source:"",notes:""}),S("")},[n,t]);const C=async P=>{P.preventDefault(),v(!0),S(""),E([]);try{const F=await l(f);if(!F.valid){E(F.errors||[]);return}if(n){const{error:L}=await Pe.from("clients").update({company_name:f.company_name,cnpj:f.cnpj||null,company_type:f.company_type||null,main_activity:f.main_activity||null,address:f.address||null,city:f.city||null,state:f.state||null,postal_code:f.postal_code||null,legal_representative_name:f.legal_representative_name||null,legal_representative_cpf:f.legal_representative_cpf||null,legal_representative_email:f.legal_representative_email||null,legal_representative_phone:f.legal_representative_phone||null,status:f.status,lead_source:f.lead_source||null,notes:f.notes||null,updated_at:new Date().toISOString()}).eq("id",n.id);if(L)throw L}else{const{error:L}=await Pe.from("clients").insert([{company_name:f.company_name,cnpj:f.cnpj||null,company_type:f.company_type||null,main_activity:f.main_activity||null,address:f.address||null,city:f.city||null,state:f.state||null,postal_code:f.postal_code||null,legal_representative_name:f.legal_representative_name||null,legal_representative_cpf:f.legal_representative_cpf||null,legal_representative_email:f.legal_representative_email||null,legal_representative_phone:f.legal_representative_phone||null,status:f.status,lead_source:f.lead_source||null,notes:f.notes||null,user_id:(i==null?void 0:i.role)==="consultor"?i.id:null}]);if(L)throw L}r(),e()}catch(F){console.error("Erro ao salvar cliente:",F),S(F.message||"Erro ao salvar cliente")}finally{v(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:n?"Editar Cliente":"Novo Cliente"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:n?"Atualize as informaes do cliente":"Cadastre um novo cliente no sistema"})]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("form",{onSubmit:C,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-[#1a237e] mb-4 flex items-center",children:[a.jsx(qr,{size:20,className:"mr-2"}),"Dados da Empresa"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(We,{label:"Nome da Empresa",placeholder:"Ex: Empresa XYZ Ltda",value:f.company_name,onChange:P=>p({...f,company_name:P.target.value})})}),a.jsx(We,{label:"CNPJ",placeholder:"00.000.000/0000-00",value:f.cnpj,onChange:P=>{const F=c(P.target.value);p({...f,cnpj:F})}}),a.jsx(We,{label:"Tipo de Empresa",placeholder:"Ex: Ltda, S.A., MEI",value:f.company_type,onChange:P=>p({...f,company_type:P.target.value})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(We,{label:"Atividade Principal",placeholder:"Ex: Consultoria em tecnologia",value:f.main_activity,onChange:P=>p({...f,main_activity:P.target.value})})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(We,{label:"Endereo",placeholder:"Rua, Nmero, Bairro",value:f.address,onChange:P=>p({...f,address:P.target.value})})}),a.jsx(We,{label:"Cidade",placeholder:"Ex: So Paulo",value:f.city,onChange:P=>p({...f,city:P.target.value})}),a.jsx(We,{label:"Estado",placeholder:"Ex: SP",value:f.state,onChange:P=>p({...f,state:P.target.value})}),a.jsx(We,{label:"CEP",placeholder:"00000-000",value:f.postal_code,onChange:P=>p({...f,postal_code:P.target.value})})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-[#1a237e] mb-4 flex items-center",children:[a.jsx(Go,{size:20,className:"mr-2"}),"Representante Legal"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(We,{label:"Nome Completo",placeholder:"Ex: Joo Silva",value:f.legal_representative_name,onChange:P=>p({...f,legal_representative_name:P.target.value})}),a.jsx(We,{label:"CPF",placeholder:"000.000.000-00",value:f.legal_representative_cpf,onChange:P=>{const F=d(P.target.value);p({...f,legal_representative_cpf:F})}}),a.jsx(We,{label:"Email",type:"email",placeholder:"joao@empresa.com",value:f.legal_representative_email,onChange:P=>p({...f,legal_representative_email:P.target.value})}),a.jsx(We,{label:"Telefone",placeholder:"(11) 99999-9999",value:f.legal_representative_phone,onChange:P=>{const F=m(P.target.value);p({...f,legal_representative_phone:F})}})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-[#1a237e] mb-4 flex items-center",children:[a.jsx(Tt,{size:20,className:"mr-2"}),"Informaes Comerciais"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Status"}),a.jsxs("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:f.status,onChange:P=>p({...f,status:P.target.value}),children:[a.jsx("option",{value:"lead",children:"Lead"}),a.jsx("option",{value:"prospect",children:"Prospect"}),a.jsx("option",{value:"active",children:"Ativo"}),a.jsx("option",{value:"inactive",children:"Inativo"})]})]}),a.jsx(We,{label:"Origem do Lead",placeholder:"Ex: Website, Indicao, LinkedIn",value:f.lead_source,onChange:P=>p({...f,lead_source:P.target.value})}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Observaes"}),a.jsx("textarea",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a] h-24 resize-none",placeholder:"Observaes sobre o cliente...",value:f.notes,onChange:P=>p({...f,notes:P.target.value})})]})]})]}),w&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm",children:w}),y.length>0&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[a.jsx("p",{className:"text-red-600 text-sm font-medium mb-2",children:"Erros de validao:"}),a.jsx("ul",{className:"list-disc list-inside text-red-600 text-sm space-y-1",children:y.map((P,F)=>a.jsx("li",{children:P},F))})]}),n&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-[#1a237e] flex items-center",children:[a.jsx(Bc,{size:20,className:"mr-2"}),"Documentos"]}),a.jsxs(ue,{type:"button",variant:"outline",size:"sm",onClick:()=>A(!D),children:[D?"Ocultar":"Mostrar"," Documentos"]})]}),D&&a.jsx(T3,{clientId:n.id,onUploadSuccess:()=>console.log("Documento enviado com sucesso")})]}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-[#e0e4e8]",children:[a.jsx(ue,{type:"button",variant:"outline",onClick:e,children:"Cancelar"}),a.jsxs(ue,{type:"submit",loading:g,children:[n?"Atualizar":"Criar"," Cliente"]})]})]})]})}):null}function Rx({isConsultor:t=!1}){const{user:e}=Rt(),{exportTable:r,exporting:n}=Sh(),i=tl(),[l,c]=U.useState([]),[d,m]=U.useState(!0),[f,p]=U.useState(""),[g,v]=U.useState("todos"),[w,S]=U.useState(!1),[y,E]=U.useState(null),[D,A]=U.useState(null);U.useEffect(()=>{C()},[e,g]);const C=async()=>{if(e)try{m(!0);let j=Pe.from("clients").select("*").order("created_at",{ascending:!1});g!=="todos"&&(j=j.eq("status",g));const{data:T,error:k}=await j;if(k)throw k;c(T||[])}catch(j){console.error("Erro ao carregar clientes:",j)}finally{m(!1)}},P=l.filter(j=>{var T,k;return j.company_name.toLowerCase().includes(f.toLowerCase())||((T=j.legal_representative_name)==null?void 0:T.toLowerCase().includes(f.toLowerCase()))||((k=j.cnpj)==null?void 0:k.includes(f))}),F=j=>{switch(j){case"active":return"bg-green-100 text-green-800";case"lead":return"bg-blue-100 text-blue-800";case"prospect":return"bg-yellow-100 text-yellow-800";case"inactive":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},L=j=>{switch(j){case"active":return"Ativo";case"lead":return"Lead";case"prospect":return"Prospect";case"inactive":return"Inativo";default:return j}},N=async()=>{const j=P.map(T=>({...T,status_label:L(T.status),created_at:T.created_at?new Date(T.created_at).toLocaleDateString("pt-BR"):"",updated_at:T.updated_at?new Date(T.updated_at).toLocaleDateString("pt-BR"):""}));await r("clients",j,`clientes_${new Date().toISOString().split("T")[0]}`)};return d?a.jsx(wr,{children:a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando clientes..."})]})})}):a.jsxs(wr,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[#1a237e]",children:t?"Meus Clientes":"Clientes"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:t?"Gerencie seus clientes atribudos":"Gerencie todos os clientes do sistema"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{variant:"outline",onClick:N,loading:n,children:[a.jsx(sn,{size:18,className:"mr-2"}),n?"Exportando...":"Exportar"]}),a.jsxs(ue,{onClick:()=>S(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Novo Cliente"]})]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar por empresa, representante ou CNPJ...",icon:a.jsx(an,{size:18}),value:f,onChange:j=>p(j.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:g,onChange:j=>v(j.target.value),children:[a.jsx("option",{value:"todos",children:"Todos os Status"}),a.jsx("option",{value:"lead",children:"Leads"}),a.jsx("option",{value:"prospect",children:"Prospects"}),a.jsx("option",{value:"active",children:"Ativos"}),a.jsx("option",{value:"inactive",children:"Inativos"})]}),a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:l.length})]}),a.jsx(qr,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Leads"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l.filter(j=>j.status==="lead").length})]}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(qr,{className:"w-5 h-5 text-blue-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Prospects"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:l.filter(j=>j.status==="prospect").length})]}),a.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:a.jsx(qr,{className:"w-5 h-5 text-yellow-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Ativos"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.filter(j=>j.status==="active").length})]}),a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(qr,{className:"w-5 h-5 text-green-600"})})]})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Lista de Clientes"}),a.jsxs(jt,{children:[P.length," ",P.length===1?"cliente encontrado":"clientes encontrados"]})]}),a.jsx(Oe,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-[#e0e4e8]",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Empresa"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Representante"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Contato"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Localizao"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Aes"})]})}),a.jsx("tbody",{children:P.length>0?P.map(j=>a.jsxs("tr",{className:"border-b border-[#e0e4e8] hover:bg-[#f7f8fc]",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:j.company_name}),j.cnpj&&a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["CNPJ: ",j.cnpj]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:j.legal_representative_name||"-"}),j.legal_representative_cpf&&a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["CPF: ",j.legal_representative_cpf]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"space-y-1",children:[j.legal_representative_email&&a.jsxs("div",{className:"flex items-center text-sm text-[#5a647e]",children:[a.jsx(Ci,{size:14,className:"mr-2"}),j.legal_representative_email]}),j.legal_representative_phone&&a.jsxs("div",{className:"flex items-center text-sm text-[#5a647e]",children:[a.jsx(eh,{size:14,className:"mr-2"}),j.legal_representative_phone]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${F(j.status)}`,children:L(j.status)})}),a.jsx("td",{className:"py-4 px-4",children:j.city&&j.state?a.jsxs("div",{className:"flex items-center text-sm text-[#5a647e]",children:[a.jsx(bg,{size:14,className:"mr-2"}),j.city,", ",j.state]}):a.jsx("span",{className:"text-[#5a647e]",children:"-"})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>A(j),title:"Visualizar cliente",children:a.jsx(Cr,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>E(j),title:"Editar cliente",children:a.jsx(is,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>{i(`/documentos?client=${j.id}&tab=generate`)},title:"Gerar documento",className:"text-[#6a1b9a]",children:a.jsx(Tt,{size:16})})]})})]},j.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"py-8 text-center text-[#5a647e]",children:"Nenhum cliente encontrado"})})})]})})})]})]}),a.jsx(wC,{isOpen:w||!!y,onClose:()=>{S(!1),E(null)},onSuccess:C,client:y}),D&&a.jsx(_C,{clientId:D.id,isOpen:!!D,onClose:()=>A(null),onEdit:()=>{E(D),A(null)}})]})}function jC({isOpen:t,onClose:e,onSuccess:r,consultor:n}){const[i,l]=U.useState({email:"",full_name:"",phone:"",department:"",password:""}),[c,d]=U.useState(!1),[m,f]=U.useState("");U.useEffect(()=>{l(n?{email:n.email,full_name:n.full_name,phone:n.phone||"",department:n.department||"",password:""}:{email:"",full_name:"",phone:"",department:"",password:""})},[n,t]);const p=async v=>{const w=new Promise((y,E)=>{setTimeout(()=>E(new Error("Timeout: Operao excedeu 10 segundos")),1e4)}),S=Pe.functions.invoke("create-consultor-simple",{body:{email:v.email,password:v.password,full_name:v.full_name,role:"consultor",phone:v.phone,department:v.department}});return Promise.race([S,w])},g=async v=>{v.preventDefault(),d(!0),f("");try{if(n){const{error:w}=await Pe.from("users").update({full_name:i.full_name,phone:i.phone||null,department:i.department||null}).eq("id",n.id);if(w)throw w}else{const{data:w,error:S}=await p(i);if(S)throw console.error("Function error:",S),new Error(`Erro ao criar consultor: ${S.message}`);if(w&&w.error)throw console.error("Response error:",w.error),new Error(w.error.message||"Erro desconhecido ao criar consultor");if(w&&!w.success)throw new Error("Falha na criao do consultor")}r(),e()}catch(w){console.error("Error creating/updating consultor:",w);let S="Erro ao salvar consultor";w.message&&(w.message.includes("timeout")||w.message.includes("Timeout")?S="Operao demorou muito para responder. Tente novamente.":w.message.includes("User already registered")?S="Este email j est cadastrado no sistema.":w.message.includes("Invalid email")?S="Email invlido. Verifique o formato do email.":w.message.includes("Password")?S="Senha deve ter pelo menos 6 caracteres.":S=w.message),f(S)}finally{d(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-[#e0e4e8]",children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:n?"Editar Consultor":"Novo Consultor"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:n?"Atualize as informaes do consultor":"Cadastre um novo consultor no sistema"})]}),a.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(We,{label:"Nome Completo",placeholder:"Ex: Joo Silva",value:i.full_name,onChange:v=>l({...i,full_name:v.target.value}),required:!0}),a.jsx(We,{label:"Email",type:"email",placeholder:"joao@seusdados.com",value:i.email,onChange:v=>l({...i,email:v.target.value}),disabled:!!n,required:!0}),a.jsx(We,{label:"Telefone",placeholder:"(11) 99999-9999",value:i.phone,onChange:v=>l({...i,phone:v.target.value})}),a.jsx(We,{label:"Departamento",placeholder:"Ex: Vendas, Consultoria",value:i.department,onChange:v=>l({...i,department:v.target.value})}),!n&&a.jsxs("div",{className:"md:col-span-2",children:[a.jsx(We,{label:"Senha Temporria",type:"password",placeholder:"Mnimo 6 caracteres",value:i.password,onChange:v=>l({...i,password:v.target.value}),required:!0}),a.jsx("p",{className:"text-xs text-[#5a647e] mt-1",children:"O consultor dever alterar a senha no primeiro acesso"})]})]}),m&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm",children:m}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[a.jsx(ue,{type:"button",variant:"outline",onClick:e,children:"Cancelar"}),a.jsxs(ue,{type:"submit",loading:c,children:[n?"Atualizar":"Criar"," Consultor"]})]})]})]})}):null}function SC(){const{user:t}=Rt(),[e,r]=U.useState([]),[n,i]=U.useState(!0),[l,c]=U.useState(""),[d,m]=U.useState("todos"),[f,p]=U.useState("todos"),[g,v]=U.useState(!1),[w,S]=U.useState(null),[y,E]=U.useState(null),[D,A]=U.useState([]),[C,P]=U.useState({totalProposals:0,totalContracts:0,totalRevenue:0});U.useEffect(()=>{F()},[]);const F=async()=>{try{i(!0);const{data:B,error:Y}=await Pe.functions.invoke("get-consultores-auth",{body:{role:"consultor"}});if(Y)throw console.error("Function error:",Y),Y;if(B&&B.error)throw console.error("Response error:",B.error),new Error(B.error.message);const pe=(B==null?void 0:B.data)||[];r(pe);const we=[...new Set(pe.map(te=>te.department).filter(Boolean))];A(we),await L(pe)}catch(B){console.error("Erro ao carregar consultores:",B);try{console.log("Tentando fallback direto...");const{data:Y,error:pe}=await Pe.from("users").select("*").eq("role","consultor").order("created_at",{ascending:!1});if(pe)throw pe;r(Y||[]);const we=[...new Set((Y||[]).map(te=>te.department).filter(Boolean))];A(we),await L(Y||[])}catch(Y){console.error("Fallback tambm falhou:",Y),r([]),A([])}}finally{i(!1)}},L=async B=>{var Y;try{const pe=B.map(re=>re.id);if(pe.length===0)return;const{data:we}=await Pe.from("proposals").select("consultant_id, total_amount").in("consultant_id",pe),{data:te}=await Pe.from("contracts").select("*"),he=(we==null?void 0:we.length)||0,Q=(te==null?void 0:te.length)||0,W=((Y=te==null?void 0:te.filter(re=>re.status==="active"))==null?void 0:Y.reduce((re,M)=>re+(M.monthly_value||0),0))||0;P({totalProposals:he,totalContracts:Q,totalRevenue:W})}catch(pe){console.error("Erro ao carregar estatsticas:",pe)}},N=async B=>{try{const{error:Y}=await Pe.from("users").update({is_active:!B.is_active}).eq("id",B.id);if(Y)throw Y;await F()}catch(Y){console.error("Erro ao alterar status do consultor:",Y)}},j=async B=>{if(confirm("Tem certeza que deseja excluir este consultor? Esta ao no pode ser desfeita."))try{i(!0);const{data:Y,error:pe}=await Pe.functions.invoke("delete-consultor",{body:{consultor_id:B.id}});if(pe)throw console.error("Function error:",pe),new Error(pe.message||"Erro ao excluir consultor");if(Y&&Y.error)throw console.error("Response error:",Y.error),new Error(Y.error.message||"Erro desconhecido ao excluir consultor");if(Y&&!Y.success)throw new Error("Falha na excluso do consultor");await F(),alert("Consultor excludo com sucesso!")}catch(Y){console.error("Erro ao excluir consultor:",Y);let pe="Erro ao excluir consultor";Y.message&&(Y.message.includes("propostas associadas")?pe="No  possvel excluir este consultor pois ele possui propostas associadas.":Y.message.includes("no encontrado")?pe="Consultor no encontrado.":pe=Y.message),alert(pe)}finally{i(!1)}},T=e.filter(B=>{const Y=B.full_name.toLowerCase().includes(l.toLowerCase())||B.email.toLowerCase().includes(l.toLowerCase()),pe=d==="todos"||B.department===d,we=f==="todos"||f==="ativo"&&B.is_active||f==="inativo"&&!B.is_active;return Y&&pe&&we}),k=B=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(B),q=B=>new Date(B).toLocaleDateString("pt-BR");return n?a.jsx(wr,{children:a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando consultores..."})]})})}):a.jsxs(wr,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[#1a237e]",children:"Consultores"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Gerencie a equipe de consultores do sistema"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{variant:"outline",children:[a.jsx(sn,{size:18,className:"mr-2"}),"Exportar"]}),a.jsxs(ue,{onClick:()=>v(!0),children:[a.jsx(iu,{size:18,className:"mr-2"}),"Novo Consultor"]})]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar por nome ou email...",icon:a.jsx(an,{size:18}),value:l,onChange:B=>c(B.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:d,onChange:B=>m(B.target.value),children:[a.jsx("option",{value:"todos",children:"Todos os Departamentos"}),D.map(B=>a.jsx("option",{value:B,children:B},B))]}),a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:f,onChange:B=>p(B.target.value),children:[a.jsx("option",{value:"todos",children:"Todos os Status"}),a.jsx("option",{value:"ativo",children:"Ativo"}),a.jsx("option",{value:"inativo",children:"Inativo"})]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Total de Consultores"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:e.length})]}),a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-lg flex items-center justify-center",children:a.jsx(Uc,{className:"w-6 h-6 text-white"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Ativos"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.filter(B=>B.is_active).length})]}),a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Tg,{className:"w-6 h-6 text-green-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Propostas Criadas"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:C.totalProposals})]}),a.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(qr,{className:"w-6 h-6 text-blue-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Receita Gerada"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:k(C.totalRevenue)})]}),a.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-lg flex items-center justify-center",children:a.jsx(Uc,{className:"w-6 h-6 text-white"})})]})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Lista de Consultores"}),a.jsxs(jt,{children:[T.length," ",T.length===1?"consultor encontrado":"consultores encontrados"]})]}),a.jsx(Oe,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-[#e0e4e8]",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Consultor"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Contato"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Departamento"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Criado em"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Aes"})]})}),a.jsx("tbody",{children:T.length>0?T.map(B=>{var Y;return a.jsxs("tr",{className:"border-b border-[#e0e4e8] hover:bg-[#f7f8fc]",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-[#6a1b9a] to-[#4a148c] rounded-full flex items-center justify-center text-white font-medium",children:(Y=B.full_name[0])==null?void 0:Y.toUpperCase()}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:B.full_name}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:B.email})]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center text-sm text-[#5a647e]",children:[a.jsx(Ci,{size:14,className:"mr-2"}),B.email]}),B.phone&&a.jsxs("div",{className:"flex items-center text-sm text-[#5a647e]",children:[a.jsx(eh,{size:14,className:"mr-2"}),B.phone]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:"text-sm text-[#333333]",children:B.department||"-"})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${B.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:B.is_active?"Ativo":"Inativo"}),a.jsx("button",{onClick:()=>N(B),className:"text-[#5a647e] hover:text-[#333333]",children:B.is_active?a.jsx(Cg,{className:"w-5 h-5 text-green-600"}):a.jsx(kg,{className:"w-5 h-5 text-gray-400"})})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:"text-sm text-[#5a647e]",children:q(B.created_at)})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>E(B),title:"Visualizar detalhes",children:a.jsx(Cr,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>S(B),title:"Editar consultor",children:a.jsx(is,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>j(B),title:"Excluir consultor",children:a.jsx(Ws,{size:16,className:"text-red-600"})})]})})]},B.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"py-8 text-center text-[#5a647e]",children:l||d!=="todos"||f!=="todos"?"Nenhum consultor encontrado com os filtros aplicados":"Nenhum consultor cadastrado"})})})]})})})]})]}),a.jsx(jC,{isOpen:g||!!w,onClose:()=>{v(!1),S(null)},onSuccess:F,consultor:w}),y&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Detalhes do Consultor"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Informaes completas do consultor"})]}),a.jsx("button",{onClick:()=>E(null),className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Ae,{children:[a.jsx(at,{children:a.jsxs(it,{className:"flex items-center space-x-2",children:[a.jsx(Go,{className:"w-5 h-5"}),a.jsx("span",{children:"Informaes Pessoais"})]})}),a.jsxs(Oe,{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Nome"}),a.jsx("p",{className:"text-[#333333]",children:y.full_name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Email"}),a.jsx("p",{className:"text-[#333333]",children:y.email})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Telefone"}),a.jsx("p",{className:"text-[#333333]",children:y.phone||"No informado"})]})]})]}),a.jsxs(Ae,{children:[a.jsx(at,{children:a.jsxs(it,{className:"flex items-center space-x-2",children:[a.jsx(qr,{className:"w-5 h-5"}),a.jsx("span",{children:"Informaes Profissionais"})]})}),a.jsxs(Oe,{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Departamento"}),a.jsx("p",{className:"text-[#333333]",children:y.department||"No definido"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Status"}),a.jsx("p",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium ${y.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.is_active?"Ativo":"Inativo"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium text-[#5a647e]",children:"Data de Criao"}),a.jsx("p",{className:"text-[#333333]",children:new Date(y.created_at).toLocaleDateString("pt-BR")})]})]})]})]}),a.jsxs("div",{className:"flex justify-between mt-6",children:[a.jsx(ue,{variant:"outline",onClick:()=>E(null),children:"Fechar"}),a.jsx(ue,{onClick:()=>{S(y),E(null)},children:"Editar Consultor"})]})]})]})})]})}function EC({isOpen:t,onClose:e,onSuccess:r,service:n}){const[i,l]=U.useState({name:"",description:"",category:"",base_price:"",price_type:"monthly",duration_months:"",features:[]}),[c,d]=U.useState(!1),[m,f]=U.useState("");U.useEffect(()=>{var g,v;l(n?{name:n.name,description:n.description||"",category:n.category||"",base_price:((g=n.base_price)==null?void 0:g.toString())||"",price_type:n.price_type,duration_months:((v=n.duration_months)==null?void 0:v.toString())||"",features:n.features||[]}:{name:"",description:"",category:"",base_price:"",price_type:"monthly",duration_months:"",features:[]})},[n,t]);const p=async g=>{g.preventDefault(),d(!0),f("");try{const v={name:i.name,description:i.description||null,category:i.category||null,base_price:i.base_price?parseFloat(i.base_price):null,price_type:i.price_type,duration_months:i.duration_months?parseInt(i.duration_months):null,features:i.features};if(n){const{error:w}=await Pe.from("services").update(v).eq("id",n.id);if(w)throw w}else{const{error:w}=await Pe.from("services").insert([v]);if(w)throw w}r(),e()}catch(v){f(v.message||"Erro ao salvar servio")}finally{d(!1)}};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b border-[#e0e4e8]",children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:n?"Editar Servio":"Novo Servio"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:n?"Atualize as informaes do servio":"Cadastre um novo servio no catlogo"})]}),a.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(We,{label:"Nome do Servio",placeholder:"Ex: Implementao LGPD",value:i.name,onChange:g=>l({...i,name:g.target.value}),required:!0})}),a.jsx(We,{label:"Categoria",placeholder:"Ex: Consultoria, Software, Treinamento",value:i.category,onChange:g=>l({...i,category:g.target.value})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Tipo de Preo"}),a.jsxs("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:i.price_type,onChange:g=>l({...i,price_type:g.target.value}),children:[a.jsx("option",{value:"monthly",children:"Mensal"}),a.jsx("option",{value:"annual",children:"Anual"}),a.jsx("option",{value:"one-time",children:"nico"}),a.jsx("option",{value:"custom",children:"Personalizado"})]})]}),a.jsx(We,{label:"Preo Base (R$)",placeholder:"1500.00",type:"number",step:"0.01",value:i.base_price,onChange:g=>l({...i,base_price:g.target.value})}),a.jsx(We,{label:"Durao (meses)",placeholder:"12",type:"number",value:i.duration_months,onChange:g=>l({...i,duration_months:g.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Descrio"}),a.jsx("textarea",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a] h-24 resize-none",placeholder:"Descrio detalhada do servio...",value:i.description,onChange:g=>l({...i,description:g.target.value})})]}),m&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm",children:m}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[a.jsx(ue,{type:"button",variant:"outline",onClick:e,children:"Cancelar"}),a.jsxs(ue,{type:"submit",loading:c,children:[n?"Atualizar":"Criar"," Servio"]})]})]})]})}):null}function NC(){const{user:t}=Rt(),[e,r]=U.useState([]),[n,i]=U.useState(!0),[l,c]=U.useState(""),[d,m]=U.useState("todas"),[f,p]=U.useState("todos"),[g,v]=U.useState(!1),[w,S]=U.useState(null),[y,E]=U.useState([]);U.useEffect(()=>{D()},[]);const D=async()=>{try{i(!0);const{data:N,error:j}=await Pe.from("services").select("*").order("created_at",{ascending:!1});if(j)throw j;r(N||[]);const T=[...new Set((N||[]).map(k=>k.category).filter(Boolean))];E(T)}catch(N){console.error("Erro ao carregar servios:",N)}finally{i(!1)}},A=async N=>{try{const{error:j}=await Pe.from("services").update({is_active:!N.is_active}).eq("id",N.id);if(j)throw j;await D()}catch(j){console.error("Erro ao alterar status do servio:",j)}},C=async N=>{if(confirm("Tem certeza que deseja excluir este servio?"))try{const{error:j}=await Pe.from("services").delete().eq("id",N.id);if(j)throw j;await D()}catch(j){console.error("Erro ao excluir servio:",j)}},P=e.filter(N=>{var q;const j=N.name.toLowerCase().includes(l.toLowerCase())||((q=N.description)==null?void 0:q.toLowerCase().includes(l.toLowerCase())),T=d==="todas"||N.category===d,k=f==="todos"||N.price_type===f;return j&&T&&k}),F=N=>{switch(N){case"monthly":return"Mensal";case"annual":return"Anual";case"one-time":return"nico";case"custom":return"Personalizado";default:return N}},L=N=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(N);return n?a.jsx(wr,{children:a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando servios..."})]})})}):a.jsxs(wr,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[#1a237e]",children:"Catlogo de Servios"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Gerencie todos os servios oferecidos pela empresa"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{variant:"outline",children:[a.jsx(sn,{size:18,className:"mr-2"}),"Exportar"]}),a.jsxs(ue,{onClick:()=>v(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Novo Servio"]})]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar por nome ou descrio...",icon:a.jsx(an,{size:18}),value:l,onChange:N=>c(N.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:d,onChange:N=>m(N.target.value),children:[a.jsx("option",{value:"todas",children:"Todas as Categorias"}),y.map(N=>a.jsx("option",{value:N,children:N},N))]}),a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:f,onChange:N=>p(N.target.value),children:[a.jsx("option",{value:"todos",children:"Todos os Tipos"}),a.jsx("option",{value:"monthly",children:"Mensal"}),a.jsx("option",{value:"annual",children:"Anual"}),a.jsx("option",{value:"one-time",children:"nico"}),a.jsx("option",{value:"custom",children:"Personalizado"})]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:e.length})]}),a.jsx(Po,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Ativos"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.filter(N=>N.is_active).length})]}),a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Po,{className:"w-5 h-5 text-green-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Categorias"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:y.length})]}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Po,{className:"w-5 h-5 text-blue-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Preo Mdio"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:L(e.reduce((N,j)=>N+(j.base_price||0),0)/e.length||0)})]}),a.jsx(sl,{className:"w-8 h-8 text-[#6a1b9a]"})]})})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.length>0?P.map(N=>a.jsxs(Ae,{variant:N.is_active?"default":"outlined",children:[a.jsx(at,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(it,{className:"text-lg",children:N.name}),N.category&&a.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full mt-2",children:N.category})]}),a.jsx("button",{onClick:()=>A(N),className:"ml-2",children:N.is_active?a.jsx(Cg,{className:"w-6 h-6 text-green-600"}):a.jsx(kg,{className:"w-6 h-6 text-gray-400"})})]})}),a.jsxs(Oe,{className:"space-y-4",children:[N.description&&a.jsx("p",{className:"text-sm text-[#5a647e] line-clamp-3",children:N.description}),a.jsxs("div",{className:"space-y-2",children:[N.base_price&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-[#5a647e]",children:"Preo Base:"}),a.jsx("span",{className:"font-medium text-[#1a237e]",children:L(N.base_price)})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-[#5a647e]",children:"Tipo:"}),a.jsx("span",{className:"text-sm font-medium text-[#333333]",children:F(N.price_type)})]}),N.duration_months&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-[#5a647e]",children:"Durao:"}),a.jsxs("span",{className:"text-sm font-medium text-[#333333]",children:[N.duration_months," meses"]})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-2",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>S(N),children:a.jsx(is,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>C(N),children:a.jsx(Ws,{size:16,className:"text-red-600"})})]}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${N.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:N.is_active?"Ativo":"Inativo"})]})]})]},N.id)):a.jsxs("div",{className:"col-span-full text-center py-12",children:[a.jsx(Po,{className:"w-16 h-16 text-[#5a647e] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-[#333333] mb-2",children:"Nenhum servio encontrado"}),a.jsx("p",{className:"text-[#5a647e] mb-6",children:l||d!=="todas"||f!=="todos"?"Tente ajustar os filtros de busca":"Comece criando seu primeiro servio"}),!l&&d==="todas"&&f==="todos"&&a.jsxs(ue,{onClick:()=>v(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Criar Primeiro Servio"]})]})})]}),a.jsx(EC,{isOpen:g||!!w,onClose:()=>{v(!1),S(null)},onSuccess:D,service:w})]})}function Fx({isCliente:t=!1}){const{user:e}=Rt(),[r,n]=U.useState([]),[i,l]=U.useState(!0),[c,d]=U.useState(""),[m,f]=U.useState("todas"),[p,g]=U.useState(!1);U.useEffect(()=>{v()},[e,m]);const v=async()=>{if(e)try{l(!0);let A=Pe.from("proposals").select(`
          *,
          clients!proposals_client_id_fkey(
            id, company_name, legal_representative_name
          )
        `).order("created_at",{ascending:!1});e.role==="consultor"?A=A.eq("consultant_id",e.id):(e.role==="cliente"||t)&&(A=A.eq("client_id",e.id)),m!=="todas"&&(A=A.eq("status",m));const{data:C,error:P}=await A;if(P)throw P;const F=(C==null?void 0:C.map(L=>({...L,client:L.clients})))||[];n(F)}catch(A){console.error("Erro ao carregar propostas:",A)}finally{l(!1)}},w=r.filter(A=>{var C,P;return A.proposal_number.toLowerCase().includes(c.toLowerCase())||((P=(C=A.client)==null?void 0:C.company_name)==null?void 0:P.toLowerCase().includes(c.toLowerCase()))}),S=A=>{switch(A){case"accepted":return"bg-green-100 text-green-800";case"sent":return"bg-blue-100 text-blue-800";case"viewed":return"bg-purple-100 text-purple-800";case"rejected":return"bg-red-100 text-red-800";case"expired":return"bg-gray-100 text-gray-800";case"draft":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},y=A=>{switch(A){case"accepted":return"Aceita";case"sent":return"Enviada";case"viewed":return"Visualizada";case"rejected":return"Rejeitada";case"expired":return"Expirada";case"draft":return"Rascunho";default:return A}},E=A=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(A),D=A=>new Date(A).toLocaleDateString("pt-BR");return i?a.jsx(wr,{children:a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando propostas..."})]})})}):a.jsxs(wr,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[#1a237e]",children:t?"Minhas Propostas":"Propostas"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:t?"Visualize e gerencie suas propostas":"Gerencie todas as propostas comerciais"})]}),!t&&a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{variant:"outline",children:[a.jsx(sn,{size:18,className:"mr-2"}),"Exportar"]}),a.jsxs(ue,{onClick:()=>g(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Nova Proposta"]})]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar por nmero da proposta ou cliente...",icon:a.jsx(an,{size:18}),value:c,onChange:A=>d(A.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:m,onChange:A=>f(A.target.value),children:[a.jsx("option",{value:"todas",children:"Todos os Status"}),a.jsx("option",{value:"draft",children:"Rascunho"}),a.jsx("option",{value:"sent",children:"Enviadas"}),a.jsx("option",{value:"viewed",children:"Visualizadas"}),a.jsx("option",{value:"accepted",children:"Aceitas"}),a.jsx("option",{value:"rejected",children:"Rejeitadas"}),a.jsx("option",{value:"expired",children:"Expiradas"})]}),a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:r.length})]}),a.jsx(Tt,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Enviadas"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.filter(A=>A.status==="sent").length})]}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-5 h-5 text-blue-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Aceitas"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.filter(A=>A.status==="accepted").length})]}),a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-5 h-5 text-green-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Valor Total"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:E(r.reduce((A,C)=>A+C.total_amount,0))})]}),a.jsx(sl,{className:"w-8 h-8 text-[#6a1b9a]"})]})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Lista de Propostas"}),a.jsxs(jt,{children:[w.length," ",w.length===1?"proposta encontrada":"propostas encontradas"]})]}),a.jsx(Oe,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-[#e0e4e8]",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Proposta"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Cliente"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Valor"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Data"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Aes"})]})}),a.jsx("tbody",{children:w.length>0?w.map(A=>{var C,P;return a.jsxs("tr",{className:"border-b border-[#e0e4e8] hover:bg-[#f7f8fc]",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-[#333333]",children:["#",A.proposal_number]}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:A.contract_duration_type==="fixed_term"?"Prazo fixo":"Indeterminado"})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:((C=A.client)==null?void 0:C.company_name)||"Cliente no encontrado"}),((P=A.client)==null?void 0:P.legal_representative_name)&&a.jsx("p",{className:"text-sm text-[#5a647e]",children:A.client.legal_representative_name})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:E(A.total_amount)}),A.discount_percentage>0&&a.jsxs("p",{className:"text-sm text-green-600",children:[A.discount_percentage,"% desconto"]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${S(A.status)}`,children:y(A.status)})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#333333]",children:D(A.created_at)}),A.expires_at&&a.jsxs("p",{className:"text-xs text-[#5a647e] flex items-center",children:[a.jsx(Vs,{size:12,className:"mr-1"}),"Expira: ",D(A.expires_at)]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",title:"Visualizar",children:a.jsx(Cr,{size:16})}),!t&&a.jsx(ue,{variant:"ghost",size:"sm",title:"Editar",children:a.jsx(is,{size:16})}),A.unique_link&&a.jsx(ue,{variant:"ghost",size:"sm",title:"Copiar link",children:a.jsx(Ng,{size:16})})]})})]},A.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"py-8 text-center text-[#5a647e]",children:"Nenhuma proposta encontrada"})})})]})})})]})]}),a.jsx(Ag,{isOpen:p,onClose:()=>g(!1),onSuccess:v})]})}const bC=({onConfigSaved:t})=>{const[e,r]=U.useState({api_token:"",crypt_key:"",environment:"sandbox",webhook_url:"",base_url:"",is_active:!0}),[n,i]=U.useState(!1),[l,c]=U.useState(!1),[d,m]=U.useState(!1),[f,p]=U.useState(!1),[g,v]=U.useState(!1),[w,S]=U.useState(null),[y,E]=U.useState([]),[D,A]=U.useState(!1);U.useEffect(()=>{C(),P()},[]);const C=async()=>{m(!0);try{const{data:j,error:T}=await Pe.from("d4sign_config").select("*").eq("is_active",!0).single();if(T&&T.code!=="PGRST116")throw T;j&&r(j)}catch(j){console.error("Erro ao carregar configurao D4Sign:",j)}finally{m(!1)}},P=async()=>{A(!0);try{const{data:j,error:T}=await Pe.from("signature_audit_logs").select("*").order("created_at",{ascending:!1}).limit(10);if(T)throw T;E(j||[])}catch(j){console.error("Erro ao carregar logs de auditoria:",j)}finally{A(!1)}},F=async()=>{p(!0),S(null);try{if(!e.api_token.trim())throw new Error("Token da API  obrigatrio");const j=e.environment==="production"?"https://secure.d4sign.com.br":"https://sandbox.d4sign.com.br",T={...e,base_url:e.base_url||j,updated_at:new Date().toISOString()};let k;if(e.id?k=await Pe.from("d4sign_config").update(T).eq("id",e.id).select().single():(await Pe.from("d4sign_config").update({is_active:!1}).neq("id","00000000-0000-0000-0000-000000000000"),k=await Pe.from("d4sign_config").insert(T).select().single()),k.error)throw k.error;r(k.data),t==null||t(k.data),S({success:!0,message:"Configurao salva com sucesso!"})}catch(j){S({success:!1,message:j.message||"Erro ao salvar configurao"})}finally{p(!1)}},L=async()=>{if(!e.api_token.trim()){S({success:!1,message:"Token da API  obrigatrio para o teste"});return}v(!0),S(null);try{const{data:j,error:T}=await Pe.functions.invoke("d4sign-diagnostic",{body:{endpoint:"account"}});if(T)throw T;const k=j==null?void 0:j.data;(k==null?void 0:k.status)===200?k.response_is_empty?S({success:!1,message:"Conexo estabelecida, mas conta D4Sign precisa ser ativada. Entre em contato com o suporte D4Sign.",details:k}):S({success:!0,message:"Conexo e credenciais funcionando perfeitamente!",details:k}):(k==null?void 0:k.status)===401?S({success:!1,message:"Credenciais invlidas. Verifique o Token da API e Crypt Key.",details:k}):S({success:!1,message:`Erro na API D4Sign (${k==null?void 0:k.status}): ${(k==null?void 0:k.response_preview)||"Erro desconhecido"}`,details:k}),e.id&&await Pe.from("d4sign_config").update({last_test_at:new Date().toISOString(),test_status:(k==null?void 0:k.status)===200?"warning":"failed"}).eq("id",e.id)}catch(j){console.error("Erro no teste de conexo:",j),S({success:!1,message:`Erro no diagnstico: ${j.message}`,details:j}),e.id&&await Pe.from("d4sign_config").update({last_test_at:new Date().toISOString(),test_status:"failed"}).eq("id",e.id)}finally{v(!1),P()}},N=()=>{const j=`${window.location.origin}/functions/v1/d4sign-webhook`;r(T=>({...T,webhook_url:j}))};return d?a.jsx(Ae,{className:"p-6",children:a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsx("div",{className:"text-gray-500",children:"Carregando configuraes..."})})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ja,{className:"h-5 w-5"}),a.jsx("h2",{className:"text-lg font-semibold",children:"Configuraes D4Sign"})]}),a.jsxs(Ae,{className:"p-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Token da API D4Sign *"}),a.jsxs("div",{className:"relative",children:[a.jsx(We,{type:n?"text":"password",value:e.api_token,onChange:j=>r(T=>({...T,api_token:j.target.value})),placeholder:"Insira o token da API D4Sign",className:"pr-10"}),a.jsx(ue,{type:"button",variant:"ghost",size:"sm",onClick:()=>i(!n),className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6 p-0",children:n?a.jsx(Mc,{className:"h-4 w-4"}):a.jsx(Cr,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Crypt Key (Opcional)"}),a.jsxs("div",{className:"relative",children:[a.jsx(We,{type:l?"text":"password",value:e.crypt_key||"",onChange:j=>r(T=>({...T,crypt_key:j.target.value})),placeholder:"Chave de criptografia (opcional)",className:"pr-10"}),a.jsx(ue,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(!l),className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6 p-0",children:l?a.jsx(Mc,{className:"h-4 w-4"}):a.jsx(Cr,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ambiente *"}),a.jsxs("select",{value:e.environment,onChange:j=>r(T=>({...T,environment:j.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsx("option",{value:"sandbox",children:"Sandbox (Testes)"}),a.jsx("option",{value:"production",children:"Produo (Validade Jurdica)"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.environment==="sandbox"?" Ambiente de testes - documentos no tm validade jurdica":" Ambiente de produo - documentos tm validade jurdica"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"URL Base (Opcional)"}),a.jsxs("div",{className:"relative",children:[a.jsx(u3,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(We,{type:"url",value:e.base_url||"",onChange:j=>r(T=>({...T,base_url:j.target.value})),placeholder:e.environment==="production"?"https://secure.d4sign.com.br":"https://sandbox.d4sign.com.br",className:"pl-10"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Deixe vazio para usar a URL padro do ambiente selecionado"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"URL do Webhook"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(w3,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(We,{type:"url",value:e.webhook_url||"",onChange:j=>r(T=>({...T,webhook_url:j.target.value})),placeholder:"URL para receber notificaes de status",className:"pl-10"})]}),a.jsx(ue,{type:"button",variant:"outline",onClick:N,className:"shrink-0",children:"Gerar"})]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Configure esta URL no painel D4Sign para receber notificaes"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"is_active",checked:e.is_active,onChange:j=>r(T=>({...T,is_active:j.target.checked})),className:"rounded"}),a.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium",children:"Configurao ativa"})]})]}),w&&a.jsxs("div",{className:Ys("mt-4 p-3 rounded-lg flex items-center gap-2",w.success?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:[w.success?a.jsx($s,{className:"h-4 w-4 text-green-500"}):a.jsx(Di,{className:"h-4 w-4 text-red-500"}),a.jsx("span",{className:"text-sm",children:w.message})]}),a.jsxs("div",{className:"flex gap-3 mt-6",children:[a.jsxs(ue,{onClick:F,disabled:f||!e.api_token.trim(),className:"flex items-center gap-2",children:[a.jsx(au,{className:"h-4 w-4"}),f?"Salvando...":"Salvar Configurao"]}),a.jsxs(ue,{variant:"outline",onClick:L,disabled:g||!e.api_token.trim(),className:"flex items-center gap-2",children:[a.jsx(y3,{className:"h-4 w-4"}),g?"Testando...":"Testar Conexo"]})]}),e.id&&a.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Status da Integrao"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-3 h-3 rounded-full ${e.test_status==="success"?"bg-green-500":e.test_status==="warning"?"bg-yellow-500":e.test_status==="failed"?"bg-red-500":"bg-gray-300"}`}),a.jsx("span",{className:"text-sm font-medium",children:e.test_status==="success"?"Funcionando":e.test_status==="warning"?"Ateno Necessria":e.test_status==="failed"?"Com Problemas":"No Testado"})]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"Ambiente:"})," ",e.environment==="production"?"Produo":"Sandbox"]}),a.jsxs("div",{className:"text-sm text-gray-600",children:[a.jsx("span",{className:"font-medium",children:"ltimo Teste:"})," ",e.last_test_at?new Date(e.last_test_at).toLocaleString("pt-BR"):"Nunca testado"]})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Logs de Auditoria (10 ltimos)"}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:P,disabled:D,className:"text-sm",children:D?"Carregando...":"Atualizar"})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg border max-h-64 overflow-y-auto",children:y.length>0?a.jsx("div",{className:"divide-y divide-gray-200",children:y.map((j,T)=>a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-2 h-2 rounded-full ${j.event_type==="DOCUMENT_UPLOADED"?"bg-blue-500":j.event_type==="DOCUMENT_SIGNED"?"bg-green-500":j.event_type==="ERROR"?"bg-red-500":"bg-gray-400"}`}),a.jsx("span",{className:"text-sm font-medium",children:j.event_type})]}),a.jsx("span",{className:"text-xs text-gray-500",children:new Date(j.created_at).toLocaleString("pt-BR")})]}),a.jsx("p",{className:"text-sm text-gray-700 mt-1",children:j.description}),j.event_data&&a.jsxs("details",{className:"mt-2",children:[a.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer",children:"Ver detalhes"}),a.jsx("pre",{className:"text-xs bg-white p-2 rounded mt-1 overflow-x-auto",children:JSON.stringify(j.event_data,null,2)})]})]},j.id||T))}):a.jsxs("div",{className:"p-6 text-center text-gray-500",children:[a.jsx("p",{className:"text-sm",children:"Nenhum log de auditoria encontrado"}),a.jsx("p",{className:"text-xs mt-1",children:"Os logs aparecero aqui quando houver atividade na integrao D4Sign"})]})})]}),a.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Tg,{className:"h-5 w-5 text-blue-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-blue-900",children:"Segurana e Privacidade"}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Suas credenciais so armazenadas de forma segura no banco de dados. Nunca compartilhe seu Token da API com terceiros."})]})]})})]})]})};function Dx({isCliente:t=!1}){const{user:e}=Rt(),{exportTable:r,exporting:n}=Sh(),[i,l]=U.useState([]),[c,d]=U.useState([]),[m,f]=U.useState(!0),[p,g]=U.useState(!0),[v,w]=U.useState(null),[S,y]=U.useState(""),[E,D]=U.useState("todos"),[A,C]=U.useState("contratos"),[P,F]=U.useState({total:0,active:0,pending:0,expiring:0,monthlyRevenue:0});U.useEffect(()=>{L(),N()},[e,E]);const L=async()=>{if(e)try{f(!0);let te=Pe.from("contracts").select(`
          *,
          clients!contracts_client_id_fkey(
            id, company_name, legal_representative_name
          )
        `).order("created_at",{ascending:!1});(e.role==="cliente"||t)&&(te=te.eq("client_id",e.id)),E!=="todos"&&(te=te.eq("status",E));const{data:he,error:Q}=await te;if(Q)throw Q;const W=(he==null?void 0:he.map(_e=>({..._e,client:_e.clients})))||[];l(W);const re=W.length,M=W.filter(_e=>_e.status==="active").length,b=W.filter(_e=>_e.status==="pending").length,I=new Date,H=new Date(I.getTime()+30*24*60*60*1e3),G=W.filter(_e=>{if(!_e.end_date)return!1;const me=new Date(_e.end_date);return me<=H&&me>I}).length,se=W.filter(_e=>_e.status==="active").reduce((_e,me)=>_e+(me.monthly_value||0),0);F({total:re,active:M,pending:b,expiring:G,monthlyRevenue:se})}catch(te){console.error("Erro ao carregar contratos:",te)}finally{f(!1)}},N=async()=>{if(e)try{g(!0);let te=Pe.from("proposals").select(`
          *,
          clients!proposals_client_id_fkey(
            id, company_name, legal_representative_name, cnpj
          )
        `).eq("status","accepted").order("created_at",{ascending:!1});e.role==="consultor"&&(te=te.eq("consultant_id",e.id));const{data:he,error:Q}=await te;if(Q)throw Q;const W=(he==null?void 0:he.map(H=>({...H,client:H.clients})))||[],re=W.map(H=>H.id),{data:M}=await Pe.from("contracts").select("proposal_id").in("proposal_id",re),b=new Set((M==null?void 0:M.map(H=>H.proposal_id))||[]),I=W.filter(H=>!b.has(H.id));d(I)}catch(te){console.error("Erro ao carregar propostas aceitas:",te)}finally{g(!1)}},j=async(te,he)=>{if(confirm(`Confirma a gerao de contrato para a proposta ${he}?`))try{w(te),console.log("Gerando contrato para proposta:",he);const{data:Q,error:W}=await Pe.functions.invoke("process-proposal-acceptance",{body:{proposalId:te}});if(W)throw new Error(W.message||"Erro ao processar proposta");if(Q!=null&&Q.error)throw new Error(Q.error.message||"Erro ao processar proposta");console.log("Contrato gerado com sucesso:",Q),alert(`Contrato gerado com sucesso!
Nmero do contrato: ${Q.data.contract.contract_number}`),await L(),await N()}catch(Q){console.error("Erro ao gerar contrato:",Q),alert(`Erro ao gerar contrato: ${Q.message}`)}finally{w(null)}},T=i.filter(te=>{var he,Q;return te.contract_number.toLowerCase().includes(S.toLowerCase())||((Q=(he=te.client)==null?void 0:he.company_name)==null?void 0:Q.toLowerCase().includes(S.toLowerCase()))}),k=te=>{switch(te){case"active":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"sent_for_signature":return"bg-blue-100 text-blue-800";case"signed":return"bg-purple-100 text-purple-800";case"terminated":return"bg-red-100 text-red-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},q=te=>{switch(te){case"active":return"Ativo";case"pending":return"Pendente";case"sent_for_signature":return"Enviado para Assinatura";case"signed":return"Assinado";case"terminated":return"Encerrado";case"cancelled":return"Cancelado";default:return te}},B=te=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(te),Y=te=>new Date(te).toLocaleDateString("pt-BR"),pe=te=>{switch(te){case"active":return a.jsx($s,{className:"w-4 h-4"});case"pending":return a.jsx(o3,{className:"w-4 h-4"});case"cancelled":case"terminated":return a.jsx(i3,{className:"w-4 h-4"});default:return a.jsx(Tt,{className:"w-4 h-4"})}},we=async()=>{const te=T.map(he=>{var Q;return{...he,client_name:((Q=he.client)==null?void 0:Q.company_name)||"",status_label:q(he.status),created_at:he.created_at?new Date(he.created_at).toLocaleDateString("pt-BR"):"",start_date:he.start_date?new Date(he.start_date).toLocaleDateString("pt-BR"):"",end_date:he.end_date?new Date(he.end_date).toLocaleDateString("pt-BR"):""}});await r("contracts",te,`contratos_${new Date().toISOString().split("T")[0]}`)};return m?a.jsx(wr,{children:a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando contratos..."})]})})}):a.jsx(wr,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[#1a237e]",children:t?"Meus Contratos":"Contratos"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:t?"Visualize e gerencie seus contratos":"Gerencie todos os contratos do sistema"})]}),!t&&a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[a.jsx("button",{onClick:()=>C("contratos"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${A==="contratos"?"bg-white text-[#1a237e] shadow-sm":"text-[#5a647e] hover:text-[#1a237e]"}`,children:"Contratos"}),a.jsx("button",{onClick:()=>C("propostas"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${A==="propostas"?"bg-white text-[#1a237e] shadow-sm":"text-[#5a647e] hover:text-[#1a237e]"}`,children:"Propostas Aceitas"}),a.jsxs("button",{onClick:()=>C("d4sign"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${A==="d4sign"?"bg-white text-[#1a237e] shadow-sm":"text-[#5a647e] hover:text-[#1a237e]"}`,children:[a.jsx(ja,{className:"w-4 h-4 mr-1 inline"}),"D4Sign"]})]}),a.jsxs(ue,{variant:"outline",onClick:we,loading:n,children:[a.jsx(sn,{size:18,className:"mr-2"}),n?"Exportando...":"Exportar Relatrio"]})]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar por nmero do contrato ou cliente...",icon:a.jsx(an,{size:18}),value:S,onChange:te=>y(te.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:E,onChange:te=>D(te.target.value),children:[a.jsx("option",{value:"todos",children:"Todos os Status"}),a.jsx("option",{value:"pending",children:"Pendente"}),a.jsx("option",{value:"sent_for_signature",children:"Enviado para Assinatura"}),a.jsx("option",{value:"signed",children:"Assinado"}),a.jsx("option",{value:"active",children:"Ativo"}),a.jsx("option",{value:"terminated",children:"Encerrado"}),a.jsx("option",{value:"cancelled",children:"Cancelado"})]}),a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:P.total})]}),a.jsx(wa,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Ativos"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:P.active})]}),a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx($s,{className:"w-5 h-5 text-green-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Vencendo"}),a.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:P.expiring})]}),a.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:a.jsx(Lf,{className:"w-5 h-5 text-yellow-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Receita Mensal"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:B(P.monthlyRevenue)})]}),a.jsx(sl,{className:"w-8 h-8 text-[#6a1b9a]"})]})})})]}),A==="contratos"&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Lista de Contratos"}),a.jsxs(jt,{children:[T.length," ",T.length===1?"contrato encontrado":"contratos encontrados"]})]}),a.jsx(Oe,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-[#e0e4e8]",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Contrato"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Cliente"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Valor"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Perodo"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Aes"})]})}),a.jsx("tbody",{children:T.length>0?T.map(te=>{var Q,W;const he=te.end_date&&new Date(te.end_date)<=new Date(Date.now()+2592e6);return a.jsxs("tr",{className:"border-b border-[#e0e4e8] hover:bg-[#f7f8fc]",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-[#333333]",children:["#",te.contract_number]}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:te.contract_type||"Contrato de Servios"})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:((Q=te.client)==null?void 0:Q.company_name)||"Cliente no encontrado"}),((W=te.client)==null?void 0:W.legal_representative_name)&&a.jsx("p",{className:"text-sm text-[#5a647e]",children:te.client.legal_representative_name})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[te.monthly_value&&a.jsxs("p",{className:"font-medium text-[#333333]",children:[B(te.monthly_value),"/ms"]}),te.annual_value&&a.jsxs("p",{className:"text-sm text-[#5a647e]",children:[B(te.annual_value),"/ano"]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("span",{className:`inline-flex items-center space-x-1 px-2 py-1 text-xs rounded-full ${k(te.status)}`,children:[pe(te.status),a.jsx("span",{children:q(te.status)})]}),he&&te.status==="active"&&a.jsx(Lf,{className:"w-4 h-4 text-yellow-600",title:"Contrato vencendo em breve"})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"text-sm",children:[te.start_date&&a.jsxs("p",{className:"text-[#333333]",children:["Incio: ",Y(te.start_date)]}),te.end_date&&a.jsxs("p",{className:`text-sm ${he?"text-yellow-600":"text-[#5a647e]"}`,children:["Fim: ",Y(te.end_date)]}),!te.end_date&&te.start_date&&a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Indeterminado"})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",title:"Visualizar",children:a.jsx(Cr,{size:16})}),!t&&a.jsx(ue,{variant:"ghost",size:"sm",title:"Editar",children:a.jsx(is,{size:16})}),te.contract_file_url&&a.jsx(ue,{variant:"ghost",size:"sm",title:"Download",children:a.jsx(sn,{size:16})})]})})]},te.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"py-8 text-center text-[#5a647e]",children:S||E!=="todos"?"Nenhum contrato encontrado com os filtros aplicados":"Nenhum contrato encontrado"})})})]})})})]}),A==="propostas"&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Propostas Aceitas"}),a.jsxs(jt,{children:[c.length," ",c.length===1?"proposta aceita disponvel":"propostas aceitas disponveis"," para gerar contrato"]})]}),a.jsx(Oe,{children:p?a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-2"}),a.jsx("p",{className:"text-[#5a647e] text-sm",children:"Carregando propostas..."})]})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-[#e0e4e8]",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Proposta"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Cliente"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Valor Total"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Data Aceite"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Aes"})]})}),a.jsx("tbody",{children:c.length>0?c.map(te=>{var he,Q,W;return a.jsxs("tr",{className:"border-b border-[#e0e4e8] hover:bg-[#f7f8fc]",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium text-[#333333]",children:["#",te.proposal_number]}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Criada em: ",Y(te.created_at)]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:((he=te.client)==null?void 0:he.company_name)||"Cliente no encontrado"}),((Q=te.client)==null?void 0:Q.cnpj)&&a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["CNPJ: ",te.client.cnpj]}),((W=te.client)==null?void 0:W.legal_representative_name)&&a.jsx("p",{className:"text-sm text-[#5a647e]",children:te.client.legal_representative_name})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:B(te.total_amount)}),te.discount_percentage>0&&a.jsxs("p",{className:"text-sm text-green-600",children:[te.discount_percentage,"% desconto"]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("div",{className:"text-sm",children:te.accepted_at?a.jsx("p",{className:"text-[#333333]",children:Y(te.accepted_at)}):a.jsx("p",{className:"text-[#5a647e]",children:"Data no informada"})})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(ue,{variant:"primary",size:"sm",onClick:()=>j(te.id,te.proposal_number),className:"bg-[#6a1b9a] hover:bg-[#5a1580] text-white",loading:v===te.id,disabled:v!==null,children:[v===te.id?a.jsx(p3,{size:16,className:"mr-1"}):a.jsx(Tt,{size:16,className:"mr-1"}),v===te.id?"Processando...":"Gerar Contrato"]}),a.jsx(ue,{variant:"ghost",size:"sm",title:"Visualizar Proposta",children:a.jsx(Cr,{size:16})})]})})]},te.id)}):a.jsx("tr",{children:a.jsx("td",{colSpan:5,className:"py-8 text-center text-[#5a647e]",children:!p&&a.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[a.jsx(Tt,{className:"w-12 h-12 text-[#e0e4e8]"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Nenhuma proposta aceita encontrada"}),a.jsx("p",{className:"text-sm",children:"As propostas aceitas aparecero aqui para gerao de contratos"})]})]})})})})]})})})]}),A==="d4sign"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsxs(it,{className:"flex items-center gap-2",children:[a.jsx(ja,{className:"w-5 h-5"}),"Configurao D4Sign"]}),a.jsx(jt,{children:"Configure a integrao com a D4Sign para assinatura eletrnica de contratos"})]}),a.jsx(Oe,{className:"p-0",children:a.jsx("div",{className:"p-6",children:a.jsx(bC,{onConfigSaved:()=>{console.log("Configurao D4Sign salva com sucesso")}})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Status da Integrao"}),a.jsx(jt,{children:"Informaes sobre o status atual da integrao D4Sign"})]}),a.jsx(Oe,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx($s,{className:"w-5 h-5 text-green-600"}),a.jsx("span",{className:"font-medium text-green-900",children:"Configurao"})]}),a.jsx("p",{className:"text-sm text-green-700",children:"Sistema configurado e ativo"})]}),a.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(ja,{className:"w-5 h-5 text-blue-600"}),a.jsx("span",{className:"font-medium text-blue-900",children:"Ambiente"})]}),a.jsx("p",{className:"text-sm text-blue-700",children:"Produo (Validade Jurdica)"})]}),a.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Tt,{className:"w-5 h-5 text-purple-600"}),a.jsx("span",{className:"font-medium text-purple-900",children:"Documentos"})]}),a.jsx("p",{className:"text-sm text-purple-700",children:"Prontos para assinatura"})]})]})})]})]})]})})}function TC({template:t,onClose:e,onSuccess:r}){const{user:n}=Rt(),[i,l]=U.useState({name:"",description:"",content_html:"",category:"contratos"}),[c,d]=U.useState(!1),[m,f]=U.useState(""),[p,g]=U.useState(!1),[v,w]=U.useState([]),[S,y]=U.useState(!1);U.useEffect(()=>{l(t?{name:t.name,description:t.description||"",content_html:t.content_html,category:t.category}:{name:"",description:"",content_html:E("contratos"),category:"contratos"}),f("")},[t]);const E=C=>{switch(C){case"contratos":return`<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Contrato de Prestao de Servios</title>
</head>
<body>
    <h1>CONTRATO DE PRESTAO DE SERVIOS</h1>
    
    <p><strong>CONTRATANTE:</strong> {{contratante_nome}}</p>
    <p><strong>CNPJ:</strong> {{contratante_cnpj}}</p>
    <p><strong>ENDEREO:</strong> {{contratante_endereco}}</p>
    
    <p><strong>CONTRATADA:</strong> Seusdados Consultoria</p>
    
    <h2>CLUSULA 1 - DO OBJETO</h2>
    <p>O presente contrato tem por objeto a prestao dos seguintes servios:</p>
    <p>{{servicos_descricao}}</p>
    
    <h2>CLUSULA 2 - DO VALOR E FORMA DE PAGAMENTO</h2>
    <p>O valor total dos servios  de {{valor_total}}, a ser pago {{forma_pagamento}}.</p>
    
    <h2>CLUSULA 3 - DO PRAZO</h2>
    <p>O prazo de vigncia deste contrato  de {{prazo_vigencia}}, iniciando em {{data_inicio}}.</p>
    
    <p>Assinado em {{data_assinatura}}.</p>
    <p>Cdigo de verificao: {{codigo_verificacao}}</p>
</body>
</html>`;case"propostas":return`<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Proposta Comercial</title>
</head>
<body>
    <h1>PROPOSTA COMERCIAL</h1>
    
    <h2>Dados do Cliente</h2>
    <p><strong>Empresa:</strong> {{empresa_nome}}</p>
    <p><strong>Representante:</strong> {{representante_nome}}</p>
    <p><strong>Data:</strong> {{data_proposta}}</p>
    
    <h2>Servios Propostos</h2>
    <p>{{servicos_lista}}</p>
    
    <h2>Investimento</h2>
    <p><strong>Valor Total:</strong> {{valor_total}}</p>
    <p><strong>Desconto:</strong> {{desconto_percentual}}%</p>
    <p><strong>Valor Final:</strong> {{valor_final}}</p>
    
    <h2>Condies</h2>
    <p><strong>Prazo:</strong> {{prazo_execucao}}</p>
    <p><strong>Forma de Pagamento:</strong> {{forma_pagamento}}</p>
    
    <p>Atenciosamente,</p>
    <p><strong>Equipe Seusdados</strong></p>
</body>
</html>`;default:return`<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>{{titulo_documento}}</title>
</head>
<body>
    <h1>{{titulo_principal}}</h1>
    <p>{{conteudo_principal}}</p>
</body>
</html>`}},D=async()=>{if(i.content_html)try{y(!0);const{data:{session:C}}=await Pe.auth.getSession(),P=C==null?void 0:C.access_token,F=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/field-detector",{method:"POST",headers:{Authorization:`Bearer ${P||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvcHBhZHpweWZ0amtlcmdjY3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDUzODYsImV4cCI6MjA3MTE4MTM4Nn0.ExLR9dipmd8XvOzSafxYFF9Y5JFBoUfLia8splbgaVc"}`,"Content-Type":"application/json"},body:JSON.stringify({template_content:i.content_html})});if(F.ok){const L=await F.json();w(L.detected_fields||[])}}catch(C){console.error("Erro ao detectar campos:",C)}finally{y(!1)}},A=async C=>{C.preventDefault(),d(!0),f("");try{const P={name:i.name,description:i.description||null,content_html:i.content_html,category:i.category,content_type:"html",is_active:!0,updated_at:new Date().toISOString()};if(t!=null&&t.id){const{error:F}=await Pe.from("document_templates").update(P).eq("id",t.id);if(F)throw F}else{const{data:F,error:L}=await Pe.from("document_templates").insert([P]).select();if(L)throw L;if(F&&F[0])try{await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/field-detector",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvcHBhZHpweWZ0amtlcmdjY3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDUzODYsImV4cCI6MjA3MTE4MTM4Nn0.ExLR9dipmd8XvOzSafxYFF9Y5JFBoUfLia8splbgaVc","Content-Type":"application/json"},body:JSON.stringify({template_content:i.content_html,template_id:F[0].id})})}catch(N){console.error("Erro na auto-deteco de campos:",N)}}r()}catch(P){console.error("Erro ao salvar template:",P),f(P.message||"Erro ao salvar template")}finally{d(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:t?"Editar Template":"Novo Template"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:t?"Atualize o template":"Crie um novo template com campos dinmicos"})]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"flex h-[calc(90vh-140px)]",children:[a.jsx("div",{className:"w-1/3 p-6 border-r border-[#e0e4e8] overflow-y-auto",children:a.jsxs("form",{onSubmit:A,className:"space-y-6",children:[a.jsx(We,{label:"Nome do Template",placeholder:"Ex: Contrato de Servios",value:i.name,onChange:C=>l({...i,name:C.target.value}),required:!0}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Categoria"}),a.jsxs("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:i.category,onChange:C=>{const P=C.target.value;l({...i,category:P,content_html:t?i.content_html:E(P)})},children:[a.jsx("option",{value:"contratos",children:"Contratos"}),a.jsx("option",{value:"propostas",children:"Propostas"}),a.jsx("option",{value:"emails",children:"E-mails"})]})]}),a.jsx(We,{label:"Descrio (opcional)",placeholder:"Descreva quando usar este template...",value:i.description,onChange:C=>l({...i,description:C.target.value})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333]",children:"Campos Detectados"}),a.jsx(ue,{type:"button",variant:"outline",size:"sm",onClick:D,loading:S,children:"Detectar Campos"})]}),v.length>0?a.jsxs("div",{className:"bg-[#f7f8fc] p-3 rounded-lg",children:[a.jsxs("p",{className:"text-sm font-medium text-[#333333] mb-2",children:[v.length," campos encontrados:"]}),a.jsx("div",{className:"space-y-1",children:v.map((C,P)=>a.jsxs("div",{className:"text-xs",children:[a.jsx("span",{className:"font-mono bg-white px-2 py-1 rounded",children:`{{${C.field_name}}}`}),a.jsxs("span",{className:"text-[#5a647e] ml-2",children:[C.display_name," (",C.suggested_type,")"]})]},P))})]}):a.jsxs("p",{className:"text-xs text-[#5a647e]",children:["Use campos como ","{{nome_cliente}}",", ","{{valor_total}}",", etc."]})]}),m&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm",children:m}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{type:"submit",loading:c,className:"flex-1",children:[a.jsx(au,{size:16,className:"mr-2"}),t?"Atualizar":"Criar"," Template"]}),a.jsx(ue,{type:"button",variant:"outline",onClick:()=>g(!p),children:p?a.jsx(Mc,{size:16}):a.jsx(Cr,{size:16})})]})]})}),a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsx("div",{className:"flex items-center justify-between p-4 border-b border-[#e0e4e8]",children:a.jsx("h3",{className:"font-medium text-[#333333]",children:p?"Preview":"Editor HTML"})}),p?a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:a.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:i.content_html}})}):a.jsx("div",{className:"flex-1",children:a.jsx("textarea",{className:"w-full h-full p-4 border-0 focus:outline-none font-mono text-sm resize-none",placeholder:"Digite o contedo HTML do template...",value:i.content_html,onChange:C=>l({...i,content_html:C.target.value}),required:!0})})]})]})]})})}function kC({selectedClientId:t,templates:e,onSuccess:r}){var he,Q;const{user:n}=Rt(),[i,l]=U.useState([]),[c,d]=U.useState(null),[m,f]=U.useState(null),[p,g]=U.useState({}),[v,w]=U.useState(""),[S,y]=U.useState(!1),[E,D]=U.useState(""),[A,C]=U.useState(!1),[P,F]=U.useState(null),[L,N]=U.useState(1);U.useEffect(()=>{j()},[]),U.useEffect(()=>{if(t){const W=i.find(re=>re.id===t);W&&(d(W),N(2))}},[t,i]),U.useEffect(()=>{c&&m&&T()},[c,m]);const j=async()=>{try{const{data:W,error:re}=await Pe.from("clients").select("*").eq("status","active").order("company_name");if(re)throw re;l(W||[])}catch(W){console.error("Erro ao carregar clientes:",W)}},T=()=>{if(!c||!m)return;const W={},re={contratante_nome:c.company_name,contratante_nome_1:c.company_name,contratante_nome_2:c.company_name,empresa_nome:c.company_name,cliente_nome:c.company_name,contratante_cnpj:c.cnpj||"",contratante_cnpj_1:c.cnpj||"",cnpj_cliente:c.cnpj||"",empresa_cnpj:c.cnpj||"",representante_nome:c.legal_representative_name||"",contratante_representante:c.legal_representative_name||"",contratante_email:c.legal_representative_email||"",representante_email:c.legal_representative_email||"",contratante_endereco:c.address||"",contratante_endereco_1:c.address||"",endereco_cliente:c.address||"",contratante_cidade:c.city||"",cidade_cliente:c.city||"",contratante_estado:c.state||"",estado_cliente:c.state||"",data_atual:new Date().toLocaleDateString("pt-BR"),data_proposta:new Date().toLocaleDateString("pt-BR"),data_assinatura:new Date().toLocaleDateString("pt-BR"),data_inicio:new Date().toLocaleDateString("pt-BR"),contrato_numero:`CTR-${Date.now().toString().slice(-6)}`,codigo_verificacao:k()},M=/\{\{\s*([a-zA-Z0-9_]+)\s*\}\}/g;let b;for(;(b=M.exec(m.content_html))!==null;){const I=b[1];re[I]?W[I]=re[I]:W[I]=""}g(W)},k=()=>{const W="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";let re="";for(let M=0;M<8;M++)re+=W.charAt(Math.floor(Math.random()*W.length));return re},q=async()=>{if(m)try{const W=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/template-processor",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvcHBhZHpweWZ0amtlcmdjY3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDUzODYsImV4cCI6MjA3MTE4MTM4Nn0.ExLR9dipmd8XvOzSafxYFF9Y5JFBoUfLia8splbgaVc","Content-Type":"application/json"},body:JSON.stringify({template_content:m.content_html,field_values:p,preview_mode:!0})});if(W.ok){const re=await W.json();D(re.data.processed_content),C(!0)}}catch(W){console.error("Erro ao gerar preview:",W)}},B=async()=>{if(!(!c||!m))try{y(!0);const W=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/document-generator",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvcHBhZHpweWZ0amtlcmdjY3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDUzODYsImV4cCI6MjA3MTE4MTM4Nn0.ExLR9dipmd8XvOzSafxYFF9Y5JFBoUfLia8splbgaVc","Content-Type":"application/json"},body:JSON.stringify({template_id:m.id,client_id:c.id,custom_field_values:p,document_type:m.category})});if(W.ok){const re=await W.json();F(re.data),N(4),r()}else throw new Error("Falha na gerao do documento")}catch(W){console.error("Erro ao gerar documento:",W)}finally{y(!1)}},Y=()=>{if(!P)return;const W=new Blob([P.processed_content],{type:"text/html"}),re=URL.createObjectURL(W),M=document.createElement("a");M.href=re,M.download=`${(m==null?void 0:m.name)||"documento"}_${(c==null?void 0:c.company_name)||"cliente"}.html`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(re)},pe=i.filter(W=>{var re,M;return W.company_name.toLowerCase().includes(v.toLowerCase())||((re=W.legal_representative_name)==null?void 0:re.toLowerCase().includes(v.toLowerCase()))||!1||((M=W.cnpj)==null?void 0:M.includes(v))||!1}),we=()=>Object.values(p).filter(W=>!W||W.trim()==="").length,te=()=>{const W=Object.keys(p).length,re=Object.values(p).filter(M=>M&&M.trim()!=="").length;return W>0?Math.round(re/W*100):0};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-center space-x-4 mb-8",children:[1,2,3,4].map(W=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${L>=W?"bg-[#6a1b9a] text-white":"bg-[#e0e4e8] text-[#5a647e]"}`,children:L>W?a.jsx($s,{size:16}):W}),W<4&&a.jsx("div",{className:`w-16 h-1 ${L>W?"bg-[#6a1b9a]":"bg-[#e0e4e8]"}`})]},W))}),L===1&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsxs(it,{className:"flex items-center",children:[a.jsx(Uc,{size:20,className:"mr-2"}),"Selecionar Cliente"]}),a.jsx(jt,{children:"Escolha o cliente para o qual o documento ser gerado"})]}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx(We,{placeholder:"Buscar cliente...",icon:a.jsx(an,{size:18}),value:v,onChange:W=>w(W.target.value)}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-96 overflow-y-auto",children:pe.map(W=>a.jsx(Ae,{className:`cursor-pointer transition-all hover:shadow-md ${(c==null?void 0:c.id)===W.id?"ring-2 ring-[#6a1b9a] bg-[#f7f8fc]":""}`,onClick:()=>{d(W),N(2)},children:a.jsxs(Oe,{className:"p-4",children:[a.jsx("h3",{className:"font-medium text-[#333333]",children:W.company_name}),W.cnpj&&a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["CNPJ: ",W.cnpj]}),W.legal_representative_name&&a.jsx("p",{className:"text-sm text-[#5a647e]",children:W.legal_representative_name})]})},W.id))})]})})]}),L===2&&c&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsxs(it,{className:"flex items-center",children:[a.jsx(Tt,{size:20,className:"mr-2"}),"Selecionar Template"]}),a.jsxs(jt,{children:["Cliente selecionado: ",a.jsx("strong",{children:c.company_name})]})]}),a.jsxs(Oe,{children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(W=>{var re;return a.jsx(Ae,{className:`cursor-pointer transition-all hover:shadow-md ${(m==null?void 0:m.id)===W.id?"ring-2 ring-[#6a1b9a] bg-[#f7f8fc]":""}`,onClick:()=>{f(W),N(3)},children:a.jsxs(Oe,{className:"p-4",children:[a.jsx("h3",{className:"font-medium text-[#333333] mb-2",children:W.name}),a.jsx("p",{className:"text-sm text-[#5a647e] mb-2",children:W.description||"Sem descrio"}),a.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-[#e0e4e8] text-[#5a647e] rounded",children:W.category}),((re=W.auto_detected_fields)==null?void 0:re.total_fields)&&a.jsxs("p",{className:"text-xs text-[#5a647e] mt-2",children:[W.auto_detected_fields.total_fields," campos detectados"]})]})},W.id)})}),a.jsx("div",{className:"flex justify-between mt-6",children:a.jsx(ue,{variant:"outline",onClick:()=>N(1),children:"Voltar"})})]})]}),L===3&&c&&m&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsxs(it,{className:"flex items-center",children:[a.jsx(ja,{size:20,className:"mr-2"}),"Preencher Campos"]}),a.jsxs(jt,{children:["Template: ",a.jsx("strong",{children:m.name})]})]}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[a.jsx("span",{children:"Progresso de preenchimento"}),a.jsxs("span",{children:[te(),"%"]})]}),a.jsx("div",{className:"w-full bg-[#e0e4e8] rounded-full h-2",children:a.jsx("div",{className:"bg-[#6a1b9a] h-2 rounded-full transition-all",style:{width:`${te()}%`}})}),we()>0&&a.jsxs("p",{className:"text-sm text-orange-600 mt-2 flex items-center",children:[a.jsx(Di,{size:16,className:"mr-1"}),we()," campos ainda precisam ser preenchidos"]})]}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Object.entries(p).map(([W,re])=>a.jsx(We,{label:W.replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase()),placeholder:`Digite ${W.replace(/_/g," ")}`,value:re,onChange:M=>g({...p,[W]:M.target.value})},W))}),a.jsxs("div",{className:"flex justify-between space-x-3",children:[a.jsx(ue,{variant:"outline",onClick:()=>N(2),children:"Voltar"}),a.jsxs("div",{className:"space-x-2",children:[a.jsxs(ue,{variant:"outline",onClick:q,children:[a.jsx(Cr,{size:16,className:"mr-2"}),"Preview"]}),a.jsx(ue,{onClick:B,loading:S,disabled:we()>0,children:"Gerar Documento"})]})]})]})})]}),A&&a.jsxs(Ae,{children:[a.jsx(at,{children:a.jsx(it,{children:"Preview do Documento"})}),a.jsx(Oe,{children:a.jsx("div",{className:"prose max-w-none border rounded-lg p-4 bg-white max-h-96 overflow-y-auto",dangerouslySetInnerHTML:{__html:E}})})]})]}),L===4&&P&&a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsxs(it,{className:"flex items-center text-green-600",children:[a.jsx($s,{size:20,className:"mr-2"}),"Documento Gerado com Sucesso"]}),a.jsxs(jt,{children:["Documento criado para ",a.jsx("strong",{children:c==null?void 0:c.company_name})]})]}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"Informaes do Documento"}),a.jsxs("div",{className:"text-sm text-green-700 space-y-1",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Cdigo de Verificao:"})," ",P.verification_code]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Template:"})," ",m==null?void 0:m.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Data de Gerao:"})," ",new Date().toLocaleDateString("pt-BR")]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Campos Preenchidos:"})," ",((he=P.processing_stats)==null?void 0:he.total_fields_processed)||0]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Taxa de Concluso:"})," ",((Q=P.processing_stats)==null?void 0:Q.completion_percentage)||0,"%"]})]})]}),a.jsxs("div",{className:"flex space-x-3",children:[a.jsxs(ue,{onClick:Y,children:[a.jsx(sn,{size:16,className:"mr-2"}),"Baixar Documento"]}),a.jsx(ue,{variant:"outline",onClick:()=>{N(1),d(null),f(null),g({}),F(null)},children:"Gerar Novo Documento"})]})]})})]})]})}function CC(){var C,P,F;const{user:t}=Rt(),[e,r]=U.useState([]),[n,i]=U.useState(!0),[l,c]=U.useState(""),[d,m]=U.useState("todos"),[f,p]=U.useState(null);U.useEffect(()=>{g()},[d]);const g=async()=>{try{i(!0);let L=Pe.from("generated_documents").select(`
          *,
          document_templates!inner(name, category),
          clients(company_name)
        `).order("created_at",{ascending:!1});d!=="todos"&&(L=L.eq("document_type",d));const{data:N,error:j}=await L;if(j)throw j;r(N||[])}catch(L){console.error("Erro ao carregar histrico:",L)}finally{i(!1)}},v=L=>{var k,q;const N=new Blob([L.generated_content],{type:"text/html"}),j=URL.createObjectURL(N),T=window.document.createElement("a");T.href=j,T.download=`${((k=L.document_templates)==null?void 0:k.name)||"documento"}_${((q=L.clients)==null?void 0:q.company_name)||"cliente"}_${L.id.slice(0,8)}.html`,window.document.body.appendChild(T),T.click(),window.document.body.removeChild(T),URL.revokeObjectURL(j)},w=L=>{const N=window.open("","_blank");N&&(N.document.write(L.generated_content),N.document.close())},S=e.filter(L=>{var N,j;return((N=L.document_templates)==null?void 0:N.name.toLowerCase().includes(l.toLowerCase()))||((j=L.clients)==null?void 0:j.company_name.toLowerCase().includes(l.toLowerCase()))||L.id.toLowerCase().includes(l.toLowerCase())}),y=L=>{switch(L){case"generated":return"bg-green-100 text-green-800";case"draft":return"bg-yellow-100 text-yellow-800";case"archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},E=L=>{switch(L){case"generated":return"Gerado";case"draft":return"Rascunho";case"archived":return"Arquivado";default:return L}},D=L=>{switch(L){case"contract":return"bg-blue-100 text-blue-800";case"proposal":return"bg-purple-100 text-purple-800";case"email":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},A=L=>{switch(L){case"contract":return"Contrato";case"proposal":return"Proposta";case"email":return"E-mail";default:return L}};return n?a.jsx("div",{className:"flex items-center justify-center h-48",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando histrico..."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Histrico de Documentos"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Visualize e gerencie todos os documentos gerados"})]})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar por template, cliente ou ID...",icon:a.jsx(an,{size:18}),value:l,onChange:L=>c(L.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:d,onChange:L=>m(L.target.value),children:[a.jsx("option",{value:"todos",children:"Todos os Tipos"}),a.jsx("option",{value:"contract",children:"Contratos"}),a.jsx("option",{value:"proposal",children:"Propostas"}),a.jsx("option",{value:"email",children:"E-mails"})]}),a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:e.length})]}),a.jsx(Tt,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Este Ms"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.filter(L=>{const N=new Date(L.created_at),j=new Date;return N.getMonth()===j.getMonth()&&N.getFullYear()===j.getFullYear()}).length})]}),a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(Vs,{className:"w-5 h-5 text-blue-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Contratos"}),a.jsx("p",{className:"text-2xl font-bold text-green-600",children:e.filter(L=>L.document_type==="contract").length})]}),a.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-5 h-5 text-green-600"})})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Propostas"}),a.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.filter(L=>L.document_type==="proposal").length})]}),a.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Tt,{className:"w-5 h-5 text-purple-600"})})]})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Documentos Gerados"}),a.jsxs(jt,{children:[S.length," ",S.length===1?"documento encontrado":"documentos encontrados"]})]}),a.jsx(Oe,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-[#e0e4e8]",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Template"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Cliente"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Tipo"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Data"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-[#333333]",children:"Aes"})]})}),a.jsx("tbody",{children:S.length>0?S.map(L=>{var N,j,T;return a.jsxs("tr",{className:"border-b border-[#e0e4e8] hover:bg-[#f7f8fc]",children:[a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:((N=L.document_templates)==null?void 0:N.name)||"Template no encontrado"}),a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["ID: ",L.id.slice(0,8),"..."]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-[#333333]",children:((j=L.clients)==null?void 0:j.company_name)||"Cliente no especificado"}),((T=L.field_values)==null?void 0:T.codigo_verificacao)&&a.jsxs("p",{className:"text-sm text-[#5a647e]",children:["Cdigo: ",L.field_values.codigo_verificacao]})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${D(L.document_type)}`,children:A(L.document_type)})}),a.jsx("td",{className:"py-4 px-4",children:a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${y(L.status)}`,children:E(L.status)})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"text-sm text-[#5a647e]",children:[a.jsx("p",{children:new Date(L.created_at).toLocaleDateString("pt-BR")}),a.jsx("p",{children:new Date(L.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})}),a.jsx("td",{className:"py-4 px-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>w(L),title:"Visualizar documento",children:a.jsx(Cr,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>v(L),title:"Baixar documento",children:a.jsx(sn,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>p(L),title:"Ver detalhes",children:a.jsx(Rc,{size:16})})]})})]},L.id)}):a.jsx("tr",{children:a.jsxs("td",{colSpan:6,className:"py-8 text-center text-[#5a647e]",children:[a.jsx(Tt,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("p",{children:"Nenhum documento encontrado"}),a.jsx("p",{className:"text-sm mt-1",children:"Gere seu primeiro documento para comear"})]})})})]})})})]}),f&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Detalhes do Documento"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:(C=f.document_templates)==null?void 0:C.name})]}),a.jsx("button",{onClick:()=>p(null),className:"text-[#5a647e] hover:text-[#333333]",children:""})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-[#333333] mb-2",children:"Informaes Bsicas"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"ID:"})," ",f.id]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Template:"})," ",(P=f.document_templates)==null?void 0:P.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Cliente:"})," ",((F=f.clients)==null?void 0:F.company_name)||"No especificado"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Tipo:"})," ",A(f.document_type)]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",E(f.status)]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Criado em:"})," ",new Date(f.created_at).toLocaleString("pt-BR")]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-[#333333] mb-2",children:"Campos Preenchidos"}),a.jsx("div",{className:"space-y-1 text-sm max-h-48 overflow-y-auto",children:Object.entries(f.field_values||{}).map(([L,N])=>a.jsxs("div",{className:"flex justify-between",children:[a.jsxs("span",{className:"text-[#5a647e]",children:[L,":"]}),a.jsx("span",{className:"font-medium truncate ml-2",children:String(N)})]},L))})]})]}),a.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-[#e0e4e8]",children:[a.jsxs(ue,{onClick:()=>w(f),children:[a.jsx(Cr,{size:16,className:"mr-2"}),"Visualizar"]}),a.jsxs(ue,{variant:"outline",onClick:()=>v(f),children:[a.jsx(sn,{size:16,className:"mr-2"}),"Baixar"]}),a.jsx(ue,{variant:"outline",onClick:()=>p(null),children:"Fechar"})]})]})]})})]})}function AC({initialView:t="templates",selectedClientId:e}){const{user:r}=Rt(),[n]=cw(),i=n.get("client"),l=n.get("tab"),[c,d]=U.useState(l||t),[m,f]=U.useState([]),[p,g]=U.useState(!0),[v,w]=U.useState(""),[S,y]=U.useState("todos"),[E,D]=U.useState(!1),[A,C]=U.useState(null);U.useEffect(()=>{c==="templates"&&P()},[c,S]),U.useEffect(()=>{(e||i)&&d("generate")},[e,i]);const P=async()=>{try{g(!0);let k=Pe.from("document_templates").select("*").eq("is_active",!0).order("created_at",{ascending:!1});S!=="todos"&&(k=k.eq("category",S));const{data:q,error:B}=await k;if(B)throw B;f(q||[])}catch(k){console.error("Erro ao carregar templates:",k)}finally{g(!1)}},F=async k=>{if(confirm("Tem certeza que deseja excluir este template?"))try{const{error:q}=await Pe.from("document_templates").update({is_active:!1}).eq("id",k.id);if(q)throw q;await P()}catch(q){console.error("Erro ao excluir template:",q)}},L=async k=>{try{const{error:q}=await Pe.from("document_templates").insert([{name:`${k.name} (Cpia)`,description:k.description,content_html:k.content_html,category:k.category,is_active:!0}]);if(q)throw q;await P()}catch(q){console.error("Erro ao duplicar template:",q)}},N=m.filter(k=>{var q;return k.name.toLowerCase().includes(v.toLowerCase())||((q=k.description)==null?void 0:q.toLowerCase().includes(v.toLowerCase()))}),j=k=>{switch(k){case"contratos":return"Contratos";case"propostas":return"Propostas";case"emails":return"E-mails";default:return k}},T=k=>{switch(k){case"contratos":return"bg-green-100 text-green-800";case"propostas":return"bg-blue-100 text-blue-800";case"emails":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"border-b border-[#e0e4e8]",children:a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx("button",{onClick:()=>d("templates"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="templates"?"border-[#6a1b9a] text-[#6a1b9a]":"border-transparent text-[#5a647e] hover:text-[#333333] hover:border-[#e0e4e8]"}`,children:"Gerenciar Templates"}),a.jsx("button",{onClick:()=>d("generate"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="generate"?"border-[#6a1b9a] text-[#6a1b9a]":"border-transparent text-[#5a647e] hover:text-[#333333] hover:border-[#e0e4e8]"}`,children:"Gerar Documento"}),a.jsx("button",{onClick:()=>d("history"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="history"?"border-[#6a1b9a] text-[#6a1b9a]":"border-transparent text-[#5a647e] hover:text-[#333333] hover:border-[#e0e4e8]"}`,children:"Histrico"})]})}),c==="templates"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Templates de Documentos"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Gerencie templates com campos dinmicos para contratos e propostas"})]}),a.jsxs(ue,{onClick:()=>D(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Novo Template"]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar templates...",icon:a.jsx(an,{size:18}),value:v,onChange:k=>w(k.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:S,onChange:k=>y(k.target.value),children:[a.jsx("option",{value:"todos",children:"Todas as Categorias"}),a.jsx("option",{value:"contratos",children:"Contratos"}),a.jsx("option",{value:"propostas",children:"Propostas"}),a.jsx("option",{value:"emails",children:"E-mails"})]}),a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})]})]})})}),p?a.jsx("div",{className:"flex items-center justify-center h-48",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando templates..."})]})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.length>0?N.map(k=>{var q;return a.jsxs(Ae,{className:"hover:shadow-lg transition-shadow",children:[a.jsx(at,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx(it,{className:"text-lg",children:k.name}),a.jsx(jt,{className:"mt-1",children:k.description||"Sem descrio"})]}),a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${T(k.category)}`,children:j(k.category)})]})}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"text-sm text-[#5a647e]",children:[a.jsxs("p",{children:["Criado em: ",new Date(k.created_at).toLocaleDateString("pt-BR")]}),((q=k.auto_detected_fields)==null?void 0:q.total_fields)&&a.jsxs("p",{children:["Campos: ",k.auto_detected_fields.total_fields," detectados"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>console.log("Preview:",k.id),title:"Visualizar",children:a.jsx(Cr,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>C(k),title:"Editar",children:a.jsx(is,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>L(k),title:"Duplicar",children:a.jsx(su,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>F(k),title:"Excluir",className:"text-red-600",children:a.jsx(Ws,{size:16})})]})]})})]},k.id)}):a.jsxs("div",{className:"col-span-full text-center py-12",children:[a.jsx(Tt,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-[#333333] mb-2",children:v||S!=="todos"?"Nenhum template encontrado":"Nenhum template cadastrado"}),a.jsx("p",{className:"text-[#5a647e] mb-6",children:v||S!=="todos"?"Tente ajustar os filtros para encontrar templates":"Crie seu primeiro template para comear"}),!v&&S==="todos"&&a.jsxs(ue,{onClick:()=>D(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Criar Template"]})]})})]}),c==="generate"&&a.jsx(kC,{selectedClientId:e||i||void 0,templates:m,onSuccess:()=>d("history")}),c==="history"&&a.jsx(CC,{}),(E||A)&&a.jsx(TC,{template:A,onClose:()=>{D(!1),C(null)},onSuccess:()=>{P(),D(!1),C(null)}})]})}function OC(){return a.jsx(wr,{children:a.jsx(AC,{})})}const Lx=["#6a1b9a","#1a237e","#4caf50","#ff9800","#f44336"];function PC(){var A,C,P;const{user:t}=Rt(),{exportTable:e,exporting:r}=Sh(),[n,i]=U.useState({}),[l,c]=U.useState(!0),[d,m]=U.useState({startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[f,p]=U.useState("todos"),[g,v]=U.useState([]);U.useEffect(()=>{S(),w()},[d,f]);const w=async()=>{try{const{data:F}=await Pe.from("users").select("id, full_name").eq("role","consultor").eq("is_active",!0);v(F||[])}catch(F){console.error("Erro ao carregar consultores:",F)}},S=async()=>{if(t)try{c(!0);let F=Pe.from("proposals").select(`
          *,
          clients!proposals_client_id_fkey(company_name),
          users!proposals_consultant_id_fkey(full_name)
        `).gte("created_at",d.startDate).lte("created_at",d.endDate+"T23:59:59");f!=="todos"&&(F=F.eq("consultant_id",f));const{data:L}=await F,{data:N}=await Pe.from("contracts").select("*").gte("created_at",d.startDate).lte("created_at",d.endDate+"T23:59:59"),{data:j}=await Pe.from("clients").select("*").eq("status","active"),T=y(L||[],N||[],j||[]);i(T)}catch(F){console.error("Erro ao carregar dados dos relatrios:",F)}finally{c(!1)}},y=(F,L,N)=>{const j=Array.from({length:12},(Q,W)=>{const re=new Date(0,W).toLocaleDateString("pt-BR",{month:"short"}),M=W+1,b=F.filter(I=>new Date(I.created_at).getMonth()+1===M&&I.status==="accepted");return{month:re,vendas:b.length,receita:b.reduce((I,H)=>I+(H.total_amount||0),0)}}),T=F.reduce((Q,W)=>(Q[W.status]=(Q[W.status]||0)+1,Q),{}),k=Object.entries(T).map(([Q,W])=>({status:Q==="accepted"?"Aceitas":Q==="rejected"?"Rejeitadas":Q==="sent"?"Enviadas":Q==="draft"?"Rascunho":Q,count:W})),q=g.reduce((Q,W)=>{const re=F.filter(b=>b.consultant_id===W.id),M=re.filter(b=>b.status==="accepted");return Q.push({consultor:W.full_name,propostas:re.length,aprovadas:M.length,receita:M.reduce((b,I)=>b+(I.total_amount||0),0),conversao:re.length>0?Math.round(M.length/re.length*100):0}),Q},[]),B=j.map((Q,W)=>({...Q,crescimento:W>0?(Q.receita-j[W-1].receita)/(j[W-1].receita||1)*100:0})),Y=F.filter(Q=>Q.status==="accepted"),pe=F.length>0?Y.length/F.length*100:0,we=Y.reduce((Q,W)=>Q+(W.total_amount||0),0),te=Y.length>0?we/Y.length:0,he=N.length;return{salesByMonth:j,proposalsByStatus:k,consultorPerformance:q,revenueGrowth:B,conversionRate:Math.round(pe),totalRevenue:we,avgDealSize:te,activeClients:he}},E=F=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(F),D=async()=>{var L;const F={data_inicio:d.startDate,data_fim:d.endDate,consultor_selecionado:f==="todos"?"Todos":((L=g.find(N=>N.id===f))==null?void 0:L.full_name)||"N/A",taxa_conversao:`${n.conversionRate||0}%`,receita_total:E(n.totalRevenue||0),ticket_medio:E(n.avgDealSize||0),clientes_ativos:n.activeClients||0,gerado_em:new Date().toLocaleString("pt-BR")};await e("relatorio",[F],`relatorio_${new Date().toISOString().split("T")[0]}`)};return l?a.jsx(wr,{children:a.jsx("div",{className:"flex items-center justify-center h-96",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando relatrios..."})]})})}):a.jsx(wr,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-[#1a237e]",children:"Relatrios"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Analytics e relatrios detalhados do sistema"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{variant:"outline",onClick:D,loading:r,children:[a.jsx(sn,{size:18,className:"mr-2"}),r?"Exportando...":"Exportar CSV"]}),a.jsxs(ue,{onClick:S,children:[a.jsx(x3,{size:18,className:"mr-2"}),"Atualizar"]})]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Data Incio"}),a.jsx(We,{type:"date",value:d.startDate,onChange:F=>m({...d,startDate:F.target.value})})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Data Fim"}),a.jsx(We,{type:"date",value:d.endDate,onChange:F=>m({...d,endDate:F.target.value})})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Consultor"}),a.jsxs("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:f,onChange:F=>p(F.target.value),children:[a.jsx("option",{value:"todos",children:"Todos os Consultores"}),g.map(F=>a.jsx("option",{value:F.id,children:F.full_name},F.id))]})]})]})})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Taxa de Converso"}),a.jsxs("p",{className:"text-2xl font-bold text-[#1a237e]",children:[n.conversionRate||0,"%"]})]}),a.jsx(_3,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Receita Total"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:E(n.totalRevenue||0)})]}),a.jsx(sl,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Ticket Mdio"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:E(n.avgDealSize||0)})]}),a.jsx(Sg,{className:"w-8 h-8 text-[#6a1b9a]"})]})})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-[#5a647e] font-medium",children:"Clientes Ativos"}),a.jsx("p",{className:"text-2xl font-bold text-[#1a237e]",children:n.activeClients||0})]}),a.jsx(Uc,{className:"w-8 h-8 text-[#6a1b9a]"})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Vendas por Ms"}),a.jsxs(jt,{children:["Volume de vendas e receita mensal - ",((A=n.salesByMonth)==null?void 0:A.length)||0," registros"]})]}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-4",children:[(n.salesByMonth||[]).map((F,L)=>{const N=Math.max(...(n.salesByMonth||[]).map(q=>q.vendas)),j=Math.max(...(n.salesByMonth||[]).map(q=>q.receita)),T=N>0?F.vendas/N*100:0,k=j>0?F.receita/j*100:0;return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"font-medium",children:F.month}),a.jsxs("span",{className:"text-muted-foreground",children:[F.vendas," vendas | ",E(F.receita)]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-[#6a1b9a] h-2 rounded-full transition-all duration-500",style:{width:`${T}%`}})}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:a.jsx("div",{className:"bg-[#1a237e] h-1 rounded-full transition-all duration-500",style:{width:`${k}%`}})})]})]},L)}),a.jsxs("div",{className:"flex justify-center space-x-4 text-xs mt-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-[#6a1b9a] rounded mr-1"}),a.jsx("span",{children:"Vendas"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-[#1a237e] rounded mr-1"}),a.jsx("span",{children:"Receita"})]})]})]})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Status das Propostas"}),a.jsxs(jt,{children:["Distribuio por status - ",((C=n.proposalsByStatus)==null?void 0:C.length)||0," categorias"]})]}),a.jsx(Oe,{children:a.jsx("div",{className:"space-y-4",children:(n.proposalsByStatus||[]).map((F,L)=>{const N=(n.proposalsByStatus||[]).reduce((k,q)=>k+q.count,0),j=N>0?F.count/N*100:0,T=Lx[L%Lx.length];return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:T}}),a.jsx("span",{className:"font-medium",children:F.status})]}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:[F.count," (",j.toFixed(1),"%)"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"h-2 rounded-full transition-all duration-500",style:{width:`${j}%`,backgroundColor:T}})})]},L)})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Crescimento de Receita"}),a.jsxs(jt,{children:["Evoluo mensal - Receita total: ",E(n.totalRevenue||0)]})]}),a.jsx(Oe,{children:a.jsx("div",{className:"space-y-4",children:(n.revenueGrowth||[]).map((F,L)=>{const N=Math.max(...(n.revenueGrowth||[]).map(k=>k.receita)),j=N>0?F.receita/N*100:0,T=F.crescimento>=0?"#4caf50":"#f44336";return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"font-medium",children:F.month}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{children:E(F.receita)}),a.jsxs("div",{className:"text-xs",style:{color:T},children:[F.crescimento>=0?"+":"",F.crescimento.toFixed(1),"%"]})]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-[#6a1b9a] h-2 rounded-full transition-all duration-500",style:{width:`${j}%`}})})]},L)})})})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Performance dos Consultores"}),a.jsxs(jt,{children:["Taxa de converso - ",((P=n.consultorPerformance)==null?void 0:P.length)||0," consultores"]})]}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-4",children:[(n.consultorPerformance||[]).map((F,L)=>{const N=Math.max(...(n.consultorPerformance||[]).map(k=>k.propostas));Math.max(...(n.consultorPerformance||[]).map(k=>k.receita));const j=N>0?F.propostas/N*100:0,T=F.propostas>0?F.aprovadas/F.propostas*100:0;return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"font-medium truncate mr-2",children:F.consultor}),a.jsxs("div",{className:"text-right text-xs",children:[a.jsxs("div",{children:[F.propostas," propostas"]}),a.jsxs("div",{className:"text-green-600",children:[F.aprovadas," aprovadas (",F.conversao,"%)"]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-[#6a1b9a] h-2 rounded-full transition-all duration-500",style:{width:`${j}%`}})}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1",children:a.jsx("div",{className:"bg-[#4caf50] h-1 rounded-full transition-all duration-500",style:{width:`${T}%`}})})]}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Receita: ",E(F.receita)]})]},L)}),a.jsxs("div",{className:"flex justify-center space-x-4 text-xs mt-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-[#6a1b9a] rounded mr-1"}),a.jsx("span",{children:"Total Propostas"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-[#4caf50] rounded mr-1"}),a.jsx("span",{children:"Taxa de Converso"})]})]})]})})]})]})]})})}function RC({presentation:t,onClose:e,onSuccess:r}){const{user:n}=Rt(),[i,l]=U.useState({name:"",description:"",content_html:"",category:"institucional"}),[c,d]=U.useState(!1),[m,f]=U.useState(""),[p,g]=U.useState(!1);U.useEffect(()=>{l(t?{name:t.name,description:t.description||"",content_html:t.content_html||"",content_json:t.content_json,category:t.category||"institucional"}:{name:"",description:"",content_html:v("institucional"),category:"institucional"}),f("")},[t]);const v=S=>{switch(S){case"institucional":return`<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apresentao Institucional</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; }
        .slide { padding: 40px; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .logo { max-height: 60px; }
        h1 { color: #6a1b9a; margin-bottom: 20px; }
        p { line-height: 1.6; }
    </style>
</head>
<body>
    <div class="slide">
        <div class="header">
            <img src="/5693A_SEUSDADOS_LOGO_ORIGINAL.png" alt="Logo" class="logo">
            <p>Apresentao Institucional</p>
        </div>
        <h1>Ttulo da Apresentao</h1>
        <p>Esta  uma apresentao institucional para a empresa.</p>
    </div>
</body>
</html>`;case"comercial":return`<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apresentao Comercial</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; }
        .slide { padding: 40px; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .logo { max-height: 60px; }
        h1 { color: #1565c0; margin-bottom: 20px; }
        p { line-height: 1.6; }
        .cta-button { background-color: #1565c0; color: white; border: none; padding: 12px 24px; border-radius: 4px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <div class="slide">
        <div class="header">
            <img src="/5693A_SEUSDADOS_LOGO_ORIGINAL.png" alt="Logo" class="logo">
            <p>Apresentao Comercial</p>
        </div>
        <h1>Proposta de Valor</h1>
        <p>Esta apresentao contm nossa proposta comercial para sua empresa.</p>
        <button class="cta-button">Solicitar Contato</button>
    </div>
</body>
</html>`;case"tecnica":return`<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apresentao Tcnica</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; }
        .slide { padding: 40px; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .logo { max-height: 60px; }
        h1 { color: #2e7d32; margin-bottom: 20px; }
        p { line-height: 1.6; }
        pre { background-color: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="slide">
        <div class="header">
            <img src="/5693A_SEUSDADOS_LOGO_ORIGINAL.png" alt="Logo" class="logo">
            <p>Apresentao Tcnica</p>
        </div>
        <h1>Detalhes Tcnicos</h1>
        <p>Esta apresentao contm os detalhes tcnicos de nossos servios e solues.</p>
        <pre>// Exemplo de implementao
const data = {
  services: ['LGPD', 'Segurana da Informao', 'Governana de Dados']
};</pre>
    </div>
</body>
</html>`;default:return`<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apresentao</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; }
        .slide { padding: 40px; min-height: 100vh; display: flex; flex-direction: column; justify-content: center; }
        .header { display: flex; justify-content: space-between; align-items: center; }
        .logo { max-height: 60px; }
        h1 { color: #333; margin-bottom: 20px; }
        p { line-height: 1.6; }
    </style>
</head>
<body>
    <div class="slide">
        <div class="header">
            <img src="/5693A_SEUSDADOS_LOGO_ORIGINAL.png" alt="Logo" class="logo">
        </div>
        <h1>Nova Apresentao</h1>
        <p>Edite este contedo para personalizar sua apresentao.</p>
    </div>
</body>
</html>`}},w=async S=>{S.preventDefault(),d(!0),f("");try{const{data:{session:y}}=await Pe.auth.getSession(),E=y==null?void 0:y.access_token,D={name:i.name,description:i.description||null,content_html:i.content_html||null,content_json:i.content_json||null,category:i.category||"institucional"};let A;if(t!=null&&t.id?A=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/presentation-manager/${t.id}`,{method:"PUT",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify(D)}):A=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/presentation-manager",{method:"POST",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify(D)}),!A.ok){const C=await A.text();throw new Error(`Erro ao salvar apresentao: ${C}`)}r()}catch(y){console.error("Erro ao salvar apresentao:",y),f(y.message||"Erro ao salvar apresentao")}finally{d(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:t?"Editar Apresentao":"Nova Apresentao"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:t?"Atualize a apresentao":"Crie uma nova apresentao personalizada"})]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"flex h-[calc(90vh-140px)]",children:[a.jsx("div",{className:"w-1/3 p-6 border-r border-[#e0e4e8] overflow-y-auto",children:a.jsxs("form",{onSubmit:w,className:"space-y-6",children:[a.jsx(We,{label:"Nome da Apresentao",placeholder:"Ex: Apresentao Institucional",value:i.name,onChange:S=>l({...i,name:S.target.value}),required:!0}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Categoria"}),a.jsxs("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:i.category,onChange:S=>{const y=S.target.value;l({...i,category:y,content_html:t?i.content_html:v(y)})},children:[a.jsx("option",{value:"institucional",children:"Institucional"}),a.jsx("option",{value:"comercial",children:"Comercial"}),a.jsx("option",{value:"tecnica",children:"Tcnica"}),a.jsx("option",{value:"outros",children:"Outros"})]})]}),a.jsx(We,{label:"Descrio (opcional)",placeholder:"Descreva o propsito desta apresentao...",value:i.description,onChange:S=>l({...i,description:S.target.value})}),m&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm",children:m}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{type:"submit",loading:c,className:"flex-1",children:[a.jsx(au,{size:16,className:"mr-2"}),t?"Atualizar":"Criar"," Apresentao"]}),a.jsx(ue,{type:"button",variant:"outline",onClick:()=>g(!p),children:p?a.jsx(Mc,{size:16}):a.jsx(Cr,{size:16})})]})]})}),a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsx("div",{className:"flex items-center justify-between p-4 border-b border-[#e0e4e8]",children:a.jsx("h3",{className:"font-medium text-[#333333]",children:p?"Preview":"Editor HTML"})}),p?a.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:a.jsx("iframe",{srcDoc:i.content_html,title:"Preview",className:"w-full h-full border rounded",sandbox:"allow-scripts"})}):a.jsx("div",{className:"flex-1",children:a.jsx("textarea",{className:"w-full h-full p-4 border-0 focus:outline-none font-mono text-sm resize-none",placeholder:"Digite o contedo HTML da apresentao...",value:i.content_html,onChange:S=>l({...i,content_html:S.target.value}),required:!0})})]})]})]})})}function FC({presentation:t,onClose:e}){const r=()=>{const n=document.createElement("a"),i=t.content_html||"",l=new Blob([i],{type:"text/html"});n.href=URL.createObjectURL(l),n.download=`${t.name.replace(/\s+/g,"_")}.html`,document.body.appendChild(n),n.click(),document.body.removeChild(n)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-[#e0e4e8] flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-[#1a237e]",children:t.name}),t.description&&a.jsx("p",{className:"text-[#5a647e] text-sm mt-1",children:t.description})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs(ue,{variant:"outline",size:"sm",onClick:r,children:[a.jsx(sn,{size:16,className:"mr-2"}),"Download"]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333] ml-4",children:a.jsx(Ar,{size:24})})]})]}),a.jsx("div",{className:"flex-1 overflow-hidden",children:t.content_html?a.jsx("iframe",{srcDoc:t.content_html,title:t.name,className:"w-full h-full border-0",sandbox:"allow-scripts"}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsx("p",{className:"text-[#5a647e]",children:"Esta apresentao no tem contedo HTML."})})})]})})}function DC(){const{user:t}=Rt(),[e,r]=U.useState("templates"),[n,i]=U.useState([]),[l,c]=U.useState(!0),[d,m]=U.useState(""),[f,p]=U.useState("todos"),[g,v]=U.useState(!1),[w,S]=U.useState(!1),[y,E]=U.useState(null),[D,A]=U.useState(null);U.useEffect(()=>{C()},[f]);const C=async()=>{try{c(!0);const{data:{session:T}}=await Pe.auth.getSession(),k=T==null?void 0:T.access_token;let q=new URLSearchParams;q.append("active_only","true"),q.append("limit","100"),f!=="todos"&&q.append("category",f);const B=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/presentation-manager?${q.toString()}`,{method:"GET",headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});if(B.ok){const Y=await B.json();i(Y.data||[])}else console.error("Erro ao carregar apresentaes:",await B.text())}catch(T){console.error("Erro ao carregar apresentaes:",T)}finally{c(!1)}},P=async T=>{if(confirm("Tem certeza que deseja excluir esta apresentao?"))try{const{data:{session:k}}=await Pe.auth.getSession(),q=k==null?void 0:k.access_token,B=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/presentation-manager/${T.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}});B.ok?await C():console.error("Erro ao excluir apresentao:",await B.text())}catch(k){console.error("Erro ao excluir apresentao:",k)}},F=async T=>{try{const{data:{session:k}}=await Pe.auth.getSession(),q=k==null?void 0:k.access_token,B={name:`${T.name} (Cpia)`,description:T.description,content_html:T.content_html,content_json:T.content_json,category:T.category},Y=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/presentation-manager",{method:"POST",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"},body:JSON.stringify(B)});Y.ok?await C():console.error("Erro ao duplicar apresentao:",await Y.text())}catch(k){console.error("Erro ao duplicar apresentao:",k)}},L=n.filter(T=>{var k;return T.name.toLowerCase().includes(d.toLowerCase())||((k=T.description)==null?void 0:k.toLowerCase().includes(d.toLowerCase()))}),N=T=>{if(!T)return"No categorizado";switch(T){case"institucional":return"Institucional";case"comercial":return"Comercial";case"tecnica":return"Tcnica";default:return T}},j=T=>{if(!T)return"bg-gray-100 text-gray-800";switch(T){case"institucional":return"bg-purple-100 text-purple-800";case"comercial":return"bg-blue-100 text-blue-800";case"tecnica":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Apresentaes Institucionais"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Gerencie apresentaes com contedo personalizado para seus clientes"})]}),a.jsxs(ue,{onClick:()=>v(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Nova Apresentao"]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar apresentaes...",icon:a.jsx(an,{size:18}),value:d,onChange:T=>m(T.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:f,onChange:T=>p(T.target.value),children:[a.jsx("option",{value:"todos",children:"Todas as Categorias"}),a.jsx("option",{value:"institucional",children:"Institucional"}),a.jsx("option",{value:"comercial",children:"Comercial"}),a.jsx("option",{value:"tecnica",children:"Tcnica"})]}),a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})]})]})})}),l?a.jsx("div",{className:"flex items-center justify-center h-48",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando apresentaes..."})]})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:L.length>0?L.map(T=>a.jsxs(Ae,{className:"hover:shadow-lg transition-shadow",children:[a.jsx(at,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx(it,{className:"text-lg",children:T.name}),a.jsx(jt,{className:"mt-1",children:T.description||"Sem descrio"})]}),a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${j(T.category)}`,children:N(T.category)})]})}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"text-sm text-[#5a647e]",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Vs,{size:14,className:"mr-1"}),a.jsxs("p",{children:["Criado em: ",new Date(T.created_at).toLocaleDateString("pt-BR")]})]}),T.version&&a.jsxs("div",{className:"flex items-center mt-1",children:[a.jsx(c3,{size:14,className:"mr-1"}),a.jsxs("p",{children:["Verso: ",T.version]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>{A(T),S(!0)},title:"Visualizar",children:a.jsx(Cr,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>E(T),title:"Editar",children:a.jsx(is,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>F(T),title:"Duplicar",children:a.jsx(su,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>P(T),title:"Excluir",className:"text-red-600",children:a.jsx(Ws,{size:16})})]})]})})]},T.id)):a.jsxs("div",{className:"col-span-full text-center py-12",children:[a.jsx(th,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-[#333333] mb-2",children:d||f!=="todos"?"Nenhuma apresentao encontrada":"Nenhuma apresentao cadastrada"}),a.jsx("p",{className:"text-[#5a647e] mb-6",children:d||f!=="todos"?"Tente ajustar os filtros para encontrar apresentaes":"Crie sua primeira apresentao para comear"}),!d&&f==="todos"&&a.jsxs(ue,{onClick:()=>v(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Criar Apresentao"]})]})}),(g||y)&&a.jsx(RC,{presentation:y,onClose:()=>{v(!1),E(null)},onSuccess:()=>{C(),v(!1),E(null)}}),w&&D&&a.jsx(FC,{presentation:D,onClose:()=>{S(!1),A(null)}})]})}function LC(){return a.jsx(wr,{children:a.jsx(DC,{})})}const Ix=[{value:"multiple_choice",label:"Mltipla Escolha (Checkbox)"},{value:"single_choice",label:"Seleo nica (Radio)"},{value:"text",label:"Texto Curto"},{value:"textarea",label:"Texto Longo"},{value:"scale",label:"Escala Numrica"},{value:"likert",label:"Escala Likert"},{value:"matrix",label:"Matriz de Respostas"},{value:"file",label:"Upload de Arquivo"},{value:"date",label:"Data/Hora"},{value:"number",label:"Campo Numrico"},{value:"email",label:"Email"},{value:"phone",label:"Telefone"},{value:"document",label:"CNPJ/CPF"},{value:"dropdown",label:"Lista Suspensa"},{value:"ranking",label:"Classificao (Ranking)"},{value:"boolean",label:"Sim/No"}];function IC({questionarioId:t,onClose:e,onSuccess:r}){const{user:n}=Rt(),[i,l]=U.useState(!1),[c,d]=U.useState(!!t),[m,f]=U.useState(""),[p,g]=U.useState({name:"",description:"",category:"pesquisa",settings_json:{theme:"default",show_progress_bar:!0,allow_save_and_continue:!0,success_message:"Obrigado por responder este questionrio!"}}),[v,w]=U.useState([{name:"Seo 1",description:"Descrio da seo",order_index:0,questions:[{question_text:"Pergunta 1",question_type:"single_choice",options_json:{options:["Opo 1","Opo 2","Opo 3"]},order_index:0,is_required:!0,help_text:"Texto de ajuda para esta pergunta"}]}]),[S,y]=U.useState({0:!0}),[E,D]=U.useState({}),[A,C]=U.useState(0),[P,F]=U.useState(null);U.useEffect(()=>{t&&L()},[t]);const L=async()=>{try{d(!0);const{data:{session:Q}}=await Pe.auth.getSession(),W=Q==null?void 0:Q.access_token,re=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager/${t}`,{headers:{Authorization:`Bearer ${W}`,"Content-Type":"application/json"}});if(re.ok){const M=await re.json(),b=M.questionnaire||{},I=M.sections||[];if(g({name:b.name||"",description:b.description||"",category:b.category||"pesquisa",settings_json:b.settings_json||{theme:"default",show_progress_bar:!0,allow_save_and_continue:!0,success_message:"Obrigado por responder este questionrio!"}}),I.length>0){w(I);const H={};I.forEach((G,se)=>{H[se]=se===0}),y(H),C(0)}}else f("Erro ao carregar o questionrio"),console.error("Erro ao carregar questionrio:",await re.text())}catch(Q){console.error("Erro ao carregar questionrio:",Q),f("Erro ao carregar o questionrio")}finally{d(!1)}},N=()=>{const Q=[...v];Q.push({name:`Seo ${Q.length+1}`,description:"",order_index:Q.length,questions:[]}),w(Q);const W={...S};W[Q.length-1]=!0,y(W),C(Q.length-1)},j=Q=>{if(v.length<=1){alert("O questionrio deve ter pelo menos uma seo");return}if(!confirm("Tem certeza que deseja remover esta seo e todas as suas perguntas?"))return;const W=[...v];W.splice(Q,1),W.forEach((M,b)=>{M.order_index=b}),w(W);const re={};W.forEach((M,b)=>{re[b]=S[b]||!1}),y(re),A>=W.length&&C(Math.max(0,W.length-1))},T=(Q,W,re)=>{const M=[...v];M[Q]={...M[Q],[W]:re},w(M)},k=Q=>{const W=[...v],re=[...W[Q].questions];re.push({question_text:`Pergunta ${re.length+1}`,question_type:"single_choice",options_json:{options:["Opo 1","Opo 2","Opo 3"]},order_index:re.length,is_required:!0,help_text:""}),W[Q].questions=re,w(W);const M=`${Q}_${re.length-1}`;D({...E,[M]:!0}),F({section:Q,question:re.length-1})},q=(Q,W)=>{if(!confirm("Tem certeza que deseja remover esta pergunta?"))return;const re=[...v],M=[...re[Q].questions];M.splice(W,1),M.forEach((b,I)=>{b.order_index=I}),re[Q].questions=M,w(re),(P==null?void 0:P.section)===Q&&P.question>=W&&(M.length===0?F(null):P.question>=M.length&&F({section:Q,question:Math.max(0,M.length-1)}))},B=(Q,W,re,M)=>{const b=[...v],I=[...b[Q].questions];I[W]={...I[W],[re]:M},b[Q].questions=I,w(b)},Y=(Q,W,re)=>{const M=[...v],b=[...M[Q].questions];b[W].options_json={...b[W].options_json,options:re},M[Q].questions=b,w(M)},pe=Q=>{y({...S,[Q]:!S[Q]}),C(Q)},we=(Q,W)=>{const re=`${Q}_${W}`;D({...E,[re]:!E[re]}),F({section:Q,question:W})},te=async Q=>{Q.preventDefault(),l(!0),f("");try{const{data:{session:W}}=await Pe.auth.getSession(),re=W==null?void 0:W.access_token,M={questionnaire:{...p,is_active:!0},sections:v.map(I=>({...I,questions:I.questions.map(H=>({...H,options_json:H.options_json||{},validation_rules_json:H.validation_rules_json||{},score_config_json:H.score_config_json||{}}))}))};let b;if(t?b=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager/${t}`,{method:"PUT",headers:{Authorization:`Bearer ${re}`,"Content-Type":"application/json"},body:JSON.stringify(M)}):b=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager",{method:"POST",headers:{Authorization:`Bearer ${re}`,"Content-Type":"application/json"},body:JSON.stringify(M)}),!b.ok){const I=await b.text();throw new Error(`Erro ao salvar questionrio: ${I}`)}r()}catch(W){console.error("Erro ao salvar questionrio:",W),f(W.message||"Erro ao salvar questionrio")}finally{l(!1)}},he=(Q,W,re)=>{const{question_type:M,options_json:b}=re;switch(M){case"multiple_choice":case"single_choice":case"dropdown":return a.jsxs("div",{className:"space-y-4",children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333]",children:"Opes de Resposta"}),a.jsx("div",{className:"space-y-2",children:((b==null?void 0:b.options)||[]).map((I,H)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"mr-2",children:M==="multiple_choice"?a.jsx("input",{type:"checkbox",disabled:!0,className:"rounded"}):a.jsx("input",{type:"radio",disabled:!0})}),a.jsx(We,{value:I,onChange:G=>{const se=[...(b==null?void 0:b.options)||[]];se[H]=G.target.value,Y(Q,W,se)},className:"flex-1"}),a.jsx(ue,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const G=[...(b==null?void 0:b.options)||[]];G.splice(H,1),Y(Q,W,G)},className:"ml-2 text-red-600",children:a.jsx(Ws,{size:16})})]},H))}),a.jsxs(ue,{type:"button",variant:"outline",size:"sm",onClick:()=>{const I=[...(b==null?void 0:b.options)||[]];I.push(`Opo ${I.length+1}`),Y(Q,W,I)},children:[a.jsx(cr,{size:16,className:"mr-2"}),"Adicionar Opo"]})]});case"scale":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Valor Mnimo"}),a.jsx(We,{type:"number",value:(b==null?void 0:b.min_value)||1,onChange:I=>{B(Q,W,"options_json",{...b,min_value:parseInt(I.target.value)})}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Valor Mximo"}),a.jsx(We,{type:"number",value:(b==null?void 0:b.max_value)||5,onChange:I=>{B(Q,W,"options_json",{...b,max_value:parseInt(I.target.value)})}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Rtulo do Valor Mnimo (opcional)"}),a.jsx(We,{value:(b==null?void 0:b.min_label)||"",placeholder:"Ex: Discordo totalmente",onChange:I=>{B(Q,W,"options_json",{...b,min_label:I.target.value})}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Rtulo do Valor Mximo (opcional)"}),a.jsx(We,{value:(b==null?void 0:b.max_label)||"",placeholder:"Ex: Concordo totalmente",onChange:I=>{B(Q,W,"options_json",{...b,max_label:I.target.value})}})]})]});case"text":case"textarea":return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Placeholder"}),a.jsx(We,{value:(b==null?void 0:b.placeholder)||"",placeholder:"Ex: Digite sua resposta aqui...",onChange:I=>{B(Q,W,"options_json",{...b,placeholder:I.target.value})}})]}),M==="text"&&a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Tamanho Mnimo"}),a.jsx(We,{type:"number",value:(b==null?void 0:b.min_length)||0,onChange:I=>{B(Q,W,"options_json",{...b,min_length:parseInt(I.target.value)})}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Tamanho Mximo"}),a.jsx(We,{type:"number",value:(b==null?void 0:b.max_length)||255,onChange:I=>{B(Q,W,"options_json",{...b,max_length:parseInt(I.target.value)})}})]})]})]});default:return a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Configure as opes para este tipo de pergunta."})}};return c?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando questionrio..."})]})}):a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-7xl w-full h-[90vh] flex flex-col",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:t?"Editar Questionrio":"Novo Questionrio"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:t?"Atualize o questionrio":"Crie um novo questionrio com lgica condicional avanada"})]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[a.jsx("div",{className:"w-1/3 p-6 border-r border-[#e0e4e8] overflow-y-auto",children:a.jsxs("form",{onSubmit:te,className:"space-y-6",children:[a.jsx(We,{label:"Nome do Questionrio",placeholder:"Ex: Diagnstico LGPD",value:p.name,onChange:Q=>g({...p,name:Q.target.value}),required:!0}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Categoria"}),a.jsxs("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:p.category,onChange:Q=>g({...p,category:Q.target.value}),children:[a.jsx("option",{value:"lgpd",children:"LGPD"}),a.jsx("option",{value:"due_diligence",children:"Due Diligence"}),a.jsx("option",{value:"pesquisa",children:"Pesquisa"}),a.jsx("option",{value:"diagnostico",children:"Diagnstico"}),a.jsx("option",{value:"outros",children:"Outros"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Descrio (opcional)"}),a.jsx("textarea",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a] resize-none h-24",placeholder:"Descreva o propsito deste questionrio...",value:p.description,onChange:Q=>g({...p,description:Q.target.value})})]}),a.jsxs("div",{className:"pt-4 border-t border-[#e0e4e8]",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"font-medium text-[#333333]",children:"Configuraes"}),a.jsx(ja,{size:16,className:"text-[#5a647e]"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"show_progress_bar",className:"mr-2",checked:p.settings_json.show_progress_bar,onChange:Q=>g({...p,settings_json:{...p.settings_json,show_progress_bar:Q.target.checked}})}),a.jsx("label",{htmlFor:"show_progress_bar",className:"text-sm text-[#333333]",children:"Mostrar barra de progresso"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"allow_save_continue",className:"mr-2",checked:p.settings_json.allow_save_and_continue,onChange:Q=>g({...p,settings_json:{...p.settings_json,allow_save_and_continue:Q.target.checked}})}),a.jsx("label",{htmlFor:"allow_save_continue",className:"text-sm text-[#333333]",children:"Permitir salvar e continuar depois"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-[#333333] mb-1",children:"Mensagem de sucesso"}),a.jsx(We,{value:p.settings_json.success_message,onChange:Q=>g({...p,settings_json:{...p.settings_json,success_message:Q.target.value}})})]})]})]}),m&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-red-600 text-sm",children:m}),a.jsx("div",{className:"flex justify-end pt-4 border-t border-[#e0e4e8]",children:a.jsxs(ue,{type:"submit",loading:i,children:[a.jsx(au,{size:16,className:"mr-2"}),t?"Atualizar":"Criar"," Questionrio"]})})]})}),a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-[#e0e4e8] flex items-center justify-between",children:[a.jsx("h3",{className:"font-medium text-[#333333]",children:"Sees e Perguntas"}),a.jsxs(ue,{variant:"outline",size:"sm",onClick:N,children:[a.jsx(cr,{size:16,className:"mr-2"}),"Adicionar Seo"]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"space-y-6",children:[v.map((Q,W)=>a.jsxs("div",{className:"border border-[#e0e4e8] rounded-lg overflow-hidden",children:[a.jsxs("div",{className:`p-4 flex items-center justify-between cursor-pointer ${A===W?"bg-[#f0e6fa]":"bg-white"}`,onClick:()=>pe(W),children:[a.jsxs("div",{className:"flex items-center",children:[S[W]?a.jsx($p,{size:18,className:"mr-2 text-[#6a1b9a]"}):a.jsx(Wp,{size:18,className:"mr-2 text-[#5a647e]"}),a.jsx("h4",{className:"font-medium",children:Q.name})]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx(ue,{variant:"ghost",size:"sm",onClick:re=>{re.stopPropagation(),j(W)},className:"text-red-600",children:a.jsx(Ws,{size:16})})})]}),S[W]&&a.jsxs("div",{className:"p-4 border-t border-[#e0e4e8]",children:[a.jsxs("div",{className:"space-y-4 mb-6",children:[a.jsx(We,{label:"Nome da Seo",value:Q.name,onChange:re=>T(W,"name",re.target.value)}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Descrio da Seo"}),a.jsx("textarea",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a] resize-none h-20",placeholder:"Descrio ou texto introdutrio para esta seo...",value:Q.description||"",onChange:re=>T(W,"description",re.target.value)})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h5",{className:"font-medium text-[#333333]",children:["Perguntas (",Q.questions.length,")"]}),a.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>k(W),children:[a.jsx(cr,{size:16,className:"mr-2"}),"Adicionar Pergunta"]})]}),a.jsx("div",{className:"space-y-4",children:Q.questions.length>0?Q.questions.map((re,M)=>{var H;const b=E[`${W}_${M}`]||!1,I=(P==null?void 0:P.section)===W&&P.question===M;return a.jsxs("div",{className:`border ${I?"border-[#6a1b9a]":"border-[#e0e4e8]"} rounded-lg overflow-hidden`,children:[a.jsxs("div",{className:`p-3 flex items-center justify-between cursor-pointer ${I?"bg-[#f0e6fa]":"bg-white"}`,onClick:()=>we(W,M),children:[a.jsxs("div",{className:"flex items-center",children:[b?a.jsx($p,{size:16,className:"mr-2 text-[#6a1b9a]"}):a.jsx(Wp,{size:16,className:"mr-2 text-[#5a647e]"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium truncate block max-w-xs",children:re.question_text}),a.jsx("span",{className:"text-xs text-[#5a647e]",children:((H=Ix.find(G=>G.value===re.question_type))==null?void 0:H.label)||re.question_type})]})]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx(ue,{variant:"ghost",size:"sm",onClick:G=>{G.stopPropagation(),q(W,M)},className:"text-red-600",children:a.jsx(Ws,{size:16})})})]}),b&&a.jsx("div",{className:"p-4 border-t border-[#e0e4e8]",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx(We,{label:"Texto da Pergunta",value:re.question_text,onChange:G=>B(W,M,"question_text",G.target.value)}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Tipo de Pergunta"}),a.jsx("select",{className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:re.question_type,onChange:G=>B(W,M,"question_type",G.target.value),children:Ix.map(G=>a.jsx("option",{value:G.value,children:G.label},G.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-[#333333] mb-2",children:"Texto de Ajuda (opcional)"}),a.jsx(We,{placeholder:"Texto explicativo sobre a pergunta...",value:re.help_text||"",onChange:G=>B(W,M,"help_text",G.target.value)})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:`required_${W}_${M}`,className:"mr-2",checked:re.is_required,onChange:G=>B(W,M,"is_required",G.target.checked)}),a.jsx("label",{htmlFor:`required_${W}_${M}`,className:"text-sm text-[#333333]",children:"Resposta obrigatria"})]}),a.jsxs("div",{className:"pt-4 border-t border-[#e0e4e8]",children:[a.jsxs("h6",{className:"font-medium text-[#333333] mb-4 flex items-center",children:[a.jsx(l3,{size:16,className:"mr-2 text-[#6a1b9a]"}),"Configuraes do Tipo de Pergunta"]}),he(W,M,re)]}),a.jsx("div",{className:"pt-4 border-t border-[#e0e4e8]",children:a.jsxs(ue,{type:"button",variant:"outline",className:"w-full justify-center",children:[a.jsx(v3,{size:16,className:"mr-2"}),"Configurar Lgica Condicional"]})})]})})]},M)}):a.jsxs("div",{className:"text-center py-8 border border-dashed border-[#e0e4e8] rounded-lg",children:[a.jsx("p",{className:"text-[#5a647e] mb-4",children:"Esta seo ainda no tem perguntas."}),a.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>k(W),children:[a.jsx(cr,{size:16,className:"mr-2"}),"Adicionar Primeira Pergunta"]})]})})]})]})]},W)),a.jsx("div",{className:"text-center",children:a.jsxs(ue,{variant:"outline",onClick:N,children:[a.jsx(cr,{size:16,className:"mr-2"}),"Adicionar Nova Seo"]})})]})})]})]})]})})}function MC({questionarioId:t,onClose:e}){const{user:r}=Rt(),[n,i]=U.useState(!0),[l,c]=U.useState(""),[d,m]=U.useState(null),[f,p]=U.useState([]),[g,v]=U.useState(0),[w,S]=U.useState({}),[y,E]=U.useState("form");U.useEffect(()=>{t&&D()},[t]);const D=async()=>{try{i(!0),c("");const{data:{session:N}}=await Pe.auth.getSession(),j=N==null?void 0:N.access_token,T=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager/${t}`,{headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"}});if(!T.ok)throw new Error(`Erro ao carregar questionrio: ${T.statusText}`);const k=await T.json();m(k.questionnaire||{}),p(k.sections||[])}catch(N){console.error("Erro ao carregar questionrio:",N),c(N.message||"Erro ao carregar questionrio")}finally{i(!1)}},A=()=>{g>0&&v(g-1)},C=()=>{g<f.length-1&&v(g+1)},P=(N,j)=>{S(T=>({...T,[N]:j}))},F=N=>{const{id:j,question_type:T,options_json:k,validation_rules_json:q}=N,B=w[j]||"";switch(T){case"single_choice":return a.jsx("div",{className:"space-y-2",children:((k==null?void 0:k.options)||[]).map((te,he)=>a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"radio",id:`${j}_${he}`,name:j,value:te,checked:B===te,onChange:Q=>P(j,Q.target.value),className:"mr-2"}),a.jsx("label",{htmlFor:`${j}_${he}`,className:"text-[#333333]",children:te})]},he))});case"multiple_choice":return a.jsx("div",{className:"space-y-2",children:((k==null?void 0:k.options)||[]).map((te,he)=>{const Q=Array.isArray(B)?B:[];return a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:`${j}_${he}`,value:te,checked:Q.includes(te),onChange:W=>{const re=W.target.checked,M=[...Q];if(re&&!Q.includes(te))M.push(te);else if(!re&&Q.includes(te)){const b=M.indexOf(te);M.splice(b,1)}P(j,M)},className:"mr-2"}),a.jsx("label",{htmlFor:`${j}_${he}`,className:"text-[#333333]",children:te})]},he)})});case"text":return a.jsx("input",{type:"text",value:B,onChange:te=>P(j,te.target.value),placeholder:(k==null?void 0:k.placeholder)||"Digite sua resposta",className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]"});case"textarea":return a.jsx("textarea",{value:B,onChange:te=>P(j,te.target.value),placeholder:(k==null?void 0:k.placeholder)||"Digite sua resposta",className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a] h-32"});case"number":return a.jsx("input",{type:"number",value:B,onChange:te=>P(j,te.target.value),placeholder:"0",className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]"});case"scale":const Y=(k==null?void 0:k.min_value)||1,pe=(k==null?void 0:k.max_value)||5,we=Array.from({length:pe-Y+1},(te,he)=>Y+he);return a.jsxs("div",{className:"w-full",children:[a.jsxs("div",{className:"flex justify-between mb-2 text-sm text-[#5a647e]",children:[a.jsx("span",{children:(k==null?void 0:k.min_label)||Y}),a.jsx("span",{children:(k==null?void 0:k.max_label)||pe})]}),a.jsx("div",{className:"flex justify-between space-x-2",children:we.map(te=>a.jsx("button",{type:"button",className:`flex-1 py-2 px-3 border ${B===te.toString()?"bg-[#6a1b9a] text-white":"bg-white text-[#333333]"} rounded-lg hover:bg-[#f0e6fa] focus:outline-none`,onClick:()=>P(j,te.toString()),children:te},te))})]});case"dropdown":return a.jsxs("select",{value:B,onChange:te=>P(j,te.target.value),className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a] bg-white",children:[a.jsx("option",{value:"",children:"Selecione uma opo"}),((k==null?void 0:k.options)||[]).map((te,he)=>a.jsx("option",{value:te,children:te},he))]});case"boolean":return a.jsxs("div",{className:"flex space-x-4",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"radio",id:`${j}_yes`,name:j,checked:B===!0,onChange:()=>P(j,!0),className:"mr-2"}),a.jsx("label",{htmlFor:`${j}_yes`,className:"text-[#333333]",children:"Sim"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"radio",id:`${j}_no`,name:j,checked:B===!1,onChange:()=>P(j,!1),className:"mr-2"}),a.jsx("label",{htmlFor:`${j}_no`,className:"text-[#333333]",children:"No"})]})]});default:return a.jsxs("p",{className:"text-[#5a647e] italic",children:['Visualizao para o tipo "',T,'" no implementada.']})}};if(n)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando questionrio..."})]})});if(l)return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full text-center",children:[a.jsx("p",{className:"text-red-600 mb-4",children:l}),a.jsx(ue,{onClick:e,children:"Fechar"})]})});const L=f[g]||{questions:[]};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-4xl w-full h-[90vh] flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-[#e0e4e8] flex items-center justify-between sticky top-0 bg-white",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-[#1a237e]",children:d.name}),d.description&&a.jsx("p",{className:"text-[#5a647e] text-sm mt-1",children:d.description})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"outline",size:"sm",onClick:()=>E(y==="form"?"json":"form"),children:y==="form"?"Ver JSON":"Ver Formulrio"}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333] ml-4",children:a.jsx(Ar,{size:20})})]})]}),y==="form"?a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-medium text-[#333333]",children:L.name}),a.jsxs("div",{className:"text-sm text-[#5a647e]",children:["Seo ",g+1," de ",f.length]})]}),L.description&&a.jsx("p",{className:"text-[#5a647e] mt-2",children:L.description})]}),a.jsx("div",{className:"space-y-8",children:L.questions&&L.questions.length>0?L.questions.map((N,j)=>a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"flex items-start",children:a.jsxs("h4",{className:"font-medium text-[#333333]",children:[j+1,". ",N.question_text,N.is_required&&a.jsx("span",{className:"text-red-600 ml-1",children:"*"})]})}),N.help_text&&a.jsx("p",{className:"text-sm text-[#5a647e]",children:N.help_text}),a.jsx("div",{className:"mt-3",children:F(N)})]},N.id)):a.jsx("p",{className:"text-center text-[#5a647e] italic",children:"Esta seo no possui perguntas."})})]})}):a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsx("pre",{className:"bg-gray-50 p-4 rounded-lg overflow-x-auto text-xs",children:JSON.stringify({questionnaire:d,sections:f},null,2)})}),y==="form"&&a.jsx("div",{className:"p-4 border-t border-[#e0e4e8] sticky bottom-0 bg-white",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ue,{variant:"outline",onClick:A,disabled:g===0,children:[a.jsx(Eg,{size:16,className:"mr-2"}),"Anterior"]}),a.jsxs(ue,{onClick:C,disabled:g===f.length-1,children:["Prxima",a.jsx(a3,{size:16,className:"ml-2"})]})]})})]})})}function BC({questionarioId:t,questionarioName:e,onClose:r}){const{user:n}=Rt(),[i,l]=U.useState(!1),[c,d]=U.useState(!0),[m,f]=U.useState(""),[p,g]=U.useState(""),[v,w]=U.useState([]),[S,y]=U.useState(""),E=window.location.origin;U.useEffect(()=>{D()},[]);const D=async()=>{try{d(!0);const{data:{session:F}}=await Pe.auth.getSession(),L=F==null?void 0:F.access_token,N=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/link-generator?questionnaire_id=${t}`,{headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"}});if(N.ok){const j=await N.json();w(j.data||[])}else console.error("Erro ao carregar links:",await N.text())}catch(F){console.error("Erro ao carregar links:",F)}finally{d(!1)}},A=async()=>{try{l(!0),f(""),g("");const{data:{session:F}}=await Pe.auth.getSession(),L=F==null?void 0:F.access_token,N={questionnaire_id:t};S&&(N.expires_at=new Date(S).toISOString());const j=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/link-generator",{method:"POST",headers:{Authorization:`Bearer ${L}`,"Content-Type":"application/json"},body:JSON.stringify(N)});if(j.ok){const T=await j.json();g("Link gerado com sucesso!"),await D(),y("")}else f("Erro ao gerar link: "+await j.text())}catch(F){f("Erro ao gerar link: "+F.message)}finally{l(!1)}},C=async F=>{try{const{data:{session:L}}=await Pe.auth.getSession(),N=L==null?void 0:L.access_token,j=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/link-generator/${F.unique_slug}`,{method:"PUT",headers:{Authorization:`Bearer ${N}`,"Content-Type":"application/json"},body:JSON.stringify({is_active:!F.is_active})});j.ok?await D():console.error("Erro ao atualizar status do link:",await j.text())}catch(L){console.error("Erro ao atualizar status do link:",L)}},P=F=>{const L=`${E}/q/${F}`;navigator.clipboard.writeText(L),g("Link copiado para a rea de transferncia!"),setTimeout(()=>g(""),3e3)};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-[#1a237e]",children:"Gerenciar Links de Compartilhamento"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:e})]}),a.jsx("button",{onClick:r,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"font-medium text-[#333333]",children:"Gerar Novo Link"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsx("div",{className:"col-span-2",children:a.jsx(We,{label:"Data de Expirao (opcional)",type:"datetime-local",value:S,onChange:F=>y(F.target.value)})}),a.jsx("div",{className:"flex items-end",children:a.jsxs(ue,{className:"w-full",onClick:A,loading:i,children:[a.jsx(df,{size:16,className:"mr-2"}),"Gerar Link"]})})]}),m&&a.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100 text-red-600 text-sm flex items-start",children:[a.jsx(Di,{size:16,className:"mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:m})]}),p&&a.jsx("div",{className:"bg-green-50 p-3 rounded-lg border border-green-100 text-green-600 text-sm",children:p})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"font-medium text-[#333333] border-b border-[#e0e4e8] pb-2",children:"Links Existentes"}),c?a.jsxs("div",{className:"text-center py-4",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-[#6a1b9a] border-t-transparent mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:"Carregando links..."})]}):v.length>0?a.jsx("div",{className:"space-y-3",children:v.map(F=>a.jsx("div",{className:`p-4 border rounded-lg ${F.is_active?"bg-white":"bg-gray-50"}`,children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(df,{size:16,className:"mr-2 text-[#6a1b9a]"}),a.jsx("p",{className:"font-medium text-[#333333]",children:`${E}/q/${F.unique_slug}`})]}),a.jsxs("div",{className:"flex flex-wrap gap-x-4 mt-2 text-sm text-[#5a647e]",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Vs,{size:14,className:"mr-1"}),a.jsxs("span",{children:["Criado em: ",new Date(F.created_at).toLocaleDateString("pt-BR")]})]}),F.expires_at&&a.jsx("div",{className:"flex items-center",children:a.jsxs("span",{children:["Expira em: ",new Date(F.expires_at).toLocaleString("pt-BR")]})}),a.jsx("div",{children:a.jsxs("span",{children:["Acessos: ",F.access_count]})})]})]}),a.jsxs("div",{className:"flex gap-2 sm:self-start self-end",children:[a.jsx(ue,{variant:"outline",size:"sm",onClick:()=>P(F.unique_slug),children:a.jsx(su,{size:16})}),a.jsx(ue,{variant:F.is_active?"outline":"default",size:"sm",onClick:()=>C(F),children:F.is_active?"Desativar":"Ativar"})]})]})},F.id))}):a.jsxs("div",{className:"text-center py-8 border border-dashed border-[#e0e4e8] rounded-lg",children:[a.jsx("p",{className:"text-[#5a647e] mb-4",children:"No h links de compartilhamento para este questionrio."}),a.jsxs(ue,{variant:"outline",onClick:A,children:[a.jsx(df,{size:16,className:"mr-2"}),"Gerar Primeiro Link"]})]})]})]})]})})}function UC({response:t,onClose:e,onSuccess:r}){const{user:n}=Rt(),[i,l]=U.useState(!1),[c,d]=U.useState(""),[m,f]=U.useState(!1),[p,g]=U.useState([]),[v,w]=U.useState(""),[S,y]=U.useState(!0),[E,D]=U.useState(null);U.useEffect(()=>{A()},[]);const A=async()=>{try{y(!0);const{data:P,error:F}=await Pe.from("users").select("id, full_name, email").eq("role","consultor").eq("is_active",!0).order("full_name",{ascending:!0});if(F)throw F;g(P||[]),P&&P.length>0&&w(P[0].id)}catch(P){console.error("Erro ao carregar consultores:",P)}finally{y(!1)}},C=async()=>{try{l(!0),d("");const{data:{session:P}}=await Pe.auth.getSession(),F=P==null?void 0:P.access_token,L=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/lead-converter",{method:"POST",headers:{Authorization:`Bearer ${F}`,"Content-Type":"application/json"},body:JSON.stringify({response_id:t.id,consultant_id:v||void 0})});if(!L.ok){const j=await L.text();throw new Error(`Erro ao converter lead: ${j}`)}const N=await L.json();if(N.lead_converted){d("Esta resposta j foi convertida em lead anteriormente.");return}D(N),f(!0),setTimeout(()=>{r()},2e3)}catch(P){console.error("Erro ao converter lead:",P),d(P.message||"Erro ao converter lead")}finally{l(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-2xl max-w-md w-full overflow-hidden",children:m?a.jsxs("div",{className:"p-6 text-center",children:[a.jsx("div",{className:"flex items-center justify-center mb-4",children:a.jsx($s,{size:64,className:"text-green-500"})}),a.jsx("h2",{className:"text-xl font-bold text-[#1a237e] mb-2",children:"Lead Criado com Sucesso!"}),a.jsx("p",{className:"text-[#5a647e] mb-6",children:"A resposta foi convertida em lead no CRM."}),E&&E.is_new_client?a.jsx("p",{className:"text-[#5a647e]",children:"Novo cliente criado e atribudo ao consultor selecionado."}):a.jsx("p",{className:"text-[#5a647e]",children:"Informaes adicionadas a um cliente existente."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-[#1a237e]",children:"Converter em Lead"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Criar lead no CRM a partir desta resposta"})]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-[#333333] mb-2",children:"Dados do Respondente"}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Nome:"})," ",t.respondent_name||"No informado"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," ",t.respondent_email||"No informado"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Questionrio:"})," ",t.questionnaires.name]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Data:"})," ",new Date(t.created_at).toLocaleString("pt-BR")]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-[#333333] mb-2",children:"Atribuir a Consultor"}),S?a.jsx("p",{className:"text-[#5a647e] text-sm",children:"Carregando consultores..."}):p.length>0?a.jsx("select",{value:v,onChange:P=>w(P.target.value),className:"w-full px-3 py-2 border border-[#e0e4e8] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",children:p.map(P=>a.jsx("option",{value:P.id,children:P.full_name},P.id))}):a.jsx("p",{className:"text-[#5a647e] text-sm",children:"No h consultores disponveis. O lead ser atribudo aleatoriamente."})]}),c&&a.jsx("div",{className:"bg-red-50 p-3 rounded-lg text-red-600 text-sm",children:c})]}),a.jsxs("div",{className:"p-6 border-t border-[#e0e4e8] flex justify-between",children:[a.jsx(ue,{variant:"outline",onClick:e,children:"Cancelar"}),a.jsxs(ue,{onClick:C,loading:i,children:[a.jsx(iu,{size:16,className:"mr-2"}),"Converter em Lead"]})]})]})})})}function zC({questionarioId:t,onBackToQuestionnaires:e}){const{user:r}=Rt(),[n,i]=U.useState([]),[l,c]=U.useState(!0),[d,m]=U.useState(""),[f,p]=U.useState(""),[g,v]=U.useState(null),[w,S]=U.useState(!1),[y,E]=U.useState(1),[D,A]=U.useState(1),[C]=U.useState(10);U.useEffect(()=>{P()},[t,y]);const P=async()=>{try{c(!0),m("");const{data:{session:q}}=await Pe.auth.getSession(),B=q==null?void 0:q.access_token;let Y=`https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-processor?page=${y}&limit=${C}`;t&&(Y+=`&questionnaire_id=${t}`);const pe=await fetch(Y,{headers:{Authorization:`Bearer ${B}`,"Content-Type":"application/json"}});if(!pe.ok)throw new Error(`Erro ao carregar respostas: ${pe.statusText}`);const we=await pe.json();i(we.data||[]),we.pagination&&A(we.pagination.pages||1)}catch(q){console.error("Erro ao carregar respostas:",q),m(q.message||"Erro ao carregar respostas")}finally{c(!1)}},F=q=>{v(q)},L=q=>{v(q),S(!0)},N=async()=>{S(!1),v(null),await P()},j=n.filter(q=>q.respondent_name&&q.respondent_name.toLowerCase().includes(f.toLowerCase())||q.respondent_email&&q.respondent_email.toLowerCase().includes(f.toLowerCase())),T=q=>{switch(q){case"completed":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"abandoned":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=q=>{switch(q){case"completed":return"Completo";case"partial":return"Parcial";case"abandoned":return"Abandonado";default:return q}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs(ue,{variant:"ghost",className:"mr-4 -ml-3",onClick:e,children:[a.jsx(Eg,{size:16,className:"mr-1"}),"Voltar"]}),a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e] inline-block",children:t?"Respostas do Questionrio":"Todas as Respostas"})]})}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar por nome ou email...",icon:a.jsx(an,{size:18}),value:f,onChange:q=>p(q.target.value)})}),a.jsx("div",{className:"flex items-center",children:a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})})]})})}),l?a.jsx("div",{className:"flex items-center justify-center h-48",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando respostas..."})]})}):d?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-red-600 mb-4",children:d}),a.jsx(ue,{onClick:P,children:"Tentar Novamente"})]}):j.length>0?a.jsxs("div",{className:"space-y-6",children:[j.map(q=>a.jsx(Ae,{className:"overflow-hidden",children:a.jsxs("div",{className:"flex flex-col md:flex-row",children:[a.jsx(at,{className:"md:w-2/3",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${T(q.completion_status)}`,children:k(q.completion_status)}),q.lead_converted&&a.jsx("span",{className:"inline-block px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",children:"Lead Convertido"})]}),a.jsx(it,{className:"text-lg",children:q.respondent_name||"Sem nome"}),a.jsxs(jt,{className:"mt-1 space-y-1",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ki,{size:14,className:"mr-2"}),a.jsx("span",{children:q.questionnaires.name})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ci,{size:14,className:"mr-2"}),a.jsx("span",{children:q.respondent_email||"Email no informado"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Vs,{size:14,className:"mr-2"}),a.jsxs("span",{children:["Respondido em: ",new Date(q.created_at).toLocaleString("pt-BR")]})]}),q.calculated_score!==null&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(Up,{size:14,className:"mr-2"}),a.jsxs("span",{children:["Pontuao: ",q.calculated_score]})]})]})]})})}),a.jsxs(Oe,{className:"p-4 md:w-1/3 flex items-center justify-end md:border-l border-[#e0e4e8] space-x-2",children:[a.jsx(ue,{variant:"outline",size:"sm",onClick:()=>F(q),children:"Ver Detalhes"}),!q.lead_converted&&a.jsx(ue,{size:"sm",onClick:()=>L(q),children:"Converter em Lead"})]})]})},q.id)),D>1&&a.jsx("div",{className:"flex justify-center mt-6",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx(ue,{variant:"outline",size:"sm",disabled:y===1,onClick:()=>E(y-1),children:"Anterior"}),a.jsx("div",{className:"flex items-center px-4 py-2 border border-[#e0e4e8] rounded-lg",children:a.jsxs("span",{className:"text-sm text-[#333333]",children:["Pgina ",y," de ",D]})}),a.jsx(ue,{variant:"outline",size:"sm",disabled:y===D,onClick:()=>E(y+1),children:"Prxima"})]})})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(ki,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-[#333333] mb-2",children:f?"Nenhuma resposta encontrada":"Nenhuma resposta recebida"}),a.jsx("p",{className:"text-[#5a647e] mb-6",children:f?"Tente ajustar os termos de busca":t?"Este questionrio ainda no recebeu respostas":"No h respostas para nenhum questionrio"}),f&&a.jsx(ue,{variant:"outline",onClick:()=>p(""),children:"Limpar Busca"})]}),g&&!w&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-3xl w-full max-h-[80vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold text-[#1a237e]",children:"Detalhes da Resposta"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:g.questionnaires.name})]}),a.jsx("button",{onClick:()=>v(null),className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Go,{size:16,className:"mr-2 text-[#5a647e]"}),a.jsx("p",{className:"font-medium",children:g.respondent_name||"Sem nome"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ci,{size:16,className:"mr-2 text-[#5a647e]"}),a.jsx("p",{children:g.respondent_email||"Email no informado"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Vs,{size:16,className:"mr-2 text-[#5a647e]"}),a.jsxs("p",{children:["Respondido em: ",new Date(g.created_at).toLocaleString("pt-BR")]})]})]}),a.jsxs("div",{className:"flex flex-col items-start sm:items-end space-y-2",children:[a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${T(g.completion_status)}`,children:k(g.completion_status)}),g.calculated_score!==null&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(Up,{size:16,className:"mr-2 text-[#5a647e]"}),a.jsxs("span",{className:"font-medium",children:["Pontuao: ",g.calculated_score]})]}),g.lead_converted?a.jsx("span",{className:"inline-block px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800",children:"Lead Convertido"}):a.jsx(ue,{size:"sm",onClick:()=>S(!0),children:"Converter em Lead"})]})]})}),a.jsxs("div",{className:"border-t border-[#e0e4e8] pt-6",children:[a.jsx("h3",{className:"font-medium text-[#333333] mb-4",children:"Respostas"}),g.responses_json&&Object.keys(g.responses_json).length>0?a.jsxs("div",{className:"space-y-4",children:[a.jsx("pre",{className:"bg-gray-50 p-4 rounded-lg overflow-x-auto text-sm",children:JSON.stringify(g.responses_json,null,2)}),a.jsx("p",{className:"text-sm text-[#5a647e]",children:"* Visualizao formatada das respostas ser implementada em breve."})]}):a.jsx("p",{className:"text-[#5a647e] italic",children:"No h dados de respostas disponveis."})]})]}),a.jsx("div",{className:"p-6 border-t border-[#e0e4e8]",children:a.jsx(ue,{variant:"outline",onClick:()=>v(null),children:"Fechar"})})]})}),w&&g&&a.jsx(UC,{response:g,onClose:()=>{S(!1),v(null)},onSuccess:N})]})}function $C({isOpen:t,onClose:e,onSuccess:r}){const{user:n}=Rt(),[i,l]=U.useState(null),[c,d]=U.useState(!1),[m,f]=U.useState(null),[p,g]=U.useState(null),[v,w]=U.useState(!1),[S,y]=U.useState(!1),E=U.useRef(null),D=N=>{N.preventDefault(),N.stopPropagation(),N.type==="dragenter"||N.type==="dragover"?y(!0):N.type==="dragleave"&&y(!1)},A=N=>{N.preventDefault(),N.stopPropagation(),y(!1),N.dataTransfer.files&&N.dataTransfer.files[0]&&C(N.dataTransfer.files[0])},C=N=>{if(!["application/json","text/plain","text/json"].includes(N.type)&&!N.name.endsWith(".json")&&!N.name.endsWith(".txt")){alert("Apenas arquivos JSON e TXT so permitidos");return}if(N.size>5*1024*1024){alert("Arquivo muito grande. Tamanho mximo: 5MB");return}l(N),P(N)},P=async N=>{try{const j=await N.text();let T;if(N.name.endsWith(".json"))try{T=JSON.parse(j)}catch{throw new Error("Arquivo JSON invlido")}else try{T=JSON.parse(j)}catch{T={name:N.name.replace(/\.[^/.]+$/,""),description:"Questionrio importado de arquivo TXT",content:j}}g(T),w(!0)}catch(j){console.error("Erro ao analisar arquivo:",j),alert("Erro ao analisar arquivo: "+j.message)}},F=async()=>{var N;if(!(!i||!p))try{d(!0),f(null);const{data:{session:j}}=await Pe.auth.getSession(),T=j==null?void 0:j.access_token,k="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvcHBhZHpweWZ0amtlcmdjY3BuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDUzODYsImV4cCI6MjA3MTE4MTM4Nn0.ExLR9dipmd8XvOzSafxYFF9Y5JFBoUfLia8splbgaVc",q=new FormData;q.append("file",i),q.append("import_options",JSON.stringify({create_new_questionnaire:!0,merge_with_existing:!1,preserve_ids:!1}));const B=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/import-questionnaire",{method:"POST",headers:{Authorization:`Bearer ${k}`,apikey:k},body:q});if(B.ok){const Y=await B.json();f(Y.data),Y.data.success&&setTimeout(()=>{r(),e()},2e3)}else{let Y="Erro na importao";try{const pe=await B.json();Y=((N=pe.error)==null?void 0:N.message)||pe.message||Y}catch{try{Y=await B.text()||Y}catch{}}f({success:!1,error:Y})}}catch(j){console.error("Erro na importao:",j),f({success:!1,error:"Erro de comunicao com o servidor"})}finally{d(!1)}},L=()=>{l(null),g(null),w(!1),f(null),E.current&&(E.current.value="")};return t?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-[#e0e4e8]",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Importar Questionrio"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Importe questionrios a partir de arquivos JSON ou TXT"})]}),a.jsx("button",{onClick:e,className:"text-[#5a647e] hover:text-[#333333]",children:a.jsx(Ar,{size:24})})]})}),a.jsxs("div",{className:"p-6",children:[!i&&a.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${S?"border-[#6a1b9a] bg-[#f7f8fc]":"border-[#e0e4e8] hover:border-[#6a1b9a]"}`,onDragEnter:D,onDragLeave:D,onDragOver:D,onDrop:A,children:[a.jsx(Bc,{className:"w-12 h-12 text-[#5a647e] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-[#333333] mb-2",children:"Selecione ou arraste um arquivo"}),a.jsx("p",{className:"text-[#5a647e] mb-4",children:"Formatos suportados: JSON, TXT (mx. 5MB)"}),a.jsx(ue,{onClick:()=>{var N;return(N=E.current)==null?void 0:N.click()},className:"mb-4",children:"Selecionar Arquivo"}),a.jsx("input",{ref:E,type:"file",accept:".json,.txt",onChange:N=>N.target.files&&C(N.target.files[0]),className:"hidden"})]}),i&&v&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Tt,{className:"w-5 h-5 text-[#6a1b9a]"}),a.jsx("span",{className:"font-medium",children:i.name}),a.jsxs("span",{className:"text-sm text-[#5a647e]",children:["(",(i.size/1024).toFixed(1)," KB)"]})]}),a.jsx(ue,{variant:"outline",size:"sm",onClick:L,children:"Trocar Arquivo"})]}),a.jsxs(Ae,{children:[a.jsxs(at,{children:[a.jsx(it,{children:"Preview da Estrutura"}),a.jsx(jt,{children:"Verificao dos dados do questionrio antes da importao"})]}),a.jsx(Oe,{children:a.jsx("div",{className:"bg-[#f7f8fc] rounded-lg p-4 max-h-64 overflow-y-auto",children:a.jsx("pre",{className:"text-sm text-[#333333] whitespace-pre-wrap",children:JSON.stringify(p,null,2)})})})]}),!c&&!m&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx(ue,{variant:"outline",onClick:e,children:"Cancelar"}),a.jsx(ue,{onClick:F,children:"Importar Questionrio"})]})]}),c&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx(d3,{className:"w-8 h-8 animate-spin text-[#6a1b9a] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-[#333333] mb-2",children:"Importando questionrio..."}),a.jsx("p",{className:"text-[#5a647e]",children:"Processando arquivo e criando estruturas no sistema"})]}),m&&a.jsxs("div",{className:"space-y-4",children:[m.success?a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx($s,{className:"w-5 h-5 text-green-600"}),a.jsx("h3",{className:"font-medium text-green-800",children:"Importao realizada com sucesso!"})]}),a.jsxs("div",{className:"text-sm text-green-700 space-y-1",children:[m.questionnaire_name&&a.jsxs("p",{children:[a.jsx("strong",{children:"Questionrio:"})," ",m.questionnaire_name]}),m.imported_sections&&a.jsxs("p",{children:[a.jsx("strong",{children:"Sees importadas:"})," ",m.imported_sections]}),m.imported_questions&&a.jsxs("p",{children:[a.jsx("strong",{children:"Perguntas importadas:"})," ",m.imported_questions]})]}),m.warnings&&m.warnings.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx("p",{className:"text-sm font-medium text-yellow-800 mb-1",children:"Avisos:"}),a.jsx("ul",{className:"text-sm text-yellow-700 list-disc list-inside",children:m.warnings.map((N,j)=>a.jsx("li",{children:N},j))})]})]}):a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx(Di,{className:"w-5 h-5 text-red-600"}),a.jsx("h3",{className:"font-medium text-red-800",children:"Erro na importao"})]}),a.jsx("p",{className:"text-sm text-red-700",children:m.error||"Erro desconhecido durante a importao"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx(ue,{variant:"outline",onClick:L,children:"Importar Outro"}),a.jsx(ue,{onClick:e,children:"Fechar"})]})]})]})]})}):null}function WC(){const{user:t}=Rt(),[e,r]=U.useState("questionarios"),[n,i]=U.useState([]),[l,c]=U.useState(!0),[d,m]=U.useState(""),[f,p]=U.useState("todos"),[g,v]=U.useState(!1),[w,S]=U.useState(!1),[y,E]=U.useState(!1),[D,A]=U.useState(!1),[C,P]=U.useState(null),[F,L]=U.useState(null);U.useEffect(()=>{e==="questionarios"&&N()},[e,f]);const N=async()=>{try{c(!0);const{data:{session:Y}}=await Pe.auth.getSession(),pe=Y==null?void 0:Y.access_token,we=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager",{headers:{Authorization:`Bearer ${pe}`,"Content-Type":"application/json"}});if(we.ok){const te=await we.json();i(te.data||[])}else console.error("Erro ao carregar questionrios:",await we.text())}catch(Y){console.error("Erro ao carregar questionrios:",Y)}finally{c(!1)}},j=async Y=>{if(confirm("Tem certeza que deseja excluir este questionrio?"))try{const{data:{session:pe}}=await Pe.auth.getSession(),we=pe==null?void 0:pe.access_token,te=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager/${Y.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${we}`,"Content-Type":"application/json"}});te.ok?await N():console.error("Erro ao excluir questionrio:",await te.text())}catch(pe){console.error("Erro ao excluir questionrio:",pe)}},T=async Y=>{try{const{data:{session:pe}}=await Pe.auth.getSession(),we=pe==null?void 0:pe.access_token,te=await fetch(`https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager/${Y.id}`,{headers:{Authorization:`Bearer ${we}`,"Content-Type":"application/json"}});if(te.ok){const Q=(await te.json()).sections||[],W={questionnaire:{name:`${Y.name} (Cpia)`,description:Y.description,category:Y.category,settings_json:Y.settings_json},sections:Q.map(M=>({...M,id:void 0,questions:M.questions.map(b=>({...b,id:void 0,logic:b.logic.map(I=>({...I,id:void 0,question_id:void 0,target_question_id:void 0,target_section_id:void 0}))}))}))},re=await fetch("https://poppadzpyftjkergccpn.supabase.co/functions/v1/questionnaire-manager",{method:"POST",headers:{Authorization:`Bearer ${we}`,"Content-Type":"application/json"},body:JSON.stringify(W)});re.ok?await N():console.error("Erro ao duplicar questionrio:",await re.text())}else console.error("Erro ao buscar questionrio para duplicar:",await te.text())}catch(pe){console.error("Erro ao duplicar questionrio:",pe)}},k=n.filter(Y=>{const pe=Y.name.toLowerCase().includes(d.toLowerCase())||(Y.description||"").toLowerCase().includes(d.toLowerCase()),we=f==="todos"||Y.category===f,te=Y.is_active!==!1;return pe&&we&&te}),q=Y=>{if(!Y)return"No categorizado";switch(Y){case"lgpd":return"LGPD";case"due_diligence":return"Due Diligence";case"pesquisa":return"Pesquisa";case"diagnostico":return"Diagnstico";default:return Y.charAt(0).toUpperCase()+Y.slice(1)}},B=Y=>{if(!Y)return"bg-gray-100 text-gray-800";switch(Y){case"lgpd":return"bg-purple-100 text-purple-800";case"due_diligence":return"bg-blue-100 text-blue-800";case"pesquisa":return"bg-green-100 text-green-800";case"diagnostico":return"bg-amber-100 text-amber-800";default:return"bg-gray-100 text-gray-800"}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"border-b border-[#e0e4e8]",children:a.jsxs("nav",{className:"flex space-x-8",children:[a.jsx("button",{onClick:()=>r("questionarios"),className:`py-2 px-1 border-b-2 font-medium text-sm ${e==="questionarios"?"border-[#6a1b9a] text-[#6a1b9a]":"border-transparent text-[#5a647e] hover:text-[#333333] hover:border-[#e0e4e8]"}`,children:"Questionrios"}),a.jsx("button",{onClick:()=>r("respostas"),className:`py-2 px-1 border-b-2 font-medium text-sm ${e==="respostas"?"border-[#6a1b9a] text-[#6a1b9a]":"border-transparent text-[#5a647e] hover:text-[#333333] hover:border-[#e0e4e8]"}`,children:"Respostas"})]})}),e==="questionarios"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-[#1a237e]",children:"Questionrios e Diagnsticos"}),a.jsx("p",{className:"text-[#5a647e] mt-1",children:"Crie, edite e gerencie questionrios com lgica condicional avanada"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs(ue,{variant:"outline",onClick:()=>A(!0),children:[a.jsx(ki,{size:18,className:"mr-2"}),"Importar Questionrio"]}),a.jsxs(ue,{onClick:()=>v(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Novo Questionrio"]})]})]}),a.jsx(Ae,{children:a.jsx(Oe,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(We,{placeholder:"Buscar questionrios...",icon:a.jsx(an,{size:18}),value:d,onChange:Y=>m(Y.target.value)})}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsxs("select",{className:"px-4 py-2 rounded-lg border border-[#e0e4e8] bg-white text-[#333333] focus:outline-none focus:ring-2 focus:ring-[#6a1b9a]",value:f,onChange:Y=>p(Y.target.value),children:[a.jsx("option",{value:"todos",children:"Todas as Categorias"}),a.jsx("option",{value:"lgpd",children:"LGPD"}),a.jsx("option",{value:"due_diligence",children:"Due Diligence"}),a.jsx("option",{value:"pesquisa",children:"Pesquisa"}),a.jsx("option",{value:"diagnostico",children:"Diagnstico"})]}),a.jsxs(ue,{variant:"outline",size:"sm",children:[a.jsx(Qs,{size:16,className:"mr-2"}),"Filtros"]})]})]})})}),l?a.jsx("div",{className:"flex items-center justify-center h-48",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-[#6a1b9a] border-t-transparent mx-auto mb-4"}),a.jsx("p",{className:"text-[#5a647e]",children:"Carregando questionrios..."})]})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.length>0?k.map(Y=>a.jsxs(Ae,{className:"hover:shadow-lg transition-shadow",children:[a.jsx(at,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx(it,{className:"text-lg",children:Y.name}),a.jsx(jt,{className:"mt-1",children:Y.description||"Sem descrio"})]}),a.jsx("span",{className:`inline-block px-2 py-1 text-xs rounded-full ${B(Y.category)}`,children:q(Y.category)})]})}),a.jsx(Oe,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"text-sm text-[#5a647e]",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx(Vs,{size:14,className:"mr-1"}),a.jsxs("p",{children:["Criado em: ",new Date(Y.created_at).toLocaleDateString("pt-BR")]})]})}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>{P(Y),S(!0)},title:"Visualizar",children:a.jsx(Cr,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>{P(Y),v(!0)},title:"Editar",children:a.jsx(is,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>T(Y),title:"Duplicar",children:a.jsx(su,{size:16})}),a.jsx(ue,{variant:"ghost",size:"sm",onClick:()=>j(Y),title:"Excluir",className:"text-red-600",children:a.jsx(Ws,{size:16})})]}),a.jsxs(ue,{variant:"outline",size:"sm",onClick:()=>{P(Y),E(!0)},children:[a.jsx(Ng,{size:16,className:"mr-2"}),"Compartilhar"]})]}),a.jsxs(ue,{variant:"ghost",className:"w-full justify-center text-sm mt-2 border border-[#e0e4e8]",onClick:()=>{L(Y.id),r("respostas")},children:[a.jsx(Sg,{size:16,className:"mr-2"}),"Ver Respostas"]})]})})]},Y.id)):a.jsxs("div",{className:"col-span-full text-center py-12",children:[a.jsx(ki,{className:"w-16 h-16 text-[#e0e4e8] mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-[#333333] mb-2",children:d||f!=="todos"?"Nenhum questionrio encontrado":"Nenhum questionrio cadastrado"}),a.jsx("p",{className:"text-[#5a647e] mb-6",children:d||f!=="todos"?"Tente ajustar os filtros para encontrar questionrios":"Crie seu primeiro questionrio para comear"}),!d&&f==="todos"&&a.jsxs(ue,{onClick:()=>v(!0),children:[a.jsx(cr,{size:18,className:"mr-2"}),"Criar Questionrio"]})]})})]}),e==="respostas"&&a.jsx(zC,{questionarioId:F,onBackToQuestionnaires:()=>{r("questionarios"),L(null)}}),g&&a.jsx(IC,{questionarioId:C==null?void 0:C.id,onClose:()=>{v(!1),P(null)},onSuccess:()=>{N(),v(!1),P(null)}}),w&&C&&a.jsx(MC,{questionarioId:C.id,onClose:()=>{S(!1),P(null)}}),y&&C&&a.jsx(BC,{questionarioId:C.id,questionarioName:C.name,onClose:()=>{E(!1),P(null)}}),D&&a.jsx($C,{isOpen:D,onClose:()=>A(!1),onSuccess:()=>{N(),A(!1)}})]})}function VC(){return a.jsx(wr,{children:a.jsx(WC,{})})}function HC(){return a.jsx("div",{className:"min-h-screen bg-[#f5f5fa] flex items-center justify-center p-6",children:a.jsxs(Ae,{variant:"elevated",className:"max-w-md w-full",children:[a.jsxs(at,{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Lf,{className:"w-8 h-8 text-red-600"})}),a.jsx(it,{className:"text-red-600",children:"Acesso Negado"}),a.jsx(jt,{children:"Voc no tem permisso para acessar esta pgina."})]}),a.jsx(Oe,{className:"text-center",children:a.jsx(ue,{onClick:()=>window.history.back(),variant:"outline",children:"Voltar"})})]})})}function qC(){return a.jsx(wj,{children:a.jsx(aw,{children:a.jsxs(Y_,{children:[a.jsx(lr,{path:"/login",element:a.jsx(j3,{})}),a.jsx(lr,{path:"/unauthorized",element:a.jsx(HC,{})}),a.jsx(lr,{path:"/dashboard",element:a.jsx(Hr,{children:a.jsx(Vp,{})})}),a.jsx(lr,{path:"/consultores",element:a.jsx(Hr,{roles:["admin"],children:a.jsx(SC,{})})}),a.jsx(lr,{path:"/clientes",element:a.jsx(Hr,{roles:["admin"],children:a.jsx(Rx,{})})}),a.jsx(lr,{path:"/servicos",element:a.jsx(Hr,{roles:["admin"],children:a.jsx(NC,{})})}),a.jsx(lr,{path:"/documentos",element:a.jsx(Hr,{roles:["admin","consultor"],children:a.jsx(OC,{})})}),a.jsx(lr,{path:"/apresentacoes",element:a.jsx(Hr,{roles:["admin","consultor"],children:a.jsx(LC,{})})}),a.jsx(lr,{path:"/questionarios",element:a.jsx(Hr,{roles:["admin","consultor"],children:a.jsx(VC,{})})}),a.jsx(lr,{path:"/relatorios",element:a.jsx(Hr,{roles:["admin"],children:a.jsx(PC,{})})}),a.jsx(lr,{path:"/meus-clientes",element:a.jsx(Hr,{roles:["consultor"],children:a.jsx(Rx,{isConsultor:!0})})}),a.jsx(lr,{path:"/propostas",element:a.jsx(Hr,{roles:["consultor","admin"],children:a.jsx(Fx,{})})}),a.jsx(lr,{path:"/contratos",element:a.jsx(Hr,{roles:["consultor","admin"],children:a.jsx(Dx,{})})}),a.jsx(lr,{path:"/area-cliente",element:a.jsx(Hr,{roles:["cliente"],children:a.jsx(Vp,{})})}),a.jsx(lr,{path:"/minhas-propostas",element:a.jsx(Hr,{roles:["cliente"],children:a.jsx(Fx,{isCliente:!0})})}),a.jsx(lr,{path:"/meus-contratos",element:a.jsx(Hr,{roles:["cliente"],children:a.jsx(Dx,{isCliente:!0})})}),a.jsx(lr,{path:"/",element:a.jsx(Fo,{to:"/dashboard",replace:!0})})]})})})}i_.createRoot(document.getElementById("root")).render(a.jsx($f.StrictMode,{children:a.jsx(qC,{})}));
